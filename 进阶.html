<!DOCTYPE html>
<!-- saved from url=(0085)http://interview.poetries.top/docs/simply.html#%E4%B8%80%E3%80%81js%E5%9F%BA%E7%A1%80 -->
<html lang="en-US" class=" "><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    
    <title>é¢è¯•æŒ‡å—</title>
    
    <link rel="icon" href="./è¿›é˜¶_files/logo.png">
    <link rel="manifest" href="http://interview.poetries.top/manifest.json">
    <link rel="apple-touch-icon" href="http://interview.poetries.top/icons/apple-touch-icon-152x152.png">
    <link rel="mask-icon" href="http://interview.poetries.top/icons/safari-pinned-tab.svg" color="#3eaf7c">
    
    
    
    
    
    
    
    <link rel="preload" href="./è¿›é˜¶_files/0.styles.a3a6df6c.css" as="style"><link rel="preload" href="./è¿›é˜¶_files/app.545cb75b.js.ä¸‹è½½" as="script"><link rel="preload" href="./è¿›é˜¶_files/5.bc663a4c.js.ä¸‹è½½" as="script"><link rel="preload" href="./è¿›é˜¶_files/4.1aaf03c6.js.ä¸‹è½½" as="script"><link rel="preload" href="./è¿›é˜¶_files/61.8356d65b.js.ä¸‹è½½" as="script"><link rel="preload" href="./è¿›é˜¶_files/11.3e5297f1.js.ä¸‹è½½" as="script"><link rel="prefetch" href="./è¿›é˜¶_files/1.d83c2af0.js.ä¸‹è½½"><link rel="prefetch" href="http://interview.poetries.top/assets/js/10.fdecf69b.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/100.df83f687.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/101.3986f029.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/102.1468be32.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/103.bfef2896.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/104.1731bbb1.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/105.710b118c.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/106.b955d37d.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/107.6f79a916.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/108.34ee5a8e.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/109.f6c05e4d.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/110.a375ddec.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/111.bcc5c187.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/112.afcfef56.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/113.2e7c6e37.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/114.9cfdb334.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/115.063815ec.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/116.4e29ee01.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/117.b106fd0d.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/118.e4e784f7.js"><link rel="prefetch" href="./è¿›é˜¶_files/119.94fe014a.js.ä¸‹è½½"><link rel="prefetch" href="http://interview.poetries.top/assets/js/12.ac0bc851.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/13.57028e74.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/14.043c3e8a.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/15.a6d0032e.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/16.6094fda8.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/17.f17aa05b.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/18.9732bfb3.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/19.2c38a6bb.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/20.92742304.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/21.28c8a661.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/22.3222a772.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/23.8192ecea.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/24.b5156b88.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/25.034d5e81.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/26.c78d8f63.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/27.cd94c89c.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/28.b2c8e24c.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/29.e9a30c2c.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/3.f5ea6e07.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/30.2bd67425.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/31.6333035e.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/32.1a34dfa0.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/33.b5863ac0.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/34.cababd6c.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/35.0b09d4a2.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/36.8f89ed73.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/37.38d590c3.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/38.4799c402.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/39.f28d21e8.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/40.21e1dcb8.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/41.16e0641a.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/42.9ce6fd83.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/43.8936e729.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/44.5ebdd233.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/45.ce59a54c.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/46.b6f1380b.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/47.5fe8aac4.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/48.a31741eb.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/49.16132e72.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/50.ca74d5c9.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/51.f21f79ee.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/52.6ff2b7c5.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/53.003482ca.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/54.136b1210.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/55.5d00c7ca.js"><link rel="prefetch" href="./è¿›é˜¶_files/56.cfa533e2.js.ä¸‹è½½"><link rel="prefetch" href="http://interview.poetries.top/assets/js/57.9275f210.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/58.dcf3e81b.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/59.5cbf4407.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/6.f2ac32df.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/60.ecfb5f55.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/62.8ca03065.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/63.a0c06a04.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/64.406f4c0f.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/65.9d0c9d57.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/66.ca2ccee4.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/67.b01df864.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/68.e99acf6a.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/69.f7dbb3b1.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/7.26b183c1.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/70.b3199540.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/71.d7c346c6.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/72.6afb9cd3.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/73.80370c6b.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/74.eec2a38b.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/75.fdbda41f.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/76.c8a9acd3.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/77.02560728.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/78.7a518fe7.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/79.01333f71.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/8.b6777e86.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/80.a7dfb481.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/81.29a3aa15.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/82.9039f284.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/83.e29f794c.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/84.9aea4d6e.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/85.6fa07b30.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/86.b0a530f1.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/87.a2c892ff.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/88.2c0ab353.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/89.0a6986cd.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/9.7231fa75.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/90.80c04201.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/91.19846beb.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/92.09ef3493.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/93.8bad40d8.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/94.f0810e7b.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/95.3a648c4f.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/96.827e7cb2.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/97.cc180b8f.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/98.d2138442.js"><link rel="prefetch" href="http://interview.poetries.top/assets/js/99.7e99e846.js">
    <link rel="stylesheet" href="./è¿›é˜¶_files/0.styles.a3a6df6c.css">
  <style type="text/css">.medium-zoom-overlay{position:fixed;top:0;right:0;bottom:0;left:0;opacity:0;transition:opacity .3s;will-change:opacity}.medium-zoom--opened .medium-zoom-overlay{cursor:pointer;cursor:zoom-out;opacity:1}.medium-zoom-image{cursor:pointer;cursor:zoom-in;transition:transform .3s cubic-bezier(.2,0,.2,1)!important}.medium-zoom-image--hidden{visibility:hidden}.medium-zoom-image--opened{position:relative;cursor:pointer;cursor:zoom-out;will-change:transform}</style><script charset="utf-8" src="./è¿›é˜¶_files/119.94fe014a.js.ä¸‹è½½"></script><script charset="utf-8" src="./è¿›é˜¶_files/1.d83c2af0.js.ä¸‹è½½"></script><script charset="utf-8" src="./è¿›é˜¶_files/56.cfa533e2.js.ä¸‹è½½"></script><meta name="description" content="å‰ç«¯é¢è¯•æŒ‡å—ï¼Œå‰ç«¯é¢è¯•é¢˜æ•´ç†ï¼ŒæŒ‰æ¨¡å—åˆ†ç±»æ•´ç†æ€»ç»“ï¼Œæ‰“é€ æœ€å…¨é¢çš„å‰ç«¯é¢è¯•é¢˜"><meta name="theme-color" content="#3eaf7c"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="msapplication-TileImage" content="/icons/msapplication-icon-144x144.png"><meta name="msapplication-TileColor" content="#000000"></head>
  <body class="">
    <div id="app"><div class="theme-container"><header class="navbar" style="background: rgb(255, 255, 255);"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="http://interview.poetries.top/" class="home-link router-link-active"><img src="./åŸç†_files/logo.png" alt="é¢è¯•æŒ‡å—" class="logo"> <span class="site-name can-hide">é¢è¯•æŒ‡å—</span></a> <div class="links" style="background: rgb(255, 255, 255); max-width: 1771px;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value="" class="" placeholder=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div><a href="./index.html" class="nav-link">åŸºç¡€
    </a></div></div><div class="nav-item"><div><a href="./è¿›é˜¶.html" class="nav-link">âœ¨è¿›é˜¶
    </a></div></div><div class="nav-item"><div><a href="./ç²¾é€‰.html" class="nav-link">ğŸ‘ç²¾é€‰
    </a></div></div><div class="nav-item"><div><a href="./é«˜é¢‘.html" class="nav-link">ğŸ”¥é«˜é¢‘
    </a></div></div><div class="nav-item"><div><a href="./æŒ‡å—.html" class="nav-link">æŒ‡å—
    </a></div></div><div class="nav-item"><div><a href="./æ€§èƒ½.html" class="nav-link">æ€§èƒ½
    </a></div></div><div class="nav-item"><div><a href="./ç»¼åˆ.html" class="nav-link">ç»¼åˆ
    </a></div></div><div class="nav-item"><div><a href="./åŸç†.html" class="nav-link">åŸç†
    </a></div></div><div class="nav-item"><div><a href="./æ‰‹å†™.html" class="nav-link">æ‰‹å†™
    </a></div></div><div class="nav-item"><div><a href="./è‡ªæ£€.html" class="nav-link">è‡ªæ£€
    </a></div></div><div class="nav-item"><div><a href="./é¢ç».html" class="nav-link">â­é¢ç»
    </a></div></div><div class="nav-item"><div><a href="./æ¯æ—¥ä¸€é¢˜.html" class="nav-link">ğŸ’¥æ¯æ—¥ä¸€é¢˜
    </a></div></div><div class="nav-item"><div><a href="./è®¾è®¡æ¨¡å¼.html" class="nav-link">è®¾è®¡æ¨¡å¼
  </a></div></div><div class="nav-item"><div><a href="http://interview.poetries.top/algorithm-interview/note/01-%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B%E2%80%94%E2%80%94%E4%BB%8E0%E5%88%B01%E6%8E%8C%E6%8F%A1%E7%AE%97%E6%B3%95%E9%9D%A2%E8%AF%95%E9%9C%80%E8%A6%81%E7%9A%84%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%EF%BC%88%E4%B8%80%EF%BC%89.html" class="nav-link">
  </a></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="æ‹“å±•é˜…è¯»" class="dropdown-title"><span class="title">æ‹“å±•é˜…è¯»</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display: none;"><li class="dropdown-item"><h4>ä¸“é¢˜</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><div><a href="http://interview.poetries.top/fe-base-docs/compute-docs/Linux.html" target="_blank" rel="noopener noreferrer" class="nav-link external"><!----></a></div></li><li class="dropdown-subitem"><div><a href="http://interview.poetries.top/fe-mobile-docs/h5-docs/1-%E5%A4%A7%E5%8E%82%20H5%20%E5%BC%80%E5%8F%91%E6%A6%82%E8%BF%B0.html" target="_blank" rel="noopener noreferrer" class="nav-link external"><!----></a></div></li><li class="dropdown-subitem"><div><a href="http://interview.poetries.top/fe-css-inspiration-docs/css-docs/note/01-%E6%B5%8F%E8%A7%88%E5%99%A8.html" target="_blank" rel="noopener noreferrer" class="nav-link external"><!----></a></div></li><li class="dropdown-subitem"><div><a href="http://interview.poetries.top/fe-vue-docs/learn-vue-base/base/1-Vue%20CLI%203%20%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%9F%BA%E7%A1%80.html" target="_blank" rel="noopener noreferrer" class="nav-link external"><!----></a></div></li><li class="dropdown-subitem"><div><a href="http://interview.poetries.top/fe-react-docs/react-web-action/01-%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91%E7%9A%84%E5%9B%9B%E4%B8%AA%E6%97%B6%E4%BB%A3.html" target="_blank" rel="noopener noreferrer" class="nav-link external"><!----></a></div></li><li class="dropdown-subitem"><div><a href="http://interview.poetries.top/fe-micro-docs/docs/01-%E5%BE%AE%E5%89%8D%E7%AB%AF%E7%9A%84%E8%AF%9E%E7%94%9F.html" target="_blank" rel="noopener noreferrer" class="nav-link external"><!----></a></div></li><li class="dropdown-subitem"><div><a href="http://interview.poetries.top/fe-engineering-docs/docs/npm-script.html" target="_blank" rel="noopener noreferrer" class="nav-link external"><!----></a></div></li><li class="dropdown-subitem"><div><a href="http://interview.poetries.top/fe-nodejs-docs/nodejs-docs/base/01-%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA.html" target="_blank" rel="noopener noreferrer" class="nav-link external"><!----></a></div></li><li class="dropdown-subitem"><div><a href="http://interview.poetries.top/fe-ts-axios-docs/ts-axios/chapter1/" target="_blank" rel="noopener noreferrer" class="nav-link external"><!----></a></div></li><li class="dropdown-subitem"><div><a href="http://interview.poetries.top/fe-algorithm-docs/algorithm/prepare/01-%E5%A6%82%E4%BD%95%E7%B3%BB%E7%BB%9F%E9%AB%98%E6%95%88%E5%9C%B0%E5%AD%A6%E4%B9%A0%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95.html" target="_blank" rel="noopener noreferrer" class="nav-link external"><!----></a></div></li><li class="dropdown-subitem"><div><a href="https://blog.poetries.top/browser-working-principle/guide/part1/lesson01.html" target="_blank" rel="noopener noreferrer" class="nav-link external"><div>
      æµè§ˆå™¨åŸç†
      <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div></a></div></li><li class="dropdown-subitem"><div><a href="https://blog.poetries.top/http-protocol/notes/base/01-HTTP%E7%9A%84%E5%89%8D%E4%B8%96%E4%BB%8A%E7%94%9F.html" target="_blank" rel="noopener noreferrer" class="nav-link external"><div>
      HTTPåŸºç¡€
      <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div></a></div></li><li class="dropdown-subitem"><div><a href="http://interview.poetries.top/docs/webpack.html" class="nav-link">webpack
  </a></div></li><li class="dropdown-subitem"><div><a href="http://interview.poetries.top/docs/npm-script.html" class="nav-link">npmå·¥ä½œæµ
  </a></div></li><li class="dropdown-subitem"><div><a href="http://interview.poetries.top/docs/canvas.html" class="nav-link">Canvas
  </a></div></li><li class="dropdown-subitem"><div><a href="http://interview.poetries.top/docs/Taro.html" class="nav-link">TaroåŸç†
  </a></div></li><li class="dropdown-subitem"><div><a href="http://interview.poetries.top/fe-nodejs-docs/nodejs-docs/base/01-%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA.html" target="_blank" rel="noopener noreferrer" class="nav-link external"><div>
      Nodeå­¦ä¹ æŒ‡å—
      <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div></a></div></li><li class="dropdown-subitem"><div><a href="http://interview.poetries.top/fe-vue-docs/vue-analysis/prepare/" target="_blank" rel="noopener noreferrer" class="nav-link external"><div>
      Vueæºç åˆ†æ
      <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div></a></div></li></ul></li><li class="dropdown-item"><h4>å…¶ä»–</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><div><a href="http://interview.poetries.top/fe-blog-docs/blog-docs/javascript/-Ajax%E6%80%BB%E7%BB%93%E7%AF%87.html" target="_blank" rel="noopener noreferrer" class="nav-link external"><div>
      æ—¥å¸¸ç§¯ç´¯
      <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div></a></div></li><li class="dropdown-subitem"><div><a href="http://blog.poetries.top/archives/" target="_blank" rel="noopener noreferrer" class="nav-link external"><div>
      åšæ–‡
      <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div></a></div></li></ul></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar" style="background: rgb(255, 255, 255);"><nav class="nav-links"><div class="nav-item"><div><a href="http://interview.poetries.top/docs/base.html" class="nav-link">åŸºç¡€
  </a></div></div><div class="nav-item"><div><a href="http://interview.poetries.top/docs/simply.html" class="nav-link router-link-active">âœ¨è¿›é˜¶
  </a></div></div><div class="nav-item"><div><a href="http://interview.poetries.top/excellent-docs/1-HTML%E6%A8%A1%E5%9D%97.html" class="nav-link">ğŸ‘ç²¾é€‰
  </a></div></div><div class="nav-item"><div><a href="http://interview.poetries.top/docs/excellent.html" class="nav-link">ğŸ”¥é«˜é¢‘
  </a></div></div><div class="nav-item"><div><a href="http://interview.poetries.top/docs/guide.html" class="nav-link">æŒ‡å—
  </a></div></div><div class="nav-item"><div><a href="http://interview.poetries.top/docs/performance.html" class="nav-link">æ€§èƒ½
  </a></div></div><div class="nav-item"><div><a href="http://interview.poetries.top/docs/detail-expain.html" class="nav-link">ç»¼åˆ
  </a></div></div><div class="nav-item"><div><a href="http://interview.poetries.top/principle-docs/comprehensive/01-%E8%99%9A%E6%8B%9FDOM%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90.html" class="nav-link">åŸç†
  </a></div></div><div class="nav-item"><div><a href="http://interview.poetries.top/docs/handwritten.html" class="nav-link">æ‰‹å†™
  </a></div></div><div class="nav-item"><div><a href="http://interview.poetries.top/qa/1-%E5%89%8D%E7%AB%AF100%E9%A2%98%E8%87%AA%E6%A3%80.html" class="nav-link">è‡ªæ£€
  </a></div></div><div class="nav-item"><div><a href="http://interview.poetries.top/interview-exp/%E5%89%8D%E7%AB%AF%E9%9D%A2%E7%BB%8F%E6%B1%87%E6%80%BB.html" class="nav-link">â­é¢ç»
  </a></div></div><div class="nav-item"><div><a href="http://interview.poetries.top/days/%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98.html" class="nav-link">ğŸ’¥æ¯æ—¥ä¸€é¢˜
  </a></div></div><div class="nav-item"><div><a href="http://interview.poetries.top/docs/design-pattern.html" class="nav-link">è®¾è®¡æ¨¡å¼
  </a></div></div><div class="nav-item"><div><a href="http://interview.poetries.top/algorithm-interview/note/01-%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B%E2%80%94%E2%80%94%E4%BB%8E0%E5%88%B01%E6%8E%8C%E6%8F%A1%E7%AE%97%E6%B3%95%E9%9D%A2%E8%AF%95%E9%9C%80%E8%A6%81%E7%9A%84%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%EF%BC%88%E4%B8%80%EF%BC%89.html" class="nav-link">
  </a></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="æ‹“å±•é˜…è¯»" class="dropdown-title"><span class="title">æ‹“å±•é˜…è¯»</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display: none;"><li class="dropdown-item"><h4>ä¸“é¢˜</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><div><a href="http://interview.poetries.top/fe-base-docs/compute-docs/Linux.html" target="_blank" rel="noopener noreferrer" class="nav-link external"><!----></a></div></li><li class="dropdown-subitem"><div><a href="http://interview.poetries.top/fe-mobile-docs/h5-docs/1-%E5%A4%A7%E5%8E%82%20H5%20%E5%BC%80%E5%8F%91%E6%A6%82%E8%BF%B0.html" target="_blank" rel="noopener noreferrer" class="nav-link external"><!----></a></div></li><li class="dropdown-subitem"><div><a href="http://interview.poetries.top/fe-css-inspiration-docs/css-docs/note/01-%E6%B5%8F%E8%A7%88%E5%99%A8.html" target="_blank" rel="noopener noreferrer" class="nav-link external"><!----></a></div></li><li class="dropdown-subitem"><div><a href="http://interview.poetries.top/fe-vue-docs/learn-vue-base/base/1-Vue%20CLI%203%20%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%9F%BA%E7%A1%80.html" target="_blank" rel="noopener noreferrer" class="nav-link external"><!----></a></div></li><li class="dropdown-subitem"><div><a href="http://interview.poetries.top/fe-react-docs/react-web-action/01-%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91%E7%9A%84%E5%9B%9B%E4%B8%AA%E6%97%B6%E4%BB%A3.html" target="_blank" rel="noopener noreferrer" class="nav-link external"><!----></a></div></li><li class="dropdown-subitem"><div><a href="http://interview.poetries.top/fe-micro-docs/docs/01-%E5%BE%AE%E5%89%8D%E7%AB%AF%E7%9A%84%E8%AF%9E%E7%94%9F.html" target="_blank" rel="noopener noreferrer" class="nav-link external"><!----></a></div></li><li class="dropdown-subitem"><div><a href="http://interview.poetries.top/fe-engineering-docs/docs/npm-script.html" target="_blank" rel="noopener noreferrer" class="nav-link external"><!----></a></div></li><li class="dropdown-subitem"><div><a href="http://interview.poetries.top/fe-nodejs-docs/nodejs-docs/base/01-%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA.html" target="_blank" rel="noopener noreferrer" class="nav-link external"><!----></a></div></li><li class="dropdown-subitem"><div><a href="http://interview.poetries.top/fe-ts-axios-docs/ts-axios/chapter1/" target="_blank" rel="noopener noreferrer" class="nav-link external"><!----></a></div></li><li class="dropdown-subitem"><div><a href="http://interview.poetries.top/fe-algorithm-docs/algorithm/prepare/01-%E5%A6%82%E4%BD%95%E7%B3%BB%E7%BB%9F%E9%AB%98%E6%95%88%E5%9C%B0%E5%AD%A6%E4%B9%A0%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95.html" target="_blank" rel="noopener noreferrer" class="nav-link external"><!----></a></div></li><li class="dropdown-subitem"><div><a href="https://blog.poetries.top/browser-working-principle/guide/part1/lesson01.html" target="_blank" rel="noopener noreferrer" class="nav-link external"><div>
      æµè§ˆå™¨åŸç†
      <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div></a></div></li><li class="dropdown-subitem"><div><a href="https://blog.poetries.top/http-protocol/notes/base/01-HTTP%E7%9A%84%E5%89%8D%E4%B8%96%E4%BB%8A%E7%94%9F.html" target="_blank" rel="noopener noreferrer" class="nav-link external"><div>
      HTTPåŸºç¡€
      <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div></a></div></li><li class="dropdown-subitem"><div><a href="http://interview.poetries.top/docs/webpack.html" class="nav-link">webpack
  </a></div></li><li class="dropdown-subitem"><div><a href="http://interview.poetries.top/docs/npm-script.html" class="nav-link">npmå·¥ä½œæµ
  </a></div></li><li class="dropdown-subitem"><div><a href="http://interview.poetries.top/docs/canvas.html" class="nav-link">Canvas
  </a></div></li><li class="dropdown-subitem"><div><a href="http://interview.poetries.top/docs/Taro.html" class="nav-link">TaroåŸç†
  </a></div></li><li class="dropdown-subitem"><div><a href="http://interview.poetries.top/fe-nodejs-docs/nodejs-docs/base/01-%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA.html" target="_blank" rel="noopener noreferrer" class="nav-link external"><div>
      Nodeå­¦ä¹ æŒ‡å—
      <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div></a></div></li><li class="dropdown-subitem"><div><a href="http://interview.poetries.top/fe-vue-docs/vue-analysis/prepare/" target="_blank" rel="noopener noreferrer" class="nav-link external"><div>
      Vueæºç åˆ†æ
      <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div></a></div></li></ul></li><li class="dropdown-item"><h4>å…¶ä»–</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><div><a href="http://interview.poetries.top/fe-blog-docs/blog-docs/javascript/-Ajax%E6%80%BB%E7%BB%93%E7%AF%87.html" target="_blank" rel="noopener noreferrer" class="nav-link external"><div>
      æ—¥å¸¸ç§¯ç´¯
      <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div></a></div></li><li class="dropdown-subitem"><div><a href="http://blog.poetries.top/archives/" target="_blank" rel="noopener noreferrer" class="nav-link external"><div>
      åšæ–‡
      <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div></a></div></li></ul></li></ul></div></div> <!----></nav> <div style="padding-left:1.5rem;"><div class="qr"><img src="./è¿›é˜¶_files/qr.ee193d28.jpg" alt="poetries" width="120" height="120" loading="lazy"> <p class="we-intro">
    å…³æ³¨å…¬ä¼—å·ï¼Œè·å–æ›´å¤šèµ„è®¯
  </p></div></div> <ul class="sidebar-links"><li><a href="http://interview.poetries.top/docs/base.html" class="sidebar-link">åŸºç¡€</a></li><li><a href="http://interview.poetries.top/docs/simply.html" aria-current="page" class="active sidebar-link">è¿›é˜¶</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#%E4%B8%80%E3%80%81js%E5%9F%BA%E7%A1%80" class="active sidebar-link" aria-current="page">ä¸€ã€JSåŸºç¡€</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_1-%E7%B1%BB%E5%9E%8B%E5%8F%8A%E6%A3%80%E6%B5%8B%E6%96%B9%E5%BC%8F" class="sidebar-link">1 ç±»å‹åŠæ£€æµ‹æ–¹å¼</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_2-this" class="sidebar-link">2 This</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_3-bind-call-apply-%E5%8C%BA%E5%88%AB%E5%8F%8A%E5%AE%9E%E7%8E%B0" class="sidebar-link">3 bind/call/apply åŒºåˆ«åŠå®ç°</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_4-%E5%8F%98%E9%87%8F%E6%8F%90%E5%8D%87" class="sidebar-link">4 å˜é‡æå‡</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_5-%E9%97%AD%E5%8C%85" class="sidebar-link">5 é—­åŒ…</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_6-%E6%89%A7%E8%A1%8C%E4%B8%8A%E4%B8%8B%E6%96%87" class="sidebar-link">6 æ‰§è¡Œä¸Šä¸‹æ–‡</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_7-%E4%BD%9C%E7%94%A8%E5%9F%9F" class="sidebar-link">7 ä½œç”¨åŸŸ</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_8-new%E7%9A%84%E8%BF%87%E7%A8%8B" class="sidebar-link">8 Newçš„è¿‡ç¨‹</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_9-%E5%8E%9F%E5%9E%8B" class="sidebar-link">9 åŸå‹</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_10-%E7%BB%A7%E6%89%BF" class="sidebar-link">10 ç»§æ‰¿</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_12-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1" class="sidebar-link">12 é¢å‘å¯¹è±¡</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_13-%E4%BA%8B%E4%BB%B6%E5%BE%AA%E7%8E%AF" class="sidebar-link">13 äº‹ä»¶å¾ªç¯</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_14-%E4%BA%8B%E4%BB%B6%E6%9C%BA%E5%88%B6" class="sidebar-link">14 äº‹ä»¶æœºåˆ¶</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_15-promise" class="sidebar-link">15 Promise</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_16-%E6%A8%A1%E5%9D%97%E5%8C%96" class="sidebar-link">16 æ¨¡å—åŒ–</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_17-iterator" class="sidebar-link">17 Iterator</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_18-generator" class="sidebar-link">18 Generator</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_19-async-await" class="sidebar-link">19 async/await</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_20-proxy" class="sidebar-link">20 Proxy</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_21-%E6%B7%B1%E6%B5%85%E6%8B%B7%E8%B4%9D" class="sidebar-link">21 æ·±æµ…æ‹·è´</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_22-%E8%8A%82%E6%B5%81%E4%B8%8E%E9%98%B2%E6%8A%96" class="sidebar-link">22 èŠ‚æµä¸é˜²æŠ–</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_23-%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6" class="sidebar-link">23 åƒåœ¾å›æ”¶</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_24-%E5%86%85%E5%AD%98%E6%B3%84%E9%9C%B2" class="sidebar-link">24 å†…å­˜æ³„éœ²</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_25-ajax" class="sidebar-link">25 Ajax</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_26-arguments%E5%AF%B9%E8%B1%A1" class="sidebar-link">26 argumentså¯¹è±¡</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_27-%E6%95%B0%E7%BB%84%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%96%B9%E6%B3%95" class="sidebar-link">27 æ•°ç»„å’Œå­—ç¬¦ä¸²æ–¹æ³•</a></li></ul></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#%E4%BA%8C%E3%80%81css%E5%9F%BA%E7%A1%80" class="sidebar-link">äºŒã€CSSåŸºç¡€</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_1-%E7%9B%92%E6%A8%A1%E5%9E%8B" class="sidebar-link">1 ç›’æ¨¡å‹</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_2-bfc" class="sidebar-link">2 BFC</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_3-%E5%B1%82%E5%8F%A0%E4%B8%8A%E4%B8%8B%E6%96%87" class="sidebar-link">3 å±‚å ä¸Šä¸‹æ–‡</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_4-%E5%B7%A6%E5%8F%B3%E5%B1%85%E4%B8%AD%E6%96%B9%E6%A1%88" class="sidebar-link">4 å·¦å³å±…ä¸­æ–¹æ¡ˆ</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_5-%E4%B8%8A%E4%B8%8B%E5%9E%82%E7%9B%B4%E5%B1%85%E4%B8%AD%E6%96%B9%E6%A1%88" class="sidebar-link">5 ä¸Šä¸‹å‚ç›´å±…ä¸­æ–¹æ¡ˆ</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_6-%E9%80%89%E6%8B%A9%E5%99%A8%E6%9D%83%E9%87%8D%E8%AE%A1%E7%AE%97%E6%96%B9%E5%BC%8F" class="sidebar-link">6 é€‰æ‹©å™¨æƒé‡è®¡ç®—æ–¹å¼</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_7-%E6%B8%85%E9%99%A4%E6%B5%AE%E5%8A%A8" class="sidebar-link">7 æ¸…é™¤æµ®åŠ¨</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_8-%E5%B7%A6%E8%BE%B9%E5%AE%9A%E5%AE%BD-%E5%8F%B3%E8%BE%B9%E8%87%AA%E9%80%82%E5%BA%94%E6%96%B9%E6%A1%88" class="sidebar-link">8 å·¦è¾¹å®šå®½ï¼Œå³è¾¹è‡ªé€‚åº”æ–¹æ¡ˆ</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_9-%E5%B7%A6%E5%8F%B3%E4%B8%A4%E8%BE%B9%E5%AE%9A%E5%AE%BD-%E4%B8%AD%E9%97%B4%E8%87%AA%E9%80%82%E5%BA%94" class="sidebar-link">9 å·¦å³ä¸¤è¾¹å®šå®½ï¼Œä¸­é—´è‡ªé€‚åº”</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_10-css%E5%8A%A8%E7%94%BB%E5%92%8C%E8%BF%87%E6%B8%A1" class="sidebar-link">10 CSSåŠ¨ç”»å’Œè¿‡æ¸¡</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_11-css3%E7%9A%84%E6%96%B0%E7%89%B9%E6%80%A7" class="sidebar-link">11 CSS3çš„æ–°ç‰¹æ€§</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_12-%E5%88%97%E4%B8%BE%E5%87%A0%E4%B8%AAcss%E4%B8%AD%E5%8F%AF%E7%BB%A7%E6%89%BF%E5%92%8C%E4%B8%8D%E5%8F%AF%E7%BB%A7%E6%89%BF%E7%9A%84%E5%85%83%E7%B4%A0" class="sidebar-link">12 åˆ—ä¸¾å‡ ä¸ªcssä¸­å¯ç»§æ‰¿å’Œä¸å¯ç»§æ‰¿çš„å…ƒç´ </a></li></ul></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#%E4%B8%89%E3%80%81%E6%B5%8F%E8%A7%88%E5%99%A8" class="sidebar-link">ä¸‰ã€æµè§ˆå™¨</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_1-%E6%B5%8F%E8%A7%88%E5%99%A8%E6%9E%B6%E6%9E%84" class="sidebar-link">1 æµè§ˆå™¨æ¶æ„</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_2-%E6%B8%B2%E6%9F%93%E6%9C%BA%E5%88%B6" class="sidebar-link">2 æ¸²æŸ“æœºåˆ¶</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_3-%E7%BC%93%E5%AD%98%E6%9C%BA%E5%88%B6" class="sidebar-link">3 ç¼“å­˜æœºåˆ¶</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_4-%E6%B5%8F%E8%A7%88%E5%99%A8%E5%AD%98%E5%82%A8" class="sidebar-link">4 æµè§ˆå™¨å­˜å‚¨</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_5-%E8%B7%A8%E5%9F%9F%E6%96%B9%E6%A1%88" class="sidebar-link">5 è·¨åŸŸæ–¹æ¡ˆ</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_6-xss-%E5%92%8C-csrf" class="sidebar-link">6 XSS å’Œ CSRF</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_7-%E6%80%8E%E4%B9%88%E5%88%A4%E6%96%AD%E9%A1%B5%E9%9D%A2%E6%98%AF%E5%90%A6%E5%8A%A0%E8%BD%BD%E5%AE%8C%E6%88%90" class="sidebar-link">7 æ€ä¹ˆåˆ¤æ–­é¡µé¢æ˜¯å¦åŠ è½½å®Œæˆ</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_8-service-worker" class="sidebar-link">8 Service Worker</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_9-dom-%E8%8A%82%E7%82%B9%E6%93%8D%E4%BD%9C" class="sidebar-link">9 DOM èŠ‚ç‚¹æ“ä½œ</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_10-%E5%BB%B6%E8%BF%9F%E5%8A%A0%E8%BD%BD%E7%9A%84%E6%96%B9%E5%BC%8F%E6%9C%89%E5%93%AA%E4%BA%9B" class="sidebar-link">10 å»¶è¿ŸåŠ è½½çš„æ–¹å¼æœ‰å“ªäº›</a></li></ul></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#%E5%9B%9B%E3%80%81%E6%A1%86%E6%9E%B6%E9%80%9A%E8%AF%86" class="sidebar-link">å››ã€æ¡†æ¶é€šè¯†</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#%E4%BA%94%E3%80%81vue" class="sidebar-link">äº”ã€Vue</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_1-vue-%E5%93%8D%E5%BA%94%E5%BC%8F%E5%8E%9F%E7%90%86" class="sidebar-link">1 Vue å“åº”å¼åŸç†</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_2-%E5%8F%91%E5%B8%83%E8%AE%A2%E9%98%85%E6%A8%A1%E5%BC%8F%E5%92%8C%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F" class="sidebar-link">2 å‘å¸ƒè®¢é˜…æ¨¡å¼å’Œè§‚å¯Ÿè€…æ¨¡å¼</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_3-%E4%B8%BA%E4%BB%80%E4%B9%88%E4%BD%BF%E7%94%A8-virtual-dom" class="sidebar-link">3 ä¸ºä»€ä¹ˆä½¿ç”¨ Virtual DOM</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_4-vdom-%E4%B8%89%E4%B8%AA-part" class="sidebar-link">4 VDOMï¼šä¸‰ä¸ª part</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_5-vue-%E5%92%8C-react%E6%8A%80%E6%9C%AF%E9%80%89%E5%9E%8B" class="sidebar-link">5 vue å’Œ reactæŠ€æœ¯é€‰å‹</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_6-nexttick" class="sidebar-link">6 nextTick</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_7-%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F" class="sidebar-link">7 ç”Ÿå‘½å‘¨æœŸ</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_8-vue-router" class="sidebar-link">8 vue-router</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_9-vuex" class="sidebar-link">9 vuex</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_10-vue3%E5%B8%A6%E6%9D%A5%E7%9A%84%E6%96%B0%E7%89%B9%E6%80%A7-%E4%BA%AE%E7%82%B9" class="sidebar-link">10 vue3å¸¦æ¥çš„æ–°ç‰¹æ€§/äº®ç‚¹</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_11-compositon-api" class="sidebar-link">11 Compositon api</a></li></ul></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#%E5%85%AD%E3%80%81react" class="sidebar-link">å…­ã€React</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_1-react%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F" class="sidebar-link">1 Reactç”Ÿå‘½å‘¨æœŸ</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_2-react-fiber%E6%9E%B6%E6%9E%84" class="sidebar-link">2 React Fiberæ¶æ„</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_1-react-%E9%83%BD%E5%81%9A%E8%BF%87%E5%93%AA%E4%BA%9B%E4%BC%98%E5%8C%96" class="sidebar-link">1. React éƒ½åšè¿‡å“ªäº›ä¼˜åŒ–</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_2-%E6%B5%8F%E8%A7%88%E5%99%A8%E4%B8%80%E5%B8%A7%E9%83%BD%E4%BC%9A%E5%B9%B2%E4%BA%9B%E4%BB%80%E4%B9%88%E4%BB%A5%E5%8F%8Arequestidlecallback%E7%9A%84%E5%90%AF%E7%A4%BA" class="sidebar-link">2. æµè§ˆå™¨ä¸€å¸§éƒ½ä¼šå¹²äº›ä»€ä¹ˆä»¥åŠrequestIdleCallbackçš„å¯ç¤º</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_3-react-fiber%E6%98%AF%E4%BB%80%E4%B9%88" class="sidebar-link">3. React Fiberæ˜¯ä»€ä¹ˆ</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_4-%E7%BB%84%E4%BB%B6%E7%9A%84%E6%B8%B2%E6%9F%93%E9%A1%BA%E5%BA%8F" class="sidebar-link">4. ç»„ä»¶çš„æ¸²æŸ“é¡ºåº</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_5-react-fiber%E6%9E%B6%E6%9E%84%E6%80%BB%E7%BB%93" class="sidebar-link">5 React Fiberæ¶æ„æ€»ç»“</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_3-createelement%E8%BF%87%E7%A8%8B" class="sidebar-link">3 createElementè¿‡ç¨‹</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_4-%E8%B0%83%E5%92%8C%E9%98%B6%E6%AE%B5-setstate%E5%86%85%E9%83%A8%E5%B9%B2%E4%BA%86%E4%BB%80%E4%B9%88" class="sidebar-link">4 è°ƒå’Œé˜¶æ®µ setStateå†…éƒ¨å¹²äº†ä»€ä¹ˆ</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_5-setstate" class="sidebar-link">5 setState</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_6-setstate%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90" class="sidebar-link">6 setStateåŸç†åˆ†æ</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_7-react%E4%BA%8B%E5%8A%A1%E6%9C%BA%E5%88%B6" class="sidebar-link">7 Reactäº‹åŠ¡æœºåˆ¶</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_8-react%E7%BB%84%E4%BB%B6%E5%92%8C%E6%B8%B2%E6%9F%93%E6%9B%B4%E6%96%B0%E8%BF%87%E7%A8%8B" class="sidebar-link">8 Reactç»„ä»¶å’Œæ¸²æŸ“æ›´æ–°è¿‡ç¨‹</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_9-diff%E7%AE%97%E6%B3%95%E6%98%AF%E6%80%8E%E4%B9%88%E8%BF%90%E4%BD%9C" class="sidebar-link">9 diffç®—æ³•æ˜¯æ€ä¹ˆè¿ä½œ</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_10-%E5%90%88%E6%88%90%E4%BA%8B%E4%BB%B6%E5%8E%9F%E7%90%86" class="sidebar-link">10 åˆæˆäº‹ä»¶åŸç†</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_11-jsx%E8%AF%AD%E6%B3%95%E7%B3%96%E6%9C%AC%E8%B4%A8" class="sidebar-link">11 JSXè¯­æ³•ç³–æœ¬è´¨</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_12-%E4%B8%BA%E4%BB%80%E4%B9%88-react-%E5%85%83%E7%B4%A0%E6%9C%89%E4%B8%80%E4%B8%AA-typeof-%E5%B1%9E%E6%80%A7" class="sidebar-link">12 ä¸ºä»€ä¹ˆ React å…ƒç´ æœ‰ä¸€ä¸ª $$typeof å±æ€§</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_13-react%E6%9C%89%E5%93%AA%E4%BA%9B%E4%BC%98%E5%8C%96%E6%80%A7%E8%83%BD%E7%9A%84%E6%89%8B%E6%AE%B5" class="sidebar-link">13 Reactæœ‰å“ªäº›ä¼˜åŒ–æ€§èƒ½çš„æ‰‹æ®µ</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_14-redux%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86%E8%A7%A3%E6%9E%90" class="sidebar-link">14 Reduxå®ç°åŸç†è§£æ</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_15-connect%E7%BB%84%E4%BB%B6%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90" class="sidebar-link">15 connectç»„ä»¶åŸç†åˆ†æ</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_16-react-hooks-%E5%AE%83%E5%B8%A6%E6%9D%A5%E4%BA%86%E9%82%A3%E4%BA%9B%E4%BE%BF%E5%88%A9" class="sidebar-link">16 react hooksï¼Œå®ƒå¸¦æ¥äº†é‚£äº›ä¾¿åˆ©</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_17-%E8%81%8A%E8%81%8A-redux-%E5%92%8C-vuex-%E7%9A%84%E8%AE%BE%E8%AE%A1%E6%80%9D%E6%83%B3" class="sidebar-link">17 èŠèŠ Redux å’Œ Vuex çš„è®¾è®¡æ€æƒ³</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_18-redux-%E4%B8%AD%E9%97%B4%E4%BB%B6" class="sidebar-link">18 redux ä¸­é—´ä»¶</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_19-redux%E6%95%B0%E6%8D%AE%E7%AE%A1%E7%90%86" class="sidebar-link">19 reduxæ•°æ®ç®¡ç†</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_20-%E5%8F%97%E6%8E%A7%E7%BB%84%E4%BB%B6%E5%92%8C%E9%9D%9E%E5%8F%97%E6%8E%A7%E7%BB%84%E4%BB%B6" class="sidebar-link">20 å—æ§ç»„ä»¶å’Œéå—æ§ç»„ä»¶</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_21-ssr%E5%8E%9F%E7%90%86" class="sidebar-link">21 SSRåŸç†</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_22-%E5%A6%82%E4%BD%95%E9%81%BF%E5%85%8Dajax%E6%95%B0%E6%8D%AE%E8%AF%B7%E6%B1%82%E9%87%8D%E6%96%B0%E8%8E%B7%E5%8F%96" class="sidebar-link">22 å¦‚ä½•é¿å…ajaxæ•°æ®è¯·æ±‚é‡æ–°è·å–</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_23-%E7%BB%84%E4%BB%B6%E4%B9%8B%E9%97%B4%E9%80%9A%E4%BF%A1" class="sidebar-link">23 ç»„ä»¶ä¹‹é—´é€šä¿¡</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_24-react-router" class="sidebar-link">24 React router</a></li></ul></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#%E4%B8%83%E3%80%81%E6%80%A7%E8%83%BD" class="sidebar-link">ä¸ƒã€æ€§èƒ½</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_1-dns-%E9%A2%84%E8%A7%A3%E6%9E%90" class="sidebar-link">1 DNS é¢„è§£æ</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_2-%E7%BC%93%E5%AD%98" class="sidebar-link">2 ç¼“å­˜</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_3-%E4%BD%BF%E7%94%A8-http-2-0" class="sidebar-link">3 ä½¿ç”¨ HTTP / 2.0</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_4-%E9%A2%84%E5%8A%A0%E8%BD%BD" class="sidebar-link">4 é¢„åŠ è½½</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_5-%E9%A2%84%E6%B8%B2%E6%9F%93" class="sidebar-link">5 é¢„æ¸²æŸ“</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_6-%E6%87%92%E6%89%A7%E8%A1%8C%E4%B8%8E%E6%87%92%E5%8A%A0%E8%BD%BD" class="sidebar-link">6 æ‡’æ‰§è¡Œä¸æ‡’åŠ è½½</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_7-%E6%96%87%E4%BB%B6%E4%BC%98%E5%8C%96" class="sidebar-link">7 æ–‡ä»¶ä¼˜åŒ–</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_8-%E5%85%B6%E4%BB%96" class="sidebar-link">8 å…¶ä»–</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_9-webpack%E7%BC%96%E8%AF%91%E4%BC%98%E5%8C%96" class="sidebar-link">9 webpackç¼–è¯‘ä¼˜åŒ–</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_10-%E5%A6%82%E4%BD%95%E6%A0%B9%E6%8D%AEchrome%E7%9A%84timing%E4%BC%98%E5%8C%96" class="sidebar-link">10 å¦‚ä½•æ ¹æ®chromeçš„timingä¼˜åŒ–</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_11-%E7%A7%BB%E5%8A%A8%E7%AB%AF%E4%BC%98%E5%8C%96" class="sidebar-link">11 ç§»åŠ¨ç«¯ä¼˜åŒ–</a></li></ul></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#%E5%85%AB%E3%80%81http" class="sidebar-link">å…«ã€HTTP</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_1-%E8%B0%88%E4%B8%80%E8%B0%88http%E5%8D%8F%E8%AE%AE%E4%BC%98%E7%BC%BA%E7%82%B9" class="sidebar-link">1 è°ˆä¸€è°ˆHTTPåè®®ä¼˜ç¼ºç‚¹</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_2-%E8%AF%B4%E4%B8%80%E8%AF%B4http-%E7%9A%84%E8%AF%B7%E6%B1%82%E6%96%B9%E6%B3%95" class="sidebar-link">2 è¯´ä¸€è¯´HTTP çš„è¯·æ±‚æ–¹æ³•</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_3-%E8%B0%88%E4%B8%80%E8%B0%88get-%E5%92%8C-post-%E7%9A%84%E5%8C%BA%E5%88%AB" class="sidebar-link">3 è°ˆä¸€è°ˆGET å’Œ POST çš„åŒºåˆ«</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_4-%E8%B0%88%E4%B8%80%E8%B0%88%E9%98%9F%E5%A4%B4%E9%98%BB%E5%A1%9E%E9%97%AE%E9%A2%98" class="sidebar-link">4 è°ˆä¸€è°ˆé˜Ÿå¤´é˜»å¡é—®é¢˜</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_5-%E8%B0%88%E4%B8%80%E8%B0%88http%E6%95%B0%E6%8D%AE%E4%BC%A0%E8%BE%93" class="sidebar-link">5 è°ˆä¸€è°ˆHTTPæ•°æ®ä¼ è¾“</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_6-cookie-%E5%92%8C-session" class="sidebar-link">6 cookie å’Œ session</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_7-%E4%BB%8B%E7%BB%8D%E4%B8%80%E4%B8%8Bhttps%E5%92%8Chttp%E5%8C%BA%E5%88%AB" class="sidebar-link">7 ä»‹ç»ä¸€ä¸‹HTTPSå’ŒHTTPåŒºåˆ«</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_8-https%E6%8F%A1%E6%89%8B%E8%BF%87%E7%A8%8B" class="sidebar-link">8 HTTPSæ¡æ‰‹è¿‡ç¨‹</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_9-%E4%BB%8B%E7%BB%8D%E4%B8%80%E4%B8%AAhttps%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86" class="sidebar-link">9 ä»‹ç»ä¸€ä¸ªHTTPSå·¥ä½œåŸç†</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_10-ssl-%E8%BF%9E%E6%8E%A5%E6%96%AD%E5%BC%80%E5%90%8E%E5%A6%82%E4%BD%95%E6%81%A2%E5%A4%8D" class="sidebar-link">10 SSL è¿æ¥æ–­å¼€åå¦‚ä½•æ¢å¤</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_11-%E8%B0%88%E4%B8%80%E8%B0%88%E4%BD%A0%E5%AF%B9http-2%E7%90%86%E8%A7%A3" class="sidebar-link">11 è°ˆä¸€è°ˆä½ å¯¹HTTP/2ç†è§£</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_12-http-1-0-http1-1-http2-0%E7%89%88%E6%9C%AC%E4%B9%8B%E9%97%B4%E7%9A%84%E5%B7%AE%E5%BC%82" class="sidebar-link">12 HTTP/1.0 HTTP1.1 HTTP2.0ç‰ˆæœ¬ä¹‹é—´çš„å·®å¼‚</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_13-dns%E5%A6%82%E4%BD%95%E5%B7%A5%E4%BD%9C%E7%9A%84" class="sidebar-link">13 DNSå¦‚ä½•å·¥ä½œçš„</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_14-%E7%9F%AD%E8%BD%AE%E8%AF%A2%E3%80%81%E9%95%BF%E8%BD%AE%E8%AF%A2%E5%92%8C-websocket-%E9%97%B4%E7%9A%84%E5%8C%BA%E5%88%AB" class="sidebar-link">14 çŸ­è½®è¯¢ã€é•¿è½®è¯¢å’Œ WebSocket é—´çš„åŒºåˆ«</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_15-%E8%AF%B4%E4%B8%80%E8%AF%B4%E6%AD%A3%E5%90%91%E4%BB%A3%E7%90%86%E5%92%8C%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86" class="sidebar-link">15 è¯´ä¸€è¯´æ­£å‘ä»£ç†å’Œåå‘ä»£ç†</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_16-%E4%BB%8B%E7%BB%8D%E4%B8%80%E4%B8%8Bconnection-keep-alive" class="sidebar-link">16 ä»‹ç»ä¸€ä¸‹Connection:keep-alive</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_17-http-https-%E5%8D%8F%E8%AE%AE%E6%80%BB%E7%BB%93" class="sidebar-link">17 http/https åè®®æ€»ç»“</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_18-tcp%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B" class="sidebar-link">18 TCPä¸ºä»€ä¹ˆè¦ä¸‰æ¬¡æ¡æ‰‹</a></li></ul></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#%E4%B9%9D%E3%80%819%E7%A7%8D%E5%89%8D%E7%AB%AF%E5%B8%B8%E8%A7%81%E7%9A%84%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F" class="sidebar-link">ä¹ã€9ç§å‰ç«¯å¸¸è§çš„è®¾è®¡æ¨¡å¼</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_1-%E5%A4%96%E8%A7%82%E6%A8%A1%E5%BC%8F" class="sidebar-link">1. å¤–è§‚æ¨¡å¼</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_2-%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F" class="sidebar-link">2. ä»£ç†æ¨¡å¼</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_3-%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F" class="sidebar-link">3. å·¥å‚æ¨¡å¼</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_4-%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F" class="sidebar-link">4. å•ä¾‹æ¨¡å¼</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_5-%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F" class="sidebar-link">5. ç­–ç•¥æ¨¡å¼</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_6-%E8%BF%AD%E4%BB%A3%E5%99%A8%E6%A8%A1%E5%BC%8F" class="sidebar-link">6. è¿­ä»£å™¨æ¨¡å¼</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_7-%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F" class="sidebar-link">7. è§‚å¯Ÿè€…æ¨¡å¼</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_8-%E4%B8%AD%E4%BB%8B%E8%80%85%E6%A8%A1%E5%BC%8F" class="sidebar-link">8. ä¸­ä»‹è€…æ¨¡å¼</a></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#_9-%E8%AE%BF%E9%97%AE%E8%80%85%E6%A8%A1%E5%BC%8F" class="sidebar-link">9. è®¿é—®è€…æ¨¡å¼</a></li></ul></li><li class="sidebar-sub-header"><a href="http://interview.poetries.top/docs/simply.html#%E5%8D%81%E3%80%81%E7%BB%BC%E5%90%88%E9%97%AE%E9%A2%98" class="sidebar-link">åã€ç»¼åˆé—®é¢˜</a></li></ul></li><li><a href="http://interview.poetries.top/docs/excellent.html" class="sidebar-link">é«˜é¢‘</a></li><li><a href="http://interview.poetries.top/docs/guide.html" class="sidebar-link">æŒ‡å—</a></li><li><a href="http://interview.poetries.top/docs/performance.html" class="sidebar-link">æ€§èƒ½</a></li><li><a href="http://interview.poetries.top/docs/qa.html" class="sidebar-link">è‡ªæ£€</a></li><li><a href="http://interview.poetries.top/docs/detail-expain.html" class="sidebar-link">ç»¼åˆ</a></li><li><a href="http://interview.poetries.top/docs/handwritten.html" class="sidebar-link">æ‰‹å†™</a></li><li><a href="http://interview.poetries.top/docs/design-pattern.html" class="sidebar-link">è®¾è®¡æ¨¡å¼</a></li></ul> </aside> <main class="page"> <div id="container" class="theme-default-content lock"><div class="content__default"><blockquote><p>é¢è¯•æ ¸å¿ƒåŸºç¡€ç‰ˆ</p></blockquote> <h2 id="ä¸€ã€jsåŸºç¡€"><a href="http://interview.poetries.top/docs/simply.html#%E4%B8%80%E3%80%81js%E5%9F%BA%E7%A1%80" class="header-anchor">#</a> ä¸€ã€JSåŸºç¡€</h2> <h3 id="_1-ç±»å‹åŠæ£€æµ‹æ–¹å¼"><a href="http://interview.poetries.top/docs/simply.html#_1-%E7%B1%BB%E5%9E%8B%E5%8F%8A%E6%A3%80%E6%B5%8B%E6%96%B9%E5%BC%8F" class="header-anchor">#</a> 1 ç±»å‹åŠæ£€æµ‹æ–¹å¼</h3> <p><strong>1. JSå†…ç½®ç±»å‹</strong></p> <ul><li><code>JavaScript</code>ä¸€å…±æœ‰8ç§æ•°æ®ç±»å‹ï¼Œå…¶ä¸­æœ‰7ç§åŸºæœ¬æ•°æ®ç±»å‹ï¼š<code>Undefined</code>ã€<code>Null</code>ã€<code>Boolean</code>ã€<code>Number</code>ã€<code>String</code>ã€<code>Symbol</code>ï¼ˆ<code>es6</code>æ–°å¢ï¼Œè¡¨ç¤ºç‹¬ä¸€æ— äºŒçš„å€¼ï¼‰å’Œ<code>BigInt</code>ï¼ˆ<code>es10</code>æ–°å¢ï¼‰ï¼›</li> <li>1ç§å¼•ç”¨æ•°æ®ç±»å‹â€”â€”<code>Object</code>ï¼ˆObjectæœ¬è´¨ä¸Šæ˜¯ç”±ä¸€ç»„æ— åºçš„åå€¼å¯¹ç»„æˆçš„ï¼‰ã€‚é‡Œé¢åŒ…å« <code>functionã€Arrayã€Date</code>ç­‰ã€‚JavaScriptä¸æ”¯æŒä»»ä½•åˆ›å»ºè‡ªå®šä¹‰ç±»å‹çš„æœºåˆ¶ï¼Œè€Œæ‰€æœ‰å€¼æœ€ç»ˆéƒ½å°†æ˜¯ä¸Šè¿° 8 ç§æ•°æ®ç±»å‹ä¹‹ä¸€ã€‚</li> <li>åŸå§‹æ•°æ®ç±»å‹ï¼šç›´æ¥å­˜å‚¨åœ¨æ ˆï¼ˆstackï¼‰ä¸­ï¼Œå æ®ç©ºé—´å°ã€å¤§å°å›ºå®šï¼Œå±äºè¢«é¢‘ç¹ä½¿ç”¨æ•°æ®ï¼Œæ‰€ä»¥æ”¾å…¥æ ˆä¸­å­˜å‚¨ã€‚</li> <li>å¼•ç”¨æ•°æ®ç±»å‹ï¼šåŒæ—¶å­˜å‚¨åœ¨æ ˆï¼ˆstackï¼‰å’Œå †ï¼ˆheapï¼‰ä¸­ï¼Œå æ®ç©ºé—´å¤§ã€å¤§å°ä¸å›ºå®šã€‚å¼•ç”¨æ•°æ®ç±»å‹åœ¨æ ˆä¸­å­˜å‚¨äº†æŒ‡é’ˆï¼Œè¯¥æŒ‡é’ˆæŒ‡å‘å †ä¸­è¯¥å®ä½“çš„èµ·å§‹åœ°å€ã€‚å½“è§£é‡Šå™¨å¯»æ‰¾å¼•ç”¨å€¼æ—¶ï¼Œä¼šé¦–å…ˆæ£€ç´¢å…¶åœ¨æ ˆä¸­çš„åœ°å€ï¼Œå–å¾—åœ°å€åä»å †ä¸­è·å¾—å®ä½“ã€‚</li></ul> <p><strong>å¼•ç”¨æ•°æ®ç±»å‹:</strong></p> <ul><li>å¯¹è±¡<code>Object</code>ï¼ˆåŒ…å«æ™®é€šå¯¹è±¡-<code>Object</code>ï¼Œæ•°ç»„å¯¹è±¡-<code>Array</code>ï¼Œæ­£åˆ™å¯¹è±¡-<code>RegExp</code>ï¼Œæ—¥æœŸå¯¹è±¡-<code>Date</code>ï¼Œæ•°å­¦å‡½æ•°-<code>Math</code>ï¼Œå‡½æ•°å¯¹è±¡-<code>Function</code>ï¼‰</li></ul> <p><strong>2. æ•°æ®ç±»å‹æ£€æµ‹</strong></p> <p><strong>ï¼ˆ1ï¼‰typeof</strong></p> <blockquote><p>typeof å¯¹äºåŸå§‹ç±»å‹æ¥è¯´ï¼Œé™¤äº† null éƒ½å¯ä»¥æ˜¾ç¤ºæ­£ç¡®çš„ç±»å‹</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>               <span class="token comment">// number</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">// boolean</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> <span class="token string">'str'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token comment">// string</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>              <span class="token comment">// object     []æ•°ç»„çš„æ•°æ®ç±»å‹åœ¨ typeof ä¸­è¢«è§£é‡Šä¸º object</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// function</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>              <span class="token comment">// object</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">// undefined</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">// object     null çš„æ•°æ®ç±»å‹è¢« typeof è§£é‡Šä¸º object</span>
</code></pre></div><blockquote><p><code>typeof</code> å¯¹äºå¯¹è±¡æ¥è¯´ï¼Œé™¤äº†å‡½æ•°éƒ½ä¼šæ˜¾ç¤º <code>object</code>ï¼Œæ‰€ä»¥è¯´ <code>typeof</code> å¹¶ä¸èƒ½å‡†ç¡®åˆ¤æ–­å˜é‡åˆ°åº•æ˜¯ä»€ä¹ˆç±»å‹,æ‰€ä»¥æƒ³åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡çš„æ­£ç¡®ç±»å‹ï¼Œè¿™æ—¶å€™å¯ä»¥è€ƒè™‘ä½¿ç”¨ <code>instanceof</code></p></blockquote> <p><strong>ï¼ˆ2ï¼‰instanceof</strong></p> <blockquote><p><code>instanceof</code> å¯ä»¥æ­£ç¡®çš„åˆ¤æ–­å¯¹è±¡çš„ç±»å‹ï¼Œå› ä¸ºå†…éƒ¨æœºåˆ¶æ˜¯é€šè¿‡åˆ¤æ–­å¯¹è±¡çš„åŸå‹é“¾ä¸­æ˜¯ä¸æ˜¯èƒ½æ‰¾åˆ°ç±»å‹çš„ <code>prototype</code></p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">2</span> <span class="token keyword">instanceof</span> <span class="token class-name">Number</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token comment">// false</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token boolean">true</span> <span class="token keyword">instanceof</span> <span class="token class-name">Boolean</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment">// false </span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'str'</span> <span class="token keyword">instanceof</span> <span class="token class-name">String</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment">// false  </span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token keyword">instanceof</span> <span class="token class-name">Array</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token keyword">instanceof</span> <span class="token class-name">Function</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token keyword">instanceof</span> <span class="token class-name">Object</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                   <span class="token comment">// true    </span>
<span class="token comment">// console.log(undefined instanceof Undefined);</span>
<span class="token comment">// console.log(null instanceof Null);</span>
</code></pre></div><blockquote><p>å¯ä»¥çœ‹å‡ºç›´æ¥çš„å­—é¢é‡å€¼åˆ¤æ–­æ•°æ®ç±»å‹ï¼Œinstanceofå¯ä»¥ç²¾å‡†åˆ¤æ–­å¼•ç”¨æ•°æ®ç±»å‹ï¼ˆArrayï¼ŒFunctionï¼ŒObjectï¼‰ï¼Œè€ŒåŸºæœ¬æ•°æ®ç±»å‹ä¸èƒ½è¢«instanceofç²¾å‡†åˆ¤æ–­ã€‚</p></blockquote> <p>æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ <code>instanceof</code>&nbsp;åœ¨MDNä¸­çš„è§£é‡Šï¼š<code>instanceof</code>&nbsp;è¿ç®—ç¬¦ç”¨æ¥æµ‹è¯•ä¸€ä¸ªå¯¹è±¡åœ¨å…¶åŸå‹é“¾ä¸­æ˜¯å¦å­˜åœ¨ä¸€ä¸ªæ„é€ å‡½æ•°çš„&nbsp;prototype&nbsp;å±æ€§ã€‚å…¶æ„æ€å°±æ˜¯åˆ¤æ–­å¯¹è±¡æ˜¯å¦æ˜¯æŸä¸€æ•°æ®ç±»å‹ï¼ˆå¦‚Arrayï¼‰çš„å®ä¾‹ï¼Œè¯·é‡ç‚¹å…³æ³¨ä¸€ä¸‹æ˜¯åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯å¦æ˜¯æ•°æ®ç±»å‹çš„å®ä¾‹ã€‚åœ¨è¿™é‡Œå­—é¢é‡å€¼ï¼Œ2ï¼Œ&nbsp;true ï¼Œ'str'ä¸æ˜¯å®ä¾‹ï¼Œæ‰€ä»¥åˆ¤æ–­å€¼ä¸º<code>false</code></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// æˆ‘ä»¬ä¹Ÿå¯ä»¥è¯•ç€å®ç°ä¸€ä¸‹ instanceof</span>
<span class="token keyword">function</span> <span class="token keyword">instanceof</span><span class="token punctuation">(</span><span class="token parameter">left<span class="token punctuation">,</span> right</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// è·å¾—ç±»å‹çš„åŸå‹</span>
    <span class="token keyword">let</span> prototype <span class="token operator">=</span> right<span class="token punctuation">.</span>prototype
    <span class="token comment">// è·å¾—å¯¹è±¡çš„åŸå‹</span>
    left <span class="token operator">=</span> left<span class="token punctuation">.</span>__proto__
    <span class="token comment">// åˆ¤æ–­å¯¹è±¡çš„ç±»å‹æ˜¯å¦ç­‰äºç±»å‹çš„åŸå‹</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    	<span class="token keyword">if</span> <span class="token punctuation">(</span>left <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
    		<span class="token keyword">return</span> <span class="token boolean">false</span>
    	<span class="token keyword">if</span> <span class="token punctuation">(</span>prototype <span class="token operator">===</span> left<span class="token punctuation">)</span>
    		<span class="token keyword">return</span> <span class="token boolean">true</span>
    	left <span class="token operator">=</span> left<span class="token punctuation">.</span>__proto__
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>ï¼ˆ3ï¼‰constructor</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span>constructor <span class="token operator">===</span> Number<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">.</span>constructor <span class="token operator">===</span> Boolean<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">'str'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>constructor <span class="token operator">===</span> String<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>constructor <span class="token operator">===</span> Array<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>constructor <span class="token operator">===</span> Function<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>constructor <span class="token operator">===</span> Object<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
</code></pre></div><blockquote><p>è¿™é‡Œæœ‰ä¸€ä¸ªå‘ï¼Œå¦‚æœæˆ‘åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œæ›´æ”¹å®ƒçš„åŸå‹ï¼Œ<code>constructor</code>å°±ä¼šå˜å¾—ä¸å¯é äº†</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
 
<span class="token class-name">Fn</span><span class="token punctuation">.</span>prototype<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token keyword">var</span> f<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>f<span class="token punctuation">.</span>constructor<span class="token operator">===</span>Fn<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// false</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>f<span class="token punctuation">.</span>constructor<span class="token operator">===</span>Array<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true </span>
</code></pre></div><p><strong>ï¼ˆ4ï¼‰Object.prototype.toString.call()</strong></p> <blockquote><p>ä½¿ç”¨ <code>Object</code> å¯¹è±¡çš„åŸå‹æ–¹æ³• <code>toString</code> ï¼Œä½¿ç”¨ <code>call</code> è¿›è¡Œç‹¸çŒ«æ¢å¤ªå­ï¼Œå€Ÿç”¨<code>Object</code>çš„ <code>toString</code> æ–¹æ³•</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>toString<span class="token punctuation">;</span>
 
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">a</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">a</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">a</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token string">'str'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">a</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">a</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">a</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">a</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">undefined</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">a</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>å¾ˆç¨³çš„åˆ¤æ–­å°è£…:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> class2type <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token string">'Array Date RegExp Object Error'</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">e</span> <span class="token operator">=&gt;</span> class2type<span class="token punctuation">[</span> <span class="token string">'[object '</span> <span class="token operator">+</span> e <span class="token operator">+</span> <span class="token string">']'</span> <span class="token punctuation">]</span> <span class="token operator">=</span> e<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 

<span class="token keyword">function</span> <span class="token function">type</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>obj <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token function">String</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token keyword">typeof</span> obj <span class="token operator">===</span> <span class="token string">'object'</span> <span class="token operator">?</span> class2type<span class="token punctuation">[</span> <span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token string">'object'</span> <span class="token operator">:</span> <span class="token keyword">typeof</span> obj
<span class="token punctuation">}</span>
</code></pre></div><p><strong>å°ç»“</strong></p> <ul><li><code>typeof</code> <ul><li>ç›´æ¥åœ¨è®¡ç®—æœºåº•å±‚åŸºäºæ•°æ®ç±»å‹çš„å€¼ï¼ˆäºŒè¿›åˆ¶ï¼‰è¿›è¡Œæ£€æµ‹</li> <li><code>typeof null</code>ä¸º<code>object</code> åŸå› æ˜¯å¯¹è±¡å­˜åœ¨åœ¨è®¡ç®—æœºä¸­ï¼Œéƒ½æ˜¯ä»¥<code>000</code>å¼€å§‹çš„äºŒè¿›åˆ¶å­˜å‚¨ï¼Œæ‰€ä»¥æ£€æµ‹å‡ºæ¥çš„ç»“æœæ˜¯å¯¹è±¡</li> <li><code>typeof</code> æ™®é€šå¯¹è±¡/æ•°ç»„å¯¹è±¡/æ­£åˆ™å¯¹è±¡/æ—¥æœŸå¯¹è±¡ éƒ½æ˜¯<code>object</code></li> <li><code>typeof NaN === 'number'</code></li></ul></li> <li><code>instanceof</code> <ul><li>æ£€æµ‹å½“å‰å®ä¾‹æ˜¯å¦å±äºè¿™ä¸ªç±»çš„</li> <li>åº•å±‚æœºåˆ¶ï¼šåªè¦å½“å‰ç±»å‡ºç°åœ¨å®ä¾‹çš„åŸå‹ä¸Šï¼Œç»“æœéƒ½æ˜¯true</li> <li>ä¸èƒ½æ£€æµ‹åŸºæœ¬æ•°æ®ç±»å‹</li></ul></li> <li><code>constructor</code> <ul><li>æ”¯æŒåŸºæœ¬ç±»å‹</li> <li>constructorå¯ä»¥éšä¾¿æ”¹ï¼Œä¹Ÿä¸å‡†</li></ul></li> <li><code>Object.prototype.toString.call([val])</code> <ul><li>è¿”å›å½“å‰å®ä¾‹æ‰€å±ç±»ä¿¡æ¯</li></ul></li></ul> <blockquote><p>åˆ¤æ–­ <code>Target</code> çš„ç±»å‹ï¼Œå•å•ç”¨ <code>typeof</code> å¹¶æ— æ³•å®Œå…¨æ»¡è¶³ï¼Œè¿™å…¶å®å¹¶ä¸æ˜¯ <code>bug</code>ï¼Œæœ¬è´¨åŸå› æ˜¯ <code>JS</code> çš„ä¸‡ç‰©çš†å¯¹è±¡çš„ç†è®ºã€‚å› æ­¤è¦çœŸæ­£å®Œç¾åˆ¤æ–­æ—¶ï¼Œæˆ‘ä»¬éœ€è¦åŒºåˆ†å¯¹å¾…:</p></blockquote> <ul><li>åŸºæœ¬ç±»å‹(<code>null</code>): ä½¿ç”¨ <code>String(null)</code></li> <li>åŸºæœ¬ç±»å‹(<code>string / number / boolean / undefined</code>) + <code>function</code>: - ç›´æ¥ä½¿ç”¨ <code>typeof</code>å³å¯</li> <li>å…¶ä½™å¼•ç”¨ç±»å‹(<code>Array / Date / RegExp Error</code>): è°ƒç”¨<code>toString</code>åæ ¹æ®<code>[object XXX]</code>è¿›è¡Œåˆ¤æ–­</li></ul> <p><strong>3. æ•°æ®ç±»å‹è½¬æ¢</strong></p> <blockquote><p>é¦–å…ˆæˆ‘ä»¬è¦çŸ¥é“ï¼Œåœ¨ <code>JS</code> ä¸­ç±»å‹è½¬æ¢åªæœ‰ä¸‰ç§æƒ…å†µï¼Œåˆ†åˆ«æ˜¯ï¼š</p></blockquote> <ul><li>è½¬æ¢ä¸ºå¸ƒå°”å€¼</li> <li>è½¬æ¢ä¸ºæ•°å­—</li> <li>è½¬æ¢ä¸ºå­—ç¬¦ä¸²</li></ul> <p><img src="./è¿›é˜¶_files/1.png" alt="" class="medium-zoom-image"></p> <p><strong>è½¬Boolean</strong></p> <blockquote><p>åœ¨æ¡ä»¶åˆ¤æ–­æ—¶ï¼Œé™¤äº† <code>undefined</code>ï¼Œ<code>null</code>ï¼Œ <code>false</code>ï¼Œ <code>NaN</code>ï¼Œ <code>''</code>ï¼Œ <code>0</code>ï¼Œ <code>-0</code>ï¼Œå…¶ä»–æ‰€æœ‰å€¼éƒ½è½¬ä¸º <code>true</code>ï¼ŒåŒ…æ‹¬æ‰€æœ‰å¯¹è±¡</p></blockquote> <p><strong>å¯¹è±¡è½¬åŸå§‹ç±»å‹</strong></p> <blockquote><p>å¯¹è±¡åœ¨è½¬æ¢ç±»å‹çš„æ—¶å€™ï¼Œä¼šè°ƒç”¨å†…ç½®çš„ <code>[[ToPrimitive]]</code> å‡½æ•°ï¼Œå¯¹äºè¯¥å‡½æ•°æ¥è¯´ï¼Œç®—æ³•é€»è¾‘ä¸€èˆ¬æ¥è¯´å¦‚ä¸‹</p></blockquote> <ul><li>å¦‚æœå·²ç»æ˜¯åŸå§‹ç±»å‹äº†ï¼Œé‚£å°±ä¸éœ€è¦è½¬æ¢äº†</li> <li>è°ƒç”¨ <code>x.valueOf()</code>ï¼Œå¦‚æœè½¬æ¢ä¸ºåŸºç¡€ç±»å‹ï¼Œå°±è¿”å›è½¬æ¢çš„å€¼</li> <li>è°ƒç”¨ <code>x.toString()</code>ï¼Œå¦‚æœè½¬æ¢ä¸ºåŸºç¡€ç±»å‹ï¼Œå°±è¿”å›è½¬æ¢çš„å€¼</li> <li>å¦‚æœéƒ½æ²¡æœ‰è¿”å›åŸå§‹ç±»å‹ï¼Œå°±ä¼šæŠ¥é”™</li></ul> <blockquote><p>å½“ç„¶ä½ ä¹Ÿå¯ä»¥é‡å†™ <code>Symbol.toPrimitive</code>ï¼Œè¯¥æ–¹æ³•åœ¨è½¬åŸå§‹ç±»å‹æ—¶è°ƒç”¨ä¼˜å…ˆçº§æœ€é«˜ã€‚</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token number">0</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">'1'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>toPrimitive<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token number">2</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token number">1</span> <span class="token operator">+</span> a <span class="token comment">// =&gt; 3</span>
</code></pre></div><p><strong>å››åˆ™è¿ç®—ç¬¦</strong></p> <blockquote><p>å®ƒæœ‰ä»¥ä¸‹å‡ ä¸ªç‰¹ç‚¹ï¼š</p></blockquote> <ul><li>è¿ç®—ä¸­å…¶ä¸­ä¸€æ–¹ä¸ºå­—ç¬¦ä¸²ï¼Œé‚£ä¹ˆå°±ä¼šæŠŠå¦ä¸€æ–¹ä¹Ÿè½¬æ¢ä¸ºå­—ç¬¦ä¸²</li> <li>å¦‚æœä¸€æ–¹ä¸æ˜¯å­—ç¬¦ä¸²æˆ–è€…æ•°å­—ï¼Œé‚£ä¹ˆä¼šå°†å®ƒè½¬æ¢ä¸ºæ•°å­—æˆ–è€…å­—ç¬¦ä¸²</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token number">1</span> <span class="token operator">+</span> <span class="token string">'1'</span> <span class="token comment">// '11'</span>
<span class="token boolean">true</span> <span class="token operator">+</span> <span class="token boolean">true</span> <span class="token comment">// 2</span>
<span class="token number">4</span> <span class="token operator">+</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token comment">// "41,2,3"</span>
</code></pre></div><ul><li>å¯¹äºç¬¬ä¸€è¡Œä»£ç æ¥è¯´ï¼Œè§¦å‘ç‰¹ç‚¹ä¸€ï¼Œæ‰€ä»¥å°†æ•°å­— <code>1</code> è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œå¾—åˆ°ç»“æœ <code>'11'</code></li> <li>å¯¹äºç¬¬äºŒè¡Œä»£ç æ¥è¯´ï¼Œè§¦å‘ç‰¹ç‚¹äºŒï¼Œæ‰€ä»¥å°† <code>true</code> è½¬ä¸ºæ•°å­— <code>1</code></li> <li>å¯¹äºç¬¬ä¸‰è¡Œä»£ç æ¥è¯´ï¼Œè§¦å‘ç‰¹ç‚¹äºŒï¼Œæ‰€ä»¥å°†æ•°ç»„é€šè¿‡ <code>toString</code>è½¬ä¸ºå­—ç¬¦ä¸² <code>1,2,3</code>ï¼Œå¾—åˆ°ç»“æœ <code>41,2,3</code></li></ul> <blockquote><p>å¦å¤–å¯¹äºåŠ æ³•è¿˜éœ€è¦æ³¨æ„è¿™ä¸ªè¡¨è¾¾å¼ <code>'a' + + 'b'</code></p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>'a' + + 'b' // -&gt; "aNaN"
</code></pre></div><ul><li>å› ä¸º <code>+ 'b'</code> ç­‰äº <code>NaN</code>ï¼Œæ‰€ä»¥ç»“æœä¸º <code>"aNaN"</code>ï¼Œä½ å¯èƒ½ä¹Ÿä¼šåœ¨ä¸€äº›ä»£ç ä¸­çœ‹åˆ°è¿‡ <code>+ '1'</code>çš„å½¢å¼æ¥å¿«é€Ÿè·å– <code>number</code> ç±»å‹ã€‚</li> <li>é‚£ä¹ˆå¯¹äºé™¤äº†åŠ æ³•çš„è¿ç®—ç¬¦æ¥è¯´ï¼Œåªè¦å…¶ä¸­ä¸€æ–¹æ˜¯æ•°å­—ï¼Œé‚£ä¹ˆå¦ä¸€æ–¹å°±ä¼šè¢«è½¬ä¸ºæ•°å­—</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token number">4</span> <span class="token operator">*</span> <span class="token string">'3'</span> <span class="token comment">// 12</span>
<span class="token number">4</span> <span class="token operator">*</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token comment">// 0</span>
<span class="token number">4</span> <span class="token operator">*</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token comment">// NaN</span>
</code></pre></div><p><strong>æ¯”è¾ƒè¿ç®—ç¬¦</strong></p> <ul><li>å¦‚æœæ˜¯å¯¹è±¡ï¼Œå°±é€šè¿‡ <code>toPrimitive</code> è½¬æ¢å¯¹è±¡</li> <li>å¦‚æœæ˜¯å­—ç¬¦ä¸²ï¼Œå°±é€šè¿‡ <code>unicode</code> å­—ç¬¦ç´¢å¼•æ¥æ¯”è¾ƒ</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token number">0</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">'1'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
a <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token comment">// true</span>
</code></pre></div><blockquote><p>åœ¨ä»¥ä¸Šä»£ç ä¸­ï¼Œå› ä¸º <code>a</code> æ˜¯å¯¹è±¡ï¼Œæ‰€ä»¥ä¼šé€šè¿‡ <code>valueOf</code> è½¬æ¢ä¸ºåŸå§‹ç±»å‹å†æ¯”è¾ƒå€¼ã€‚</p></blockquote> <p><strong>null å’Œ undefined çš„åŒºåˆ«ï¼Ÿ</strong></p> <ul><li>é¦–å…ˆ <code>Undefined</code> å’Œ <code>Null</code> éƒ½æ˜¯åŸºæœ¬æ•°æ®ç±»å‹ï¼Œè¿™ä¸¤ä¸ªåŸºæœ¬æ•°æ®ç±»å‹åˆ†åˆ«éƒ½åªæœ‰ä¸€ä¸ªå€¼ï¼Œå°±æ˜¯ <code>undefined</code> å’Œ <code>null</code>ã€‚</li> <li><code>undefined</code> ä»£è¡¨çš„å«ä¹‰æ˜¯æœªå®šä¹‰ï¼Œ <code>null</code> ä»£è¡¨çš„å«ä¹‰æ˜¯ç©ºå¯¹è±¡ï¼ˆå…¶å®ä¸æ˜¯çœŸçš„å¯¹è±¡ï¼Œè¯·çœ‹ä¸‹é¢çš„æ³¨æ„ï¼ï¼‰ã€‚ä¸€èˆ¬å˜é‡å£°æ˜äº†ä½†è¿˜æ²¡æœ‰å®šä¹‰çš„æ—¶å€™ä¼šè¿”å› <code>undefined</code>ï¼Œ<code>null</code> ä¸»è¦ç”¨äºèµ‹å€¼ç»™ä¸€äº›å¯èƒ½ä¼šè¿”å›å¯¹è±¡çš„å˜é‡ï¼Œä½œä¸ºåˆå§‹åŒ–ã€‚</li></ul> <blockquote><p>å…¶å® null ä¸æ˜¯å¯¹è±¡ï¼Œè™½ç„¶ typeof null ä¼šè¾“å‡º objectï¼Œä½†æ˜¯è¿™åªæ˜¯ JS å­˜åœ¨çš„ä¸€ä¸ªæ‚ ä¹… Bugã€‚åœ¨ JS çš„æœ€åˆç‰ˆæœ¬ä¸­ä½¿ç”¨çš„æ˜¯ 32 ä½ç³»ç»Ÿï¼Œä¸ºäº†æ€§èƒ½è€ƒè™‘ä½¿ç”¨ä½ä½å­˜å‚¨å˜é‡çš„ç±»å‹ä¿¡æ¯ï¼Œ000 å¼€å¤´ä»£è¡¨æ˜¯å¯¹è±¡ï¼Œç„¶è€Œ null è¡¨ç¤ºä¸ºå…¨é›¶ï¼Œæ‰€ä»¥å°†å®ƒé”™è¯¯çš„åˆ¤æ–­ä¸º object ã€‚è™½ç„¶ç°åœ¨çš„å†…éƒ¨ç±»å‹åˆ¤æ–­ä»£ç å·²ç»æ”¹å˜äº†ï¼Œä½†æ˜¯å¯¹äºè¿™ä¸ª Bug å´æ˜¯ä¸€ç›´æµä¼ ä¸‹æ¥ã€‚</p></blockquote> <ul><li>undefined åœ¨ js ä¸­ä¸æ˜¯ä¸€ä¸ªä¿ç•™å­—ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>undefined</code> æ¥ä½œä¸ºä¸€ä¸ªå˜é‡åï¼Œè¿™æ ·çš„åšæ³•æ˜¯éå¸¸å±é™©çš„ï¼Œå®ƒä¼šå½±å“æˆ‘ä»¬å¯¹ undefined å€¼çš„åˆ¤æ–­ã€‚ä½†æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€äº›æ–¹æ³•è·å¾—å®‰å…¨çš„ <code>undefined</code> å€¼ï¼Œæ¯”å¦‚è¯´ <code>void 0</code>ã€‚</li> <li>å½“æˆ‘ä»¬å¯¹ä¸¤ç§ç±»å‹ä½¿ç”¨ typeof è¿›è¡Œåˆ¤æ–­çš„æ—¶å€™ï¼ŒNull ç±»å‹åŒ–ä¼šè¿”å› â€œobjectâ€ï¼Œè¿™æ˜¯ä¸€ä¸ªå†å²é—ç•™çš„é—®é¢˜ã€‚å½“æˆ‘ä»¬ä½¿ç”¨åŒç­‰å·å¯¹ä¸¤ç§ç±»å‹çš„å€¼è¿›è¡Œæ¯”è¾ƒæ—¶ä¼šè¿”å› trueï¼Œä½¿ç”¨ä¸‰ä¸ªç­‰å·æ—¶ä¼šè¿”å› falseã€‚</li></ul> <h3 id="_2-this"><a href="http://interview.poetries.top/docs/simply.html#_2-this" class="header-anchor">#</a> 2 This</h3> <blockquote><p>ä¸åŒæƒ…å†µçš„è°ƒç”¨ï¼Œ<code>this</code>æŒ‡å‘åˆ†åˆ«å¦‚ä½•ã€‚é¡ºå¸¦å¯ä»¥æä¸€ä¸‹ <code>es6</code> ä¸­ç®­å¤´å‡½æ•°æ²¡æœ‰ <code>this</code>, <code>arguments</code>, <code>super</code> ç­‰ï¼Œè¿™äº›åªä¾èµ–åŒ…å«ç®­å¤´å‡½æ•°æœ€æ¥è¿‘çš„å‡½æ•°</p></blockquote> <blockquote><p>æˆ‘ä»¬å…ˆæ¥çœ‹å‡ ä¸ªå‡½æ•°è°ƒç”¨çš„åœºæ™¯</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>a<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">1</span>
<span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  a<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
  foo<span class="token operator">:</span> foo
<span class="token punctuation">}</span>
obj<span class="token punctuation">.</span><span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> c <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>å¯¹äºç›´æ¥è°ƒç”¨ <code>foo</code> æ¥è¯´ï¼Œä¸ç®¡ <code>foo</code> å‡½æ•°è¢«æ”¾åœ¨äº†ä»€ä¹ˆåœ°æ–¹ï¼Œ<code>this</code> ä¸€å®šæ˜¯<code>window</code></li> <li>å¯¹äº <code>obj.foo()</code> æ¥è¯´ï¼Œæˆ‘ä»¬åªéœ€è¦è®°ä½ï¼Œè°è°ƒç”¨äº†å‡½æ•°ï¼Œè°å°±æ˜¯ <code>this</code>ï¼Œæ‰€ä»¥åœ¨è¿™ä¸ªåœºæ™¯ä¸‹ <code>foo</code> å‡½æ•°ä¸­çš„ <code>this</code> å°±æ˜¯ <code>obj</code> å¯¹è±¡</li> <li>å¯¹äº <code>new</code> çš„æ–¹å¼æ¥è¯´ï¼Œ<code>this</code> è¢«æ°¸è¿œç»‘å®šåœ¨äº† <code>c</code> ä¸Šé¢ï¼Œä¸ä¼šè¢«ä»»ä½•æ–¹å¼æ”¹å˜ <code>this</code></li></ul> <blockquote><p>è¯´å®Œäº†ä»¥ä¸Šå‡ ç§æƒ…å†µï¼Œå…¶å®å¾ˆå¤šä»£ç ä¸­çš„ <code>this</code> åº”è¯¥å°±æ²¡ä»€ä¹ˆé—®é¢˜äº†ï¼Œä¸‹é¢è®©æˆ‘ä»¬çœ‹çœ‹ç®­å¤´å‡½æ•°ä¸­çš„ <code>this</code></p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>é¦–å…ˆç®­å¤´å‡½æ•°å…¶å®æ˜¯æ²¡æœ‰ <code>this</code> çš„ï¼Œç®­å¤´å‡½æ•°ä¸­çš„ <code>this</code> åªå–å†³åŒ…è£¹ç®­å¤´å‡½æ•°çš„ç¬¬ä¸€ä¸ªæ™®é€šå‡½æ•°çš„ <code>this</code>ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå› ä¸ºåŒ…è£¹ç®­å¤´å‡½æ•°çš„ç¬¬ä¸€ä¸ªæ™®é€šå‡½æ•°æ˜¯ <code>a</code>ï¼Œæ‰€ä»¥æ­¤æ—¶çš„ <code>this</code> æ˜¯ <code>window</code>ã€‚å¦å¤–å¯¹ç®­å¤´å‡½æ•°ä½¿ç”¨ <code>bind</code>è¿™ç±»å‡½æ•°æ˜¯æ— æ•ˆçš„ã€‚</li> <li>æœ€åç§æƒ…å†µä¹Ÿå°±æ˜¯ <code>bind</code> è¿™äº›æ”¹å˜ä¸Šä¸‹æ–‡çš„ <code>API</code> äº†ï¼Œå¯¹äºè¿™äº›å‡½æ•°æ¥è¯´ï¼Œ<code>this</code> å–å†³äºç¬¬ä¸€ä¸ªå‚æ•°ï¼Œå¦‚æœç¬¬ä¸€ä¸ªå‚æ•°ä¸ºç©ºï¼Œé‚£ä¹ˆå°±æ˜¯ <code>window</code>ã€‚</li> <li>é‚£ä¹ˆè¯´åˆ° <code>bind</code>ï¼Œä¸çŸ¥é“å¤§å®¶æ˜¯å¦è€ƒè™‘è¿‡ï¼Œå¦‚æœå¯¹ä¸€ä¸ªå‡½æ•°è¿›è¡Œå¤šæ¬¡ <code>bind</code>ï¼Œé‚£ä¹ˆä¸Šä¸‹æ–‡ä¼šæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">let</span> <span class="token function-variable function">fn</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
<span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// =&gt; ?</span>
</code></pre></div><blockquote><p>å¦‚æœä½ è®¤ä¸ºè¾“å‡ºç»“æœæ˜¯ <code>a</code>ï¼Œé‚£ä¹ˆä½ å°±é”™äº†ï¼Œå…¶å®æˆ‘ä»¬å¯ä»¥æŠŠä¸Šè¿°ä»£ç è½¬æ¢æˆå¦ä¸€ç§å½¢å¼</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// fn.bind().bind(a) ç­‰äº</span>
<span class="token keyword">let</span> <span class="token function-variable function">fn2</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">fn1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">fn2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><blockquote><p>å¯ä»¥ä»ä¸Šè¿°ä»£ç ä¸­å‘ç°ï¼Œä¸ç®¡æˆ‘ä»¬ç»™å‡½æ•° <code>bind</code> å‡ æ¬¡ï¼Œ<code>fn</code> ä¸­çš„ <code>this</code> æ°¸è¿œç”±ç¬¬ä¸€æ¬¡ <code>bind</code> å†³å®šï¼Œæ‰€ä»¥ç»“æœæ°¸è¿œæ˜¯ <code>window</code></p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'poetries'</span> <span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">foo</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// =&gt; 'poetries'</span>
</code></pre></div><blockquote><p>ä»¥ä¸Šå°±æ˜¯ <code>this</code> çš„è§„åˆ™äº†ï¼Œä½†æ˜¯å¯èƒ½ä¼šå‘ç”Ÿå¤šä¸ªè§„åˆ™åŒæ—¶å‡ºç°çš„æƒ…å†µï¼Œè¿™æ—¶å€™ä¸åŒçš„è§„åˆ™ä¹‹é—´ä¼šæ ¹æ®ä¼˜å…ˆçº§æœ€é«˜çš„æ¥å†³å®š <code>this</code> æœ€ç»ˆæŒ‡å‘å“ªé‡Œã€‚</p></blockquote> <blockquote><p>é¦–å…ˆï¼Œ<code>new</code> çš„æ–¹å¼ä¼˜å…ˆçº§æœ€é«˜ï¼Œæ¥ä¸‹æ¥æ˜¯ <code>bind</code> è¿™äº›å‡½æ•°ï¼Œç„¶åæ˜¯ <code>obj.foo()</code> è¿™ç§è°ƒç”¨æ–¹å¼ï¼Œæœ€åæ˜¯ <code>foo</code> è¿™ç§è°ƒç”¨æ–¹å¼ï¼ŒåŒæ—¶ï¼Œç®­å¤´å‡½æ•°çš„ <code>this</code> ä¸€æ—¦è¢«ç»‘å®šï¼Œå°±ä¸ä¼šå†è¢«ä»»ä½•æ–¹å¼æ‰€æ”¹å˜ã€‚</p></blockquote> <p><img src="./è¿›é˜¶_files/2.png" alt="image.png" class="medium-zoom-image"></p> <p><strong>å‡½æ•°æ‰§è¡Œæ”¹å˜this</strong></p> <ul><li>ç”±äº JS çš„è®¾è®¡åŸç†: åœ¨å‡½æ•°ä¸­ï¼Œå¯ä»¥å¼•ç”¨è¿è¡Œç¯å¢ƒä¸­çš„å˜é‡ã€‚å› æ­¤å°±éœ€è¦ä¸€ä¸ªæœºåˆ¶æ¥è®©æˆ‘ä»¬å¯ä»¥åœ¨å‡½æ•°ä½“å†…éƒ¨è·å–å½“å‰çš„è¿è¡Œç¯å¢ƒï¼Œè¿™ä¾¿æ˜¯<code>this</code>ã€‚</li></ul> <blockquote><p>å› æ­¤è¦æ˜ç™½ <code>this</code> æŒ‡å‘ï¼Œå…¶å®å°±æ˜¯è¦ææ¸…æ¥š å‡½æ•°çš„è¿è¡Œç¯å¢ƒï¼Œè¯´äººè¯å°±æ˜¯ï¼Œè°è°ƒç”¨äº†å‡½æ•°ã€‚ä¾‹å¦‚</p></blockquote> <ul><li><code>obj.fn()</code>ï¼Œä¾¿æ˜¯ <code>obj</code> è°ƒç”¨äº†å‡½æ•°ï¼Œæ—¢å‡½æ•°ä¸­çš„ <code>this === obj</code></li> <li><code>fn()</code>ï¼Œè¿™é‡Œå¯ä»¥çœ‹æˆ <code>window.fn()</code>ï¼Œå› æ­¤ <code>this === window</code></li></ul> <blockquote><p>ä½†è¿™ç§æœºåˆ¶å¹¶ä¸å®Œå…¨èƒ½æ»¡è¶³æˆ‘ä»¬çš„ä¸šåŠ¡éœ€æ±‚ï¼Œå› æ­¤æä¾›äº†ä¸‰ç§æ–¹å¼å¯ä»¥æ‰‹åŠ¨ä¿®æ”¹ <code>this</code> çš„æŒ‡å‘:</p></blockquote> <ul><li><code>call: fn.call(target, 1, 2)</code></li> <li><code>apply: fn.apply(target, [1, 2])</code></li> <li><code>bind: fn.bind(target)(1,2)</code></li></ul> <h3 id="_3-bind-call-apply-åŒºåˆ«åŠå®ç°"><a href="http://interview.poetries.top/docs/simply.html#_3-bind-call-apply-%E5%8C%BA%E5%88%AB%E5%8F%8A%E5%AE%9E%E7%8E%B0" class="header-anchor">#</a> 3 bind/call/apply åŒºåˆ«åŠå®ç°</h3> <ul><li>åœ¨æµè§ˆå™¨é‡Œï¼Œåœ¨å…¨å±€èŒƒå›´å†…this æŒ‡å‘windowå¯¹è±¡ï¼›</li> <li>åœ¨å‡½æ•°ä¸­ï¼Œthisæ°¸è¿œæŒ‡å‘æœ€åè°ƒç”¨ä»–çš„é‚£ä¸ªå¯¹è±¡ï¼›</li> <li>æ„é€ å‡½æ•°ä¸­ï¼ŒthisæŒ‡å‘newå‡ºæ¥çš„é‚£ä¸ªæ–°çš„å¯¹è±¡ï¼›</li> <li><code>callã€applyã€bind</code>ä¸­çš„thisè¢«å¼ºç»‘å®šåœ¨æŒ‡å®šçš„é‚£ä¸ªå¯¹è±¡ä¸Šï¼›</li> <li>ç®­å¤´å‡½æ•°ä¸­thisæ¯”è¾ƒç‰¹æ®Š,ç®­å¤´å‡½æ•°thisä¸ºçˆ¶ä½œç”¨åŸŸçš„thisï¼Œä¸æ˜¯è°ƒç”¨æ—¶çš„this.è¦çŸ¥é“å‰å››ç§æ–¹å¼,éƒ½æ˜¯è°ƒç”¨æ—¶ç¡®å®š,ä¹Ÿå°±æ˜¯åŠ¨æ€çš„,è€Œç®­å¤´å‡½æ•°çš„thisæŒ‡å‘æ˜¯é™æ€çš„,å£°æ˜çš„æ—¶å€™å°±ç¡®å®šäº†ä¸‹æ¥ï¼›</li> <li><code>applyã€callã€bind</code>éƒ½æ˜¯jsç»™å‡½æ•°å†…ç½®çš„ä¸€äº›APIï¼Œè°ƒç”¨ä»–ä»¬å¯ä»¥ä¸ºå‡½æ•°æŒ‡å®šthisçš„æ‰§è¡Œ,åŒæ—¶ä¹Ÿå¯ä»¥ä¼ å‚ã€‚</li></ul> <p><img src="./è¿›é˜¶_files/6.png" alt="" class="medium-zoom-image"></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token punctuation">{</span>
    value<span class="token operator">:</span> <span class="token number">1</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">getValue</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>age<span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">getValue</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token string">'poe'</span><span class="token punctuation">,</span> <span class="token string">'24'</span><span class="token punctuation">)</span>
<span class="token function">getValue</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'poe'</span><span class="token punctuation">,</span> <span class="token string">'24'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><blockquote><p><code>bind</code> å’Œå…¶ä»–ä¸¤ä¸ªæ–¹æ³•ä½œç”¨ä¹Ÿæ˜¯ä¸€è‡´çš„ï¼Œåªæ˜¯è¯¥æ–¹æ³•ä¼šè¿”å›ä¸€ä¸ªå‡½æ•°ã€‚å¹¶ä¸”æˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>bind</code> å®ç°æŸ¯é‡ŒåŒ–</p></blockquote> <p><strong>å®ç°ä¸€ä¸ª bind å‡½æ•°</strong></p> <p>å¯¹äºå®ç°ä»¥ä¸‹å‡ ä¸ªå‡½æ•°ï¼Œå¯ä»¥ä»å‡ ä¸ªæ–¹é¢æ€è€ƒ</p> <ul><li>ä¸ä¼ å…¥ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œé‚£ä¹ˆé»˜è®¤ä¸º <code>window</code></li> <li>æ”¹å˜äº† <code>this</code> æŒ‡å‘ï¼Œè®©æ–°çš„å¯¹è±¡å¯ä»¥æ‰§è¡Œè¯¥å‡½æ•°ã€‚é‚£ä¹ˆæ€è·¯æ˜¯å¦å¯ä»¥å˜æˆç»™æ–°çš„å¯¹è±¡æ·»åŠ ä¸€ä¸ªå‡½æ•°ï¼Œç„¶ååœ¨æ‰§è¡Œå®Œä»¥ååˆ é™¤ï¼Ÿ</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">myBind</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">context</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> <span class="token keyword">this</span> <span class="token operator">!==</span> <span class="token string">'function'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">TypeError</span><span class="token punctuation">(</span><span class="token string">'Error'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">var</span> _this <span class="token operator">=</span> <span class="token keyword">this</span>
  <span class="token keyword">var</span> args <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>arguments<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
  <span class="token comment">// è¿”å›ä¸€ä¸ªå‡½æ•°</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token constant">F</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// å› ä¸ºè¿”å›äº†ä¸€ä¸ªå‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥ new F()ï¼Œæ‰€ä»¥éœ€è¦åˆ¤æ–­</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token keyword">instanceof</span> <span class="token class-name">F</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">_this</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">,</span> <span class="token operator">...</span>arguments<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token function">_this</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> args<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token operator">...</span>arguments<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>å®ç°ä¸€ä¸ª call å‡½æ•°</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">myCall</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">context</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> context <span class="token operator">=</span> context <span class="token operator">||</span> window
  <span class="token comment">// ç»™ context æ·»åŠ ä¸€ä¸ªå±æ€§</span>
  <span class="token comment">// getValue.call(a, 'pp', '24') =&gt; a.fn = getValue</span>
  context<span class="token punctuation">.</span>fn <span class="token operator">=</span> <span class="token keyword">this</span>
  <span class="token comment">// å°† context åé¢çš„å‚æ•°å–å‡ºæ¥</span>
  <span class="token keyword">var</span> args <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>arguments<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
  <span class="token comment">// getValue.call(a, 'pp', '24') =&gt; a.fn('pp', '24')</span>
  <span class="token keyword">var</span> result <span class="token operator">=</span> context<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span>
  <span class="token comment">// åˆ é™¤ fn</span>
  <span class="token keyword">delete</span> context<span class="token punctuation">.</span>fn
  <span class="token keyword">return</span> result
<span class="token punctuation">}</span>
</code></pre></div><p><strong>å®ç°ä¸€ä¸ª apply å‡½æ•°</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">myApply</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">context <span class="token operator">=</span> window<span class="token punctuation">,</span> <span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// this--&gt;func  context--&gt; obj  args--&gt; ä¼ é€’è¿‡æ¥çš„å‚æ•°</span>

  <span class="token comment">// åœ¨contextä¸ŠåŠ ä¸€ä¸ªå”¯ä¸€å€¼ä¸å½±å“contextä¸Šçš„å±æ€§</span>
  <span class="token keyword">let</span> key <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">'key'</span><span class="token punctuation">)</span>
  context<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span> <span class="token comment">// contextä¸ºè°ƒç”¨çš„ä¸Šä¸‹æ–‡,thisæ­¤å¤„ä¸ºå‡½æ•°ï¼Œå°†è¿™ä¸ªå‡½æ•°ä½œä¸ºcontextçš„æ–¹æ³•</span>
  <span class="token comment">// let args = [...arguments].slice(1)   //ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºobjæ‰€ä»¥åˆ é™¤,ä¼ªæ•°ç»„è½¬ä¸ºæ•°ç»„</span>
  
  <span class="token keyword">let</span> result <span class="token operator">=</span> context<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è¿™é‡Œå’Œcallä¼ å‚ä¸ä¸€æ ·</span>
  <span class="token keyword">delete</span> context<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// ä¸åˆ é™¤ä¼šå¯¼è‡´contextå±æ€§è¶Šæ¥è¶Šå¤š</span>
  <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// ä½¿ç”¨</span>
<span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span>b</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
 console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span>
 console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> obj<span class="token operator">=</span><span class="token punctuation">{</span>
 name<span class="token operator">:</span><span class="token string">'å¼ ä¸‰'</span>
<span class="token punctuation">}</span>
f<span class="token punctuation">.</span><span class="token function">myApply</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment">//arguments[1]</span>
</code></pre></div><h3 id="_4-å˜é‡æå‡"><a href="http://interview.poetries.top/docs/simply.html#_4-%E5%8F%98%E9%87%8F%E6%8F%90%E5%8D%87" class="header-anchor">#</a> 4 å˜é‡æå‡</h3> <blockquote><p>å½“æ‰§è¡Œ <code>JS</code> ä»£ç æ—¶ï¼Œä¼šç”Ÿæˆæ‰§è¡Œç¯å¢ƒï¼Œåªè¦ä»£ç ä¸æ˜¯å†™åœ¨å‡½æ•°ä¸­çš„ï¼Œå°±æ˜¯åœ¨å…¨å±€æ‰§è¡Œç¯å¢ƒä¸­ï¼Œå‡½æ•°ä¸­çš„ä»£ç ä¼šäº§ç”Ÿå‡½æ•°æ‰§è¡Œç¯å¢ƒï¼Œåªæ­¤ä¸¤ç§æ‰§è¡Œç¯å¢ƒã€‚</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// call b</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token comment">// undefined</span>

<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token string">'Hello world'</span>

<span class="token keyword">function</span> <span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'call b'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>æƒ³å¿…ä»¥ä¸Šçš„è¾“å‡ºå¤§å®¶è‚¯å®šéƒ½å·²ç»æ˜ç™½äº†ï¼Œè¿™æ˜¯å› ä¸ºå‡½æ•°å’Œå˜é‡æå‡çš„åŸå› ã€‚é€šå¸¸æå‡çš„è§£é‡Šæ˜¯è¯´å°†å£°æ˜çš„ä»£ç ç§»åŠ¨åˆ°äº†é¡¶éƒ¨ï¼Œè¿™å…¶å®æ²¡æœ‰ä»€ä¹ˆé”™è¯¯ï¼Œä¾¿äºå¤§å®¶ç†è§£ã€‚ä½†æ˜¯æ›´å‡†ç¡®çš„è§£é‡Šåº”è¯¥æ˜¯ï¼šåœ¨ç”Ÿæˆæ‰§è¡Œç¯å¢ƒæ—¶ï¼Œä¼šæœ‰ä¸¤ä¸ªé˜¶æ®µã€‚ç¬¬ä¸€ä¸ªé˜¶æ®µæ˜¯åˆ›å»ºçš„é˜¶æ®µï¼Œ<code>JS</code> è§£é‡Šå™¨ä¼šæ‰¾å‡ºéœ€è¦æå‡çš„å˜é‡å’Œå‡½æ•°ï¼Œå¹¶ä¸”ç»™ä»–ä»¬æå‰åœ¨å†…å­˜ä¸­å¼€è¾Ÿå¥½ç©ºé—´ï¼Œå‡½æ•°çš„è¯ä¼šå°†æ•´ä¸ªå‡½æ•°å­˜å…¥å†…å­˜ä¸­ï¼Œå˜é‡åªå£°æ˜å¹¶ä¸”èµ‹å€¼ä¸º <code>undefined</code>ï¼Œæ‰€ä»¥åœ¨ç¬¬äºŒä¸ªé˜¶æ®µï¼Œä¹Ÿå°±æ˜¯ä»£ç æ‰§è¡Œé˜¶æ®µï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥æå‰ä½¿ç”¨</p></blockquote> <ul><li>åœ¨æå‡çš„è¿‡ç¨‹ä¸­ï¼Œç›¸åŒçš„å‡½æ•°ä¼šè¦†ç›–ä¸Šä¸€ä¸ªå‡½æ•°ï¼Œå¹¶ä¸”å‡½æ•°ä¼˜å…ˆäºå˜é‡æå‡</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// call b second</span>

<span class="token keyword">function</span> <span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'call b fist'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'call b second'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token string">'Hello world'</span>
</code></pre></div><blockquote><p><code>var</code> ä¼šäº§ç”Ÿå¾ˆå¤šé”™è¯¯ï¼Œæ‰€ä»¥åœ¨ ES6ä¸­å¼•å…¥äº† <code>let</code>ã€‚<code>let</code>ä¸èƒ½åœ¨å£°æ˜å‰ä½¿ç”¨ï¼Œä½†æ˜¯è¿™å¹¶ä¸æ˜¯å¸¸è¯´çš„ <code>let</code> ä¸ä¼šæå‡ï¼Œ<code>let</code>æå‡äº†ï¼Œåœ¨ç¬¬ä¸€é˜¶æ®µå†…å­˜ä¹Ÿå·²ç»ä¸ºä»–å¼€è¾Ÿå¥½äº†ç©ºé—´ï¼Œä½†æ˜¯å› ä¸ºè¿™ä¸ªå£°æ˜çš„ç‰¹æ€§å¯¼è‡´äº†å¹¶ä¸èƒ½åœ¨å£°æ˜å‰ä½¿ç”¨</p></blockquote> <h3 id="_5-é—­åŒ…"><a href="http://interview.poetries.top/docs/simply.html#_5-%E9%97%AD%E5%8C%85" class="header-anchor">#</a> 5 é—­åŒ…</h3> <blockquote><p>é—­åŒ…æ˜¯æŒ‡æœ‰æƒè®¿é—®å¦ä¸€ä¸ªå‡½æ•°ä½œç”¨åŸŸå†…å˜é‡çš„å‡½æ•°ï¼Œåˆ›å»ºé—­åŒ…çš„æœ€å¸¸è§çš„æ–¹å¼å°±æ˜¯åœ¨ä¸€ä¸ªå‡½æ•°å†…åˆ›å»ºå¦ä¸€ä¸ªå‡½æ•°ï¼Œåˆ›å»ºçš„å‡½æ•°å¯ä»¥ è®¿é—®åˆ°å½“å‰å‡½æ•°çš„å±€éƒ¨å˜é‡ã€‚</p></blockquote> <p><strong>é—­åŒ…æœ‰ä¸¤ä¸ªå¸¸ç”¨çš„ç”¨é€”</strong></p> <ul><li>é—­åŒ…çš„ç¬¬ä¸€ä¸ªç”¨é€”æ˜¯ä½¿æˆ‘ä»¬åœ¨å‡½æ•°å¤–éƒ¨èƒ½å¤Ÿè®¿é—®åˆ°å‡½æ•°å†…éƒ¨çš„å˜é‡ã€‚é€šè¿‡ä½¿ç”¨é—­åŒ…ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨å¤–éƒ¨è°ƒç”¨é—­åŒ…å‡½æ•°ï¼Œä»è€Œåœ¨å¤–éƒ¨è®¿é—®åˆ°å‡½æ•°å†…éƒ¨çš„å˜é‡ï¼Œå¯ä»¥ä½¿ç”¨è¿™ç§æ–¹æ³•æ¥åˆ›å»ºç§æœ‰å˜é‡ã€‚</li> <li>å‡½æ•°çš„å¦ä¸€ä¸ªç”¨é€”æ˜¯ä½¿å·²ç»è¿è¡Œç»“æŸçš„å‡½æ•°ä¸Šä¸‹æ–‡ä¸­çš„å˜é‡å¯¹è±¡ç»§ç»­ç•™åœ¨å†…å­˜ä¸­ï¼Œå› ä¸ºé—­åŒ…å‡½æ•°ä¿ç•™äº†è¿™ä¸ªå˜é‡å¯¹è±¡çš„å¼•ç”¨ï¼Œæ‰€ä»¥è¿™ä¸ªå˜é‡å¯¹è±¡ä¸ä¼šè¢«å›æ”¶ã€‚</li></ul> <blockquote><p>å…¶å®é—­åŒ…çš„æœ¬è´¨å°±æ˜¯ä½œç”¨åŸŸé“¾çš„ä¸€ä¸ªç‰¹æ®Šçš„åº”ç”¨ï¼Œåªè¦äº†è§£äº†ä½œç”¨åŸŸé“¾çš„åˆ›å»ºè¿‡ç¨‹ï¼Œå°±èƒ½å¤Ÿç†è§£é—­åŒ…çš„å®ç°åŸç†ã€‚</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token number">1</span>
<span class="token comment">// fn æ˜¯é—­åŒ…</span>
<span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">fn1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token number">1</span>
  <span class="token comment">// è¿™é‡Œä¹Ÿæ˜¯é—­åŒ…</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> fn2 <span class="token operator">=</span> <span class="token function">fn1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">fn2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>å¤§å®¶éƒ½çŸ¥é“é—­åŒ…å…¶ä¸­ä¸€ä¸ªä½œç”¨æ˜¯è®¿é—®ç§æœ‰å˜é‡ï¼Œå°±æ¯”å¦‚ä¸Šè¿°ä»£ç ä¸­çš„ fn2 è®¿é—®åˆ°äº† fn1 å‡½æ•°ä¸­çš„å˜é‡ aã€‚ä½†æ˜¯æ­¤æ—¶ fn1 æ—©å·²é”€æ¯ï¼Œæˆ‘ä»¬æ˜¯å¦‚ä½•è®¿é—®åˆ°å˜é‡ a çš„å‘¢ï¼Ÿä¸æ˜¯éƒ½è¯´åŸå§‹ç±»å‹æ˜¯å­˜æ”¾åœ¨æ ˆä¸Šçš„ä¹ˆï¼Œä¸ºä»€ä¹ˆæ­¤æ—¶å´æ²¡æœ‰è¢«é”€æ¯æ‰ï¼Ÿ</li> <li>æ¥ä¸‹æ¥ç¬”è€…ä¼šæ ¹æ®æµè§ˆå™¨çš„è¡¨ç°æ¥é‡æ–°ç†è§£å…³äºåŸå§‹ç±»å‹å­˜æ”¾ä½ç½®çš„è¯´æ³•ã€‚</li> <li>å…ˆæ¥è¯´ä¸‹æ•°æ®å­˜æ”¾çš„æ­£ç¡®è§„åˆ™æ˜¯ï¼šå±€éƒ¨ã€å ç”¨ç©ºé—´ç¡®å®šçš„æ•°æ®ï¼Œä¸€èˆ¬ä¼šå­˜æ”¾åœ¨æ ˆä¸­ï¼Œå¦åˆ™å°±åœ¨å †ä¸­ï¼ˆä¹Ÿæœ‰ä¾‹å¤–ï¼‰ã€‚ é‚£ä¹ˆæ¥ä¸‹æ¥æˆ‘ä»¬å¯ä»¥é€šè¿‡ Chrome æ¥å¸®åŠ©æˆ‘ä»¬éªŒè¯è¿™ä¸ªè¯´æ³•è¯´æ³•ã€‚</li></ul> <p><img src="./è¿›é˜¶_files/20210406200721.png" alt="" class="medium-zoom-image"></p> <blockquote><p>ä¸Šå›¾ä¸­ç”»çº¢æ¡†çš„ä½ç½®æˆ‘ä»¬èƒ½çœ‹åˆ°ä¸€ä¸ªå†…éƒ¨çš„å¯¹è±¡ <code>[[Scopes]]</code>ï¼Œå…¶ä¸­å­˜æ”¾ç€å˜é‡ aï¼Œè¯¥å¯¹è±¡æ˜¯è¢«å­˜æ”¾åœ¨å †ä¸Šçš„ï¼Œå…¶ä¸­åŒ…å«äº†é—­åŒ…ã€å…¨å±€å¯¹è±¡ç­‰ç­‰å†…å®¹ï¼Œå› æ­¤æˆ‘ä»¬èƒ½é€šè¿‡é—­åŒ…è®¿é—®åˆ°æœ¬è¯¥é”€æ¯çš„å˜é‡ã€‚</p></blockquote> <p>å¦å¤–æœ€å¼€å§‹æˆ‘ä»¬å¯¹äºé—­åŒ…çš„å®šä½æ˜¯ï¼šå‡å¦‚ä¸€ä¸ªå‡½æ•°èƒ½è®¿é—®å¤–éƒ¨çš„å˜é‡ï¼Œé‚£ä¹ˆè¿™ä¸ªå‡½æ•°å®ƒå°±æ˜¯ä¸€ä¸ªé—­åŒ…ï¼Œå› æ­¤æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹çœ‹åœ¨å…¨å±€ä¸‹çš„è¡¨ç°æ˜¯æ€ä¹ˆæ ·çš„ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token number">1</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token number">2</span>
<span class="token comment">// fn æ˜¯é—­åŒ…</span>
<span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><img src="./è¿›é˜¶_files/20210406200756.png" alt="" class="medium-zoom-image"></p> <p>ä»ä¸Šå›¾æˆ‘ä»¬èƒ½å‘ç°å…¨å±€ä¸‹å£°æ˜çš„å˜é‡ï¼Œå¦‚æœæ˜¯ var çš„è¯å°±ç›´æ¥è¢«æŒ‚åˆ° globe ä¸Šï¼Œå¦‚æœæ˜¯å…¶ä»–å…³é”®å­—å£°æ˜çš„è¯å°±è¢«æŒ‚åˆ° Script ä¸Šã€‚è™½ç„¶è¿™äº›å†…å®¹åŒæ ·è¿˜æ˜¯å­˜åœ¨ <code>[[Scopes]]</code>ï¼Œä½†æ˜¯å…¨å±€å˜é‡åº”è¯¥æ˜¯å­˜æ”¾åœ¨é™æ€åŒºåŸŸçš„ï¼Œå› ä¸ºå…¨å±€å˜é‡æ— éœ€è¿›è¡Œåƒåœ¾å›æ”¶ï¼Œç­‰éœ€è¦å›æ”¶çš„æ—¶å€™æ•´ä¸ªåº”ç”¨éƒ½æ²¡äº†ã€‚</p> <p>åªæœ‰åœ¨ä¸‹å›¾çš„åœºæ™¯ä¸­ï¼ŒåŸå§‹ç±»å‹æ‰å¯èƒ½æ˜¯è¢«å­˜å‚¨åœ¨æ ˆä¸Šã€‚</p> <blockquote><p>è¿™é‡Œä¸ºä»€ä¹ˆè¦è¯´å¯èƒ½ï¼Œæ˜¯å› ä¸º JS æ˜¯é—¨åŠ¨æ€ç±»å‹è¯­è¨€ï¼Œä¸€ä¸ªå˜é‡å£°æ˜æ—¶å¯ä»¥æ˜¯åŸå§‹ç±»å‹ï¼Œé©¬ä¸Šåˆå¯ä»¥èµ‹å€¼ä¸ºå¯¹è±¡ç±»å‹ï¼Œç„¶ååˆå›åˆ°åŸå§‹ç±»å‹ã€‚è¿™æ ·é¢‘ç¹çš„åœ¨å †æ ˆä¸Šåˆ‡æ¢å­˜å‚¨ä½ç½®ï¼Œå†…éƒ¨å¼•æ“æ˜¯ä¸æ˜¯ä¹Ÿä¼šæœ‰ä»€ä¹ˆä¼˜åŒ–æ‰‹æ®µï¼Œæˆ–è€…å¹²è„†å…¨éƒ¨éƒ½ä¸¢å †ä¸Šï¼Ÿåªæœ‰ const å£°æ˜çš„åŸå§‹ç±»å‹æ‰ä¸€å®šå­˜åœ¨æ ˆä¸Šï¼Ÿå½“ç„¶è¿™åªæ˜¯ç¬”è€…çš„ä¸€ä¸ªæ¨æµ‹ï¼Œæš‚æ—¶æ²¡æœ‰æ·±ç©¶ï¼Œè¯»è€…å¯ä»¥å¿½ç•¥è¿™æ®µçæƒ³</p></blockquote> <p><img src="./è¿›é˜¶_files/20210406200826.png" alt="" class="medium-zoom-image"></p> <p>å› æ­¤ç¬”è€…å¯¹äºåŸå§‹ç±»å‹å­˜å‚¨ä½ç½®çš„ç†è§£ä¸ºï¼šå±€éƒ¨å˜é‡æ‰æ˜¯è¢«å­˜å‚¨åœ¨æ ˆä¸Šï¼Œå…¨å±€å˜é‡å­˜åœ¨é™æ€åŒºåŸŸä¸Šï¼Œå…¶å®ƒéƒ½å­˜å‚¨åœ¨å †ä¸Šã€‚</p> <p>å½“ç„¶è¿™ä¸ªç†è§£æ˜¯å»ºç«‹çš„ Chrome çš„è¡¨ç°ä¹‹ä¸Šçš„ï¼Œåœ¨ä¸åŒçš„æµè§ˆå™¨ä¸Šå› ä¸ºå¼•æ“çš„ä¸åŒï¼Œå¯èƒ½å­˜å‚¨çš„æ–¹å¼è¿˜æ˜¯æœ‰æ‰€å˜åŒ–çš„ã€‚</p> <p><strong>å¸¸è§è€ƒç‚¹</strong></p> <ul><li>é—­åŒ…èƒ½è€ƒçš„å¾ˆå¤šï¼Œæ¦‚å¿µå’Œç¬”è¯•é¢˜éƒ½ä¼šè€ƒã€‚</li> <li>æ¦‚å¿µé¢˜å°±æ˜¯è€ƒè€ƒé—­åŒ…æ˜¯ä»€ä¹ˆäº†ã€‚</li> <li>ç¬”è¯•é¢˜çš„è¯åŸºæœ¬éƒ½ä¼šç»“åˆä¸Šå¼‚æ­¥ï¼Œæ¯”å¦‚æœ€å¸¸è§çš„ï¼š</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">6</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>è¿™é“é¢˜ä¼šé—®è¾“å‡ºä»€ä¹ˆï¼Œæœ‰å“ªå‡ ç§æ–¹å¼å¯ä»¥å¾—åˆ°æƒ³è¦çš„ç­”æ¡ˆï¼Ÿ</p> <h3 id="_6-æ‰§è¡Œä¸Šä¸‹æ–‡"><a href="http://interview.poetries.top/docs/simply.html#_6-%E6%89%A7%E8%A1%8C%E4%B8%8A%E4%B8%8B%E6%96%87" class="header-anchor">#</a> 6 æ‰§è¡Œä¸Šä¸‹æ–‡</h3> <blockquote><p>å½“æ‰§è¡Œ JS ä»£ç æ—¶ï¼Œä¼šäº§ç”Ÿä¸‰ç§æ‰§è¡Œä¸Šä¸‹æ–‡</p></blockquote> <ul><li>å…¨å±€æ‰§è¡Œä¸Šä¸‹æ–‡</li> <li>å‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡</li> <li><code>eval</code> æ‰§è¡Œä¸Šä¸‹æ–‡</li></ul> <blockquote><p>æ¯ä¸ªæ‰§è¡Œä¸Šä¸‹æ–‡ä¸­éƒ½æœ‰ä¸‰ä¸ªé‡è¦çš„å±æ€§</p></blockquote> <ul><li>å˜é‡å¯¹è±¡ï¼ˆ<code>VO</code>ï¼‰ï¼ŒåŒ…å«å˜é‡ã€å‡½æ•°å£°æ˜å’Œå‡½æ•°çš„å½¢å‚ï¼Œè¯¥å±æ€§åªèƒ½åœ¨å…¨å±€ä¸Šä¸‹æ–‡ä¸­è®¿é—®</li> <li>ä½œç”¨åŸŸé“¾ï¼ˆ<code>JS</code> é‡‡ç”¨è¯æ³•ä½œç”¨åŸŸï¼Œä¹Ÿå°±æ˜¯è¯´å˜é‡çš„ä½œç”¨åŸŸæ˜¯åœ¨å®šä¹‰æ—¶å°±å†³å®šäº†ï¼‰</li> <li><code>this</code></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">10</span>
<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token parameter">i</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token number">20</span>
<span class="token punctuation">}</span>
<span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><blockquote><p>å¯¹äºä¸Šè¿°ä»£ç ï¼Œæ‰§è¡Œæ ˆä¸­æœ‰ä¸¤ä¸ªä¸Šä¸‹æ–‡ï¼šå…¨å±€ä¸Šä¸‹æ–‡å’Œå‡½æ•° foo ä¸Šä¸‹æ–‡ã€‚</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code>stack <span class="token operator">=</span> <span class="token punctuation">[</span>
    globalContext<span class="token punctuation">,</span>
    fooContext
<span class="token punctuation">]</span>
</code></pre></div><blockquote><p>å¯¹äºå…¨å±€ä¸Šä¸‹æ–‡æ¥è¯´ï¼Œ<code>VO</code>å¤§æ¦‚æ˜¯è¿™æ ·çš„</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code>globalContext<span class="token punctuation">.</span><span class="token constant">VO</span> <span class="token operator">===</span> globe
globalContext<span class="token punctuation">.</span><span class="token constant">VO</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
    a<span class="token operator">:</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span>
	foo<span class="token operator">:</span> <span class="token operator">&lt;</span>Function<span class="token operator">&gt;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>å¯¹äºå‡½æ•° <code>foo</code> æ¥è¯´ï¼Œ<code>VO</code> ä¸èƒ½è®¿é—®ï¼Œåªèƒ½è®¿é—®åˆ°æ´»åŠ¨å¯¹è±¡ï¼ˆ<code>AO</code>ï¼‰</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code>fooContext<span class="token punctuation">.</span><span class="token constant">VO</span> <span class="token operator">===</span> foo<span class="token punctuation">.</span><span class="token constant">AO</span>
fooContext<span class="token punctuation">.</span><span class="token constant">AO</span> <span class="token punctuation">{</span>
    i<span class="token operator">:</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span>
	b<span class="token operator">:</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span>
    arguments<span class="token operator">:</span> <span class="token operator">&lt;</span><span class="token operator">&gt;</span>
<span class="token punctuation">}</span>
<span class="token comment">// arguments æ˜¯å‡½æ•°ç‹¬æœ‰çš„å¯¹è±¡(ç®­å¤´å‡½æ•°æ²¡æœ‰)</span>
<span class="token comment">// è¯¥å¯¹è±¡æ˜¯ä¸€ä¸ªä¼ªæ•°ç»„ï¼Œæœ‰ `length` å±æ€§ä¸”å¯ä»¥é€šè¿‡ä¸‹æ ‡è®¿é—®å…ƒç´ </span>
<span class="token comment">// è¯¥å¯¹è±¡ä¸­çš„ `callee` å±æ€§ä»£è¡¨å‡½æ•°æœ¬èº«</span>
<span class="token comment">// `caller` å±æ€§ä»£è¡¨å‡½æ•°çš„è°ƒç”¨è€…</span>
</code></pre></div><blockquote><p>å¯¹äºä½œç”¨åŸŸé“¾ï¼Œå¯ä»¥æŠŠå®ƒç†è§£æˆåŒ…å«è‡ªèº«å˜é‡å¯¹è±¡å’Œä¸Šçº§å˜é‡å¯¹è±¡çš„åˆ—è¡¨ï¼Œé€šè¿‡ <code>[[Scope]]</code>å±æ€§æŸ¥æ‰¾ä¸Šçº§å˜é‡</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code>fooContext<span class="token punctuation">.</span><span class="token punctuation">[</span><span class="token punctuation">[</span>Scope<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
    globalContext<span class="token punctuation">.</span><span class="token constant">VO</span>
<span class="token punctuation">]</span>
fooContext<span class="token punctuation">.</span>Scope <span class="token operator">=</span> fooContext<span class="token punctuation">.</span><span class="token punctuation">[</span><span class="token punctuation">[</span>Scope<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">+</span> fooContext<span class="token punctuation">.</span><span class="token constant">VO</span>
fooContext<span class="token punctuation">.</span>Scope <span class="token operator">=</span> <span class="token punctuation">[</span>
    fooContext<span class="token punctuation">.</span><span class="token constant">VO</span><span class="token punctuation">,</span>
    globalContext<span class="token punctuation">.</span><span class="token constant">VO</span>
<span class="token punctuation">]</span>
</code></pre></div><blockquote><p>æ¥ä¸‹æ¥è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªè€ç”Ÿå¸¸è°ˆçš„ä¾‹å­ï¼Œ<code>var</code></p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// call b</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token comment">// undefined</span>

<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token string">'Hello world'</span>

<span class="token keyword">function</span> <span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'call b'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>æƒ³å¿…ä»¥ä¸Šçš„è¾“å‡ºå¤§å®¶è‚¯å®šéƒ½å·²ç»æ˜ç™½äº†ï¼Œè¿™æ˜¯å› ä¸ºå‡½æ•°å’Œå˜é‡æå‡çš„åŸå› ã€‚é€šå¸¸æå‡çš„è§£é‡Šæ˜¯è¯´å°†å£°æ˜çš„ä»£ç ç§»åŠ¨åˆ°äº†é¡¶éƒ¨ï¼Œè¿™å…¶å®æ²¡æœ‰ä»€ä¹ˆé”™è¯¯ï¼Œä¾¿äºå¤§å®¶ç†è§£ã€‚ä½†æ˜¯æ›´å‡†ç¡®çš„è§£é‡Šåº”è¯¥æ˜¯ï¼šåœ¨ç”Ÿæˆæ‰§è¡Œä¸Šä¸‹æ–‡æ—¶ï¼Œä¼šæœ‰ä¸¤ä¸ªé˜¶æ®µã€‚ç¬¬ä¸€ä¸ªé˜¶æ®µæ˜¯åˆ›å»ºçš„é˜¶æ®µï¼ˆå…·ä½“æ­¥éª¤æ˜¯åˆ›å»º <code>VO</code>ï¼‰ï¼Œ<code>JS</code> è§£é‡Šå™¨ä¼šæ‰¾å‡ºéœ€è¦æå‡çš„å˜é‡å’Œå‡½æ•°ï¼Œå¹¶ä¸”ç»™ä»–ä»¬æå‰åœ¨å†…å­˜ä¸­å¼€è¾Ÿå¥½ç©ºé—´ï¼Œå‡½æ•°çš„è¯ä¼šå°†æ•´ä¸ªå‡½æ•°å­˜å…¥å†…å­˜ä¸­ï¼Œå˜é‡åªå£°æ˜å¹¶ä¸”èµ‹å€¼ä¸º <code>undefined</code>ï¼Œæ‰€ä»¥åœ¨ç¬¬äºŒä¸ªé˜¶æ®µï¼Œä¹Ÿå°±æ˜¯ä»£ç æ‰§è¡Œé˜¶æ®µï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥æå‰ä½¿ç”¨ã€‚</p></blockquote> <ul><li>åœ¨æå‡çš„è¿‡ç¨‹ä¸­ï¼Œç›¸åŒçš„å‡½æ•°ä¼šè¦†ç›–ä¸Šä¸€ä¸ªå‡½æ•°ï¼Œå¹¶ä¸”å‡½æ•°ä¼˜å…ˆäºå˜é‡æå‡</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// call b second</span>

<span class="token keyword">function</span> <span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'call b fist'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'call b second'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token string">'Hello world'</span>
</code></pre></div><blockquote><p><code>var</code>ä¼šäº§ç”Ÿå¾ˆå¤šé”™è¯¯ï¼Œæ‰€ä»¥åœ¨ <code>ES6</code>ä¸­å¼•å…¥äº† <code>let</code>ã€‚<code>let</code>ä¸èƒ½åœ¨å£°æ˜å‰ä½¿ç”¨ï¼Œä½†æ˜¯è¿™å¹¶ä¸æ˜¯å¸¸è¯´çš„ <code>let</code> ä¸ä¼šæå‡ï¼Œ<code>let</code> æå‡äº†å£°æ˜ä½†æ²¡æœ‰èµ‹å€¼ï¼Œå› ä¸ºä¸´æ—¶æ­»åŒºå¯¼è‡´äº†å¹¶ä¸èƒ½åœ¨å£°æ˜å‰ä½¿ç”¨ã€‚</p></blockquote> <ul><li>å¯¹äºéåŒ¿åçš„ç«‹å³æ‰§è¡Œå‡½æ•°éœ€è¦æ³¨æ„ä»¥ä¸‹ä¸€ç‚¹</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> foo <span class="token operator">=</span> <span class="token number">1</span>
<span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    foo <span class="token operator">=</span> <span class="token number">10</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>foo<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// -&gt; Æ’ foo() { foo = 10 ; console.log(foo) }</span>
</code></pre></div><blockquote><p>å› ä¸ºå½“ <code>JS</code> è§£é‡Šå™¨åœ¨é‡åˆ°éåŒ¿åçš„ç«‹å³æ‰§è¡Œå‡½æ•°æ—¶ï¼Œä¼šåˆ›å»ºä¸€ä¸ªè¾…åŠ©çš„ç‰¹å®šå¯¹è±¡ï¼Œç„¶åå°†å‡½æ•°åç§°ä½œä¸ºè¿™ä¸ªå¯¹è±¡çš„å±æ€§ï¼Œå› æ­¤å‡½æ•°å†…éƒ¨æ‰å¯ä»¥è®¿é—®åˆ° <code>foo</code>ï¼Œä½†æ˜¯è¿™ä¸ªå€¼åˆæ˜¯åªè¯»çš„ï¼Œæ‰€ä»¥å¯¹å®ƒçš„èµ‹å€¼å¹¶ä¸ç”Ÿæ•ˆï¼Œæ‰€ä»¥æ‰“å°çš„ç»“æœè¿˜æ˜¯è¿™ä¸ªå‡½æ•°ï¼Œå¹¶ä¸”å¤–éƒ¨çš„å€¼ä¹Ÿæ²¡æœ‰å‘ç”Ÿæ›´æ”¹ã€‚</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code>specialObject <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

Scope <span class="token operator">=</span> specialObject <span class="token operator">+</span> Scope<span class="token punctuation">;</span>

foo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FunctionExpression</span><span class="token punctuation">;</span>
foo<span class="token punctuation">.</span><span class="token punctuation">[</span><span class="token punctuation">[</span>Scope<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> Scope<span class="token punctuation">;</span>
specialObject<span class="token punctuation">.</span>foo <span class="token operator">=</span> foo<span class="token punctuation">;</span> <span class="token comment">// {DontDelete}, {ReadOnly}</span>

<span class="token keyword">delete</span> Scope<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// remove specialObject from the front of scope chain</span>
</code></pre></div><p><strong>æ€»ç»“</strong></p> <blockquote><p>æ‰§è¡Œä¸Šä¸‹æ–‡å¯ä»¥ç®€å•ç†è§£ä¸ºä¸€ä¸ªå¯¹è±¡:</p></blockquote> <p><strong>å®ƒåŒ…å«ä¸‰ä¸ªéƒ¨åˆ†:</strong></p> <ul><li>å˜é‡å¯¹è±¡(<code>VO</code>)</li> <li>ä½œç”¨åŸŸé“¾(è¯æ³•ä½œç”¨åŸŸ)</li> <li><code>this</code>æŒ‡å‘</li></ul> <p><strong>å®ƒçš„ç±»å‹:</strong></p> <ul><li>å…¨å±€æ‰§è¡Œä¸Šä¸‹æ–‡</li> <li>å‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡</li> <li><code>eval</code>æ‰§è¡Œä¸Šä¸‹æ–‡</li></ul> <p><strong>ä»£ç æ‰§è¡Œè¿‡ç¨‹:</strong></p> <ul><li>åˆ›å»º å…¨å±€ä¸Šä¸‹æ–‡ (<code>global EC</code>)</li> <li>å…¨å±€æ‰§è¡Œä¸Šä¸‹æ–‡ (<code>caller</code>) é€è¡Œ è‡ªä¸Šè€Œä¸‹ æ‰§è¡Œã€‚é‡åˆ°å‡½æ•°æ—¶ï¼Œå‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡ (<code>callee</code>) è¢«<code>push</code>åˆ°æ‰§è¡Œæ ˆé¡¶å±‚</li> <li>å‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡è¢«æ¿€æ´»ï¼Œæˆä¸º <code>active EC</code>, å¼€å§‹æ‰§è¡Œå‡½æ•°ä¸­çš„ä»£ç ï¼Œ<code>caller</code> è¢«æŒ‚èµ·</li> <li>å‡½æ•°æ‰§è¡Œå®Œåï¼Œ<code>callee</code> è¢«<code>pop</code>ç§»é™¤å‡ºæ‰§è¡Œæ ˆï¼Œæ§åˆ¶æƒäº¤è¿˜å…¨å±€ä¸Šä¸‹æ–‡ (<code>caller</code>)ï¼Œç»§ç»­æ‰§è¡Œ</li></ul> <h3 id="_7-ä½œç”¨åŸŸ"><a href="http://interview.poetries.top/docs/simply.html#_7-%E4%BD%9C%E7%94%A8%E5%9F%9F" class="header-anchor">#</a> 7 ä½œç”¨åŸŸ</h3> <ul><li>ä½œç”¨åŸŸï¼š ä½œç”¨åŸŸæ˜¯å®šä¹‰å˜é‡çš„åŒºåŸŸï¼Œå®ƒæœ‰ä¸€å¥—è®¿é—®å˜é‡çš„è§„åˆ™ï¼Œè¿™å¥—è§„åˆ™æ¥ç®¡ç†æµè§ˆå™¨å¼•æ“å¦‚ä½•åœ¨å½“å‰ä½œç”¨åŸŸä»¥åŠåµŒå¥—çš„ä½œç”¨åŸŸä¸­æ ¹æ®å˜é‡ï¼ˆæ ‡è¯†ç¬¦ï¼‰è¿›è¡Œå˜é‡æŸ¥æ‰¾</li> <li>ä½œç”¨åŸŸé“¾ï¼š ä½œç”¨åŸŸé“¾çš„ä½œç”¨æ˜¯ä¿è¯å¯¹æ‰§è¡Œç¯å¢ƒæœ‰æƒè®¿é—®çš„æ‰€æœ‰å˜é‡å’Œå‡½æ•°çš„æœ‰åºè®¿é—®ï¼Œé€šè¿‡ä½œç”¨åŸŸé“¾ï¼Œæˆ‘ä»¬å¯ä»¥è®¿é—®åˆ°å¤–å±‚ç¯å¢ƒçš„å˜é‡å’Œ å‡½æ•°ã€‚</li></ul> <blockquote><p>ä½œç”¨åŸŸé“¾çš„æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªæŒ‡å‘å˜é‡å¯¹è±¡çš„æŒ‡é’ˆåˆ—è¡¨ã€‚å˜é‡å¯¹è±¡æ˜¯ä¸€ä¸ªåŒ…å«äº†æ‰§è¡Œç¯å¢ƒä¸­æ‰€æœ‰å˜é‡å’Œå‡½æ•°çš„å¯¹è±¡ã€‚ä½œç”¨åŸŸé“¾çš„å‰ ç«¯å§‹ç»ˆéƒ½æ˜¯å½“å‰æ‰§è¡Œä¸Šä¸‹æ–‡çš„å˜é‡å¯¹è±¡ã€‚å…¨å±€æ‰§è¡Œä¸Šä¸‹æ–‡çš„å˜é‡å¯¹è±¡ï¼ˆä¹Ÿå°±æ˜¯å…¨å±€å¯¹è±¡ï¼‰å§‹ç»ˆæ˜¯ä½œç”¨åŸŸé“¾çš„æœ€åä¸€ä¸ªå¯¹è±¡ã€‚</p></blockquote> <ul><li>å½“æˆ‘ä»¬æŸ¥æ‰¾ä¸€ä¸ªå˜é‡æ—¶ï¼Œå¦‚æœå½“å‰æ‰§è¡Œç¯å¢ƒä¸­æ²¡æœ‰æ‰¾åˆ°ï¼Œæˆ‘ä»¬å¯ä»¥æ²¿ç€ä½œç”¨åŸŸé“¾å‘åæŸ¥æ‰¾</li> <li>ä½œç”¨åŸŸé“¾çš„åˆ›å»ºè¿‡ç¨‹è·Ÿæ‰§è¡Œä¸Šä¸‹æ–‡çš„å»ºç«‹æœ‰å…³....</li></ul> <blockquote><p>ä½œç”¨åŸŸå¯ä»¥ç†è§£ä¸ºå˜é‡çš„å¯è®¿é—®æ€§ï¼Œæ€»å…±åˆ†ä¸ºä¸‰ç§ç±»å‹ï¼Œåˆ†åˆ«ä¸ºï¼š</p></blockquote> <ul><li>å…¨å±€ä½œç”¨åŸŸ</li> <li>å‡½æ•°ä½œç”¨åŸŸ</li> <li>å—çº§ä½œç”¨åŸŸï¼ŒES6 ä¸­çš„ <code>let</code>ã€<code>const</code> å°±å¯ä»¥äº§ç”Ÿè¯¥ä½œç”¨åŸŸ</li></ul> <p>å…¶å®çœ‹å®Œå‰é¢çš„é—­åŒ…ã€<code>this</code> è¿™éƒ¨åˆ†å†…éƒ¨çš„è¯ï¼Œåº”è¯¥åŸºæœ¬èƒ½äº†è§£ä½œç”¨åŸŸçš„ä¸€äº›åº”ç”¨ã€‚</p> <p>ä¸€æ—¦æˆ‘ä»¬å°†è¿™äº›ä½œç”¨åŸŸåµŒå¥—èµ·æ¥ï¼Œå°±å˜æˆäº†å¦å¤–ä¸€ä¸ªé‡è¦çš„çŸ¥è¯†ç‚¹ã€Œä½œç”¨åŸŸé“¾ã€ï¼Œä¹Ÿå°±æ˜¯ JS åˆ°åº•æ˜¯å¦‚ä½•è®¿é—®éœ€è¦çš„å˜é‡æˆ–è€…å‡½æ•°çš„ã€‚</p> <ul><li>é¦–å…ˆä½œç”¨åŸŸé“¾æ˜¯åœ¨å®šä¹‰æ—¶å°±è¢«ç¡®å®šä¸‹æ¥çš„ï¼Œå’Œç®­å¤´å‡½æ•°é‡Œçš„ this ä¸€æ ·ï¼Œåç»­ä¸ä¼šæ”¹å˜ï¼ŒJS ä¼šä¸€å±‚å±‚å¾€ä¸Šå¯»æ‰¾éœ€è¦çš„å†…å®¹ã€‚</li> <li>å…¶å®ä½œç”¨åŸŸé“¾è¿™ä¸ªä¸œè¥¿æˆ‘ä»¬åœ¨é—­åŒ…å°ç»“ä¸­å·²ç»çœ‹åˆ°è¿‡å®ƒçš„å®ä½“äº†ï¼š<code>[[Scopes]]</code></li></ul> <p><img src="./è¿›é˜¶_files/20210406201055.png" alt="" class="medium-zoom-image"></p> <p>å›¾ä¸­çš„ <code>[[Scopes]]</code> æ˜¯ä¸ªæ•°ç»„ï¼Œä½œç”¨åŸŸçš„ä¸€å±‚å±‚å¾€ä¸Šå¯»æ‰¾å°±ç­‰åŒäºéå† <code>[[Scopes]]</code>ã€‚</p> <p><strong>å¸¸è§è€ƒç‚¹</strong></p> <ul><li>ä»€ä¹ˆæ˜¯ä½œç”¨åŸŸ</li> <li>ä»€ä¹ˆæ˜¯ä½œç”¨åŸŸé“¾</li></ul> <h3 id="_8-newçš„è¿‡ç¨‹"><a href="http://interview.poetries.top/docs/simply.html#_8-new%E7%9A%84%E8%BF%87%E7%A8%8B" class="header-anchor">#</a> 8 Newçš„è¿‡ç¨‹</h3> <blockquote><p><code>new</code> æ“ä½œç¬¦å¯ä»¥å¸®åŠ©æˆ‘ä»¬æ„å»ºå‡ºä¸€ä¸ªå®ä¾‹ï¼Œå¹¶ä¸”ç»‘å®šä¸Š thisï¼Œå†…éƒ¨æ‰§è¡Œæ­¥éª¤å¯å¤§æ¦‚åˆ†ä¸ºä»¥ä¸‹å‡ æ­¥ï¼š</p></blockquote> <ul><li>æ–°ç”Ÿæˆäº†ä¸€ä¸ªå¯¹è±¡</li> <li>å¯¹è±¡è¿æ¥åˆ°æ„é€ å‡½æ•°åŸå‹ä¸Šï¼Œå¹¶ç»‘å®š <code>this</code></li> <li>æ‰§è¡Œæ„é€ å‡½æ•°ä»£ç </li> <li>è¿”å›æ–°å¯¹è±¡</li> <li>åœ¨ç¬¬å››æ­¥è¿”å›æ–°å¯¹è±¡è¿™è¾¹æœ‰ä¸€ä¸ªæƒ…å†µä¼šä¾‹å¤–ï¼š</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Test</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token comment">// Test { name: 'yck' }</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span> age<span class="token operator">:</span> <span class="token number">26</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> t <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Test</span><span class="token punctuation">(</span><span class="token string">'kkk'</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span> <span class="token comment">// { age: 26 }</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token comment">// 'undefined'</span>
</code></pre></div><blockquote><p>å½“åœ¨æ„é€ å‡½æ•°ä¸­è¿”å›ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œå†…éƒ¨åˆ›å»ºå‡ºæ¥çš„æ–°å¯¹è±¡å°±è¢«æˆ‘ä»¬è¿”å›çš„å¯¹è±¡æ‰€è¦†ç›–ï¼Œæ‰€ä»¥ä¸€èˆ¬æ¥è¯´æ„å»ºå‡½æ•°å°±åˆ«è¿”å›å¯¹è±¡äº†ï¼ˆè¿”å›åŸå§‹ç±»å‹ä¸å½±å“ï¼‰ã€‚</p></blockquote> <p><strong>å¸¸è§è€ƒç‚¹</strong></p> <ul><li><code>new</code> åšäº†é‚£äº›äº‹ï¼Ÿ</li> <li><code>new</code> è¿”å›ä¸åŒçš„ç±»å‹æ—¶ä¼šæœ‰ä»€ä¹ˆè¡¨ç°ï¼Ÿ</li> <li>æ‰‹å†™ new çš„å®ç°è¿‡ç¨‹</li></ul> <p>æˆ‘ä»¬ä¹Ÿå¯ä»¥è¯•ç€æ¥è‡ªå·±å®ç°ä¸€ä¸ª new</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">myNew</span><span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span> <span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> instance <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>fn<span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> res <span class="token operator">=</span> <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>instance<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æ”¹å˜thisæŒ‡å‘</span>

    <span class="token comment">// ç¡®ä¿è¿”å›çš„æ˜¯ä¸€ä¸ªå¯¹è±¡(ä¸‡ä¸€fnä¸æ˜¯æ„é€ å‡½æ•°)</span>
    <span class="token keyword">return</span> <span class="token keyword">typeof</span> res <span class="token operator">===</span> <span class="token string">'object'</span> <span class="token operator">?</span> res<span class="token operator">:</span> instance<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_9-åŸå‹"><a href="http://interview.poetries.top/docs/simply.html#_9-%E5%8E%9F%E5%9E%8B" class="header-anchor">#</a> 9 åŸå‹</h3> <p><strong><code>__proto__</code>å’Œprototypeå…³ç³»</strong>ï¼š<code>__proto__</code>å’Œ<code>constructor</code>æ˜¯<strong>å¯¹è±¡</strong>ç‹¬æœ‰çš„ã€‚2ï¸âƒ£<code>prototype</code>å±æ€§æ˜¯<strong>å‡½æ•°</strong>ç‹¬æœ‰çš„</p> <blockquote><p>åœ¨ js ä¸­æˆ‘ä»¬æ˜¯ä½¿ç”¨æ„é€ å‡½æ•°æ¥æ–°å»ºä¸€ä¸ªå¯¹è±¡çš„ï¼Œæ¯ä¸€ä¸ªæ„é€ å‡½æ•°çš„å†…éƒ¨éƒ½æœ‰ä¸€ä¸ª prototype å±æ€§å€¼ï¼Œè¿™ä¸ªå±æ€§å€¼æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡åŒ…å«äº†å¯ä»¥ç”±è¯¥æ„é€ å‡½æ•°çš„æ‰€æœ‰å®ä¾‹å…±äº«çš„å±æ€§å’Œæ–¹æ³•ã€‚å½“æˆ‘ä»¬ä½¿ç”¨æ„é€ å‡½æ•°æ–°å»ºä¸€ä¸ªå¯¹è±¡åï¼Œåœ¨è¿™ä¸ªå¯¹è±¡çš„å†…éƒ¨å°†åŒ…å«ä¸€ä¸ªæŒ‡é’ˆï¼Œè¿™ä¸ªæŒ‡é’ˆæŒ‡å‘æ„é€ å‡½æ•°çš„ prototype å±æ€§å¯¹åº”çš„å€¼ï¼Œåœ¨ ES5 ä¸­è¿™ä¸ªæŒ‡é’ˆè¢«ç§°ä¸ºå¯¹è±¡çš„åŸå‹ã€‚ä¸€èˆ¬æ¥è¯´æˆ‘ä»¬æ˜¯ä¸åº”è¯¥èƒ½å¤Ÿè·å–åˆ°è¿™ä¸ªå€¼çš„ï¼Œä½†æ˜¯ç°åœ¨æµè§ˆå™¨ä¸­éƒ½å®ç°äº† proto å±æ€§æ¥è®©æˆ‘ä»¬è®¿é—®è¿™ä¸ªå±æ€§ï¼Œä½†æ˜¯æˆ‘ä»¬æœ€å¥½ä¸è¦ä½¿ç”¨è¿™ä¸ªå±æ€§ï¼Œå› ä¸ºå®ƒä¸æ˜¯è§„èŒƒä¸­è§„å®šçš„ã€‚ES5 ä¸­æ–°å¢äº†ä¸€ä¸ª <code>Object.getPrototypeOf()</code> æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ä¸ªæ–¹æ³•æ¥è·å–å¯¹è±¡çš„åŸå‹ã€‚</p></blockquote> <p>å½“æˆ‘ä»¬è®¿é—®ä¸€ä¸ªå¯¹è±¡çš„å±æ€§æ—¶ï¼Œå¦‚æœè¿™ä¸ªå¯¹è±¡å†…éƒ¨ä¸å­˜åœ¨è¿™ä¸ªå±æ€§ï¼Œé‚£ä¹ˆå®ƒå°±ä¼šå»å®ƒçš„åŸå‹å¯¹è±¡é‡Œæ‰¾è¿™ä¸ªå±æ€§ï¼Œè¿™ä¸ªåŸå‹å¯¹è±¡åˆä¼šæœ‰è‡ªå·±çš„åŸå‹ï¼Œäºæ˜¯å°±è¿™æ ·ä¸€ç›´æ‰¾ä¸‹å»ï¼Œä¹Ÿå°±æ˜¯åŸå‹é“¾çš„æ¦‚å¿µã€‚åŸå‹é“¾çš„å°½å¤´ä¸€èˆ¬æ¥è¯´éƒ½æ˜¯ <code>Object.prototype</code> æ‰€ä»¥è¿™å°±æ˜¯æˆ‘ä»¬æ–°å»ºçš„å¯¹è±¡ä¸ºä»€ä¹ˆèƒ½å¤Ÿä½¿ç”¨ <code>toString()</code> ç­‰æ–¹æ³•çš„åŸå› ã€‚</p> <blockquote><p>ç‰¹ç‚¹ï¼šJavaScript å¯¹è±¡æ˜¯é€šè¿‡å¼•ç”¨æ¥ä¼ é€’çš„ï¼Œæˆ‘ä»¬åˆ›å»ºçš„æ¯ä¸ªæ–°å¯¹è±¡å®ä½“ä¸­å¹¶æ²¡æœ‰ä¸€ä»½å±äºè‡ªå·±çš„åŸå‹å‰¯æœ¬ã€‚å½“æˆ‘ä»¬ä¿®æ”¹åŸå‹æ—¶ï¼Œä¸ ä¹‹ç›¸å…³çš„å¯¹è±¡ä¹Ÿä¼šç»§æ‰¿è¿™ä¸€æ”¹å˜</p></blockquote> <ul><li>åŸå‹(<code>prototype</code>): ä¸€ä¸ªç®€å•çš„å¯¹è±¡ï¼Œç”¨äºå®ç°å¯¹è±¡çš„ å±æ€§ç»§æ‰¿ã€‚å¯ä»¥ç®€å•çš„ç†è§£æˆå¯¹è±¡çš„çˆ¹ã€‚åœ¨ <code>Firefox</code> å’Œ <code>Chrome</code> ä¸­ï¼Œæ¯ä¸ª<code>JavaScript</code>å¯¹è±¡ä¸­éƒ½åŒ…å«ä¸€ä¸ª<code>__proto__</code>(éæ ‡å‡†)çš„å±æ€§æŒ‡å‘å®ƒçˆ¹(è¯¥å¯¹è±¡çš„åŸå‹)ï¼Œå¯<code>obj.__proto__</code>è¿›è¡Œè®¿é—®ã€‚</li> <li>æ„é€ å‡½æ•°: å¯ä»¥é€šè¿‡<code>new</code>æ¥ æ–°å»ºä¸€ä¸ªå¯¹è±¡ çš„å‡½æ•°ã€‚</li> <li>å®ä¾‹: é€šè¿‡æ„é€ å‡½æ•°å’Œ<code>new</code>åˆ›å»ºå‡ºæ¥çš„å¯¹è±¡ï¼Œä¾¿æ˜¯å®ä¾‹ã€‚ å®ä¾‹é€šè¿‡<code>__proto__</code>æŒ‡å‘åŸå‹ï¼Œé€šè¿‡<code>constructor</code>æŒ‡å‘æ„é€ å‡½æ•°ã€‚</li></ul> <blockquote><p>ä»¥<code>Object</code>ä¸ºä¾‹ï¼Œæˆ‘ä»¬å¸¸ç”¨çš„<code>Object</code>ä¾¿æ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥é€šè¿‡å®ƒæ„å»ºå®ä¾‹ã€‚</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// å®ä¾‹</span>
<span class="token keyword">const</span> instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><blockquote><p>åˆ™æ­¤æ—¶ï¼Œ å®ä¾‹ä¸º<code>instance</code>, æ„é€ å‡½æ•°ä¸º<code>Object</code>ï¼Œæˆ‘ä»¬çŸ¥é“ï¼Œæ„é€ å‡½æ•°æ‹¥æœ‰ä¸€ä¸ª<code>prototype</code>çš„å±æ€§æŒ‡å‘åŸå‹ï¼Œå› æ­¤åŸå‹ä¸º:</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// åŸå‹</span>
<span class="token keyword">const</span> prototype <span class="token operator">=</span> <span class="token class-name">Object</span><span class="token punctuation">.</span>prototype
</code></pre></div><p><strong>è¿™é‡Œæˆ‘ä»¬å¯ä»¥æ¥çœ‹å‡ºä¸‰è€…çš„å…³ç³»:</strong></p> <ul><li><code>å®ä¾‹.__proto__ === åŸå‹</code></li> <li><code>åŸå‹.constructor === æ„é€ å‡½æ•°</code></li> <li><code>æ„é€ å‡½æ•°.prototype === åŸå‹</code></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// è¿™æ¡çº¿å…¶å®æ˜¯æ˜¯åŸºäºåŸå‹è¿›è¡Œè·å–çš„ï¼Œå¯ä»¥ç†è§£æˆä¸€æ¡åŸºäºåŸå‹çš„æ˜ å°„çº¿</span>
<span class="token comment">// ä¾‹å¦‚: </span>
<span class="token comment">// const o = new Object()</span>
<span class="token comment">// o.constructor === Object   --&gt; true</span>
<span class="token comment">// o.__proto__ = null;</span>
<span class="token comment">// o.constructor === Object   --&gt; false</span>
<span class="token class-name">å®ä¾‹</span><span class="token punctuation">.</span>constructor <span class="token operator">===</span> æ„é€ å‡½æ•°
</code></pre></div><p><img src="./è¿›é˜¶_files/112.png" alt="" class="medium-zoom-image"></p> <p><strong>åŸå‹é“¾</strong></p> <blockquote><p>åŸå‹é“¾æ˜¯ç”±åŸå‹å¯¹è±¡ç»„æˆï¼Œæ¯ä¸ªå¯¹è±¡éƒ½æœ‰ <code>__proto__</code> å±æ€§ï¼ŒæŒ‡å‘äº†åˆ›å»ºè¯¥å¯¹è±¡çš„æ„é€ å‡½æ•°çš„åŸå‹ï¼Œ<code>__proto__</code> å°†å¯¹è±¡è¿æ¥èµ·æ¥ç»„æˆäº†åŸå‹é“¾ã€‚æ˜¯ä¸€ä¸ªç”¨æ¥å®ç°ç»§æ‰¿å’Œå…±äº«å±æ€§çš„æœ‰é™çš„å¯¹è±¡é“¾</p></blockquote> <ul><li>å±æ€§æŸ¥æ‰¾æœºåˆ¶: å½“æŸ¥æ‰¾å¯¹è±¡çš„å±æ€§æ—¶ï¼Œå¦‚æœå®ä¾‹å¯¹è±¡è‡ªèº«ä¸å­˜åœ¨è¯¥å±æ€§ï¼Œåˆ™æ²¿ç€åŸå‹é“¾å¾€ä¸Šä¸€çº§æŸ¥æ‰¾ï¼Œæ‰¾åˆ°æ—¶åˆ™è¾“å‡ºï¼Œä¸å­˜åœ¨æ—¶ï¼Œåˆ™ç»§ç»­æ²¿ç€åŸå‹é“¾å¾€ä¸Šä¸€çº§æŸ¥æ‰¾ï¼Œç›´è‡³æœ€é¡¶çº§çš„åŸå‹å¯¹è±¡<code>Object.prototype</code>ï¼Œå¦‚è¿˜æ˜¯æ²¡æ‰¾åˆ°ï¼Œåˆ™è¾“å‡º<code>undefined</code>ï¼›</li> <li>å±æ€§ä¿®æ”¹æœºåˆ¶: åªä¼šä¿®æ”¹å®ä¾‹å¯¹è±¡æœ¬èº«çš„å±æ€§ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œåˆ™è¿›è¡Œæ·»åŠ è¯¥å±æ€§ï¼Œå¦‚æœéœ€è¦ä¿®æ”¹åŸå‹çš„å±æ€§æ—¶ï¼Œåˆ™å¯ä»¥ç”¨: <code>b.prototype.x = 2</code>ï¼›ä½†æ˜¯è¿™æ ·ä¼šé€ æˆæ‰€æœ‰ç»§æ‰¿äºè¯¥å¯¹è±¡çš„å®ä¾‹çš„å±æ€§å‘ç”Ÿæ”¹å˜ã€‚</li></ul> <p><strong>js è·å–åŸå‹çš„æ–¹æ³•</strong></p> <ul><li><code>p.proto</code></li> <li><code>p.constructor.prototype</code></li> <li><code>Object.getPrototypeOf(p)</code></li></ul> <p><strong>æ€»ç»“</strong></p> <p><img src="./è¿›é˜¶_files/105.png" alt="" class="medium-zoom-image"></p> <ul><li>æ¯ä¸ªå‡½æ•°éƒ½æœ‰ <code>prototype</code> å±æ€§ï¼Œé™¤äº† <code>Function.prototype.bind()</code>ï¼Œè¯¥å±æ€§æŒ‡å‘åŸå‹ã€‚</li> <li>æ¯ä¸ªå¯¹è±¡éƒ½æœ‰ <code>__proto__</code> å±æ€§ï¼ŒæŒ‡å‘äº†åˆ›å»ºè¯¥å¯¹è±¡çš„æ„é€ å‡½æ•°çš„åŸå‹ã€‚å…¶å®è¿™ä¸ªå±æ€§æŒ‡å‘äº† <code>[[prototype]]</code>ï¼Œä½†æ˜¯ <code>[[prototype]]</code>æ˜¯å†…éƒ¨å±æ€§ï¼Œæˆ‘ä»¬å¹¶ä¸èƒ½è®¿é—®åˆ°ï¼Œæ‰€ä»¥ä½¿ç”¨ <code>_proto_</code>æ¥è®¿é—®ã€‚</li> <li>å¯¹è±¡å¯ä»¥é€šè¿‡ <code>__proto__</code> æ¥å¯»æ‰¾ä¸å±äºè¯¥å¯¹è±¡çš„å±æ€§ï¼Œ<code>__proto__</code> å°†å¯¹è±¡è¿æ¥èµ·æ¥ç»„æˆäº†åŸå‹é“¾ã€‚</li></ul> <h3 id="_10-ç»§æ‰¿"><a href="http://interview.poetries.top/docs/simply.html#_10-%E7%BB%A7%E6%89%BF" class="header-anchor">#</a> 10 ç»§æ‰¿</h3> <blockquote><p>æ¶‰åŠé¢è¯•é¢˜ï¼šåŸå‹å¦‚ä½•å®ç°ç»§æ‰¿ï¼Ÿ<code>Class</code> å¦‚ä½•å®ç°ç»§æ‰¿ï¼Ÿ<code>Class</code> æœ¬è´¨æ˜¯ä»€ä¹ˆï¼Ÿ</p></blockquote> <p>é¦–å…ˆå…ˆæ¥è®²ä¸‹ <code>class</code>ï¼Œå…¶å®åœ¨ <code>JS</code>ä¸­å¹¶ä¸å­˜åœ¨ç±»ï¼Œ<code>class</code> åªæ˜¯è¯­æ³•ç³–ï¼Œæœ¬è´¨è¿˜æ˜¯å‡½æ•°</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
Person <span class="token keyword">instanceof</span> <span class="token class-name">Function</span> <span class="token comment">// true</span>
</code></pre></div><p><strong>ç»„åˆç»§æ‰¿</strong></p> <blockquote><p>ç»„åˆç»§æ‰¿æ˜¯æœ€å¸¸ç”¨çš„ç»§æ‰¿æ–¹å¼</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Parent</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>val <span class="token operator">=</span> value
<span class="token punctuation">}</span>
<span class="token class-name">Parent</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getValue</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>val<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">Child</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">Parent</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token class-name">Child</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Parent</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> child <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Child</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>

child<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 1</span>
child <span class="token keyword">instanceof</span> <span class="token class-name">Parent</span> <span class="token comment">// true</span>
</code></pre></div><ul><li>ä»¥ä¸Šç»§æ‰¿çš„æ–¹å¼æ ¸å¿ƒæ˜¯åœ¨å­ç±»çš„æ„é€ å‡½æ•°ä¸­é€šè¿‡ <code>Parent.call(this)</code> ç»§æ‰¿çˆ¶ç±»çš„å±æ€§ï¼Œç„¶åæ”¹å˜å­ç±»çš„åŸå‹ä¸º <code>new Parent()</code> æ¥ç»§æ‰¿çˆ¶ç±»çš„å‡½æ•°ã€‚</li> <li>è¿™ç§ç»§æ‰¿æ–¹å¼ä¼˜ç‚¹åœ¨äºæ„é€ å‡½æ•°å¯ä»¥ä¼ å‚ï¼Œä¸ä¼šä¸çˆ¶ç±»å¼•ç”¨å±æ€§å…±äº«ï¼Œå¯ä»¥å¤ç”¨çˆ¶ç±»çš„å‡½æ•°ï¼Œä½†æ˜¯ä¹Ÿå­˜åœ¨ä¸€ä¸ªç¼ºç‚¹å°±æ˜¯åœ¨ç»§æ‰¿çˆ¶ç±»å‡½æ•°çš„æ—¶å€™è°ƒç”¨äº†çˆ¶ç±»æ„é€ å‡½æ•°ï¼Œå¯¼è‡´å­ç±»çš„åŸå‹ä¸Šå¤šäº†ä¸éœ€è¦çš„çˆ¶ç±»å±æ€§ï¼Œå­˜åœ¨å†…å­˜ä¸Šçš„æµªè´¹</li></ul> <p><strong>å¯„ç”Ÿç»„åˆç»§æ‰¿</strong></p> <blockquote><p>è¿™ç§ç»§æ‰¿æ–¹å¼å¯¹ç»„åˆç»§æ‰¿è¿›è¡Œäº†ä¼˜åŒ–ï¼Œç»„åˆç»§æ‰¿ç¼ºç‚¹åœ¨äºç»§æ‰¿çˆ¶ç±»å‡½æ•°æ—¶è°ƒç”¨äº†æ„é€ å‡½æ•°ï¼Œæˆ‘ä»¬åªéœ€è¦ä¼˜åŒ–æ‰è¿™ç‚¹å°±è¡Œäº†</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Parent</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>val <span class="token operator">=</span> value
<span class="token punctuation">}</span>
<span class="token class-name">Parent</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getValue</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>val<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">Child</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">Parent</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token class-name">Child</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">Parent</span><span class="token punctuation">.</span>prototype<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  constructor<span class="token operator">:</span> <span class="token punctuation">{</span>
    value<span class="token operator">:</span> Child<span class="token punctuation">,</span>
    enumerable<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    writable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    configurable<span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> child <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Child</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>

child<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 1</span>
child <span class="token keyword">instanceof</span> <span class="token class-name">Parent</span> <span class="token comment">// true</span>
</code></pre></div><blockquote><p>ä»¥ä¸Šç»§æ‰¿å®ç°çš„æ ¸å¿ƒå°±æ˜¯å°†çˆ¶ç±»çš„åŸå‹èµ‹å€¼ç»™äº†å­ç±»ï¼Œå¹¶ä¸”å°†æ„é€ å‡½æ•°è®¾ç½®ä¸ºå­ç±»ï¼Œè¿™æ ·æ—¢è§£å†³äº†æ— ç”¨çš„çˆ¶ç±»å±æ€§é—®é¢˜ï¼Œè¿˜èƒ½æ­£ç¡®çš„æ‰¾åˆ°å­ç±»çš„æ„é€ å‡½æ•°ã€‚</p></blockquote> <p><strong>Class ç»§æ‰¿</strong></p> <blockquote><p>ä»¥ä¸Šä¸¤ç§ç»§æ‰¿æ–¹å¼éƒ½æ˜¯é€šè¿‡åŸå‹å»è§£å†³çš„ï¼Œåœ¨ ES6 ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ class å»å®ç°ç»§æ‰¿ï¼Œå¹¶ä¸”å®ç°èµ·æ¥å¾ˆç®€å•</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Parent</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>val <span class="token operator">=</span> value
  <span class="token punctuation">}</span>
  <span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>val<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">Child</span> <span class="token keyword">extends</span> <span class="token class-name">Parent</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>val <span class="token operator">=</span> value
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> child <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Child</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
child<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 1</span>
child <span class="token keyword">instanceof</span> <span class="token class-name">Parent</span> <span class="token comment">// true</span>
</code></pre></div><blockquote><p><code>class</code> å®ç°ç»§æ‰¿çš„æ ¸å¿ƒåœ¨äºä½¿ç”¨ <code>extends</code> è¡¨æ˜ç»§æ‰¿è‡ªå“ªä¸ªçˆ¶ç±»ï¼Œå¹¶ä¸”åœ¨å­ç±»æ„é€ å‡½æ•°ä¸­å¿…é¡»è°ƒç”¨ <code>super</code>ï¼Œå› ä¸ºè¿™æ®µä»£ç å¯ä»¥çœ‹æˆ <code>Parent.call(this, value)</code>ã€‚</p></blockquote> <p><strong>ES5 å’Œ 6 ç»§æ‰¿çš„åŒºåˆ«ï¼š</strong></p> <ul><li>ES6 ç»§æ‰¿çš„å­ç±»éœ€è¦è°ƒç”¨ <code>super()</code> æ‰èƒ½æ‹¿åˆ°å­ç±»ï¼ŒES5 çš„è¯æ˜¯é€šè¿‡ <code>apply</code> è¿™ç§ç»‘å®šçš„æ–¹å¼</li> <li>ç±»å£°æ˜ä¸ä¼šæå‡ï¼Œå’Œ let è¿™äº›ä¸€è‡´</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Super</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token class-name">Super</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getNumber</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token number">1</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">Sub</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token class-name">Sub</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">Super</span><span class="token punctuation">.</span>prototype<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  constructor<span class="token operator">:</span> <span class="token punctuation">{</span>
    value<span class="token operator">:</span> Sub<span class="token punctuation">,</span>
    enumerable<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    writable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    configurable<span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> s <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Sub</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span><span class="token function">getNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="_12-é¢å‘å¯¹è±¡"><a href="http://interview.poetries.top/docs/simply.html#_12-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1" class="header-anchor">#</a> 12 é¢å‘å¯¹è±¡</h3> <p><strong>ç¼–ç¨‹æ€æƒ³</strong></p> <ul><li>åŸºæœ¬æ€æƒ³æ˜¯ä½¿ç”¨å¯¹è±¡ï¼Œç±»ï¼Œç»§æ‰¿ï¼Œå°è£…ç­‰åŸºæœ¬æ¦‚å¿µæ¥è¿›è¡Œç¨‹åºè®¾è®¡</li> <li>ä¼˜ç‚¹
<ul><li>æ˜“ç»´æŠ¤
<ul><li>é‡‡ç”¨é¢å‘å¯¹è±¡æ€æƒ³è®¾è®¡çš„ç»“æ„ï¼Œå¯è¯»æ€§é«˜ï¼Œç”±äºç»§æ‰¿çš„å­˜åœ¨ï¼Œå³ä½¿æ”¹å˜éœ€æ±‚ï¼Œé‚£ä¹ˆç»´æŠ¤ä¹Ÿåªæ˜¯åœ¨å±€éƒ¨æ¨¡å—ï¼Œæ‰€ä»¥ç»´æŠ¤èµ·æ¥æ˜¯éå¸¸æ–¹ä¾¿å’Œè¾ƒä½æˆæœ¬çš„</li></ul></li> <li>æ˜“æ‰©å±•</li> <li>å¼€å‘å·¥ä½œçš„é‡ç”¨æ€§ã€ç»§æ‰¿æ€§é«˜ï¼Œé™ä½é‡å¤å·¥ä½œé‡ã€‚</li> <li>ç¼©çŸ­äº†å¼€å‘å‘¨æœŸ</li></ul></li></ul> <blockquote><p>ä¸€èˆ¬é¢å‘å¯¹è±¡åŒ…å«ï¼šç»§æ‰¿ï¼Œå°è£…ï¼Œå¤šæ€ï¼ŒæŠ½è±¡</p></blockquote> <p><strong>1. å¯¹è±¡å½¢å¼çš„ç»§æ‰¿</strong></p> <p>æµ…æ‹·è´</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> Person <span class="token operator">=</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">'allin'</span><span class="token punctuation">,</span>
    age<span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
    address<span class="token operator">:</span> <span class="token punctuation">{</span>
        home<span class="token operator">:</span> <span class="token string">'home'</span><span class="token punctuation">,</span>
        office<span class="token operator">:</span> <span class="token string">'office'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
    sclools<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'x'</span><span class="token punctuation">,</span><span class="token string">'z'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> programer <span class="token operator">=</span> <span class="token punctuation">{</span>
    language<span class="token operator">:</span> <span class="token string">'js'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">extend</span><span class="token punctuation">(</span><span class="token parameter">p<span class="token punctuation">,</span> c</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> c <span class="token operator">=</span> c <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span> <span class="token keyword">var</span> prop <span class="token keyword">in</span> p<span class="token punctuation">)</span><span class="token punctuation">{</span>
        c<span class="token punctuation">[</span>prop<span class="token punctuation">]</span> <span class="token operator">=</span> p<span class="token punctuation">[</span>prop<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token function">extend</span><span class="token punctuation">(</span>Person<span class="token punctuation">,</span> programer<span class="token punctuation">)</span><span class="token punctuation">;</span>
programer<span class="token punctuation">.</span>name<span class="token punctuation">;</span>  <span class="token comment">// allin</span>
programer<span class="token punctuation">.</span>address<span class="token punctuation">.</span>home<span class="token punctuation">;</span>  <span class="token comment">// home</span>
programer<span class="token punctuation">.</span>address<span class="token punctuation">.</span>home <span class="token operator">=</span> <span class="token string">'house'</span><span class="token punctuation">;</span>  <span class="token comment">//house</span>
Person<span class="token punctuation">.</span>address<span class="token punctuation">.</span>home<span class="token punctuation">;</span>  <span class="token comment">// house</span>
</code></pre></div><blockquote><p>ä»ä¸Šé¢çš„ç»“æœçœ‹å‡ºï¼Œæµ…æ‹·è´çš„ç¼ºé™·åœ¨äºä¿®æ”¹äº†å­å¯¹è±¡ä¸­å¼•ç”¨ç±»å‹çš„å€¼ï¼Œä¼šå½±å“åˆ°çˆ¶å¯¹è±¡ä¸­çš„å€¼ï¼Œå› ä¸ºåœ¨æµ…æ‹·è´ä¸­å¯¹å¼•ç”¨ç±»å‹çš„æ‹·è´åªæ˜¯æ‹·è´äº†åœ°å€ï¼ŒæŒ‡å‘äº†å†…å­˜ä¸­åŒä¸€ä¸ªå‰¯æœ¬</p></blockquote> <p>æ·±æ‹·è´</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">extendDeeply</span><span class="token punctuation">(</span><span class="token parameter">p<span class="token punctuation">,</span> c</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> c <span class="token operator">=</span> c <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> prop <span class="token keyword">in</span> p<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> p<span class="token punctuation">[</span>prop<span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string">"object"</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            c<span class="token punctuation">[</span>prop<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>p<span class="token punctuation">[</span>prop<span class="token punctuation">]</span><span class="token punctuation">.</span>constructor <span class="token operator">===</span> Array<span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
            <span class="token function">extendDeeply</span><span class="token punctuation">(</span>p<span class="token punctuation">[</span>prop<span class="token punctuation">]</span><span class="token punctuation">,</span> c<span class="token punctuation">[</span>prop<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
            c<span class="token punctuation">[</span>prop<span class="token punctuation">]</span> <span class="token operator">=</span> p<span class="token punctuation">[</span>prop<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>åˆ©ç”¨é€’å½’è¿›è¡Œæ·±æ‹·è´ï¼Œè¿™æ ·å­å¯¹è±¡çš„ä¿®æ”¹å°±ä¸ä¼šå½±å“åˆ°çˆ¶å¯¹è±¡</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">extendDeeply</span><span class="token punctuation">(</span>Person<span class="token punctuation">,</span> programer<span class="token punctuation">)</span><span class="token punctuation">;</span>
programer<span class="token punctuation">.</span>address<span class="token punctuation">.</span>home <span class="token operator">=</span> <span class="token string">'allin'</span><span class="token punctuation">;</span>
Person<span class="token punctuation">.</span>address<span class="token punctuation">.</span>home<span class="token punctuation">;</span> <span class="token comment">// home</span>
</code></pre></div><p><strong>åˆ©ç”¨callå’Œapplyç»§æ‰¿</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Parent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"abc"</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>address <span class="token operator">=</span> <span class="token punctuation">{</span>home<span class="token operator">:</span> <span class="token string">"home"</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">Child</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">Parent</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>language <span class="token operator">=</span> <span class="token string">"js"</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span>
</code></pre></div><p><strong>ES5ä¸­çš„Object.create()</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> p <span class="token operator">=</span> <span class="token punctuation">{</span> name <span class="token operator">:</span> <span class="token string">'allin'</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> obj <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token punctuation">;</span>
obj<span class="token punctuation">.</span>name<span class="token punctuation">;</span> <span class="token comment">// allin</span>
</code></pre></div><blockquote><p><code>Object.create()</code>ä½œä¸ºnewæ“ä½œç¬¦çš„æ›¿ä»£æ–¹æ¡ˆæ˜¯ES5ä¹‹åæ‰å‡ºæ¥çš„ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥è‡ªå·±æ¨¡æ‹Ÿè¯¥æ–¹æ³•ï¼š</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//æ¨¡æ‹ŸObject.create()æ–¹æ³•</span>
<span class="token keyword">function</span> <span class="token function">myCreate</span><span class="token punctuation">(</span><span class="token parameter">o</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">function</span> <span class="token constant">F</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token class-name">F</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> o<span class="token punctuation">;</span>
    o <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">F</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> o<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> p <span class="token operator">=</span> <span class="token punctuation">{</span> name <span class="token operator">:</span> <span class="token string">'allin'</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token function">myCreate</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token punctuation">;</span>
obj<span class="token punctuation">.</span>name<span class="token punctuation">;</span> <span class="token comment">// allin</span>
</code></pre></div><p>ç›®å‰ï¼Œå„å¤§æµè§ˆå™¨çš„æœ€æ–°ç‰ˆæœ¬ï¼ˆåŒ…æ‹¬IE9ï¼‰éƒ½éƒ¨ç½²äº†è¿™ä¸ªæ–¹æ³•ã€‚å¦‚æœé‡åˆ°è€å¼æµè§ˆå™¨ï¼Œå¯ä»¥ç”¨ä¸‹é¢çš„ä»£ç è‡ªè¡Œéƒ¨ç½²</p> <div class="language-js extra-class"><pre class="language-js"><code>ã€€<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>Object<span class="token punctuation">.</span>create<span class="token punctuation">)</span> <span class="token punctuation">{</span>
ã€€ã€€ã€€ã€€Object<span class="token punctuation">.</span><span class="token function-variable function">create</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">o</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
ã€€ã€€ã€€ã€€ã€€ã€€ <span class="token keyword">function</span> <span class="token constant">F</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
ã€€ã€€ã€€ã€€ã€€ã€€<span class="token constant">F</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> o<span class="token punctuation">;</span>
ã€€ã€€ã€€ã€€ã€€ã€€<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">F</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ã€€ã€€ã€€ã€€<span class="token punctuation">}</span><span class="token punctuation">;</span>
ã€€ã€€<span class="token punctuation">}</span>
</code></pre></div><p><strong>2. ç±»çš„ç»§æ‰¿</strong></p> <blockquote><p><code>Object.create()</code></p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token class-name">Person</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>headCount <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token class-name">Person</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">eat</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'eating...'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">Programmer</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> title</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token class-name">Programmer</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">Person</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//å»ºç«‹ç»§æ‰¿å…³ç³»</span>
<span class="token class-name">Programmer</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor <span class="token operator">=</span> Programmer<span class="token punctuation">;</span>  <span class="token comment">// ä¿®æ”¹constructorçš„æŒ‡å‘</span>
</code></pre></div><p><strong>è°ƒç”¨çˆ¶ç±»æ–¹æ³•</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token class-name">Person</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>headCount <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token class-name">Person</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">eat</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'eating...'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">Programmer</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> title</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">Person</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> arguments<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è°ƒç”¨çˆ¶ç±»çš„æ„é€ å™¨</span>
<span class="token punctuation">}</span>


<span class="token class-name">Programmer</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">Person</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Programmer</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor <span class="token operator">=</span> Programmer<span class="token punctuation">;</span>

<span class="token class-name">Programmer</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>language <span class="token operator">=</span> <span class="token string">"js"</span><span class="token punctuation">;</span>
<span class="token class-name">Programmer</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">work</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'i am working code in '</span><span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>language<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Person</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">eat</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> arguments<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è°ƒç”¨çˆ¶ç±»ä¸Šçš„æ–¹æ³•</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>3. å°è£…</strong></p> <ul><li>å‘½åç©ºé—´
<ul><li>jsæ˜¯æ²¡æœ‰å‘½åç©ºé—´çš„ï¼Œå› æ­¤å¯ä»¥ç”¨å¯¹è±¡æ¨¡æ‹Ÿ</li></ul></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> app <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token comment">// å‘½åç©ºé—´app</span>
<span class="token comment">//æ¨¡å—1</span>
app<span class="token punctuation">.</span>module1 <span class="token operator">=</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">'allin'</span><span class="token punctuation">,</span>
    <span class="token function-variable function">f</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'hi robot'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span>module1<span class="token punctuation">.</span>name<span class="token punctuation">;</span> <span class="token comment">// "allin"</span>
app<span class="token punctuation">.</span>module1<span class="token punctuation">.</span><span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// hi robot</span>
</code></pre></div><blockquote><p>å¯¹è±¡çš„å±æ€§å¤–ç•Œæ˜¯å¯è¯»å¯å†™ å¦‚ä½•æ¥è¾¾åˆ°å°è£…çš„é¢ç›®çš„ï¼Ÿç­”ï¼šå¯é€šè¿‡<code>é—­åŒ…+å±€éƒ¨å˜é‡</code>æ¥å®Œæˆ</p></blockquote> <ul><li>åœ¨æ„é€ å‡½æ•°å†…éƒ¨å£°æ˜å±€éƒ¨å˜é‡ å’Œæ™®é€šæ–¹æ³•</li> <li>å› ä¸ºä½œç”¨åŸŸçš„å…³ç³» åªæœ‰æ„é€ å‡½æ•°å†…çš„æ–¹æ³•</li> <li>æ‰èƒ½è®¿é—®å±€éƒ¨å˜é‡ è€Œæ–¹æ³•å¯¹äºå¤–ç•Œæ˜¯å¼€æ”¾çš„</li> <li>å› æ­¤å¯ä»¥é€šè¿‡æ–¹æ³•æ¥è®¿é—® åŸæœ¬å¤–ç•Œè®¿é—®ä¸åˆ°çš„å±€éƒ¨å˜é‡ è¾¾åˆ°å‡½æ•°å°è£…çš„ç›®çš„</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Girl</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span>age</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">var</span> love <span class="token operator">=</span> <span class="token string">'å°æ˜'</span><span class="token punctuation">;</span><span class="token comment">//love æ˜¯å±€éƒ¨å˜é‡ å‡†ç¡®è¯´ä¸å±äºå¯¹è±¡ å±äºè¿™ä¸ªå‡½æ•°çš„é¢æ¿€æ´»å¯¹è±¡ å‡½æ•°è°ƒç”¨æ—¶å¿…å°†äº§ç”Ÿä¸€ä¸ªæ¿€æ´»å¯¹è±¡ loveåœ¨æ¿€æ´»å¯¹è±¡èº«ä¸Š   æ¿€æ´»å¯¹è±¡æœ‰ä½œç”¨åŸŸçš„å…³ç³» æœ‰åŠæ³•è®¿é—®  åŠ ä¸€ä¸ªå‡½æ•°æä¾›å¤–ç•Œè®¿é—®</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">say</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> love<span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>

	<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">movelove</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		love <span class="token operator">=</span> <span class="token string">'å°è½©'</span><span class="token punctuation">;</span> <span class="token comment">//35</span>
	<span class="token punctuation">}</span>

<span class="token punctuation">}</span> 

<span class="token keyword">var</span> g <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Girl</span><span class="token punctuation">(</span><span class="token string">'yinghong'</span><span class="token punctuation">,</span><span class="token number">22</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>g<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>g<span class="token punctuation">.</span><span class="token function">say</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å°æ˜</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>g<span class="token punctuation">.</span><span class="token function">movelove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//undefined  å› ä¸º35è¡Œæ²¡æœ‰è¿”å›</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>g<span class="token punctuation">.</span><span class="token function">say</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å°è½©</span>



<span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">function</span> <span class="token function">t</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token comment">//var age = 22;//å£°æ˜ageå˜é‡ åœ¨tçš„æ¿€æ´»å¯¹è±¡ä¸Š</span>
		age <span class="token operator">=</span> <span class="token number">22</span><span class="token punctuation">;</span><span class="token comment">//èµ‹å€¼æ“ä½œ tçš„æ¿€æ´»å¯¹è±¡ä¸Šæ‰¾ageå±æ€§ ï¼Œæ‰¾ä¸åˆ° æ‰¾fnçš„æ¿€æ´»å¯¹è±¡....å†æ‰¾åˆ° æœ€ç»ˆæ‰¾åˆ°window.age = 22;</span>
				<span class="token comment">//ä¸åŠ varå°±æ˜¯æ“ä½œwindowå…¨å±€å±æ€§</span>
	
	<span class="token punctuation">}</span>
	<span class="token function">t</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//undefined</span>
</code></pre></div><p><strong>4. é™æ€æˆå‘˜</strong></p> <blockquote><p>é¢å‘å¯¹è±¡ä¸­çš„é™æ€æ–¹æ³•-é™æ€å±æ€§ï¼šæ²¡æœ‰newå¯¹è±¡ ä¹Ÿèƒ½å¼•ç”¨é™æ€æ–¹æ³•å±æ€§</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> age <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//é™æ€æˆå‘˜</span>
Person<span class="token punctuation">.</span><span class="token function-variable function">walk</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'static'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
Person<span class="token punctuation">.</span><span class="token function">walk</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// static</span>
</code></pre></div><p><strong>5. ç§æœ‰ä¸å…¬æœ‰</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// ç§æœ‰å±æ€§ä¸æ–¹æ³•</span>
    <span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">'allin'</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> <span class="token function-variable function">work</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token comment">//å…¬æœ‰å±æ€§ä¸æ–¹æ³•</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>id <span class="token operator">=</span> id<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">say</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'say hello'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">work</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> p1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
p1<span class="token punctuation">.</span>name<span class="token punctuation">;</span> <span class="token comment">// undefined</span>
p1<span class="token punctuation">.</span>id<span class="token punctuation">;</span>  <span class="token comment">// 123</span>
p1<span class="token punctuation">.</span><span class="token function">say</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// say hello 123</span>
</code></pre></div><p><strong>6. æ¨¡å—åŒ–</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> moduleA<span class="token punctuation">;</span>
<span class="token function-variable function">moduleA</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> prop <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

    <span class="token keyword">function</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

    <span class="token keyword">return</span> <span class="token punctuation">{</span>
        func<span class="token operator">:</span> func<span class="token punctuation">,</span>
        prop<span class="token operator">:</span> prop
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ç«‹å³æ‰§è¡ŒåŒ¿åå‡½æ•°</span>
</code></pre></div><p><strong>7. å¤šæ€</strong></p> <blockquote><p>å¤šæ€:åŒä¸€ä¸ªçˆ¶ç±»ç»§æ‰¿å‡ºæ¥çš„å­ç±»å„æœ‰å„çš„å½¢æ€</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Cat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>eat <span class="token operator">=</span> <span class="token string">'è‚‰'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">Tiger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">'é»‘é»„ç›¸é—´'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">Cheetah</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">'æŠ¥æ–‡'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">Lion</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">'åœŸé»„è‰²'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token class-name">Tiger</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span>  <span class="token class-name">Cheetah</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token class-name">Lion</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å…±äº«ä¸€ä¸ªç¥–å…ˆ Cat</span>

<span class="token keyword">var</span> <span class="token constant">T</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Tiger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> <span class="token constant">C</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cheetah</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> <span class="token constant">L</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Lion</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token constant">T</span><span class="token punctuation">.</span>color<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token constant">C</span><span class="token punctuation">.</span>color<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token constant">L</span><span class="token punctuation">.</span>color<span class="token punctuation">)</span><span class="token punctuation">;</span>


console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token constant">T</span><span class="token punctuation">.</span>eat<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token constant">C</span><span class="token punctuation">.</span>eat<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token constant">L</span><span class="token punctuation">.</span>eat<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>8. æŠ½è±¡ç±»</strong></p> <blockquote><p>åœ¨æ„é€ å™¨ä¸­ <code>throw new Error('')</code>; æŠ›å¼‚å¸¸ã€‚è¿™æ ·é˜²æ­¢è¿™ä¸ªç±»è¢«ç›´æ¥è°ƒç”¨</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">DetectorBase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'Abstract class can not be invoked directly!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token class-name">DetectorBase</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">detect</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Detection starting...'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token class-name">DetectorBase</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">stop</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Detection stopped.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token class-name">DetectorBase</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">init</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'Error'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// var d = new DetectorBase();</span>
<span class="token comment">// Uncaught Error: Abstract class can not be invoked directly!</span>

<span class="token keyword">function</span> <span class="token function">LinkDetector</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token class-name">LinkDetector</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">DetectorBase</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">LinkDetector</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor <span class="token operator">=</span> LinkDetector<span class="token punctuation">;</span>

<span class="token keyword">var</span> l <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkDetector</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//LinkDetector {}__proto__: LinkDetector</span>
l<span class="token punctuation">.</span><span class="token function">detect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//Detection starting...</span>
l<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//Uncaught Error: Error</span>
</code></pre></div><h3 id="_13-äº‹ä»¶å¾ªç¯"><a href="http://interview.poetries.top/docs/simply.html#_13-%E4%BA%8B%E4%BB%B6%E5%BE%AA%E7%8E%AF" class="header-anchor">#</a> 13 äº‹ä»¶å¾ªç¯</h3> <p><strong>1. æµè§ˆå™¨äº‹ä»¶å¾ªç¯</strong></p> <blockquote><p>æ¶‰åŠé¢è¯•é¢˜ï¼šå¼‚æ­¥ä»£ç æ‰§è¡Œé¡ºåºï¼Ÿè§£é‡Šä¸€ä¸‹ä»€ä¹ˆæ˜¯ <code>Event Loop</code> ï¼Ÿ</p></blockquote> <blockquote><p>JavaScriptçš„å•çº¿ç¨‹ï¼Œä¸å®ƒçš„ç”¨é€”æœ‰å…³ã€‚ä½œä¸ºæµè§ˆå™¨è„šæœ¬è¯­è¨€ï¼ŒJavaScriptçš„ä¸»è¦ç”¨é€”æ˜¯ä¸ç”¨æˆ·äº’åŠ¨ï¼Œä»¥åŠæ“ä½œDOMã€‚è¿™å†³å®šäº†å®ƒåªèƒ½æ˜¯å•çº¿ç¨‹ï¼Œå¦åˆ™ä¼šå¸¦æ¥å¾ˆå¤æ‚çš„åŒæ­¥é—®é¢˜ã€‚æ¯”å¦‚ï¼Œå‡å®šJavaScriptåŒæ—¶æœ‰ä¸¤ä¸ªçº¿ç¨‹ï¼Œä¸€ä¸ªçº¿ç¨‹åœ¨æŸä¸ªDOMèŠ‚ç‚¹ä¸Šæ·»åŠ å†…å®¹ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹åˆ é™¤äº†è¿™ä¸ªèŠ‚ç‚¹ï¼Œè¿™æ—¶æµè§ˆå™¨åº”è¯¥ä»¥å“ªä¸ªçº¿ç¨‹ä¸ºå‡†ï¼Ÿæ‰€ä»¥ï¼Œä¸ºäº†é¿å…å¤æ‚æ€§ï¼Œä»ä¸€è¯ç”Ÿï¼ŒJavaScriptå°±æ˜¯å•çº¿ç¨‹ï¼Œè¿™å·²ç»æˆäº†è¿™é—¨è¯­è¨€çš„æ ¸å¿ƒç‰¹å¾ï¼Œå°†æ¥ä¹Ÿä¸ä¼šæ”¹å˜</p></blockquote> <blockquote><p>jsä»£ç æ‰§è¡Œè¿‡ç¨‹ä¸­ä¼šæœ‰å¾ˆå¤šä»»åŠ¡ï¼Œè¿™äº›ä»»åŠ¡æ€»çš„åˆ†æˆä¸¤ç±»ï¼š</p></blockquote> <ul><li>åŒæ­¥ä»»åŠ¡</li> <li>å¼‚æ­¥ä»»åŠ¡</li></ul> <blockquote><p>å½“æˆ‘ä»¬æ‰“å¼€ç½‘ç«™æ—¶ï¼Œç½‘é¡µçš„æ¸²æŸ“è¿‡ç¨‹å°±æ˜¯ä¸€å¤§å †åŒæ­¥ä»»åŠ¡ï¼Œæ¯”å¦‚é¡µé¢éª¨æ¶å’Œé¡µé¢å…ƒç´ çš„æ¸²æŸ“ã€‚è€ŒåƒåŠ è½½å›¾ç‰‡éŸ³ä¹ä¹‹ç±»å ç”¨èµ„æºå¤§è€—æ—¶ä¹…çš„ä»»åŠ¡ï¼Œå°±æ˜¯å¼‚æ­¥ä»»åŠ¡ã€‚ï¼Œæˆ‘ä»¬ç”¨å¯¼å›¾æ¥è¯´æ˜ï¼š</p></blockquote> <p><img src="./è¿›é˜¶_files/10.png" alt="" class="medium-zoom-image"></p> <p><strong>æˆ‘ä»¬è§£é‡Šä¸€ä¸‹è¿™å¼ å›¾ï¼š</strong></p> <ul><li>åŒæ­¥å’Œå¼‚æ­¥ä»»åŠ¡åˆ†åˆ«è¿›å…¥ä¸åŒçš„æ‰§è¡Œ"åœºæ‰€"ï¼ŒåŒæ­¥çš„è¿›å…¥ä¸»çº¿ç¨‹ï¼Œå¼‚æ­¥çš„è¿›å…¥Event Tableå¹¶æ³¨å†Œå‡½æ•°ã€‚</li> <li>å½“æŒ‡å®šçš„äº‹æƒ…å®Œæˆæ—¶ï¼ŒEvent Tableä¼šå°†è¿™ä¸ªå‡½æ•°ç§»å…¥Event Queueã€‚</li> <li>ä¸»çº¿ç¨‹å†…çš„ä»»åŠ¡æ‰§è¡Œå®Œæ¯•ä¸ºç©ºï¼Œä¼šå»Event Queueè¯»å–å¯¹åº”çš„å‡½æ•°ï¼Œè¿›å…¥ä¸»çº¿ç¨‹æ‰§è¡Œã€‚</li> <li>ä¸Šè¿°è¿‡ç¨‹ä¼šä¸æ–­é‡å¤ï¼Œä¹Ÿå°±æ˜¯å¸¸è¯´çš„Event Loop(äº‹ä»¶å¾ªç¯)ã€‚</li></ul> <blockquote><p>é‚£ä¸»çº¿ç¨‹æ‰§è¡Œæ ˆä½•æ—¶ä¸ºç©ºå‘¢ï¼Ÿjså¼•æ“å­˜åœ¨monitoring processè¿›ç¨‹ï¼Œä¼šæŒç»­ä¸æ–­çš„æ£€æŸ¥ä¸»çº¿ç¨‹æ‰§è¡Œæ ˆæ˜¯å¦ä¸ºç©ºï¼Œä¸€æ—¦ä¸ºç©ºï¼Œå°±ä¼šå»Event Queueé‚£é‡Œæ£€æŸ¥æ˜¯å¦æœ‰ç­‰å¾…è¢«è°ƒç”¨çš„å‡½æ•°</p></blockquote> <p>ä»¥ä¸Šå°±æ˜¯jsè¿è¡Œçš„æ•´ä½“æµç¨‹</p> <p><strong>é¢è¯•ä¸­è¯¥å¦‚ä½•å›ç­”å‘¢ï¼Ÿ ä¸‹é¢æ˜¯æˆ‘ä¸ªäººæ¨èçš„å›ç­”ï¼š</strong></p> <ul><li>é¦–å…ˆjs æ˜¯å•çº¿ç¨‹è¿è¡Œçš„ï¼Œåœ¨ä»£ç æ‰§è¡Œçš„æ—¶å€™ï¼Œé€šè¿‡å°†ä¸åŒå‡½æ•°çš„æ‰§è¡Œä¸Šä¸‹æ–‡å‹å…¥æ‰§è¡Œæ ˆä¸­æ¥ä¿è¯ä»£ç çš„æœ‰åºæ‰§è¡Œ</li> <li>åœ¨æ‰§è¡ŒåŒæ­¥ä»£ç çš„æ—¶å€™ï¼Œå¦‚æœé‡åˆ°äº†å¼‚æ­¥äº‹ä»¶ï¼Œjs å¼•æ“å¹¶ä¸ä¼šä¸€ç›´ç­‰å¾…å…¶è¿”å›ç»“æœï¼Œè€Œæ˜¯ä¼šå°†è¿™ä¸ªäº‹ä»¶æŒ‚èµ·ï¼Œç»§ç»­æ‰§è¡Œæ‰§è¡Œæ ˆä¸­çš„å…¶ä»–ä»»åŠ¡</li> <li>å½“åŒæ­¥äº‹ä»¶æ‰§è¡Œå®Œæ¯•åï¼Œå†å°†å¼‚æ­¥äº‹ä»¶å¯¹åº”çš„å›è°ƒåŠ å…¥åˆ°ä¸å½“å‰æ‰§è¡Œæ ˆä¸­ä¸åŒçš„å¦ä¸€ä¸ªä»»åŠ¡é˜Ÿåˆ—ä¸­ç­‰å¾…æ‰§è¡Œ</li> <li>ä»»åŠ¡é˜Ÿåˆ—å¯ä»¥åˆ†ä¸ºå®ä»»åŠ¡å¯¹åˆ—å’Œå¾®ä»»åŠ¡å¯¹åˆ—ï¼Œå½“å½“å‰æ‰§è¡Œæ ˆä¸­çš„äº‹ä»¶æ‰§è¡Œå®Œæ¯•åï¼Œjs å¼•æ“é¦–å…ˆä¼šåˆ¤æ–­å¾®ä»»åŠ¡å¯¹åˆ—ä¸­æ˜¯å¦æœ‰ä»»åŠ¡å¯ä»¥æ‰§è¡Œï¼Œå¦‚æœæœ‰å°±å°†å¾®ä»»åŠ¡é˜Ÿé¦–çš„äº‹ä»¶å‹å…¥æ ˆä¸­æ‰§è¡Œ</li> <li>å½“å¾®ä»»åŠ¡å¯¹åˆ—ä¸­çš„ä»»åŠ¡éƒ½æ‰§è¡Œå®Œæˆåå†å»åˆ¤æ–­å®ä»»åŠ¡å¯¹åˆ—ä¸­çš„ä»»åŠ¡ã€‚</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
process<span class="token punctuation">.</span><span class="token function">nextTick</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>ç¬¬ä¸€è½®ï¼šä¸»çº¿ç¨‹å¼€å§‹æ‰§è¡Œï¼Œé‡åˆ°<code>setTimeout</code>ï¼Œå°†setTimeoutçš„å›è°ƒå‡½æ•°ä¸¢åˆ°å®ä»»åŠ¡é˜Ÿåˆ—ä¸­ï¼Œåœ¨å¾€ä¸‹æ‰§è¡Œ<code>new Promise</code>ç«‹å³æ‰§è¡Œï¼Œè¾“å‡º2ï¼Œthençš„å›è°ƒå‡½æ•°ä¸¢åˆ°å¾®ä»»åŠ¡é˜Ÿåˆ—ä¸­ï¼Œå†ç»§ç»­æ‰§è¡Œï¼Œé‡åˆ°<code>process.nextTick</code>ï¼ŒåŒæ ·å°†å›è°ƒå‡½æ•°æ‰”åˆ°ä¸ºä»»åŠ¡é˜Ÿåˆ—ï¼Œå†ç»§ç»­æ‰§è¡Œï¼Œè¾“å‡º5ï¼Œå½“æ‰€æœ‰åŒæ­¥ä»»åŠ¡æ‰§è¡Œå®Œæˆåçœ‹æœ‰æ²¡æœ‰å¯ä»¥æ‰§è¡Œçš„å¾®ä»»åŠ¡ï¼Œå‘ç°æœ‰thenå‡½æ•°å’Œ<code>nextTick</code>ä¸¤ä¸ªå¾®ä»»åŠ¡ï¼Œå…ˆæ‰§è¡Œå“ªä¸ªå‘¢ï¼Ÿ<code>process.nextTick</code>æŒ‡å®šçš„å¼‚æ­¥ä»»åŠ¡æ€»æ˜¯å‘ç”Ÿåœ¨æ‰€æœ‰å¼‚æ­¥ä»»åŠ¡ä¹‹å‰ï¼Œå› æ­¤å…ˆæ‰§è¡Œprocess.nextTickè¾“å‡º4ç„¶åæ‰§è¡Œthenå‡½æ•°è¾“å‡º3ï¼Œç¬¬ä¸€è½®æ‰§è¡Œç»“æŸã€‚</li> <li>ç¬¬äºŒè½®ï¼šä»å®ä»»åŠ¡é˜Ÿåˆ—å¼€å§‹ï¼Œå‘ç°setTimeoutå›è°ƒï¼Œè¾“å‡º1æ‰§è¡Œå®Œæ¯•ï¼Œå› æ­¤ç»“æœæ˜¯25431</li></ul> <blockquote><p><code>JS</code> åœ¨æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ä¼šäº§ç”Ÿæ‰§è¡Œç¯å¢ƒï¼Œè¿™äº›æ‰§è¡Œç¯å¢ƒä¼šè¢«é¡ºåºçš„åŠ å…¥åˆ°æ‰§è¡Œæ ˆä¸­ã€‚å¦‚æœé‡åˆ°å¼‚æ­¥çš„ä»£ç ï¼Œä¼šè¢«æŒ‚èµ·å¹¶åŠ å…¥åˆ° <code>Task</code>ï¼ˆæœ‰å¤šç§ <code>task</code>ï¼‰ é˜Ÿåˆ—ä¸­ã€‚ä¸€æ—¦æ‰§è¡Œæ ˆä¸ºç©ºï¼Œ<code>Event</code> <code>Loop</code> å°±ä¼šä» <code>Task</code> é˜Ÿåˆ—ä¸­æ‹¿å‡ºéœ€è¦æ‰§è¡Œçš„ä»£ç å¹¶æ”¾å…¥æ‰§è¡Œæ ˆä¸­æ‰§è¡Œï¼Œæ‰€ä»¥æœ¬è´¨ä¸Šæ¥è¯´ <code>JS</code> ä¸­çš„å¼‚æ­¥è¿˜æ˜¯åŒæ­¥è¡Œä¸º</p></blockquote> <p><img src="./è¿›é˜¶_files/4.png" alt="" class="medium-zoom-image"></p> <div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'script start'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'setTimeout'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'script end'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><blockquote><p>ä¸åŒçš„ä»»åŠ¡æºä¼šè¢«åˆ†é…åˆ°ä¸åŒçš„ <code>Task</code> é˜Ÿåˆ—ä¸­ï¼Œä»»åŠ¡æºå¯ä»¥åˆ†ä¸º å¾®ä»»åŠ¡ï¼ˆ<code>microtask</code>ï¼‰ å’Œ å®ä»»åŠ¡ï¼ˆ<code>macrotask</code>ï¼‰ã€‚åœ¨ <code>ES6</code> è§„èŒƒä¸­ï¼Œ<code>microtask</code> ç§°ä¸º <code>jobs</code>ï¼Œ<code>macrotask</code> ç§°ä¸º <code>task</code></p></blockquote> <div class="language-javascript extra-class"><pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'script start'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'setTimeout'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Promise'</span><span class="token punctuation">)</span>
    <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'promise1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'promise2'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'script end'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// script start =&gt; Promise =&gt; script end =&gt; promise1 =&gt; promise2 =&gt; setTimeout</span>
</code></pre></div><blockquote><p>ä»¥ä¸Šä»£ç è™½ç„¶ <code>setTimeout</code> å†™åœ¨ <code>Promise</code> ä¹‹å‰ï¼Œä½†æ˜¯å› ä¸º <code>Promise</code> å±äºå¾®ä»»åŠ¡è€Œ <code>setTimeout</code> å±äºå®ä»»åŠ¡</p></blockquote> <p><strong>å¾®ä»»åŠ¡</strong></p> <ul><li><code>process.nextTick</code></li> <li><code>promise</code></li> <li><code>Object.observe</code></li> <li><code>MutationObserver</code></li></ul> <p><strong>å®ä»»åŠ¡</strong></p> <ul><li><code>script</code></li> <li><code>setTimeout</code></li> <li><code>setInterval</code></li> <li><code>setImmediate</code></li> <li><code>I/O</code></li> <li><code>UI rendering</code></li></ul> <blockquote><p>å®ä»»åŠ¡ä¸­åŒ…æ‹¬äº† <code>script</code> ï¼Œæµè§ˆå™¨ä¼šå…ˆæ‰§è¡Œä¸€ä¸ªå®ä»»åŠ¡ï¼Œæ¥ä¸‹æ¥æœ‰å¼‚æ­¥ä»£ç çš„è¯å°±å…ˆæ‰§è¡Œå¾®ä»»åŠ¡</p></blockquote> <p><strong>æ‰€ä»¥æ­£ç¡®çš„ä¸€æ¬¡ Event loop é¡ºåºæ˜¯è¿™æ ·çš„</strong></p> <ul><li>æ‰§è¡ŒåŒæ­¥ä»£ç ï¼Œè¿™å±äºå®ä»»åŠ¡</li> <li>æ‰§è¡Œæ ˆä¸ºç©ºï¼ŒæŸ¥è¯¢æ˜¯å¦æœ‰å¾®ä»»åŠ¡éœ€è¦æ‰§è¡Œ</li> <li>æ‰§è¡Œæ‰€æœ‰å¾®ä»»åŠ¡</li> <li>å¿…è¦çš„è¯æ¸²æŸ“ UI</li> <li>ç„¶åå¼€å§‹ä¸‹ä¸€è½® <code>Event loop</code>ï¼Œæ‰§è¡Œå®ä»»åŠ¡ä¸­çš„å¼‚æ­¥ä»£ç </li></ul> <blockquote><p>é€šè¿‡ä¸Šè¿°çš„ <code>Event loop</code> é¡ºåºå¯çŸ¥ï¼Œå¦‚æœå®ä»»åŠ¡ä¸­çš„å¼‚æ­¥ä»£ç æœ‰å¤§é‡çš„è®¡ç®—å¹¶ä¸”éœ€è¦æ“ä½œ <code>DOM</code> çš„è¯ï¼Œä¸ºäº†æ›´å¿«çš„å“åº”ç•Œé¢å“åº”ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠæ“ä½œ <code>DOM</code> æ”¾å…¥å¾®ä»»åŠ¡ä¸­</p></blockquote> <p><strong>2. Node ä¸­çš„ Event loop</strong></p> <ul><li><code>Node</code> ä¸­çš„ <code>Event loop</code> å’Œæµè§ˆå™¨ä¸­çš„ä¸ç›¸åŒã€‚</li> <li><code>Node</code> çš„ <code>Event loop</code> åˆ†ä¸º<code>6</code>ä¸ªé˜¶æ®µï¼Œå®ƒä»¬ä¼šæŒ‰ç…§é¡ºåºåå¤è¿è¡Œ</li></ul> <div class="language- extra-class"><pre class="language-text"><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”Œâ”€&gt;â”‚        timers         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â”‚     I/O callbacks     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â”‚     idle, prepare     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚   incoming:   â”‚
â”‚  â”‚         poll          â”‚&lt;â”€â”€connectionsâ”€â”€â”€     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚   data, etc.  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚  â”‚        check          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â””â”€â”€â”¤    close callbacks    â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div><p><strong>timer</strong></p> <ul><li><code>timers</code> é˜¶æ®µä¼šæ‰§è¡Œ <code>setTimeout</code> å’Œ <code>setInterval</code></li> <li>ä¸€ä¸ª timer æŒ‡å®šçš„æ—¶é—´å¹¶ä¸æ˜¯å‡†ç¡®æ—¶é—´ï¼Œè€Œæ˜¯åœ¨è¾¾åˆ°è¿™ä¸ªæ—¶é—´åå°½å¿«æ‰§è¡Œå›è°ƒï¼Œå¯èƒ½ä¼šå› ä¸ºç³»ç»Ÿæ­£åœ¨æ‰§è¡Œåˆ«çš„äº‹åŠ¡è€Œå»¶è¿Ÿ</li></ul> <p><strong>I/O</strong></p> <ul><li><code>I/O</code> é˜¶æ®µä¼šæ‰§è¡Œé™¤äº† <code>close</code> äº‹ä»¶ï¼Œå®šæ—¶å™¨å’Œ <code>setImmediate</code> çš„å›è°ƒ</li></ul> <p><strong>poll</strong></p> <ul><li><p><code>poll</code> é˜¶æ®µå¾ˆé‡è¦ï¼Œè¿™ä¸€é˜¶æ®µä¸­ï¼Œç³»ç»Ÿä¼šåšä¸¤ä»¶äº‹æƒ…</p> <ul><li>æ‰§è¡Œåˆ°ç‚¹çš„å®šæ—¶å™¨</li> <li>æ‰§è¡Œ <code>poll</code> é˜Ÿåˆ—ä¸­çš„äº‹ä»¶</li></ul></li> <li><p>å¹¶ä¸”å½“ <code>poll</code> ä¸­æ²¡æœ‰å®šæ—¶å™¨çš„æƒ…å†µä¸‹ï¼Œä¼šå‘ç°ä»¥ä¸‹ä¸¤ä»¶äº‹æƒ…</p> <ul><li>å¦‚æœ <code>poll</code> é˜Ÿåˆ—ä¸ä¸ºç©ºï¼Œä¼šéå†å›è°ƒé˜Ÿåˆ—å¹¶åŒæ­¥æ‰§è¡Œï¼Œç›´åˆ°é˜Ÿåˆ—ä¸ºç©ºæˆ–è€…ç³»ç»Ÿé™åˆ¶</li> <li>å¦‚æœ <code>poll</code> é˜Ÿåˆ—ä¸ºç©ºï¼Œä¼šæœ‰ä¸¤ä»¶äº‹å‘ç”Ÿ</li> <li>å¦‚æœæœ‰ <code>setImmediate</code> éœ€è¦æ‰§è¡Œï¼Œ<code>poll</code> é˜¶æ®µä¼šåœæ­¢å¹¶ä¸”è¿›å…¥åˆ° <code>check</code> é˜¶æ®µæ‰§è¡Œ <code>setImmediate</code></li> <li>å¦‚æœæ²¡æœ‰ <code>setImmediate</code> éœ€è¦æ‰§è¡Œï¼Œä¼šç­‰å¾…å›è°ƒè¢«åŠ å…¥åˆ°é˜Ÿåˆ—ä¸­å¹¶ç«‹å³æ‰§è¡Œå›è°ƒ</li> <li>å¦‚æœæœ‰åˆ«çš„å®šæ—¶å™¨éœ€è¦è¢«æ‰§è¡Œï¼Œä¼šå›åˆ° <code>timer</code> é˜¶æ®µæ‰§è¡Œå›è°ƒã€‚</li></ul></li></ul> <p><strong>check</strong></p> <ul><li><code>check</code> é˜¶æ®µæ‰§è¡Œ <code>setImmediate</code></li></ul> <p><strong>close callbacks</strong></p> <ul><li><code>close callbacks</code> é˜¶æ®µæ‰§è¡Œ <code>close</code> äº‹ä»¶</li> <li>å¹¶ä¸”åœ¨ <code>Node</code> ä¸­ï¼Œæœ‰äº›æƒ…å†µä¸‹çš„å®šæ—¶å™¨æ‰§è¡Œé¡ºåºæ˜¯éšæœºçš„</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'setTimeout'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">setImmediate</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'setImmediate'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// è¿™é‡Œå¯èƒ½ä¼šè¾“å‡º setTimeoutï¼ŒsetImmediate</span>
<span class="token comment">// å¯èƒ½ä¹Ÿä¼šç›¸åçš„è¾“å‡ºï¼Œè¿™å–å†³äºæ€§èƒ½</span>
<span class="token comment">// å› ä¸ºå¯èƒ½è¿›å…¥ event loop ç”¨äº†ä¸åˆ° 1 æ¯«ç§’ï¼Œè¿™æ—¶å€™ä¼šæ‰§è¡Œ setImmediate</span>
<span class="token comment">// å¦åˆ™ä¼šæ‰§è¡Œ setTimeout</span>
</code></pre></div><blockquote><p>ä¸Šé¢ä»‹ç»çš„éƒ½æ˜¯ <code>macrotask</code> çš„æ‰§è¡Œæƒ…å†µï¼Œ<code>microtask</code> ä¼šåœ¨ä»¥ä¸Šæ¯ä¸ªé˜¶æ®µå®Œæˆåç«‹å³æ‰§è¡Œ</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'timer1'</span><span class="token punctuation">)</span>

    Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'promise1'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>

<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'timer2'</span><span class="token punctuation">)</span>

    Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'promise2'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>

<span class="token comment">// ä»¥ä¸Šä»£ç åœ¨æµè§ˆå™¨å’Œ node ä¸­æ‰“å°æƒ…å†µæ˜¯ä¸åŒçš„</span>
<span class="token comment">// æµè§ˆå™¨ä¸­ä¸€å®šæ‰“å° timer1, promise1, timer2, promise2</span>
<span class="token comment">// node ä¸­å¯èƒ½æ‰“å° timer1, timer2, promise1, promise2</span>
<span class="token comment">// ä¹Ÿå¯èƒ½æ‰“å° timer1, promise1, timer2, promise2</span>
</code></pre></div><blockquote><p><code>Node</code> ä¸­çš„ <code>process.nextTick</code> ä¼šå…ˆäºå…¶ä»– <code>microtask</code> æ‰§è¡Œ</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
 console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"timer1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

 Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"promise1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

process<span class="token punctuation">.</span><span class="token function">nextTick</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
 console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"nextTick"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// nextTick, timer1, promise1</span>
</code></pre></div><blockquote><p>å¯¹äº <code>microtask</code> æ¥è¯´ï¼Œå®ƒä¼šåœ¨ä»¥ä¸Šæ¯ä¸ªé˜¶æ®µå®Œæˆå‰æ¸…ç©º <code>microtask</code> é˜Ÿåˆ—ï¼Œä¸‹å›¾ä¸­çš„ <code>Tick</code> å°±ä»£è¡¨äº† <code>microtask</code></p></blockquote> <p><img src="./è¿›é˜¶_files/5.png" alt="" class="medium-zoom-image"></p> <h3 id="_14-äº‹ä»¶æœºåˆ¶"><a href="http://interview.poetries.top/docs/simply.html#_14-%E4%BA%8B%E4%BB%B6%E6%9C%BA%E5%88%B6" class="header-anchor">#</a> 14 äº‹ä»¶æœºåˆ¶</h3> <blockquote><p>æ¶‰åŠé¢è¯•é¢˜ï¼šäº‹ä»¶çš„è§¦å‘è¿‡ç¨‹æ˜¯æ€ä¹ˆæ ·çš„ï¼ŸçŸ¥é“ä»€ä¹ˆæ˜¯äº‹ä»¶ä»£ç†å˜›ï¼Ÿ</p></blockquote> <p><strong>1. ç®€ä»‹</strong></p> <blockquote><p>äº‹ä»¶æµæ˜¯ä¸€ä¸ªäº‹ä»¶æ²¿ç€ç‰¹å®šæ•°æ®ç»“æ„ä¼ æ’­çš„è¿‡ç¨‹ã€‚å†’æ³¡å’Œæ•è·æ˜¯äº‹ä»¶æµåœ¨<code>DOM</code>ä¸­ä¸¤ç§ä¸åŒçš„ä¼ æ’­æ–¹æ³•</p></blockquote> <p><strong>äº‹ä»¶æµæœ‰ä¸‰ä¸ªé˜¶æ®µ</strong></p> <ul><li>äº‹ä»¶æ•è·é˜¶æ®µ</li> <li>å¤„äºç›®æ ‡é˜¶æ®µ</li> <li>äº‹ä»¶å†’æ³¡é˜¶æ®µ</li></ul> <p><strong>äº‹ä»¶æ•è·</strong></p> <blockquote><p>äº‹ä»¶æ•è·ï¼ˆ<code>event capturing</code>ï¼‰ï¼šé€šä¿—çš„ç†è§£å°±æ˜¯ï¼Œå½“é¼ æ ‡ç‚¹å‡»æˆ–è€…è§¦å‘<code>dom</code>äº‹ä»¶æ—¶ï¼Œæµè§ˆå™¨ä¼šä»æ ¹èŠ‚ç‚¹å¼€å§‹ç”±å¤–åˆ°å†…è¿›è¡Œäº‹ä»¶ä¼ æ’­ï¼Œå³ç‚¹å‡»äº†å­å…ƒç´ ï¼Œå¦‚æœçˆ¶å…ƒç´ é€šè¿‡äº‹ä»¶æ•è·æ–¹å¼æ³¨å†Œäº†å¯¹åº”çš„äº‹ä»¶çš„è¯ï¼Œä¼šå…ˆè§¦å‘çˆ¶å…ƒç´ ç»‘å®šçš„äº‹ä»¶</p></blockquote> <p><strong>äº‹ä»¶å†’æ³¡</strong></p> <blockquote><p>äº‹ä»¶å†’æ³¡ï¼ˆdubbed bubblingï¼‰ï¼šä¸äº‹ä»¶æ•è·æ°æ°ç›¸åï¼Œäº‹ä»¶å†’æ³¡é¡ºåºæ˜¯ç”±å†…åˆ°å¤–è¿›è¡Œäº‹ä»¶ä¼ æ’­ï¼Œç›´åˆ°æ ¹èŠ‚ç‚¹</p></blockquote> <p>æ— è®ºæ˜¯äº‹ä»¶æ•è·è¿˜æ˜¯äº‹ä»¶å†’æ³¡ï¼Œå®ƒä»¬éƒ½æœ‰ä¸€ä¸ªå…±åŒçš„è¡Œä¸ºï¼Œå°±æ˜¯äº‹ä»¶ä¼ æ’­</p> <p><img src="./è¿›é˜¶_files/319.png" alt="img" class="medium-zoom-image"></p> <p><strong>2. æ•è·å’Œå†’æ³¡</strong></p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>div1<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>div2<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    <span class="token keyword">let</span> div1 <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'div1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> div2 <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'div2'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    div1<span class="token punctuation">.</span><span class="token function-variable function">onClick</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'1'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    
    div2<span class="token punctuation">.</span><span class="token function-variable function">onClick</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'2'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><blockquote><p>å½“ç‚¹å‡» <code>div2</code>æ—¶ï¼Œä¼šå¼¹å‡ºä¸¤ä¸ªå¼¹å‡ºæ¡†ã€‚åœ¨ <code>ie8/9/10</code>ã€<code>chrome</code>æµè§ˆå™¨ï¼Œä¼šå…ˆå¼¹å‡ºâ€2â€å†å¼¹å‡ºâ€œ1â€ï¼Œè¿™å°±æ˜¯äº‹ä»¶å†’æ³¡ï¼šäº‹ä»¶ä»æœ€åº•å±‚çš„èŠ‚ç‚¹å‘ä¸Šå†’æ³¡ä¼ æ’­ã€‚äº‹ä»¶æ•è·åˆ™è·Ÿäº‹ä»¶å†’æ³¡ç›¸å</p></blockquote> <blockquote><p>W3Cçš„æ ‡å‡†æ˜¯å…ˆæ•è·å†å†’æ³¡ï¼Œ <code>addEventListener</code>çš„ç¬¬ä¸‰ä¸ªå‚æ•°å†³å®šæŠŠäº‹ä»¶æ³¨å†Œåœ¨æ•è·ï¼ˆ<code>true</code>ï¼‰è¿˜æ˜¯å†’æ³¡(<code>false</code>)</p></blockquote> <p><strong>3. äº‹ä»¶å¯¹è±¡</strong></p> <p><img src="./è¿›é˜¶_files/320.png" alt="img" class="medium-zoom-image"></p> <p><strong>4. äº‹ä»¶æµé˜»æ­¢</strong></p> <blockquote><p>åœ¨ä¸€äº›æƒ…å†µä¸‹éœ€è¦é˜»æ­¢äº‹ä»¶æµçš„ä¼ æ’­ï¼Œé˜»æ­¢é»˜è®¤åŠ¨ä½œçš„å‘ç”Ÿ</p></blockquote> <ul><li><code>event.preventDefault()</code>ï¼šå–æ¶ˆäº‹ä»¶å¯¹è±¡çš„é»˜è®¤åŠ¨ä½œä»¥åŠç»§ç»­ä¼ æ’­ã€‚</li> <li><code>event.stopPropagation()/ event.cancelBubble = true</code>ï¼šé˜»æ­¢äº‹ä»¶å†’æ³¡ã€‚</li></ul> <p><strong>äº‹ä»¶çš„é˜»æ­¢åœ¨ä¸åŒæµè§ˆå™¨æœ‰ä¸åŒå¤„ç†</strong></p> <ul><li>åœ¨<code>IE</code>ä¸‹ä½¿ç”¨ <code>event.returnValue= false</code>ï¼Œ</li> <li>åœ¨é<code>IE</code>ä¸‹åˆ™ä½¿ç”¨ <code>event.preventDefault()</code>è¿›è¡Œé˜»æ­¢</li></ul> <p><strong>preventDefaultä¸stopPropagationçš„åŒºåˆ«</strong></p> <ul><li><code>preventDefault</code>å‘Šè¯‰æµè§ˆå™¨ä¸ç”¨æ‰§è¡Œä¸äº‹ä»¶ç›¸å…³è”çš„é»˜è®¤åŠ¨ä½œï¼ˆå¦‚è¡¨å•æäº¤ï¼‰</li> <li><code>stopPropagation</code>æ˜¯åœæ­¢äº‹ä»¶ç»§ç»­å†’æ³¡ï¼Œä½†æ˜¯å¯¹IE9ä»¥ä¸‹çš„æµè§ˆå™¨æ— æ•ˆ</li></ul> <p><strong>5. äº‹ä»¶æ³¨å†Œ</strong></p> <ul><li>é€šå¸¸æˆ‘ä»¬ä½¿ç”¨ <code>addEventListener</code> æ³¨å†Œäº‹ä»¶ï¼Œè¯¥å‡½æ•°çš„ç¬¬ä¸‰ä¸ªå‚æ•°å¯ä»¥æ˜¯å¸ƒå°”å€¼ï¼Œä¹Ÿå¯ä»¥æ˜¯å¯¹è±¡ã€‚å¯¹äºå¸ƒå°”å€¼ <code>useCapture</code> å‚æ•°æ¥è¯´ï¼Œè¯¥å‚æ•°é»˜è®¤å€¼ä¸º <code>false</code>ã€‚<code>useCapture</code> å†³å®šäº†æ³¨å†Œçš„äº‹ä»¶æ˜¯æ•è·äº‹ä»¶è¿˜æ˜¯å†’æ³¡äº‹ä»¶</li> <li>ä¸€èˆ¬æ¥è¯´ï¼Œæˆ‘ä»¬åªå¸Œæœ›äº‹ä»¶åªè§¦å‘åœ¨ç›®æ ‡ä¸Šï¼Œè¿™æ—¶å€™å¯ä»¥ä½¿ç”¨ <code>stopPropagation</code> æ¥é˜»æ­¢äº‹ä»¶çš„è¿›ä¸€æ­¥ä¼ æ’­ã€‚é€šå¸¸æˆ‘ä»¬è®¤ä¸º <code>stopPropagation</code> æ˜¯ç”¨æ¥é˜»æ­¢äº‹ä»¶å†’æ³¡çš„ï¼Œå…¶å®è¯¥å‡½æ•°ä¹Ÿå¯ä»¥é˜»æ­¢æ•è·äº‹ä»¶ã€‚<code>stopImmediatePropagation</code> åŒæ ·ä¹Ÿèƒ½å®ç°é˜»æ­¢äº‹ä»¶ï¼Œä½†æ˜¯è¿˜èƒ½é˜»æ­¢è¯¥äº‹ä»¶ç›®æ ‡æ‰§è¡Œåˆ«çš„æ³¨å†Œäº‹ä»¶</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>node<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span><span class="token punctuation">{</span>
	event<span class="token punctuation">.</span><span class="token function">stopImmediatePropagation</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'å†’æ³¡'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// ç‚¹å‡» node åªä¼šæ‰§è¡Œä¸Šé¢çš„å‡½æ•°ï¼Œè¯¥å‡½æ•°ä¸ä¼šæ‰§è¡Œ</span>
node<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'æ•è· '</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>6. äº‹ä»¶å§”æ‰˜</strong></p> <ul><li>åœ¨<code>js</code>ä¸­æ€§èƒ½ä¼˜åŒ–çš„å…¶ä¸­ä¸€ä¸ªä¸»è¦æ€æƒ³æ˜¯å‡å°‘<code>dom</code>æ“ä½œã€‚</li> <li>èŠ‚çœå†…å­˜</li> <li>ä¸éœ€è¦ç»™å­èŠ‚ç‚¹æ³¨é”€äº‹ä»¶</li></ul> <blockquote><p>å‡è®¾æœ‰<code>100</code>ä¸ª<code>li</code>ï¼Œæ¯ä¸ª<code>li</code>æœ‰ç›¸åŒçš„ç‚¹å‡»äº‹ä»¶ã€‚å¦‚æœä¸ºæ¯<code>ä¸ªLi</code>éƒ½æ·»åŠ äº‹ä»¶ï¼Œåˆ™ä¼šé€ æˆ<code>dom</code>è®¿é—®æ¬¡æ•°è¿‡å¤šï¼Œå¼•èµ·æµè§ˆå™¨é‡ç»˜ä¸é‡æ’çš„æ¬¡æ•°è¿‡å¤šï¼Œæ€§èƒ½åˆ™ä¼šé™ä½ã€‚
ä½¿ç”¨äº‹ä»¶å§”æ‰˜åˆ™å¯ä»¥è§£å†³è¿™æ ·çš„é—®é¢˜</p></blockquote> <p><strong>åŸç†</strong></p> <blockquote><p>å®ç°äº‹ä»¶å§”æ‰˜æ˜¯åˆ©ç”¨äº†äº‹ä»¶çš„å†’æ³¡åŸç†å®ç°çš„ã€‚å½“æˆ‘ä»¬ä¸ºæœ€å¤–å±‚çš„èŠ‚ç‚¹æ·»åŠ ç‚¹å‡»äº‹ä»¶ï¼Œé‚£ä¹ˆé‡Œé¢çš„<code>ul</code>ã€<code>li</code>ã€<code>a</code>çš„ç‚¹å‡»äº‹ä»¶éƒ½ä¼šå†’æ³¡åˆ°æœ€å¤–å±‚èŠ‚ç‚¹ä¸Šï¼Œå§”æ‰˜å®ƒä»£ä¸ºæ‰§è¡Œäº‹ä»¶</p></blockquote> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ul<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
window.onload = function(){
    var ulEle = document.getElementById('ul');
    ul.onclick = function(ev){
        //å…¼å®¹IE
        ev = ev || window.event;
        var target = ev.target || ev.srcElement;
        
        if(target.nodeName.toLowerCase() == 'li'){
            alert( target.innerHTML);
        }
        
    }
}
</code></pre></div><h3 id="_15-promise"><a href="http://interview.poetries.top/docs/simply.html#_15-promise" class="header-anchor">#</a> 15 Promise</h3> <blockquote><p>è¿™é‡Œä½ è°ˆ <code>promise</code>çš„æ—¶å€™ï¼Œé™¤äº†å°†ä»–è§£å†³çš„ç—›ç‚¹ä»¥åŠå¸¸ç”¨çš„ <code>API</code> ä¹‹å¤–ï¼Œæœ€å¥½è¿›è¡Œæ‹“å±•æŠŠ <code>eventloop</code> å¸¦è¿›æ¥å¥½å¥½è®²ä¸€ä¸‹ï¼Œ<code>microtask</code>(å¾®ä»»åŠ¡)ã€<code>macrotask</code>(ä»»åŠ¡) çš„æ‰§è¡Œé¡ºåºï¼Œå¦‚æœçœ‹è¿‡ <code>promise</code> æºç ï¼Œæœ€å¥½å¯ä»¥è°ˆä¸€è°ˆ åŸç”Ÿ <code>Promise</code> æ˜¯å¦‚ä½•å®ç°çš„ã€‚<code>Promise</code> çš„å…³é”®ç‚¹åœ¨äº<code>callback</code> çš„ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ˜¯ <code>resovle</code>ï¼Œä¸€ä¸ªæ˜¯ <code>reject</code>ã€‚è¿˜æœ‰å°±æ˜¯ <code>Promise</code> çš„é“¾å¼è°ƒç”¨ï¼ˆ<code>Promise.then()</code>ï¼Œæ¯ä¸€ä¸ª <code>then</code> éƒ½æ˜¯ä¸€ä¸ªè´£ä»»äººï¼‰</p></blockquote> <ul><li><code>Promise</code> æ˜¯ <code>ES6</code> æ–°å¢çš„è¯­æ³•ï¼Œè§£å†³äº†å›è°ƒåœ°ç‹±çš„é—®é¢˜ã€‚</li> <li>å¯ä»¥æŠŠ <code>Promise</code>çœ‹æˆä¸€ä¸ªçŠ¶æ€æœºã€‚åˆå§‹æ˜¯ <code>pending</code> çŠ¶æ€ï¼Œå¯ä»¥é€šè¿‡å‡½æ•° <code>resolve</code> å’Œ <code>reject</code>ï¼Œå°†çŠ¶æ€è½¬å˜ä¸º <code>resolved</code> æˆ–è€… <code>rejected</code> çŠ¶æ€ï¼ŒçŠ¶æ€ä¸€æ—¦æ”¹å˜å°±ä¸èƒ½å†æ¬¡å˜åŒ–ã€‚</li> <li><code>then</code> å‡½æ•°ä¼šè¿”å›ä¸€ä¸ª <code>Promise</code> å®ä¾‹ï¼Œå¹¶ä¸”è¯¥è¿”å›å€¼æ˜¯ä¸€ä¸ªæ–°çš„å®ä¾‹è€Œä¸æ˜¯ä¹‹å‰çš„å®ä¾‹ã€‚å› ä¸º <code>Promise</code> è§„èŒƒè§„å®šé™¤äº† <code>pending</code> çŠ¶æ€ï¼Œå…¶ä»–çŠ¶æ€æ˜¯ä¸å¯ä»¥æ”¹å˜çš„ï¼Œå¦‚æœè¿”å›çš„æ˜¯ä¸€ä¸ªç›¸åŒå®ä¾‹çš„è¯ï¼Œå¤šä¸ª <code>then</code> è°ƒç”¨å°±å¤±å»æ„ä¹‰äº†ã€‚
å¯¹äº <code>then</code> æ¥è¯´ï¼Œæœ¬è´¨ä¸Šå¯ä»¥æŠŠå®ƒçœ‹æˆæ˜¯ <code>flatMap</code></li></ul> <p><strong>promiseæ‰‹å†™å®ç°ï¼Œé¢è¯•å¤Ÿç”¨ç‰ˆï¼š</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">myPromise</span><span class="token punctuation">(</span><span class="token parameter">constructor</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">let</span> self<span class="token operator">=</span><span class="token keyword">this</span><span class="token punctuation">;</span>
    self<span class="token punctuation">.</span>status<span class="token operator">=</span><span class="token string">"pending"</span> <span class="token comment">//å®šä¹‰çŠ¶æ€æ”¹å˜å‰çš„åˆå§‹çŠ¶æ€</span>
    self<span class="token punctuation">.</span>value<span class="token operator">=</span><span class="token keyword">undefined</span><span class="token punctuation">;</span><span class="token comment">//å®šä¹‰çŠ¶æ€ä¸ºresolvedçš„æ—¶å€™çš„çŠ¶æ€</span>
    self<span class="token punctuation">.</span>reason<span class="token operator">=</span><span class="token keyword">undefined</span><span class="token punctuation">;</span><span class="token comment">//å®šä¹‰çŠ¶æ€ä¸ºrejectedçš„æ—¶å€™çš„çŠ¶æ€</span>
    <span class="token keyword">function</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">//ä¸¤ä¸ª==="pending"ï¼Œä¿è¯äº†çŠ¶æ€çš„æ”¹å˜æ˜¯ä¸å¯é€†çš„</span>
       <span class="token keyword">if</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>status<span class="token operator">===</span><span class="token string">"pending"</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
          self<span class="token punctuation">.</span>value<span class="token operator">=</span>value<span class="token punctuation">;</span>
          self<span class="token punctuation">.</span>status<span class="token operator">=</span><span class="token string">"resolved"</span><span class="token punctuation">;</span>
       <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">function</span> <span class="token function">reject</span><span class="token punctuation">(</span><span class="token parameter">reason</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">//ä¸¤ä¸ª==="pending"ï¼Œä¿è¯äº†çŠ¶æ€çš„æ”¹å˜æ˜¯ä¸å¯é€†çš„</span>
       <span class="token keyword">if</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>status<span class="token operator">===</span><span class="token string">"pending"</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
          self<span class="token punctuation">.</span>reason<span class="token operator">=</span>reason<span class="token punctuation">;</span>
          self<span class="token punctuation">.</span>status<span class="token operator">=</span><span class="token string">"rejected"</span><span class="token punctuation">;</span>
       <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//æ•è·æ„é€ å¼‚å¸¸</span>
    <span class="token keyword">try</span><span class="token punctuation">{</span>
       <span class="token function">constructor</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span>reject<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
       <span class="token function">reject</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// å®šä¹‰é“¾å¼è°ƒç”¨çš„thenæ–¹æ³•</span>
myPromise<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">then</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">onFullfilled<span class="token punctuation">,</span>onRejected</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
   <span class="token keyword">let</span> self<span class="token operator">=</span><span class="token keyword">this</span><span class="token punctuation">;</span>
   <span class="token keyword">switch</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>status<span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">case</span> <span class="token string">"resolved"</span><span class="token operator">:</span>
        <span class="token function">onFullfilled</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
      <span class="token keyword">case</span> <span class="token string">"rejected"</span><span class="token operator">:</span>
        <span class="token function">onRejected</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>reason<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
      <span class="token keyword">default</span><span class="token operator">:</span>       
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>å…³äºPromiseè¿˜æœ‰å…¶ä»–çš„çŸ¥è¯†ï¼Œæ¯”å¦‚Promise.all()ã€Promise.race()ç­‰çš„è¿ç”¨ï¼Œç”±äºç¯‡å¹…åŸå› å°±ä¸å†åšå±•å¼€</p></blockquote> <h3 id="_16-æ¨¡å—åŒ–"><a href="http://interview.poetries.top/docs/simply.html#_16-%E6%A8%A1%E5%9D%97%E5%8C%96" class="header-anchor">#</a> 16 æ¨¡å—åŒ–</h3> <blockquote><p>js ä¸­ç°åœ¨æ¯”è¾ƒæˆç†Ÿçš„æœ‰å››ç§æ¨¡å—åŠ è½½æ–¹æ¡ˆï¼š</p></blockquote> <ul><li>ç¬¬ä¸€ç§æ˜¯ CommonJS æ–¹æ¡ˆï¼Œå®ƒé€šè¿‡ require æ¥å¼•å…¥æ¨¡å—ï¼Œé€šè¿‡ module.exports å®šä¹‰æ¨¡å—çš„è¾“å‡ºæ¥å£ã€‚è¿™ç§æ¨¡å—åŠ è½½æ–¹æ¡ˆæ˜¯æœåŠ¡å™¨ç«¯çš„è§£å†³æ–¹æ¡ˆï¼Œå®ƒæ˜¯ä»¥åŒæ­¥çš„æ–¹å¼æ¥å¼•å…¥æ¨¡å—çš„ï¼Œå› ä¸ºåœ¨æœåŠ¡ç«¯æ–‡ä»¶éƒ½å­˜å‚¨åœ¨æœ¬åœ°ç£ç›˜ï¼Œæ‰€ä»¥è¯»å–éå¸¸å¿«ï¼Œæ‰€ä»¥ä»¥åŒæ­¥çš„æ–¹å¼åŠ è½½æ²¡æœ‰é—®é¢˜ã€‚ä½†å¦‚æœæ˜¯åœ¨æµè§ˆå™¨ç«¯ï¼Œç”±äºæ¨¡å—çš„åŠ è½½æ˜¯ä½¿ç”¨ç½‘ç»œè¯·æ±‚ï¼Œå› æ­¤ä½¿ç”¨å¼‚æ­¥åŠ è½½çš„æ–¹å¼æ›´åŠ åˆé€‚ã€‚</li> <li>ç¬¬äºŒç§æ˜¯ AMD æ–¹æ¡ˆï¼Œè¿™ç§æ–¹æ¡ˆé‡‡ç”¨å¼‚æ­¥åŠ è½½çš„æ–¹å¼æ¥åŠ è½½æ¨¡å—ï¼Œæ¨¡å—çš„åŠ è½½ä¸å½±å“åé¢è¯­å¥çš„æ‰§è¡Œï¼Œæ‰€æœ‰ä¾èµ–è¿™ä¸ªæ¨¡å—çš„è¯­å¥éƒ½å®šä¹‰åœ¨ä¸€ä¸ªå›è°ƒå‡½æ•°é‡Œï¼Œç­‰åˆ°åŠ è½½å®Œæˆåå†æ‰§è¡Œå›è°ƒå‡½æ•°ã€‚require.js å®ç°äº† AMD è§„èŒƒ</li> <li>ç¬¬ä¸‰ç§æ˜¯ CMD æ–¹æ¡ˆï¼Œè¿™ç§æ–¹æ¡ˆå’Œ AMD æ–¹æ¡ˆéƒ½æ˜¯ä¸ºäº†è§£å†³å¼‚æ­¥æ¨¡å—åŠ è½½çš„é—®é¢˜ï¼Œsea.js å®ç°äº† CMD è§„èŒƒã€‚å®ƒå’Œrequire.jsçš„åŒºåˆ«åœ¨äºæ¨¡å—å®šä¹‰æ—¶å¯¹ä¾èµ–çš„å¤„ç†ä¸åŒå’Œå¯¹ä¾èµ–æ¨¡å—çš„æ‰§è¡Œæ—¶æœºçš„å¤„ç†ä¸åŒã€‚</li> <li>ç¬¬å››ç§æ–¹æ¡ˆæ˜¯ ES6 æå‡ºçš„æ–¹æ¡ˆï¼Œä½¿ç”¨ import å’Œ export çš„å½¢å¼æ¥å¯¼å…¥å¯¼å‡ºæ¨¡å—</li></ul> <blockquote><p>åœ¨æœ‰ <code>Babel</code> çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨ <code>ES6</code>çš„æ¨¡å—åŒ–</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// file a.js</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token comment">// file b.js</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span>a<span class="token punctuation">,</span> b<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./a.js'</span>
<span class="token keyword">import</span> <span class="token constant">XXX</span> <span class="token keyword">from</span> <span class="token string">'./b.js'</span>
</code></pre></div><p><strong>CommonJS</strong></p> <blockquote><p><code>CommonJs</code> æ˜¯ <code>Node</code> ç‹¬æœ‰çš„è§„èŒƒï¼Œæµè§ˆå™¨ä¸­ä½¿ç”¨å°±éœ€è¦ç”¨åˆ° <code>Browserify</code>è§£æäº†ã€‚</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// a.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    a<span class="token operator">:</span> <span class="token number">1</span>
<span class="token punctuation">}</span>
<span class="token comment">// or</span>
exports<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">1</span>

<span class="token comment">// b.js</span>
<span class="token keyword">var</span> module <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./a.js'</span><span class="token punctuation">)</span>
module<span class="token punctuation">.</span>a <span class="token comment">// -&gt; log 1</span>
</code></pre></div><blockquote><p>åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œ<code>module.exports</code> å’Œ <code>exports</code> å¾ˆå®¹æ˜“æ··æ·†ï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹å¤§è‡´å†…éƒ¨å®ç°</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> module <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./a.js'</span><span class="token punctuation">)</span>
module<span class="token punctuation">.</span>a
<span class="token comment">// è¿™é‡Œå…¶å®å°±æ˜¯åŒ…è£…äº†ä¸€å±‚ç«‹å³æ‰§è¡Œå‡½æ•°ï¼Œè¿™æ ·å°±ä¸ä¼šæ±¡æŸ“å…¨å±€å˜é‡äº†ï¼Œ</span>
<span class="token comment">// é‡è¦çš„æ˜¯ module è¿™é‡Œï¼Œmodule æ˜¯ Node ç‹¬æœ‰çš„ä¸€ä¸ªå˜é‡</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    a<span class="token operator">:</span> <span class="token number">1</span>
<span class="token punctuation">}</span>
<span class="token comment">// åŸºæœ¬å®ç°</span>
<span class="token keyword">var</span> module <span class="token operator">=</span> <span class="token punctuation">{</span>
  exports<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment">// exports å°±æ˜¯ä¸ªç©ºå¯¹è±¡</span>
<span class="token punctuation">}</span>
<span class="token comment">// è¿™ä¸ªæ˜¯ä¸ºä»€ä¹ˆ exports å’Œ module.exports ç”¨æ³•ç›¸ä¼¼çš„åŸå› </span>
<span class="token keyword">var</span> exports <span class="token operator">=</span> module<span class="token punctuation">.</span>exports
<span class="token keyword">var</span> <span class="token function-variable function">load</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">module</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// å¯¼å‡ºçš„ä¸œè¥¿</span>
    <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">1</span>
    module<span class="token punctuation">.</span>exports <span class="token operator">=</span> a
    <span class="token keyword">return</span> module<span class="token punctuation">.</span>exports
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><blockquote><p>å†æ¥è¯´è¯´ <code>module.exports</code> å’Œ<code>exports</code>ï¼Œç”¨æ³•å…¶å®æ˜¯ç›¸ä¼¼çš„ï¼Œä½†æ˜¯ä¸èƒ½å¯¹ <code>exports</code> ç›´æ¥èµ‹å€¼ï¼Œä¸ä¼šæœ‰ä»»ä½•æ•ˆæœã€‚</p></blockquote> <blockquote><p>å¯¹äº <code>CommonJS</code> å’Œ <code>ES6</code> ä¸­çš„æ¨¡å—åŒ–çš„ä¸¤è€…åŒºåˆ«æ˜¯ï¼š</p></blockquote> <ul><li>å‰è€…æ”¯æŒåŠ¨æ€å¯¼å…¥ï¼Œä¹Ÿå°±æ˜¯ <code>require(${path}/xx.js)</code>ï¼Œåè€…ç›®å‰ä¸æ”¯æŒï¼Œä½†æ˜¯å·²æœ‰ææ¡ˆ,å‰è€…æ˜¯åŒæ­¥å¯¼å…¥ï¼Œå› ä¸ºç”¨äºæœåŠ¡ç«¯ï¼Œæ–‡ä»¶éƒ½åœ¨æœ¬åœ°ï¼ŒåŒæ­¥å¯¼å…¥å³ä½¿å¡ä½ä¸»çº¿ç¨‹å½±å“ä¹Ÿä¸å¤§ã€‚</li> <li>è€Œåè€…æ˜¯å¼‚æ­¥å¯¼å…¥ï¼Œå› ä¸ºç”¨äºæµè§ˆå™¨ï¼Œéœ€è¦ä¸‹è½½æ–‡ä»¶ï¼Œå¦‚æœä¹Ÿé‡‡ç”¨åŒæ­¥å¯¼å…¥ä¼šå¯¹æ¸²æŸ“æœ‰å¾ˆå¤§å½±å“</li> <li>å‰è€…åœ¨å¯¼å‡ºæ—¶éƒ½æ˜¯å€¼æ‹·è´ï¼Œå°±ç®—å¯¼å‡ºçš„å€¼å˜äº†ï¼Œå¯¼å…¥çš„å€¼ä¹Ÿä¸ä¼šæ”¹å˜ï¼Œæ‰€ä»¥å¦‚æœæƒ³æ›´æ–°å€¼ï¼Œå¿…é¡»é‡æ–°å¯¼å…¥ä¸€æ¬¡ã€‚</li> <li>ä½†æ˜¯åè€…é‡‡ç”¨å®æ—¶ç»‘å®šçš„æ–¹å¼ï¼Œå¯¼å…¥å¯¼å‡ºçš„å€¼éƒ½æŒ‡å‘åŒä¸€ä¸ªå†…å­˜åœ°å€ï¼Œæ‰€ä»¥å¯¼å…¥å€¼ä¼šè·Ÿéšå¯¼å‡ºå€¼å˜åŒ–</li> <li>åè€…ä¼šç¼–è¯‘æˆ <code>require/exports</code> æ¥æ‰§è¡Œçš„</li></ul> <p><strong>AMD</strong></p> <blockquote><p><code>AMD</code> æ˜¯ç”± <code>RequireJS</code> æå‡ºçš„</p></blockquote> <p><strong>AMD å’Œ CMD è§„èŒƒçš„åŒºåˆ«ï¼Ÿ</strong></p> <ul><li>ç¬¬ä¸€ä¸ªæ–¹é¢æ˜¯åœ¨æ¨¡å—å®šä¹‰æ—¶å¯¹ä¾èµ–çš„å¤„ç†ä¸åŒã€‚AMDæ¨å´‡ä¾èµ–å‰ç½®ï¼Œåœ¨å®šä¹‰æ¨¡å—çš„æ—¶å€™å°±è¦å£°æ˜å…¶ä¾èµ–çš„æ¨¡å—ã€‚è€Œ CMD æ¨å´‡å°±è¿‘ä¾èµ–ï¼Œåªæœ‰åœ¨ç”¨åˆ°æŸä¸ªæ¨¡å—çš„æ—¶å€™å†å» requireã€‚</li> <li>ç¬¬äºŒä¸ªæ–¹é¢æ˜¯å¯¹ä¾èµ–æ¨¡å—çš„æ‰§è¡Œæ—¶æœºå¤„ç†ä¸åŒã€‚é¦–å…ˆ AMD å’Œ CMD å¯¹äºæ¨¡å—çš„åŠ è½½æ–¹å¼éƒ½æ˜¯å¼‚æ­¥åŠ è½½ï¼Œä¸è¿‡å®ƒä»¬çš„åŒºåˆ«åœ¨äºæ¨¡å—çš„æ‰§è¡Œæ—¶æœºï¼ŒAMD åœ¨ä¾èµ–æ¨¡å—åŠ è½½å®Œæˆåå°±ç›´æ¥æ‰§è¡Œä¾èµ–æ¨¡å—ï¼Œä¾èµ–æ¨¡å—çš„æ‰§è¡Œé¡ºåºå’Œæˆ‘ä»¬ä¹¦å†™çš„é¡ºåºä¸ä¸€å®šä¸€è‡´ã€‚è€Œ CMDåœ¨ä¾èµ–æ¨¡å—åŠ è½½å®Œæˆåå¹¶ä¸æ‰§è¡Œï¼Œåªæ˜¯ä¸‹è½½è€Œå·²ï¼Œç­‰åˆ°æ‰€æœ‰çš„ä¾èµ–æ¨¡å—éƒ½åŠ è½½å¥½åï¼Œè¿›å…¥å›è°ƒå‡½æ•°é€»è¾‘ï¼Œé‡åˆ° require è¯­å¥çš„æ—¶å€™æ‰æ‰§è¡Œå¯¹åº”çš„æ¨¡å—ï¼Œè¿™æ ·æ¨¡å—çš„æ‰§è¡Œé¡ºåºå°±å’Œæˆ‘ä»¬ä¹¦å†™çš„é¡ºåºä¿æŒä¸€è‡´äº†ã€‚</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// CMD</span>
<span class="token function">define</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">require<span class="token punctuation">,</span> exports<span class="token punctuation">,</span> module</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"./a"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  a<span class="token punctuation">.</span><span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// æ­¤å¤„ç•¥å» 100 è¡Œ</span>
  <span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"./b"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ä¾èµ–å¯ä»¥å°±è¿‘ä¹¦å†™</span>
  b<span class="token punctuation">.</span><span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// AMD é»˜è®¤æ¨è</span>
<span class="token function">define</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"./a"</span><span class="token punctuation">,</span> <span class="token string">"./b"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ä¾èµ–å¿…é¡»ä¸€å¼€å§‹å°±å†™å¥½</span>
  a<span class="token punctuation">.</span><span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// æ­¤å¤„ç•¥å» 100 è¡Œ</span>
  b<span class="token punctuation">.</span><span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><ul><li><strong>AMD</strong>ï¼š<code>requirejs</code> åœ¨æ¨å¹¿è¿‡ç¨‹ä¸­å¯¹æ¨¡å—å®šä¹‰çš„è§„èŒƒåŒ–äº§å‡ºï¼Œæå‰æ‰§è¡Œï¼Œæ¨å´‡ä¾èµ–å‰ç½®</li> <li><strong>CMD</strong>ï¼š<code>seajs</code> åœ¨æ¨å¹¿è¿‡ç¨‹ä¸­å¯¹æ¨¡å—å®šä¹‰çš„è§„èŒƒåŒ–äº§å‡ºï¼Œå»¶è¿Ÿæ‰§è¡Œï¼Œæ¨å´‡ä¾èµ–å°±è¿‘</li> <li><strong>CommonJs</strong>ï¼šæ¨¡å—è¾“å‡ºçš„æ˜¯ä¸€ä¸ªå€¼çš„ <code>copy</code>ï¼Œè¿è¡Œæ—¶åŠ è½½ï¼ŒåŠ è½½çš„æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ˆ<code>module.exports</code> å±æ€§ï¼‰ï¼Œè¯¥å¯¹è±¡åªæœ‰åœ¨è„šæœ¬è¿è¡Œå®Œæ‰ä¼šç”Ÿæˆ</li> <li><strong>ES6 Module</strong>ï¼šæ¨¡å—è¾“å‡ºçš„æ˜¯ä¸€ä¸ªå€¼çš„å¼•ç”¨ï¼Œç¼–è¯‘æ—¶è¾“å‡ºæ¥å£ï¼Œ<code>ES6</code>æ¨¡å—ä¸æ˜¯å¯¹è±¡ï¼Œå®ƒå¯¹å¤–æ¥å£åªæ˜¯ä¸€ç§é™æ€å®šä¹‰ï¼Œåœ¨ä»£ç é™æ€è§£æé˜¶æ®µå°±ä¼šç”Ÿæˆã€‚</li></ul> <p><strong>è°ˆè°ˆå¯¹æ¨¡å—åŒ–å¼€å‘çš„ç†è§£</strong></p> <ul><li>æˆ‘å¯¹æ¨¡å—çš„ç†è§£æ˜¯ï¼Œä¸€ä¸ªæ¨¡å—æ˜¯å®ç°ä¸€ä¸ªç‰¹å®šåŠŸèƒ½çš„ä¸€ç»„æ–¹æ³•ã€‚åœ¨æœ€å¼€å§‹çš„æ—¶å€™ï¼Œjs åªå®ç°ä¸€äº›ç®€å•çš„åŠŸèƒ½ï¼Œæ‰€ä»¥å¹¶æ²¡æœ‰æ¨¡å—çš„æ¦‚å¿µï¼Œä½†éšç€ç¨‹åºè¶Šæ¥è¶Šå¤æ‚ï¼Œä»£ç çš„æ¨¡å—åŒ–å¼€å‘å˜å¾—è¶Šæ¥è¶Šé‡è¦ã€‚</li> <li>ç”±äºå‡½æ•°å…·æœ‰ç‹¬ç«‹ä½œç”¨åŸŸçš„ç‰¹ç‚¹ï¼Œæœ€åŸå§‹çš„å†™æ³•æ˜¯ä½¿ç”¨å‡½æ•°æ¥ä½œä¸ºæ¨¡å—ï¼Œå‡ ä¸ªå‡½æ•°ä½œä¸ºä¸€ä¸ªæ¨¡å—ï¼Œä½†æ˜¯è¿™ç§æ–¹å¼å®¹æ˜“é€ æˆå…¨å±€å˜é‡çš„æ±¡æŸ“ï¼Œå¹¶ä¸”æ¨¡å—é—´æ²¡æœ‰è”ç³»ã€‚</li> <li>åé¢æå‡ºäº†å¯¹è±¡å†™æ³•ï¼Œé€šè¿‡å°†å‡½æ•°ä½œä¸ºä¸€ä¸ªå¯¹è±¡çš„æ–¹æ³•æ¥å®ç°ï¼Œè¿™æ ·è§£å†³äº†ç›´æ¥ä½¿ç”¨å‡½æ•°ä½œä¸ºæ¨¡å—çš„ä¸€äº›ç¼ºç‚¹ï¼Œä½†æ˜¯è¿™ç§åŠæ³•ä¼šæš´éœ²æ‰€æœ‰çš„æ‰€æœ‰çš„æ¨¡å—æˆå‘˜ï¼Œå¤–éƒ¨ä»£ç å¯ä»¥ä¿®æ”¹å†…éƒ¨å±æ€§çš„å€¼ã€‚</li> <li>ç°åœ¨æœ€å¸¸ç”¨çš„æ˜¯ç«‹å³æ‰§è¡Œå‡½æ•°çš„å†™æ³•ï¼Œé€šè¿‡åˆ©ç”¨é—­åŒ…æ¥å®ç°æ¨¡å—ç§æœ‰ä½œç”¨åŸŸçš„å»ºç«‹ï¼ŒåŒæ—¶ä¸ä¼šå¯¹å…¨å±€ä½œç”¨åŸŸé€ æˆæ±¡æŸ“ã€‚</li></ul> <h3 id="_17-iterator"><a href="http://interview.poetries.top/docs/simply.html#_17-iterator" class="header-anchor">#</a> 17 Iterator</h3> <blockquote><p><code>Iterator</code>ï¼ˆè¿­ä»£å™¨ï¼‰æ˜¯ä¸€ç§æ¥å£ï¼Œä¹Ÿå¯ä»¥è¯´æ˜¯ä¸€ç§è§„èŒƒã€‚ä¸ºå„ç§ä¸åŒçš„æ•°æ®ç»“æ„æä¾›ç»Ÿä¸€çš„è®¿é—®æœºåˆ¶ã€‚ä»»ä½•æ•°æ®ç»“æ„åªè¦éƒ¨ç½²<code>Iterator</code>æ¥å£ï¼Œå°±å¯ä»¥å®Œæˆéå†æ“ä½œï¼ˆå³ä¾æ¬¡å¤„ç†è¯¥æ•°æ®ç»“æ„çš„æ‰€æœ‰æˆå‘˜ï¼‰ã€‚</p></blockquote> <p>Iteratorè¯­æ³•ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>iterator<span class="token punctuation">]</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p><code>[Symbol.iterator]</code> å±æ€§åæ˜¯å›ºå®šçš„å†™æ³•ï¼Œåªè¦æ‹¥æœ‰äº†è¯¥å±æ€§çš„å¯¹è±¡ï¼Œå°±èƒ½å¤Ÿç”¨è¿­ä»£å™¨çš„æ–¹å¼è¿›è¡Œéå†ã€‚</p></blockquote> <ul><li>è¿­ä»£å™¨çš„éå†æ–¹æ³•æ˜¯é¦–å…ˆè·å¾—ä¸€ä¸ªè¿­ä»£å™¨çš„æŒ‡é’ˆï¼Œåˆå§‹æ—¶è¯¥æŒ‡é’ˆæŒ‡å‘ç¬¬ä¸€æ¡æ•°æ®ä¹‹å‰ï¼Œæ¥ç€é€šè¿‡è°ƒç”¨ next æ–¹æ³•ï¼Œæ”¹å˜æŒ‡é’ˆçš„æŒ‡å‘ï¼Œè®©å…¶æŒ‡å‘ä¸‹ä¸€æ¡æ•°æ®</li> <li>æ¯ä¸€æ¬¡çš„ <code>next</code> éƒ½ä¼šè¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œè¯¥å¯¹è±¡æœ‰ä¸¤ä¸ªå±æ€§
<ul><li><code>value</code> ä»£è¡¨æƒ³è¦è·å–çš„æ•°æ®</li> <li><code>done</code> å¸ƒå°”å€¼ï¼Œfalseè¡¨ç¤ºå½“å‰æŒ‡é’ˆæŒ‡å‘çš„æ•°æ®æœ‰å€¼ï¼Œtrueè¡¨ç¤ºéå†å·²ç»ç»“æŸ</li></ul></li></ul> <p><strong>Iterator çš„ä½œç”¨æœ‰ä¸‰ä¸ªï¼š</strong></p> <ul><li>åˆ›å»ºä¸€ä¸ªæŒ‡é’ˆå¯¹è±¡ï¼ŒæŒ‡å‘å½“å‰æ•°æ®ç»“æ„çš„èµ·å§‹ä½ç½®ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œéå†å™¨å¯¹è±¡æœ¬è´¨ä¸Šï¼Œå°±æ˜¯ä¸€ä¸ªæŒ‡é’ˆå¯¹è±¡ã€‚</li> <li>ç¬¬ä¸€æ¬¡è°ƒç”¨æŒ‡é’ˆå¯¹è±¡çš„nextæ–¹æ³•ï¼Œå¯ä»¥å°†æŒ‡é’ˆæŒ‡å‘æ•°æ®ç»“æ„çš„ç¬¬ä¸€ä¸ªæˆå‘˜ã€‚</li> <li>ç¬¬äºŒæ¬¡è°ƒç”¨æŒ‡é’ˆå¯¹è±¡çš„nextæ–¹æ³•ï¼ŒæŒ‡é’ˆå°±æŒ‡å‘æ•°æ®ç»“æ„çš„ç¬¬äºŒä¸ªæˆå‘˜ã€‚</li> <li>ä¸æ–­è°ƒç”¨æŒ‡é’ˆå¯¹è±¡çš„nextæ–¹æ³•ï¼Œç›´åˆ°å®ƒæŒ‡å‘æ•°æ®ç»“æ„çš„ç»“æŸä½ç½®ã€‚</li></ul> <blockquote><p>æ¯ä¸€æ¬¡è°ƒç”¨nextæ–¹æ³•ï¼Œéƒ½ä¼šè¿”å›æ•°æ®ç»“æ„çš„å½“å‰æˆå‘˜çš„ä¿¡æ¯ã€‚å…·ä½“æ¥è¯´ï¼Œå°±æ˜¯è¿”å›ä¸€ä¸ªåŒ…å«valueå’Œdoneä¸¤ä¸ªå±æ€§çš„å¯¹è±¡ã€‚å…¶ä¸­ï¼Œvalueå±æ€§æ˜¯å½“å‰æˆå‘˜çš„å€¼ï¼Œdoneå±æ€§æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºéå†æ˜¯å¦ç»“æŸã€‚</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>num<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span>
<span class="token keyword">let</span> it <span class="token operator">=</span> arr<span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>iterator<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// è·å–æ•°ç»„ä¸­çš„è¿­ä»£å™¨</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>it<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">// { value: Object { num: 1 }, done: false }</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>it<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">// { value: 2, done: false }</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>it<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">// { value: 3, done: false }</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>it<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">// { value: undefined, done: true }</span>
</code></pre></div><blockquote><p>å¯¹è±¡æ²¡æœ‰å¸ƒå±€Iteratoræ¥å£ï¼Œæ— æ³•ä½¿ç”¨<code>for of</code> éå†ã€‚ä¸‹é¢ä½¿å¾—å¯¹è±¡å…·å¤‡Iteratoræ¥å£</p></blockquote> <ul><li>ä¸€ä¸ªæ•°æ®ç»“æ„åªè¦æœ‰Symbol.iteratorå±æ€§ï¼Œå°±å¯ä»¥è®¤ä¸ºæ˜¯â€œå¯éå†çš„â€</li> <li>åŸå‹éƒ¨ç½²äº†Iteratoræ¥å£çš„æ•°æ®ç»“æ„æœ‰ä¸‰ç§ï¼Œå…·ä½“åŒ…å«å››ç§ï¼Œåˆ†åˆ«æ˜¯æ•°ç»„ï¼Œç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ï¼ŒSetå’ŒMapç»“æ„</li></ul> <p><strong>ä¸ºä»€ä¹ˆå¯¹è±¡ï¼ˆObjectï¼‰æ²¡æœ‰éƒ¨ç½²Iteratoræ¥å£å‘¢ï¼Ÿ</strong></p> <ul><li>ä¸€æ˜¯å› ä¸ºå¯¹è±¡çš„å“ªä¸ªå±æ€§å…ˆéå†ï¼Œå“ªä¸ªå±æ€§åéå†æ˜¯ä¸ç¡®å®šçš„ï¼Œéœ€è¦å¼€å‘è€…æ‰‹åŠ¨æŒ‡å®šã€‚ç„¶è€Œéå†éå†å™¨æ˜¯ä¸€ç§çº¿æ€§å¤„ç†ï¼Œå¯¹äºéçº¿æ€§çš„æ•°æ®ç»“æ„ï¼Œéƒ¨ç½²éå†å™¨æ¥å£ï¼Œå°±ç­‰äºè¦éƒ¨ç½²ä¸€ç§çº¿æ€§è½¬æ¢</li> <li>å¯¹å¯¹è±¡éƒ¨ç½²<code>Iterator</code>æ¥å£å¹¶ä¸æ˜¯å¾ˆå¿…è¦ï¼Œå› ä¸º<code>Map</code>å¼¥è¡¥äº†å®ƒçš„ç¼ºé™·ï¼Œåˆæ­£å¥½æœ‰<code>Iteraotr</code>æ¥å£</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
    id<span class="token operator">:</span> <span class="token string">'123'</span><span class="token punctuation">,</span>
    name<span class="token operator">:</span> <span class="token string">'å¼ ä¸‰'</span><span class="token punctuation">,</span>
    age<span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
    gender<span class="token operator">:</span> <span class="token string">'ç”·'</span><span class="token punctuation">,</span>
    hobbie<span class="token operator">:</span> <span class="token string">'ç¡è§‰'</span>
<span class="token punctuation">}</span>

obj<span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>iterator<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> keyArr <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span>
    <span class="token keyword">let</span> index <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
        <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> index <span class="token operator">&lt;</span> keyArr<span class="token punctuation">.</span>length <span class="token operator">?</span> <span class="token punctuation">{</span>
                value<span class="token operator">:</span> <span class="token punctuation">{</span>
                    key<span class="token operator">:</span> keyArr<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">,</span>
                    val<span class="token operator">:</span> obj<span class="token punctuation">[</span>keyArr<span class="token punctuation">[</span>index<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
                done<span class="token operator">:</span> <span class="token boolean">true</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> key <span class="token keyword">of</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p><img src="./è¿›é˜¶_files/20210407141323.png" alt="" class="medium-zoom-image"></p> <h3 id="_18-generator"><a href="http://interview.poetries.top/docs/simply.html#_18-generator" class="header-anchor">#</a> 18 Generator</h3> <blockquote><p><code>Generator</code> æ˜¯ <code>ES6</code>ä¸­æ–°å¢çš„è¯­æ³•ï¼Œå’Œ <code>Promise</code> ä¸€æ ·ï¼Œéƒ½å¯ä»¥ç”¨æ¥å¼‚æ­¥ç¼–ç¨‹ã€‚Generatorå‡½æ•°å¯ä»¥è¯´æ˜¯Iteratoræ¥å£çš„å…·ä½“å®ç°æ–¹å¼ã€‚Generator æœ€å¤§çš„ç‰¹ç‚¹å°±æ˜¯å¯ä»¥æ§åˆ¶å‡½æ•°çš„æ‰§è¡Œã€‚</p></blockquote> <ul><li><code>function*</code> ç”¨æ¥å£°æ˜ä¸€ä¸ªå‡½æ•°æ˜¯ç”Ÿæˆå™¨å‡½æ•°ï¼Œå®ƒæ¯”æ™®é€šçš„å‡½æ•°å£°æ˜å¤šäº†ä¸€ä¸ª<code>*</code>,<code>*</code>çš„ä½ç½®æ¯”è¾ƒéšæ„å¯ä»¥æŒ¨ç€ <code>function</code> å…³é”®å­—ï¼Œä¹Ÿå¯ä»¥æŒ¨ç€å‡½æ•°å</li> <li><code>yield</code> äº§å‡ºçš„æ„æ€ï¼Œè¿™ä¸ªå…³é”®å­—åªèƒ½å‡ºç°åœ¨ç”Ÿæˆå™¨å‡½æ•°ä½“å†…ï¼Œä½†æ˜¯ç”Ÿæˆå™¨ä¸­ä¹Ÿå¯ä»¥æ²¡æœ‰<code>yield</code> å…³é”®å­—ï¼Œå‡½æ•°é‡åˆ° <code>yield</code> çš„æ—¶å€™ä¼šæš‚åœï¼Œå¹¶æŠŠ <code>yield</code> åé¢çš„è¡¨è¾¾å¼ç»“æœæŠ›å‡ºå»</li> <li><code>next</code>ä½œç”¨æ˜¯å°†ä»£ç çš„æ§åˆ¶æƒäº¤è¿˜ç»™ç”Ÿæˆå™¨å‡½æ•°</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token operator">*</span><span class="token function">foo</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> y <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token keyword">yield</span> <span class="token punctuation">(</span>x <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token keyword">let</span> z <span class="token operator">=</span> <span class="token keyword">yield</span> <span class="token punctuation">(</span>y <span class="token operator">/</span> <span class="token number">3</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>x <span class="token operator">+</span> y <span class="token operator">+</span> z<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> it <span class="token operator">=</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>it<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>   <span class="token comment">// =&gt; {value: 6, done: false}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>it<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// =&gt; {value: 8, done: false}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>it<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// =&gt; {value: 42, done: true}</span>
</code></pre></div><p>ä¸Šé¢è¿™ä¸ªç¤ºä¾‹å°±æ˜¯ä¸€ä¸ªGeneratorå‡½æ•°ï¼Œæˆ‘ä»¬æ¥åˆ†æå…¶æ‰§è¡Œè¿‡ç¨‹ï¼š</p> <ul><li>é¦–å…ˆ Generator å‡½æ•°è°ƒç”¨æ—¶å®ƒä¼šè¿”å›ä¸€ä¸ªè¿­ä»£å™¨</li> <li>å½“æ‰§è¡Œç¬¬ä¸€æ¬¡ next æ—¶ï¼Œä¼ å‚ä¼šè¢«å¿½ç•¥ï¼Œå¹¶ä¸”å‡½æ•°æš‚åœåœ¨ yield (x + 1) å¤„ï¼Œæ‰€ä»¥è¿”å› 5 + 1 = 6</li> <li>å½“æ‰§è¡Œç¬¬äºŒæ¬¡ next æ—¶ï¼Œä¼ å…¥çš„å‚æ•°ç­‰äºä¸Šä¸€ä¸ª yield çš„è¿”å›å€¼ï¼Œå¦‚æœä½ ä¸ä¼ å‚ï¼Œyield æ°¸è¿œè¿”å› undefinedã€‚æ­¤æ—¶ let y = 2 * 12ï¼Œæ‰€ä»¥ç¬¬äºŒä¸ª yield ç­‰äº 2 * 12 / 3 = 8</li> <li>å½“æ‰§è¡Œç¬¬ä¸‰æ¬¡ next æ—¶ï¼Œä¼ å…¥çš„å‚æ•°ä¼šä¼ é€’ç»™ zï¼Œæ‰€ä»¥ z = 13, x = 5, y = 24ï¼Œç›¸åŠ ç­‰äº 42</li></ul> <p><code>yield</code>å®é™…å°±æ˜¯æš‚ç¼“æ‰§è¡Œçš„æ ‡ç¤ºï¼Œæ¯æ‰§è¡Œä¸€æ¬¡<code>next()</code>ï¼Œç›¸å½“äºæŒ‡é’ˆç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ª<code>yield</code>ä½ç½®</p> <p><img src="./è¿›é˜¶_files/20210408100806.png" alt="" class="medium-zoom-image"></p> <blockquote><p><strong>æ€»ç»“ä¸€ä¸‹</strong>ï¼Œ<code>Generator</code>å‡½æ•°æ˜¯<code>ES6</code>æä¾›çš„ä¸€ç§å¼‚æ­¥ç¼–ç¨‹è§£å†³æ–¹æ¡ˆã€‚é€šè¿‡<code>yield</code>æ ‡è¯†ä½å’Œ<code>next()</code>æ–¹æ³•è°ƒç”¨ï¼Œå®ç°å‡½æ•°çš„åˆ†æ®µæ‰§è¡Œ</p></blockquote> <p><strong>éå†å™¨å¯¹è±¡ç”Ÿæˆå‡½æ•°ï¼Œæœ€å¤§çš„ç‰¹ç‚¹æ˜¯å¯ä»¥äº¤å‡ºå‡½æ•°çš„æ‰§è¡Œæƒ</strong></p> <ul><li><code>function</code> å…³é”®å­—ä¸å‡½æ•°åä¹‹é—´æœ‰ä¸€ä¸ªæ˜Ÿå·ï¼›</li> <li>å‡½æ•°ä½“å†…éƒ¨ä½¿ç”¨ <code>yield</code>è¡¨è¾¾å¼ï¼Œå®šä¹‰ä¸åŒçš„å†…éƒ¨çŠ¶æ€ï¼›</li> <li><code>next</code>æŒ‡é’ˆç§»å‘ä¸‹ä¸€ä¸ªçŠ¶æ€</li></ul> <blockquote><p>è¿™é‡Œä½ å¯ä»¥è¯´è¯´ <code>Generator</code>çš„å¼‚æ­¥ç¼–ç¨‹ï¼Œä»¥åŠå®ƒçš„è¯­æ³•ç³– <code>async</code> å’Œ <code>awiat</code>ï¼Œä¼ ç»Ÿçš„å¼‚æ­¥ç¼–ç¨‹ã€‚<code>ES6</code> ä¹‹å‰ï¼Œå¼‚æ­¥ç¼–ç¨‹å¤§è‡´å¦‚ä¸‹</p></blockquote> <ul><li>å›è°ƒå‡½æ•°</li> <li>äº‹ä»¶ç›‘å¬</li> <li>å‘å¸ƒ/è®¢é˜…</li></ul> <blockquote><p>ä¼ ç»Ÿå¼‚æ­¥ç¼–ç¨‹æ–¹æ¡ˆä¹‹ä¸€ï¼šåç¨‹ï¼Œå¤šä¸ªçº¿ç¨‹äº’ç›¸åä½œï¼Œå®Œæˆå¼‚æ­¥ä»»åŠ¡ã€‚</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// ä½¿ç”¨ * è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ª Generator å‡½æ•°</span>
<span class="token comment">// å†…éƒ¨å¯ä»¥é€šè¿‡ yield æš‚åœä»£ç </span>
<span class="token comment">// é€šè¿‡è°ƒç”¨ next æ¢å¤æ‰§è¡Œ</span>
<span class="token keyword">function</span><span class="token operator">*</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">;</span>
  <span class="token keyword">yield</span> <span class="token number">2</span><span class="token punctuation">;</span>
  <span class="token keyword">yield</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> b <span class="token operator">=</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &gt;  { value: 2, done: false }</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &gt;  { value: 3, done: false }</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &gt;  { value: undefined, done: true }</span>
</code></pre></div><blockquote><p>ä»ä»¥ä¸Šä»£ç å¯ä»¥å‘ç°ï¼ŒåŠ ä¸Š <code>*</code>çš„å‡½æ•°æ‰§è¡Œåæ‹¥æœ‰äº† <code>next</code> å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯è¯´å‡½æ•°æ‰§è¡Œåè¿”å›äº†ä¸€ä¸ªå¯¹è±¡ã€‚æ¯æ¬¡è°ƒç”¨ <code>next</code> å‡½æ•°å¯ä»¥ç»§ç»­æ‰§è¡Œè¢«æš‚åœçš„ä»£ç ã€‚ä»¥ä¸‹æ˜¯ <code>Generator</code> å‡½æ•°çš„ç®€å•å®ç°</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// cb ä¹Ÿå°±æ˜¯ç¼–è¯‘è¿‡çš„ test å‡½æ•°</span>
<span class="token keyword">function</span> <span class="token function">generator</span><span class="token punctuation">(</span><span class="token parameter">cb</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{</span>
      next<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      <span class="token function-variable function">stop</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      <span class="token function-variable function">next</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> ret <span class="token operator">=</span> <span class="token function">cb</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>ret <span class="token operator">===</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token punctuation">{</span> value<span class="token operator">:</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span> done<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
          value<span class="token operator">:</span> ret<span class="token punctuation">,</span>
          done<span class="token operator">:</span> <span class="token boolean">false</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// å¦‚æœä½ ä½¿ç”¨ babel ç¼–è¯‘åå¯ä»¥å‘ç° test å‡½æ•°å˜æˆäº†è¿™æ ·</span>
<span class="token keyword">function</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> a<span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token function">generator</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">_context</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">switch</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>_context<span class="token punctuation">.</span>prev <span class="token operator">=</span> _context<span class="token punctuation">.</span>next<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// å¯ä»¥å‘ç°é€šè¿‡ yield å°†ä»£ç åˆ†å‰²æˆå‡ å—</span>
        <span class="token comment">// æ¯æ¬¡æ‰§è¡Œ next å‡½æ•°å°±æ‰§è¡Œä¸€å—ä»£ç </span>
        <span class="token comment">// å¹¶ä¸”è¡¨æ˜ä¸‹æ¬¡éœ€è¦æ‰§è¡Œå“ªå—ä»£ç </span>
        <span class="token keyword">case</span> <span class="token number">0</span><span class="token operator">:</span>
          a <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">;</span>
          _context<span class="token punctuation">.</span>next <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>
          <span class="token keyword">return</span> <span class="token number">2</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token number">4</span><span class="token operator">:</span>
          _context<span class="token punctuation">.</span>next <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span>
          <span class="token keyword">return</span> <span class="token number">3</span><span class="token punctuation">;</span>
		<span class="token comment">// æ‰§è¡Œå®Œæ¯•</span>
        <span class="token keyword">case</span> <span class="token number">6</span><span class="token operator">:</span>
        <span class="token keyword">case</span> <span class="token string">"end"</span><span class="token operator">:</span>
          <span class="token keyword">return</span> _context<span class="token punctuation">.</span><span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_19-async-await"><a href="http://interview.poetries.top/docs/simply.html#_19-async-await" class="header-anchor">#</a> 19 async/await</h3> <blockquote><p><code>Generator</code> å‡½æ•°çš„è¯­æ³•ç³–ã€‚æœ‰æ›´å¥½çš„è¯­ä¹‰ã€æ›´å¥½çš„é€‚ç”¨æ€§ã€è¿”å›å€¼æ˜¯ <code>Promise</code>ã€‚</p></blockquote> <ul><li>await å’Œ promise ä¸€æ ·ï¼Œæ›´å¤šçš„æ˜¯è€ƒç¬”è¯•é¢˜ï¼Œå½“ç„¶å¶å°”ä¹Ÿä¼šé—®åˆ°å’Œ promise çš„ä¸€äº›åŒºåˆ«ã€‚</li> <li>await ç›¸æ¯”ç›´æ¥ä½¿ç”¨ Promise æ¥è¯´ï¼Œä¼˜åŠ¿åœ¨äºå¤„ç† then çš„è°ƒç”¨é“¾ï¼Œèƒ½å¤Ÿæ›´æ¸…æ™°å‡†ç¡®çš„å†™å‡ºä»£ç ã€‚ç¼ºç‚¹åœ¨äºæ»¥ç”¨ await å¯èƒ½ä¼šå¯¼è‡´æ€§èƒ½é—®é¢˜ï¼Œå› ä¸º await ä¼šé˜»å¡ä»£ç ï¼Œä¹Ÿè®¸ä¹‹åçš„å¼‚æ­¥ä»£ç å¹¶ä¸ä¾èµ–äºå‰è€…ï¼Œä½†ä»ç„¶éœ€è¦ç­‰å¾…å‰è€…å®Œæˆï¼Œå¯¼è‡´ä»£ç å¤±å»äº†å¹¶å‘æ€§ï¼Œæ­¤æ—¶æ›´åº”è¯¥ä½¿ç”¨ Promise.allã€‚</li> <li>ä¸€ä¸ªå‡½æ•°å¦‚æœåŠ ä¸Š async ï¼Œé‚£ä¹ˆè¯¥å‡½æ•°å°±ä¼šè¿”å›ä¸€ä¸ª Promise</li></ul> <blockquote><ul><li><code>async =&gt; *</code></li> <li><code>await =&gt; yield</code></li></ul></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// åŸºæœ¬ç”¨æ³•</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">timeout</span> <span class="token punctuation">(</span><span class="token parameter">ms</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> ms<span class="token punctuation">)</span>    
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">asyncConsole</span> <span class="token punctuation">(</span><span class="token parameter">value<span class="token punctuation">,</span> ms</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">await</span> <span class="token function">timeout</span><span class="token punctuation">(</span>ms<span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">asyncConsole</span><span class="token punctuation">(</span><span class="token string">'hello async and await'</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
</code></pre></div><p>ä¸‹é¢æ¥çœ‹ä¸€ä¸ªä½¿ç”¨ <code>await</code> çš„ä»£ç ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">var</span> <span class="token function-variable function">b</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  a <span class="token operator">=</span> a <span class="token operator">+</span> <span class="token keyword">await</span> <span class="token number">10</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'2'</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span> <span class="token comment">// -&gt; '2' 10</span>
  a <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">await</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">+</span> a
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'3'</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span> <span class="token comment">// -&gt; '3' 20</span>
<span class="token punctuation">}</span>
<span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
a<span class="token operator">++</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1'</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span> <span class="token comment">// -&gt; '1' 1</span>
</code></pre></div><ul><li>é¦–å…ˆå‡½æ•°<code>b</code> å…ˆæ‰§è¡Œï¼Œåœ¨æ‰§è¡Œåˆ° <code>await 10</code> ä¹‹å‰å˜é‡ <code>a</code> è¿˜æ˜¯ <code>0</code>ï¼Œå› ä¸ºåœ¨ <code>await</code> å†…éƒ¨å®ç°äº† <code>generators</code> ï¼Œ<code>generators</code> ä¼šä¿ç•™å †æ ˆä¸­ä¸œè¥¿ï¼Œæ‰€ä»¥è¿™æ—¶å€™ <code>a = 0</code> è¢«ä¿å­˜äº†ä¸‹æ¥</li> <li>å› ä¸º <code>await</code> æ˜¯å¼‚æ­¥æ“ä½œï¼Œé‡åˆ°<code>await</code>å°±ä¼šç«‹å³è¿”å›ä¸€ä¸ª<code>pending</code>çŠ¶æ€çš„<code>Promise</code>å¯¹è±¡ï¼Œæš‚æ—¶è¿”å›æ‰§è¡Œä»£ç çš„æ§åˆ¶æƒï¼Œä½¿å¾—å‡½æ•°å¤–çš„ä»£ç å¾—ä»¥ç»§ç»­æ‰§è¡Œï¼Œæ‰€ä»¥ä¼šå…ˆæ‰§è¡Œ <code>console.log('1', a)</code></li> <li>è¿™æ—¶å€™åŒæ­¥ä»£ç æ‰§è¡Œå®Œæ¯•ï¼Œå¼€å§‹æ‰§è¡Œå¼‚æ­¥ä»£ç ï¼Œå°†ä¿å­˜ä¸‹æ¥çš„å€¼æ‹¿å‡ºæ¥ä½¿ç”¨ï¼Œè¿™æ—¶å€™ <code>a = 10</code></li> <li>ç„¶ååé¢å°±æ˜¯å¸¸è§„æ‰§è¡Œä»£ç äº†</li></ul> <p><strong>ä¼˜ç¼ºç‚¹ï¼š</strong></p> <blockquote><p><code>async/await</code>çš„ä¼˜åŠ¿åœ¨äºå¤„ç† then çš„è°ƒç”¨é“¾ï¼Œèƒ½å¤Ÿæ›´æ¸…æ™°å‡†ç¡®çš„å†™å‡ºä»£ç ï¼Œå¹¶ä¸”ä¹Ÿèƒ½ä¼˜é›…åœ°è§£å†³å›è°ƒåœ°ç‹±é—®é¢˜ã€‚å½“ç„¶ä¹Ÿå­˜åœ¨ä¸€äº›ç¼ºç‚¹ï¼Œå› ä¸º await å°†å¼‚æ­¥ä»£ç æ”¹é€ æˆäº†åŒæ­¥ä»£ç ï¼Œå¦‚æœå¤šä¸ªå¼‚æ­¥ä»£ç æ²¡æœ‰ä¾èµ–æ€§å´ä½¿ç”¨äº† await ä¼šå¯¼è‡´æ€§èƒ½ä¸Šçš„é™ä½ã€‚</p></blockquote> <p><strong>asyncåŸç†</strong></p> <blockquote><p><code>async/await</code>è¯­æ³•ç³–å°±æ˜¯ä½¿ç”¨<code>Generator</code>å‡½æ•°+è‡ªåŠ¨æ‰§è¡Œå™¨æ¥è¿ä½œçš„</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// å®šä¹‰äº†ä¸€ä¸ªpromiseï¼Œç”¨æ¥æ¨¡æ‹Ÿå¼‚æ­¥è¯·æ±‚ï¼Œä½œç”¨æ˜¯ä¼ å…¥å‚æ•°++</span>
<span class="token keyword">function</span> <span class="token function">getNum</span><span class="token punctuation">(</span><span class="token parameter">num</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token function">resolve</span><span class="token punctuation">(</span>num<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">//è‡ªåŠ¨æ‰§è¡Œå™¨ï¼Œå¦‚æœä¸€ä¸ªGeneratorå‡½æ•°æ²¡æœ‰æ‰§è¡Œå®Œï¼Œåˆ™é€’å½’è°ƒç”¨</span>
<span class="token keyword">function</span> <span class="token function">asyncFun</span><span class="token punctuation">(</span><span class="token parameter">func</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">var</span> gen <span class="token operator">=</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">function</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> result <span class="token operator">=</span> gen<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span>done<span class="token punctuation">)</span> <span class="token keyword">return</span> result<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
    result<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token function">next</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// æ‰€éœ€è¦æ‰§è¡Œçš„Generatorå‡½æ•°ï¼Œå†…éƒ¨çš„æ•°æ®åœ¨æ‰§è¡Œå®Œæˆä¸€æ­¥çš„promiseä¹‹åï¼Œå†è°ƒç”¨ä¸‹ä¸€æ­¥</span>
<span class="token keyword">var</span> <span class="token function-variable function">func</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token operator">*</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">var</span> f1 <span class="token operator">=</span> <span class="token keyword">yield</span> <span class="token function">getNum</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> f2 <span class="token operator">=</span> <span class="token keyword">yield</span> <span class="token function">getNum</span><span class="token punctuation">(</span>f1<span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>f2<span class="token punctuation">)</span> <span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token function">asyncFun</span><span class="token punctuation">(</span>func<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>åœ¨æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œåˆ¤æ–­ä¸€ä¸ªå‡½æ•°çš„<code>promise</code>æ˜¯å¦å®Œæˆï¼Œå¦‚æœå·²ç»å®Œæˆï¼Œå°†ç»“æœä¼ å…¥ä¸‹ä¸€ä¸ªå‡½æ•°ï¼Œç»§ç»­é‡å¤æ­¤æ­¥éª¤</li> <li>æ¯ä¸€ä¸ª <code>next()</code> æ–¹æ³•è¿”å›å€¼çš„ <code>value</code> å±æ€§ä¸ºä¸€ä¸ª <code>Promise</code> å¯¹è±¡ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸ºå…¶æ·»åŠ  <code>then</code> æ–¹æ³•ï¼Œ åœ¨ <code>then</code> æ–¹æ³•é‡Œé¢æ¥ç€è¿è¡Œ <code>next</code> æ–¹æ³•æŒªç§»éå†å™¨æŒ‡é’ˆï¼Œç›´åˆ° <code>Generator</code>å‡½æ•°è¿è¡Œå®Œæˆ</li></ul> <h3 id="_20-proxy"><a href="http://interview.poetries.top/docs/simply.html#_20-proxy" class="header-anchor">#</a> 20 Proxy</h3> <blockquote><p>proxyåœ¨ç›®æ ‡å¯¹è±¡çš„å¤–å±‚æ­å»ºäº†ä¸€å±‚æ‹¦æˆªï¼Œå¤–ç•Œå¯¹ç›®æ ‡å¯¹è±¡çš„æŸäº›æ“ä½œï¼Œå¿…é¡»é€šè¿‡è¿™å±‚æ‹¦æˆª</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> handler<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><blockquote><p><code>new Proxy()</code>è¡¨ç¤ºç”Ÿæˆä¸€ä¸ªProxyå®ä¾‹ï¼Œ<code>target</code>å‚æ•°è¡¨ç¤ºæ‰€è¦æ‹¦æˆªçš„ç›®æ ‡å¯¹è±¡ï¼Œ<code>handler</code>å‚æ•°ä¹Ÿæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œç”¨æ¥å®šåˆ¶æ‹¦æˆªè¡Œä¸º</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> target <span class="token operator">=</span> <span class="token punctuation">{</span>
   name<span class="token operator">:</span> <span class="token string">'poetries'</span>
 <span class="token punctuation">}</span><span class="token punctuation">;</span>
 <span class="token keyword">var</span> logHandler <span class="token operator">=</span> <span class="token punctuation">{</span>
   <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> key</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>key<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> è¢«è¯»å–</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token keyword">return</span> target<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span><span class="token punctuation">,</span>
   <span class="token function-variable function">set</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>key<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> è¢«è®¾ç½®ä¸º </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>value<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     target<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> value<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
 <span class="token punctuation">}</span>
 <span class="token keyword">var</span> targetWithLog <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> logHandler<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
 targetWithLog<span class="token punctuation">.</span>name<span class="token punctuation">;</span> <span class="token comment">// æ§åˆ¶å°è¾“å‡ºï¼šname è¢«è¯»å–</span>
 targetWithLog<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'others'</span><span class="token punctuation">;</span> <span class="token comment">// æ§åˆ¶å°è¾“å‡ºï¼šname è¢«è®¾ç½®ä¸º others</span>
 
 console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>target<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æ§åˆ¶å°è¾“å‡º: others</span>
</code></pre></div><ul><li><code>targetWithLog</code> è¯»å–å±æ€§çš„å€¼æ—¶ï¼Œå®é™…ä¸Šæ‰§è¡Œçš„æ˜¯ <code>logHandler.get</code> ï¼šåœ¨æ§åˆ¶å°è¾“å‡ºä¿¡æ¯ï¼Œå¹¶ä¸”è¯»å–è¢«ä»£ç†å¯¹è±¡ <code>target</code> çš„å±æ€§ã€‚</li> <li>åœ¨ <code>targetWithLog</code> è®¾ç½®å±æ€§å€¼æ—¶ï¼Œå®é™…ä¸Šæ‰§è¡Œçš„æ˜¯ <code>logHandler.set</code> ï¼šåœ¨æ§åˆ¶å°è¾“å‡ºä¿¡æ¯ï¼Œå¹¶ä¸”è®¾ç½®è¢«ä»£ç†å¯¹è±¡ <code>target</code> çš„å±æ€§çš„å€¼</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// ç”±äºæ‹¦æˆªå‡½æ•°æ€»æ˜¯è¿”å›35ï¼Œæ‰€ä»¥è®¿é—®ä»»ä½•å±æ€§éƒ½å¾—åˆ°35</span>
<span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> property</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token number">35</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

proxy<span class="token punctuation">.</span>time <span class="token comment">// 35</span>
proxy<span class="token punctuation">.</span>name <span class="token comment">// 35</span>
proxy<span class="token punctuation">.</span>title <span class="token comment">// 35</span>
</code></pre></div><p><strong>Proxy å®ä¾‹ä¹Ÿå¯ä»¥ä½œä¸ºå…¶ä»–å¯¹è±¡çš„åŸå‹å¯¹è±¡</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> property</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token number">35</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> obj <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>proxy<span class="token punctuation">)</span><span class="token punctuation">;</span>
obj<span class="token punctuation">.</span>time <span class="token comment">// 35</span>
</code></pre></div><blockquote><p><code>proxy</code>å¯¹è±¡æ˜¯<code>obj</code>å¯¹è±¡çš„åŸå‹ï¼Œ<code>obj</code>å¯¹è±¡æœ¬èº«å¹¶æ²¡æœ‰<code>time</code>å±æ€§ï¼Œæ‰€ä»¥æ ¹æ®åŸå‹é“¾ï¼Œä¼šåœ¨<code>proxy</code>å¯¹è±¡ä¸Šè¯»å–è¯¥å±æ€§ï¼Œå¯¼è‡´è¢«æ‹¦æˆª</p></blockquote> <p><strong>Proxyçš„ä½œç”¨</strong></p> <blockquote><p>å¯¹äºä»£ç†æ¨¡å¼ <code>Proxy</code> çš„ä½œç”¨ä¸»è¦ä½“ç°åœ¨ä¸‰ä¸ªæ–¹é¢</p></blockquote> <ul><li>æ‹¦æˆªå’Œç›‘è§†å¤–éƒ¨å¯¹å¯¹è±¡çš„è®¿é—®</li> <li>é™ä½å‡½æ•°æˆ–ç±»çš„å¤æ‚åº¦</li> <li>åœ¨å¤æ‚æ“ä½œå‰å¯¹æ“ä½œè¿›è¡Œæ ¡éªŒæˆ–å¯¹æ‰€éœ€èµ„æºè¿›è¡Œç®¡ç†</li></ul> <p><strong>Proxyæ‰€èƒ½ä»£ç†çš„èŒƒå›´--handler</strong></p> <blockquote><p>å®é™…ä¸Š handler æœ¬èº«å°±æ˜¯ES6æ‰€æ–°è®¾è®¡çš„ä¸€ä¸ªå¯¹è±¡.å®ƒçš„ä½œç”¨å°±æ˜¯ç”¨æ¥ è‡ªå®šä¹‰ä»£ç†å¯¹è±¡çš„å„ç§å¯ä»£ç†æ“ä½œ ã€‚å®ƒæœ¬èº«ä¸€å…±æœ‰13ä¸­æ–¹æ³•,æ¯ç§æ–¹æ³•éƒ½å¯ä»¥ä»£ç†ä¸€ç§æ“ä½œ.å…¶13ç§æ–¹æ³•å¦‚ä¸‹</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// åœ¨è¯»å–ä»£ç†å¯¹è±¡çš„åŸå‹æ—¶è§¦å‘è¯¥æ“ä½œï¼Œæ¯”å¦‚åœ¨æ‰§è¡Œ Object.getPrototypeOf(proxy) æ—¶ã€‚</span>
handler<span class="token punctuation">.</span><span class="token function">getPrototypeOf</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// åœ¨è®¾ç½®ä»£ç†å¯¹è±¡çš„åŸå‹æ—¶è§¦å‘è¯¥æ“ä½œï¼Œæ¯”å¦‚åœ¨æ‰§è¡Œ Object.setPrototypeOf(proxy, null) æ—¶ã€‚</span>
handler<span class="token punctuation">.</span><span class="token function">setPrototypeOf</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

 
<span class="token comment">// åœ¨åˆ¤æ–­ä¸€ä¸ªä»£ç†å¯¹è±¡æ˜¯å¦æ˜¯å¯æ‰©å±•æ—¶è§¦å‘è¯¥æ“ä½œï¼Œæ¯”å¦‚åœ¨æ‰§è¡Œ Object.isExtensible(proxy) æ—¶ã€‚</span>
handler<span class="token punctuation">.</span><span class="token function">isExtensible</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

 
<span class="token comment">// åœ¨è®©ä¸€ä¸ªä»£ç†å¯¹è±¡ä¸å¯æ‰©å±•æ—¶è§¦å‘è¯¥æ“ä½œï¼Œæ¯”å¦‚åœ¨æ‰§è¡Œ Object.preventExtensions(proxy) æ—¶ã€‚</span>
handler<span class="token punctuation">.</span><span class="token function">preventExtensions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// åœ¨è·å–ä»£ç†å¯¹è±¡æŸä¸ªå±æ€§çš„å±æ€§æè¿°æ—¶è§¦å‘è¯¥æ“ä½œï¼Œæ¯”å¦‚åœ¨æ‰§è¡Œ Object.getOwnPropertyDescriptor(proxy, "foo") æ—¶ã€‚</span>
handler<span class="token punctuation">.</span><span class="token function">getOwnPropertyDescriptor</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

 
<span class="token comment">// åœ¨å®šä¹‰ä»£ç†å¯¹è±¡æŸä¸ªå±æ€§æ—¶çš„å±æ€§æè¿°æ—¶è§¦å‘è¯¥æ“ä½œï¼Œæ¯”å¦‚åœ¨æ‰§è¡Œ Object.defineProperty(proxy, "foo", {}) æ—¶ã€‚</span>
andler<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

 
<span class="token comment">// åœ¨åˆ¤æ–­ä»£ç†å¯¹è±¡æ˜¯å¦æ‹¥æœ‰æŸä¸ªå±æ€§æ—¶è§¦å‘è¯¥æ“ä½œï¼Œæ¯”å¦‚åœ¨æ‰§è¡Œ "foo" in proxy æ—¶ã€‚</span>
handler<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// åœ¨è¯»å–ä»£ç†å¯¹è±¡çš„æŸä¸ªå±æ€§æ—¶è§¦å‘è¯¥æ“ä½œï¼Œæ¯”å¦‚åœ¨æ‰§è¡Œ proxy.foo æ—¶ã€‚</span>
handler<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

 
<span class="token comment">// åœ¨ç»™ä»£ç†å¯¹è±¡çš„æŸä¸ªå±æ€§èµ‹å€¼æ—¶è§¦å‘è¯¥æ“ä½œï¼Œæ¯”å¦‚åœ¨æ‰§è¡Œ proxy.foo = 1 æ—¶ã€‚</span>
handler<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// åœ¨åˆ é™¤ä»£ç†å¯¹è±¡çš„æŸä¸ªå±æ€§æ—¶è§¦å‘è¯¥æ“ä½œï¼Œæ¯”å¦‚åœ¨æ‰§è¡Œ delete proxy.foo æ—¶ã€‚</span>
handler<span class="token punctuation">.</span><span class="token function">deleteProperty</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// åœ¨è·å–ä»£ç†å¯¹è±¡çš„æ‰€æœ‰å±æ€§é”®æ—¶è§¦å‘è¯¥æ“ä½œï¼Œæ¯”å¦‚åœ¨æ‰§è¡Œ Object.getOwnPropertyNames(proxy) æ—¶ã€‚</span>
handler<span class="token punctuation">.</span><span class="token function">ownKeys</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// åœ¨è°ƒç”¨ä¸€ä¸ªç›®æ ‡å¯¹è±¡ä¸ºå‡½æ•°çš„ä»£ç†å¯¹è±¡æ—¶è§¦å‘è¯¥æ“ä½œï¼Œæ¯”å¦‚åœ¨æ‰§è¡Œ proxy() æ—¶ã€‚</span>
<span class="token function">handler</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

 
<span class="token comment">// åœ¨ç»™ä¸€ä¸ªç›®æ ‡å¯¹è±¡ä¸ºæ„é€ å‡½æ•°çš„ä»£ç†å¯¹è±¡æ„é€ å®ä¾‹æ—¶è§¦å‘è¯¥æ“ä½œï¼Œæ¯”å¦‚åœ¨æ‰§è¡Œnew proxy() æ—¶ã€‚</span>
handler<span class="token punctuation">.</span><span class="token function">construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>ä¸ºä½•Proxyä¸èƒ½è¢«Polyfill</strong></p> <ul><li>å¦‚classå¯ä»¥ç”¨<code>function</code>æ¨¡æ‹Ÿï¼›<code>promise</code>å¯ä»¥ç”¨<code>callback</code>æ¨¡æ‹Ÿ</li> <li>ä½†æ˜¯proxyä¸èƒ½ç”¨<code>Object.defineProperty</code>æ¨¡æ‹Ÿ</li></ul> <blockquote><p>ç›®å‰è°·æ­Œçš„polyfillåªèƒ½å®ç°éƒ¨åˆ†çš„åŠŸèƒ½ï¼Œå¦‚getã€set  https://github.com/GoogleChrome/proxy-polyfill</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// commonJS require</span>
<span class="token keyword">const</span> proxyPolyfill <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'proxy-polyfill/src/proxy'</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Your environment may also support transparent rewriting of commonJS to ES6:</span>
<span class="token keyword">import</span> ProxyPolyfillBuilder <span class="token keyword">from</span> <span class="token string">'proxy-polyfill/src/proxy'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> proxyPolyfill <span class="token operator">=</span> <span class="token function">ProxyPolyfillBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Then use...</span>
<span class="token keyword">const</span> myProxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">proxyPolyfill</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_21-æ·±æµ…æ‹·è´"><a href="http://interview.poetries.top/docs/simply.html#_21-%E6%B7%B1%E6%B5%85%E6%8B%B7%E8%B4%9D" class="header-anchor">#</a> 21 æ·±æµ…æ‹·è´</h3> <blockquote><p>è¿™ä¸ªé—®é¢˜é€šå¸¸å¯ä»¥é€šè¿‡ <code>JSON.parse(JSON.stringify(object))</code> æ¥è§£å†³</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token punctuation">{</span>
    age<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    jobs<span class="token operator">:</span> <span class="token punctuation">{</span>
        first<span class="token operator">:</span> <span class="token string">'FE'</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> b <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span>
a<span class="token punctuation">.</span>jobs<span class="token punctuation">.</span>first <span class="token operator">=</span> <span class="token string">'native'</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>jobs<span class="token punctuation">.</span>first<span class="token punctuation">)</span> <span class="token comment">// FE</span>
</code></pre></div><p><strong>ä½†æ˜¯è¯¥æ–¹æ³•ä¹Ÿæ˜¯æœ‰å±€é™æ€§çš„</strong>ï¼š</p> <ul><li>ä¼šå¿½ç•¥ <code>undefined</code></li> <li>ä¼šå¿½ç•¥ <code>symbol</code></li> <li>ä¸èƒ½åºåˆ—åŒ–å‡½æ•°</li> <li>ä¸èƒ½è§£å†³å¾ªç¯å¼•ç”¨çš„å¯¹è±¡</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  a<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  b<span class="token operator">:</span> <span class="token punctuation">{</span>
    c<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    d<span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
obj<span class="token punctuation">.</span>c <span class="token operator">=</span> obj<span class="token punctuation">.</span>b
obj<span class="token punctuation">.</span>e <span class="token operator">=</span> obj<span class="token punctuation">.</span>a
obj<span class="token punctuation">.</span>b<span class="token punctuation">.</span>c <span class="token operator">=</span> obj<span class="token punctuation">.</span>c
obj<span class="token punctuation">.</span>b<span class="token punctuation">.</span>d <span class="token operator">=</span> obj<span class="token punctuation">.</span>b
obj<span class="token punctuation">.</span>b<span class="token punctuation">.</span>e <span class="token operator">=</span> obj<span class="token punctuation">.</span>b<span class="token punctuation">.</span>c
<span class="token keyword">let</span> newObj <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newObj<span class="token punctuation">)</span>
å¤
</code></pre></div><blockquote><p>åœ¨é‡åˆ°å‡½æ•°ã€ <code>undefined</code> æˆ–è€… <code>symbol</code> çš„æ—¶å€™ï¼Œè¯¥å¯¹è±¡ä¹Ÿä¸èƒ½æ­£å¸¸çš„åºåˆ—åŒ–</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token punctuation">{</span>
    age<span class="token operator">:</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span>
    sex<span class="token operator">:</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">'male'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function-variable function">jobs</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    name<span class="token operator">:</span> <span class="token string">'ppp'</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> b <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token comment">// {name: "ppp"}</span>
</code></pre></div><blockquote><p>ä½†æ˜¯åœ¨é€šå¸¸æƒ…å†µä¸‹ï¼Œå¤æ‚æ•°æ®éƒ½æ˜¯å¯ä»¥åºåˆ—åŒ–çš„ï¼Œæ‰€ä»¥è¿™ä¸ªå‡½æ•°å¯ä»¥è§£å†³å¤§éƒ¨åˆ†é—®é¢˜ï¼Œå¹¶ä¸”è¯¥å‡½æ•°æ˜¯å†…ç½®å‡½æ•°ä¸­å¤„ç†æ·±æ‹·è´æ€§èƒ½æœ€å¿«çš„ã€‚å½“ç„¶å¦‚æœä½ çš„æ•°æ®ä¸­å«æœ‰ä»¥ä¸Šä¸‰ç§æƒ…å†µä¸‹ï¼Œå¯ä»¥ä½¿ç”¨ <code>lodash</code> çš„æ·±æ‹·è´å‡½æ•°</p></blockquote> <p><strong>æµ…æ‹·è´: ä»¥èµ‹å€¼çš„å½¢å¼æ‹·è´å¼•ç”¨å¯¹è±¡ï¼Œä»æŒ‡å‘åŒä¸€ä¸ªåœ°å€ï¼Œä¿®æ”¹æ—¶åŸå¯¹è±¡ä¹Ÿä¼šå—åˆ°å½±å“</strong></p> <ul><li><code>Object.assign</code></li> <li>å±•å¼€è¿ç®—ç¬¦(<code>...</code>)</li></ul> <p><strong>æ·±æ‹·è´: å®Œå…¨æ‹·è´ä¸€ä¸ªæ–°å¯¹è±¡ï¼Œä¿®æ”¹æ—¶åŸå¯¹è±¡ä¸å†å—åˆ°ä»»ä½•å½±å“</strong></p> <ul><li><code>JSON.parse(JSON.stringify(obj))</code>: æ€§èƒ½æœ€å¿«</li> <li>å…·æœ‰å¾ªç¯å¼•ç”¨çš„å¯¹è±¡æ—¶ï¼ŒæŠ¥é”™</li> <li>å½“å€¼ä¸ºå‡½æ•°ã€<code>undefined</code>ã€æˆ–<code>symbol</code>æ—¶ï¼Œæ— æ³•æ‹·è´</li> <li>é€’å½’è¿›è¡Œé€ä¸€èµ‹å€¼</li></ul> <p><strong>å®ç°æ·±æ‹·è´</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// è§£å†³äº†å¸¸è§çš„ç±»å‹ä»¥åŠå¾ªç¯å¼•ç”¨çš„é—®é¢˜ï¼Œå½“ç„¶è¿˜æ˜¯ä¸€éƒ¨åˆ†ç¼ºé™·çš„ï¼Œä½†æ˜¯é¢è¯•æ—¶å€™èƒ½å†™å‡ºä¸Šé¢çš„ä»£ç å·²ç»è¶³å¤Ÿäº†</span>
<span class="token comment">// åˆ©ç”¨ WeakMap è§£å†³å¾ªç¯å¼•ç”¨</span>
<span class="token keyword">let</span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WeakMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">function</span> <span class="token function">deepClone</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>obj <span class="token keyword">instanceof</span> <span class="token class-name">Object</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">let</span> newObj
    <span class="token keyword">if</span> <span class="token punctuation">(</span>obj <span class="token keyword">instanceof</span> <span class="token class-name">Array</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      newObj <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>     
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>obj <span class="token keyword">instanceof</span> <span class="token class-name">Function</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function-variable function">newObj</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">obj</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> arguments<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>obj <span class="token keyword">instanceof</span> <span class="token class-name">RegExp</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// æ‹¼æ¥æ­£åˆ™</span>
      newobj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>source<span class="token punctuation">,</span> obj<span class="token punctuation">.</span>flags<span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>obj <span class="token keyword">instanceof</span> <span class="token class-name">Date</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      newobj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      newObj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// å…‹éš†ä¸€ä»½å¯¹è±¡å‡ºæ¥</span>
    <span class="token keyword">let</span> desc <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">getOwnPropertyDescriptors</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span>
    <span class="token keyword">let</span> clone <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">getPrototypeOf</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">,</span> desc<span class="token punctuation">)</span>
    map<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> clone<span class="token punctuation">)</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> key <span class="token keyword">in</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>obj<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        newObj<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">deepClone</span><span class="token punctuation">(</span>obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> newObj
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> obj
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_22-èŠ‚æµä¸é˜²æŠ–"><a href="http://interview.poetries.top/docs/simply.html#_22-%E8%8A%82%E6%B5%81%E4%B8%8E%E9%98%B2%E6%8A%96" class="header-anchor">#</a> 22 èŠ‚æµä¸é˜²æŠ–</h3> <ul><li>å‡½æ•°é˜²æŠ– æ˜¯æŒ‡åœ¨äº‹ä»¶è¢«è§¦å‘ n ç§’åå†æ‰§è¡Œå›è°ƒï¼Œå¦‚æœåœ¨è¿™ n ç§’å†…äº‹ä»¶åˆè¢«è§¦å‘ï¼Œåˆ™é‡æ–°è®¡æ—¶ã€‚è¿™å¯ä»¥ä½¿ç”¨åœ¨ä¸€äº›ç‚¹å‡»è¯·æ±‚çš„äº‹ä»¶ä¸Šï¼Œé¿å…å› ä¸ºç”¨æˆ·çš„å¤šæ¬¡ç‚¹å‡»å‘åç«¯å‘é€å¤šæ¬¡è¯·æ±‚ã€‚</li> <li>å‡½æ•°èŠ‚æµ æ˜¯æŒ‡è§„å®šä¸€ä¸ªå•ä½æ—¶é—´ï¼Œåœ¨è¿™ä¸ªå•ä½æ—¶é—´å†…ï¼Œåªèƒ½æœ‰ä¸€æ¬¡è§¦å‘äº‹ä»¶çš„å›è°ƒå‡½æ•°æ‰§è¡Œï¼Œå¦‚æœåœ¨åŒä¸€ä¸ªå•ä½æ—¶é—´å†…æŸäº‹ä»¶è¢«è§¦å‘å¤šæ¬¡ï¼Œåªæœ‰ä¸€æ¬¡èƒ½ç”Ÿæ•ˆã€‚èŠ‚æµå¯ä»¥ä½¿ç”¨åœ¨ scroll å‡½æ•°çš„äº‹ä»¶ç›‘å¬ä¸Šï¼Œé€šè¿‡äº‹ä»¶èŠ‚æµæ¥é™ä½äº‹ä»¶è°ƒç”¨çš„é¢‘ç‡ã€‚</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>
<span class="token comment">// å‡½æ•°é˜²æŠ–çš„å®ç°</span>
<span class="token keyword">function</span> <span class="token function">debounce</span><span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span> wait</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> timer <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> context <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">,</span>
      args <span class="token operator">=</span> arguments<span class="token punctuation">;</span>

    <span class="token comment">// å¦‚æœæ­¤æ—¶å­˜åœ¨å®šæ—¶å™¨çš„è¯ï¼Œåˆ™å–æ¶ˆä¹‹å‰çš„å®šæ—¶å™¨é‡æ–°è®°æ—¶</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>timer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">clearTimeout</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span><span class="token punctuation">;</span>
      timer <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// è®¾ç½®å®šæ—¶å™¨ï¼Œä½¿äº‹ä»¶é—´éš”æŒ‡å®šäº‹ä»¶åæ‰§è¡Œ</span>
    timer <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> wait<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// å‡½æ•°èŠ‚æµçš„å®ç°;</span>
<span class="token keyword">function</span> <span class="token function">throttle</span><span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span> delay</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> preTime <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> context <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">,</span>
      args <span class="token operator">=</span> arguments<span class="token punctuation">,</span>
      nowTime <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// å¦‚æœä¸¤æ¬¡æ—¶é—´é—´éš”è¶…è¿‡äº†æŒ‡å®šæ—¶é—´ï¼Œåˆ™æ‰§è¡Œå‡½æ•°ã€‚</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>nowTime <span class="token operator">-</span> preTime <span class="token operator">&gt;=</span> delay<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      preTime <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_23-åƒåœ¾å›æ”¶"><a href="http://interview.poetries.top/docs/simply.html#_23-%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6" class="header-anchor">#</a> 23 åƒåœ¾å›æ”¶</h3> <ul><li>å¯¹äºåœ¨JavaScriptä¸­çš„å­—ç¬¦ä¸²ï¼Œå¯¹è±¡ï¼Œæ•°ç»„æ˜¯æ²¡æœ‰å›ºå®šå¤§å°çš„ï¼Œåªæœ‰å½“å¯¹ä»–ä»¬è¿›è¡ŒåŠ¨æ€åˆ†é…å­˜å‚¨æ—¶ï¼Œè§£é‡Šå™¨å°±ä¼šåˆ†é…å†…å­˜æ¥å­˜å‚¨è¿™äº›æ•°æ®ï¼Œå½“JavaScriptçš„è§£é‡Šå™¨æ¶ˆè€—å®Œç³»ç»Ÿä¸­æ‰€æœ‰å¯ç”¨çš„å†…å­˜æ—¶ï¼Œå°±ä¼šé€ æˆç³»ç»Ÿå´©æºƒã€‚</li> <li>å†…å­˜æ³„æ¼ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä¸å†ä½¿ç”¨åˆ°çš„å˜é‡æ‰€å ç”¨å†…å­˜æ²¡æœ‰åŠæ—¶é‡Šæ”¾ï¼Œå¯¼è‡´ç¨‹åºè¿è¡Œä¸­ï¼Œå†…å­˜è¶Šå è¶Šå¤§ï¼Œæç«¯æƒ…å†µä¸‹å¯ä»¥å¯¼è‡´ç³»ç»Ÿå´©æºƒï¼ŒæœåŠ¡å™¨å®•æœºã€‚</li> <li>JavaScriptæœ‰è‡ªå·±çš„ä¸€å¥—åƒåœ¾å›æ”¶æœºåˆ¶ï¼ŒJavaScriptçš„è§£é‡Šå™¨å¯ä»¥æ£€æµ‹åˆ°ä»€ä¹ˆæ—¶å€™ç¨‹åºä¸å†ä½¿ç”¨è¿™ä¸ªå¯¹è±¡äº†ï¼ˆæ•°æ®ï¼‰ï¼Œå°±ä¼šæŠŠå®ƒæ‰€å ç”¨çš„å†…å­˜é‡Šæ”¾æ‰ã€‚</li> <li>é’ˆå¯¹JavaScriptçš„æ¥åŠå›æ”¶æœºåˆ¶æœ‰ä»¥ä¸‹ä¸¤ç§æ–¹æ³•ï¼ˆå¸¸ç”¨ï¼‰ï¼šæ ‡è®°æ¸…é™¤ï¼Œå¼•ç”¨è®¡æ•°</li> <li>æ ‡è®°æ¸…é™¤</li></ul> <blockquote><p>v8 çš„åƒåœ¾å›æ”¶æœºåˆ¶åŸºäºåˆ†ä»£å›æ”¶æœºåˆ¶ï¼Œè¿™ä¸ªæœºåˆ¶åˆåŸºäºä¸–ä»£å‡è¯´ï¼Œè¿™ä¸ªå‡è¯´æœ‰ä¸¤ä¸ªç‰¹ç‚¹ï¼Œä¸€æ˜¯æ–°ç”Ÿçš„å¯¹è±¡å®¹æ˜“æ—©æ­»ï¼Œå¦ä¸€ä¸ªæ˜¯ä¸æ­»çš„å¯¹è±¡ä¼šæ´»å¾—æ›´ä¹…ã€‚åŸºäºè¿™ä¸ªå‡è¯´ï¼Œv8 å¼•æ“å°†å†…å­˜åˆ†ä¸ºäº†æ–°ç”Ÿä»£å’Œè€ç”Ÿä»£ã€‚</p></blockquote> <ul><li>æ–°åˆ›å»ºçš„å¯¹è±¡æˆ–è€…åªç»å†è¿‡ä¸€æ¬¡çš„åƒåœ¾å›æ”¶çš„å¯¹è±¡è¢«ç§°ä¸ºæ–°ç”Ÿä»£ã€‚ç»å†è¿‡å¤šæ¬¡åƒåœ¾å›æ”¶çš„å¯¹è±¡è¢«ç§°ä¸ºè€ç”Ÿä»£ã€‚</li> <li>æ–°ç”Ÿä»£è¢«åˆ†ä¸º From å’Œ To ä¸¤ä¸ªç©ºé—´ï¼ŒTo ä¸€èˆ¬æ˜¯é—²ç½®çš„ã€‚å½“ From ç©ºé—´æ»¡äº†çš„æ—¶å€™ä¼šæ‰§è¡Œ Scavenge ç®—æ³•è¿›è¡Œåƒåœ¾å›æ”¶ã€‚å½“æˆ‘ä»¬æ‰§è¡Œåƒåœ¾å›æ”¶ç®—æ³•çš„æ—¶å€™åº”ç”¨é€»è¾‘å°†ä¼šåœæ­¢ï¼Œç­‰åƒåœ¾å›æ”¶ç»“æŸåå†ç»§ç»­æ‰§è¡Œã€‚</li></ul> <p><strong>è¿™ä¸ªç®—æ³•åˆ†ä¸ºä¸‰æ­¥ï¼š</strong></p> <ul><li>é¦–å…ˆæ£€æŸ¥ From ç©ºé—´çš„å­˜æ´»å¯¹è±¡ï¼Œå¦‚æœå¯¹è±¡å­˜æ´»åˆ™åˆ¤æ–­å¯¹è±¡æ˜¯å¦æ»¡è¶³æ™‹å‡åˆ°è€ç”Ÿä»£çš„æ¡ä»¶ï¼Œå¦‚æœæ»¡è¶³æ¡ä»¶åˆ™æ™‹å‡åˆ°è€ç”Ÿä»£ã€‚å¦‚æœä¸æ»¡è¶³æ¡ä»¶åˆ™ç§»åŠ¨ To ç©ºé—´ã€‚</li> <li>å¦‚æœå¯¹è±¡ä¸å­˜æ´»ï¼Œåˆ™é‡Šæ”¾å¯¹è±¡çš„ç©ºé—´ã€‚</li> <li>æœ€åå°† From ç©ºé—´å’Œ To ç©ºé—´è§’è‰²è¿›è¡Œäº¤æ¢ã€‚</li></ul> <p><strong>æ–°ç”Ÿä»£å¯¹è±¡æ™‹å‡åˆ°è€ç”Ÿä»£æœ‰ä¸¤ä¸ªæ¡ä»¶ï¼š</strong></p> <ul><li>ç¬¬ä¸€ä¸ªæ˜¯åˆ¤æ–­æ˜¯å¯¹è±¡å¦å·²ç»ç»è¿‡ä¸€æ¬¡ Scavenge å›æ”¶ã€‚è‹¥ç»å†è¿‡ï¼Œåˆ™å°†å¯¹è±¡ä» From ç©ºé—´å¤åˆ¶åˆ°è€ç”Ÿä»£ä¸­ï¼›è‹¥æ²¡æœ‰ç»å†ï¼Œåˆ™å¤åˆ¶åˆ° To ç©ºé—´ã€‚</li> <li>ç¬¬äºŒä¸ªæ˜¯ To ç©ºé—´çš„å†…å­˜ä½¿ç”¨å æ¯”æ˜¯å¦è¶…è¿‡é™åˆ¶ã€‚å½“å¯¹è±¡ä» From ç©ºé—´å¤åˆ¶åˆ° To ç©ºé—´æ—¶ï¼Œè‹¥ To ç©ºé—´ä½¿ç”¨è¶…è¿‡ 25%ï¼Œåˆ™å¯¹è±¡ç›´æ¥æ™‹å‡åˆ°è€ç”Ÿä»£ä¸­ã€‚è®¾ç½® 25% çš„åŸå› ä¸»è¦æ˜¯å› ä¸ºç®—æ³•ç»“æŸåï¼Œä¸¤ä¸ªç©ºé—´ç»“æŸåä¼šäº¤æ¢ä½ç½®ï¼Œå¦‚æœ To ç©ºé—´çš„å†…å­˜å¤ªå°ï¼Œä¼šå½±å“åç»­çš„å†…å­˜åˆ†é…ã€‚</li></ul> <blockquote><p>è€ç”Ÿä»£é‡‡ç”¨äº†æ ‡è®°æ¸…é™¤æ³•å’Œæ ‡è®°å‹ç¼©æ³•ã€‚æ ‡è®°æ¸…é™¤æ³•é¦–å…ˆä¼šå¯¹å†…å­˜ä¸­å­˜æ´»çš„å¯¹è±¡è¿›è¡Œæ ‡è®°ï¼Œæ ‡è®°ç»“æŸåæ¸…é™¤æ‰é‚£äº›æ²¡æœ‰æ ‡è®°çš„å¯¹è±¡ã€‚ç”±äºæ ‡è®°æ¸…é™¤åä¼šé€ æˆå¾ˆå¤šçš„å†…å­˜ç¢ç‰‡ï¼Œä¸ä¾¿äºåé¢çš„å†…å­˜åˆ†é…ã€‚æ‰€ä»¥äº†è§£å†³å†…å­˜ç¢ç‰‡çš„é—®é¢˜å¼•å…¥äº†æ ‡è®°å‹ç¼©æ³•ã€‚</p></blockquote> <p>ç”±äºåœ¨è¿›è¡Œåƒåœ¾å›æ”¶çš„æ—¶å€™ä¼šæš‚åœåº”ç”¨çš„é€»è¾‘ï¼Œå¯¹äºæ–°ç”Ÿä»£æ–¹æ³•ç”±äºå†…å­˜å°ï¼Œæ¯æ¬¡åœé¡¿çš„æ—¶é—´ä¸ä¼šå¤ªé•¿ï¼Œä½†å¯¹äºè€ç”Ÿä»£æ¥è¯´æ¯æ¬¡åƒåœ¾å›æ”¶çš„æ—¶é—´é•¿ï¼Œåœé¡¿ä¼šé€ æˆå¾ˆå¤§çš„å½±å“ã€‚ ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ V8 å¼•å…¥äº†å¢é‡æ ‡è®°çš„æ–¹æ³•ï¼Œå°†ä¸€æ¬¡åœé¡¿è¿›è¡Œçš„è¿‡ç¨‹åˆ†ä¸ºäº†å¤šæ­¥ï¼Œæ¯æ¬¡æ‰§è¡Œå®Œä¸€å°æ­¥å°±è®©è¿è¡Œé€»è¾‘æ‰§è¡Œä¸€ä¼šï¼Œå°±è¿™æ ·äº¤æ›¿è¿è¡Œ</p> <h3 id="_24-å†…å­˜æ³„éœ²"><a href="http://interview.poetries.top/docs/simply.html#_24-%E5%86%85%E5%AD%98%E6%B3%84%E9%9C%B2" class="header-anchor">#</a> 24 å†…å­˜æ³„éœ²</h3> <ul><li>æ„å¤–çš„å…¨å±€å˜é‡: æ— æ³•è¢«å›æ”¶</li> <li>å®šæ—¶å™¨: æœªè¢«æ­£ç¡®å…³é—­ï¼Œå¯¼è‡´æ‰€å¼•ç”¨çš„å¤–éƒ¨å˜é‡æ— æ³•è¢«é‡Šæ”¾</li> <li>äº‹ä»¶ç›‘å¬: æ²¡æœ‰æ­£ç¡®é”€æ¯ (ä½ç‰ˆæœ¬æµè§ˆå™¨å¯èƒ½å‡ºç°)</li> <li>é—­åŒ…
<ul><li>ç¬¬ä¸€ç§æƒ…å†µæ˜¯æˆ‘ä»¬ç”±äºä½¿ç”¨æœªå£°æ˜çš„å˜é‡ï¼Œè€Œæ„å¤–çš„åˆ›å»ºäº†ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œè€Œä½¿è¿™ä¸ªå˜é‡ä¸€ç›´ç•™åœ¨å†…å­˜ä¸­æ— æ³•è¢«å›æ”¶ã€‚</li> <li>ç¬¬äºŒç§æƒ…å†µæ˜¯æˆ‘ä»¬è®¾ç½®äº†setIntervalå®šæ—¶å™¨ï¼Œè€Œå¿˜è®°å–æ¶ˆå®ƒï¼Œå¦‚æœå¾ªç¯å‡½æ•°æœ‰å¯¹å¤–éƒ¨å˜é‡çš„å¼•ç”¨çš„è¯ï¼Œé‚£ä¹ˆè¿™ä¸ªå˜é‡ä¼šè¢«ä¸€ç›´ç•™åœ¨å†…å­˜ä¸­ï¼Œè€Œæ— æ³•è¢«å›æ”¶ã€‚</li> <li>ç¬¬ä¸‰ç§æƒ…å†µæ˜¯æˆ‘ä»¬è·å–ä¸€ä¸ªDOMå…ƒç´ çš„å¼•ç”¨ï¼Œè€Œåé¢è¿™ä¸ªå…ƒç´ è¢«åˆ é™¤ï¼Œç”±äºæˆ‘ä»¬ä¸€ç›´ä¿ç•™äº†å¯¹è¿™ä¸ªå…ƒç´ çš„å¼•ç”¨ï¼Œæ‰€ä»¥å®ƒä¹Ÿæ— æ³•è¢«å›æ”¶ã€‚</li> <li>ç¬¬å››ç§æƒ…å†µæ˜¯ä¸åˆç†çš„ä½¿ç”¨é—­åŒ…ï¼Œä»è€Œå¯¼è‡´æŸäº›å˜é‡ä¸€ç›´è¢«ç•™åœ¨å†…å­˜å½“ä¸­ã€‚</li></ul></li> <li><code>dom</code> å¼•ç”¨: <code>dom</code> å…ƒç´ è¢«åˆ é™¤æ—¶ï¼Œå†…å­˜ä¸­çš„å¼•ç”¨æœªè¢«æ­£ç¡®æ¸…ç©º</li> <li>æ§åˆ¶å°<code>console.log</code>æ‰“å°çš„ä¸œè¥¿</li></ul> <blockquote><p>å¯ç”¨ <code>chrome</code> ä¸­çš„ <code>timeline</code> è¿›è¡Œå†…å­˜æ ‡è®°ï¼Œå¯è§†åŒ–æŸ¥çœ‹å†…å­˜çš„å˜åŒ–æƒ…å†µï¼Œæ‰¾å‡ºå¼‚å¸¸ç‚¹ã€‚</p></blockquote> <p><a href="https://juejin.cn/post/6947841638118998029?utm_source=gold_browser_extension" target="_blank" rel="noopener noreferrer">å†…å­˜æ³„éœ²æ’æŸ¥æ–¹æ³•<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="_25-ajax"><a href="http://interview.poetries.top/docs/simply.html#_25-ajax" class="header-anchor">#</a> 25 Ajax</h3> <blockquote><p>å®ƒæ˜¯ä¸€ç§å¼‚æ­¥é€šä¿¡çš„æ–¹æ³•ï¼Œé€šè¿‡ç›´æ¥ç”± js è„šæœ¬å‘æœåŠ¡å™¨å‘èµ· http é€šä¿¡ï¼Œç„¶åæ ¹æ®æœåŠ¡å™¨è¿”å›çš„æ•°æ®ï¼Œæ›´æ–°ç½‘é¡µçš„ç›¸åº”éƒ¨åˆ†ï¼Œè€Œä¸ç”¨åˆ·æ–°æ•´ä¸ªé¡µé¢çš„ä¸€ç§æ–¹æ³•ã€‚</p></blockquote> <p><img src="./è¿›é˜¶_files/9.png" alt="" class="medium-zoom-image"></p> <p><strong>é¢è¯•æ‰‹å†™ï¼ˆåŸç”Ÿï¼‰ï¼š</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//1ï¼šåˆ›å»ºAjaxå¯¹è±¡</span>
<span class="token keyword">var</span> xhr <span class="token operator">=</span> window<span class="token punctuation">.</span>XMLHttpRequest<span class="token operator">?</span><span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token keyword">new</span> <span class="token class-name">ActiveXObject</span><span class="token punctuation">(</span><span class="token string">'Microsoft.XMLHTTP'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// å…¼å®¹IE6åŠä»¥ä¸‹ç‰ˆæœ¬</span>
<span class="token comment">//2ï¼šé…ç½® Ajaxè¯·æ±‚åœ°å€</span>
xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'get'</span><span class="token punctuation">,</span><span class="token string">'index.xml'</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//3ï¼šå‘é€è¯·æ±‚</span>
xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ä¸¥è°¨å†™æ³•</span>
<span class="token comment">//4:ç›‘å¬è¯·æ±‚ï¼Œæ¥å—å“åº”</span>
xhr<span class="token punctuation">.</span><span class="token function-variable function">onreadysatechange</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
     <span class="token keyword">if</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>readySate<span class="token operator">==</span><span class="token number">4</span><span class="token operator">&amp;&amp;</span>xhr<span class="token punctuation">.</span>status<span class="token operator">==</span><span class="token number">200</span> <span class="token operator">||</span> xhr<span class="token punctuation">.</span>status<span class="token operator">==</span><span class="token number">304</span> <span class="token punctuation">)</span>
          console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>responsetXML<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>jQueryå†™æ³•</strong></p> <div class="language- extra-class"><pre class="language-text"><code>$.ajax({
  type:'post',
  url:'',
  async:ture,//async å¼‚æ­¥  sync  åŒæ­¥
  data:data,//é’ˆå¯¹postè¯·æ±‚
  dataType:'jsonp',
  success:function (msg) {

  },
  error:function (error) {

  }
})
</code></pre></div><p><strong>promise å°è£…å®ç°ï¼š</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// promise å°è£…å®ç°ï¼š</span>

<span class="token keyword">function</span> <span class="token function">getJSON</span><span class="token punctuation">(</span><span class="token parameter">url</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// åˆ›å»ºä¸€ä¸ª promise å¯¹è±¡</span>
  <span class="token keyword">let</span> promise <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// æ–°å»ºä¸€ä¸ª http è¯·æ±‚</span>
    xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">"GET"</span><span class="token punctuation">,</span> url<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// è®¾ç½®çŠ¶æ€çš„ç›‘å¬å‡½æ•°</span>
    xhr<span class="token punctuation">.</span><span class="token function-variable function">onreadystatechange</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>readyState <span class="token operator">!==</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>

      <span class="token comment">// å½“è¯·æ±‚æˆåŠŸæˆ–å¤±è´¥æ—¶ï¼Œæ”¹å˜ promise çš„çŠ¶æ€</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>response<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token function">reject</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>statusText<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token comment">// è®¾ç½®é”™è¯¯ç›‘å¬å‡½æ•°</span>
    xhr<span class="token punctuation">.</span><span class="token function-variable function">onerror</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">reject</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>statusText<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token comment">// è®¾ç½®å“åº”çš„æ•°æ®ç±»å‹</span>
    xhr<span class="token punctuation">.</span>responseType <span class="token operator">=</span> <span class="token string">"json"</span><span class="token punctuation">;</span>

    <span class="token comment">// è®¾ç½®è¯·æ±‚å¤´ä¿¡æ¯</span>
    xhr<span class="token punctuation">.</span><span class="token function">setRequestHeader</span><span class="token punctuation">(</span><span class="token string">"Accept"</span><span class="token punctuation">,</span> <span class="token string">"application/json"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// å‘é€ http è¯·æ±‚</span>
    xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> promise<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_26-argumentså¯¹è±¡"><a href="http://interview.poetries.top/docs/simply.html#_26-arguments%E5%AF%B9%E8%B1%A1" class="header-anchor">#</a> 26 argumentså¯¹è±¡</h3> <blockquote><p>argumentså¯¹è±¡æ˜¯å‡½æ•°ä¸­ä¼ é€’çš„å‚æ•°å€¼çš„é›†åˆã€‚å®ƒæ˜¯ä¸€ä¸ªç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ï¼Œå› ä¸ºå®ƒæœ‰ä¸€ä¸ªlengthå±æ€§ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ•°ç»„ç´¢å¼•è¡¨ç¤ºæ³•arguments[1]æ¥è®¿é—®å•ä¸ªå€¼ï¼Œä½†å®ƒæ²¡æœ‰æ•°ç»„ä¸­çš„å†…ç½®æ–¹æ³•ï¼Œå¦‚ï¼šforEachã€reduceã€filterå’Œmapã€‚</p></blockquote> <p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>Array.prototype.slice</code>å°†<code>arguments</code>å¯¹è±¡è½¬æ¢æˆä¸€ä¸ªæ•°ç»„ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">one</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>æ³¨æ„:ç®­å¤´å‡½æ•°ä¸­æ²¡æœ‰argumentså¯¹è±¡ã€‚</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">one</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> arguments<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> <span class="token function-variable function">two</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> arguments<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> <span class="token function-variable function">three</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">three</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> arguments<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token function-variable function">four</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> arguments<span class="token punctuation">;</span>

<span class="token function">four</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Throws an error  - arguments is not defined</span>
</code></pre></div><blockquote><p>å½“æˆ‘ä»¬è°ƒç”¨å‡½æ•°fouræ—¶ï¼Œå®ƒä¼šæŠ›å‡ºä¸€ä¸ªReferenceError: arguments is not defined errorã€‚ä½¿ç”¨restè¯­æ³•ï¼Œå¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>const four = (...args) =&gt; args;
</code></pre></div><p>è¿™ä¼šè‡ªåŠ¨å°†æ‰€æœ‰å‚æ•°å€¼æ”¾å…¥æ•°ç»„ä¸­ã€‚</p> <h3 id="_27-æ•°ç»„å’Œå­—ç¬¦ä¸²æ–¹æ³•"><a href="http://interview.poetries.top/docs/simply.html#_27-%E6%95%B0%E7%BB%84%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%96%B9%E6%B3%95" class="header-anchor">#</a> 27 æ•°ç»„å’Œå­—ç¬¦ä¸²æ–¹æ³•</h3> <p><img src="./è¿›é˜¶_files/7.png" alt="" class="medium-zoom-image"> <img src="./è¿›é˜¶_files/8.png" alt="" class="medium-zoom-image"></p> <h2 id="äºŒã€cssåŸºç¡€"><a href="http://interview.poetries.top/docs/simply.html#%E4%BA%8C%E3%80%81css%E5%9F%BA%E7%A1%80" class="header-anchor">#</a> äºŒã€CSSåŸºç¡€</h2> <h3 id="_1-ç›’æ¨¡å‹"><a href="http://interview.poetries.top/docs/simply.html#_1-%E7%9B%92%E6%A8%A1%E5%9E%8B" class="header-anchor">#</a> 1 ç›’æ¨¡å‹</h3> <blockquote><p>contentï¼ˆå…ƒç´ å†…å®¹ï¼‰ + paddingï¼ˆå†…è¾¹è·ï¼‰ + borderï¼ˆè¾¹æ¡†ï¼‰ + marginï¼ˆå¤–è¾¹è·ï¼‰</p></blockquote> <p>å»¶ä¼¸ï¼š<code>box-sizing</code></p> <ul><li><code>content-box</code>ï¼šé»˜è®¤å€¼ï¼Œæ€»å®½åº¦ = <code>margin</code> + <code>border</code> + <code>padding</code> + <code>width</code></li> <li><code>border-box</code>ï¼šç›’å­å®½åº¦åŒ…å« <code>padding</code> å’Œ <code>border</code>ï¼Œ<code>æ€»å®½åº¦ = margin + width</code></li> <li><code>inherit</code>ï¼šä»çˆ¶å…ƒç´ ç»§æ‰¿ <code>box-sizing</code> å±æ€§</li></ul> <h3 id="_2-bfc"><a href="http://interview.poetries.top/docs/simply.html#_2-bfc" class="header-anchor">#</a> 2 BFC</h3> <blockquote><p>å—çº§æ ¼å¼åŒ–ä¸Šä¸‹æ–‡ï¼Œæ˜¯ä¸€ä¸ªç‹¬ç«‹çš„æ¸²æŸ“åŒºåŸŸï¼Œè®©å¤„äº <code>BFC</code> å†…éƒ¨çš„å…ƒç´ ä¸å¤–éƒ¨çš„å…ƒç´ ç›¸äº’éš”ç¦»ï¼Œä½¿å†…å¤–å…ƒç´ çš„å®šä½ä¸ä¼šç›¸äº’å½±å“ã€‚</p></blockquote> <blockquote><p>IEä¸‹ä¸º <code>Layout</code>ï¼Œå¯é€šè¿‡ <code>zoom:1</code> è§¦å‘</p></blockquote> <p><strong>è§¦å‘æ¡ä»¶:</strong></p> <ul><li>æ ¹å…ƒç´ </li> <li><code>position: absolute/fixed</code></li> <li><code>display: inline-block / table</code></li> <li><code>float</code> å…ƒç´ </li> <li><code>ovevflow !== visible</code></li></ul> <p><strong>è§„åˆ™:</strong></p> <ul><li>å±äºåŒä¸€ä¸ª <code>BFC</code> çš„ä¸¤ä¸ªç›¸é‚» <code>Box</code> å‚ç›´æ’åˆ—</li> <li>å±äºåŒä¸€ä¸ª <code>BFC</code> çš„ä¸¤ä¸ªç›¸é‚» <code>Box</code> çš„ <code>margin</code> ä¼šå‘ç”Ÿé‡å </li> <li><code>BFC</code> ä¸­å­å…ƒç´ çš„ <code>margin box</code> çš„å·¦è¾¹ï¼Œ ä¸åŒ…å«å— (BFC) <code>border box</code>çš„å·¦è¾¹ç›¸æ¥è§¦ (å­å…ƒç´  <code>absolute</code> é™¤å¤–)</li> <li><code>BFC</code> çš„åŒºåŸŸä¸ä¼šä¸ <code>float</code> çš„å…ƒç´ åŒºåŸŸé‡å </li> <li>è®¡ç®— <code>BFC</code> çš„é«˜åº¦æ—¶ï¼Œæµ®åŠ¨å­å…ƒç´ ä¹Ÿå‚ä¸è®¡ç®—</li> <li>æ–‡å­—å±‚ä¸ä¼šè¢«æµ®åŠ¨å±‚è¦†ç›–ï¼Œç¯ç»•äºå‘¨å›´</li></ul> <p><strong>åº”ç”¨:</strong></p> <ul><li>é˜»æ­¢<code>margin</code>é‡å </li> <li>å¯ä»¥åŒ…å«æµ®åŠ¨å…ƒç´  â€”â€” æ¸…é™¤å†…éƒ¨æµ®åŠ¨(æ¸…é™¤æµ®åŠ¨çš„åŸç†æ˜¯ä¸¤ä¸ª<code>div</code>éƒ½ä½äºåŒä¸€ä¸ª <code>BFC</code> åŒºåŸŸä¹‹ä¸­)</li> <li>è‡ªé€‚åº”ä¸¤æ å¸ƒå±€</li> <li>å¯ä»¥é˜»æ­¢å…ƒç´ è¢«æµ®åŠ¨å…ƒç´ è¦†ç›–</li></ul> <h3 id="_3-å±‚å ä¸Šä¸‹æ–‡"><a href="http://interview.poetries.top/docs/simply.html#_3-%E5%B1%82%E5%8F%A0%E4%B8%8A%E4%B8%8B%E6%96%87" class="header-anchor">#</a> 3 å±‚å ä¸Šä¸‹æ–‡</h3> <blockquote><p>å…ƒç´ æå‡ä¸ºä¸€ä¸ªæ¯”è¾ƒç‰¹æ®Šçš„å›¾å±‚ï¼Œåœ¨ä¸‰ç»´ç©ºé—´ä¸­ (zè½´) é«˜å‡ºæ™®é€šå…ƒç´ ä¸€ç­‰ã€‚</p></blockquote> <p><strong>è§¦å‘æ¡ä»¶</strong></p> <ul><li>æ ¹å±‚å ä¸Šä¸‹æ–‡(<code>html</code>)</li> <li><code>position</code></li> <li><code>css3</code>å±æ€§
<ul><li><code>flex</code></li> <li><code>transform</code></li> <li><code>opacity</code></li> <li><code>filter</code></li> <li><code>will-change</code></li> <li><code>webkit-overflow-scrolling</code></li></ul></li></ul> <p><strong>å±‚å ç­‰çº§ï¼šå±‚å ä¸Šä¸‹æ–‡åœ¨zè½´ä¸Šçš„æ’åº</strong></p> <ul><li>åœ¨åŒä¸€å±‚å ä¸Šä¸‹æ–‡ä¸­ï¼Œå±‚å ç­‰çº§æ‰æœ‰æ„ä¹‰</li> <li><code>z-index</code>çš„ä¼˜å…ˆçº§æœ€é«˜</li></ul> <p><img src="./è¿›é˜¶_files/111.png" alt="" class="medium-zoom-image"></p> <h3 id="_4-å·¦å³å±…ä¸­æ–¹æ¡ˆ"><a href="http://interview.poetries.top/docs/simply.html#_4-%E5%B7%A6%E5%8F%B3%E5%B1%85%E4%B8%AD%E6%96%B9%E6%A1%88" class="header-anchor">#</a> 4 å·¦å³å±…ä¸­æ–¹æ¡ˆ</h3> <ul><li>è¡Œå†…å…ƒç´ : <code>text-align: center</code></li> <li>å®šå®½å—çŠ¶å…ƒç´ : å·¦å³ <code>margin</code> å€¼ä¸º <code>auto</code></li> <li>ä¸å®šå®½å—çŠ¶å…ƒç´ : <code>table</code>å¸ƒå±€ï¼Œ<code>position + transform</code></li></ul> <div class="language-css extra-class"><pre class="language-css"><code><span class="token comment">/* æ–¹æ¡ˆ1 */</span>
<span class="token selector">.wrap</span> <span class="token punctuation">{</span>
  <span class="token property">text-align</span><span class="token punctuation">:</span> center
<span class="token punctuation">}</span>
<span class="token selector">.center</span> <span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> inline<span class="token punctuation">;</span>
  <span class="token comment">/* or */</span>
  <span class="token comment">/* display: inline-block; */</span>
<span class="token punctuation">}</span>
<span class="token comment">/* æ–¹æ¡ˆ2 */</span>
<span class="token selector">.center</span> <span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 100px<span class="token punctuation">;</span>
  <span class="token property">margin</span><span class="token punctuation">:</span> 0 auto<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/* æ–¹æ¡ˆ2 */</span>
<span class="token selector">.wrap</span> <span class="token punctuation">{</span>
  <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.center</span> <span class="token punctuation">{</span>
  <span class="token property">position</span><span class="token punctuation">:</span> absulote<span class="token punctuation">;</span>
  <span class="token property">left</span><span class="token punctuation">:</span> 50%<span class="token punctuation">;</span>
  <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">translateX</span><span class="token punctuation">(</span>-50%<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_5-ä¸Šä¸‹å‚ç›´å±…ä¸­æ–¹æ¡ˆ"><a href="http://interview.poetries.top/docs/simply.html#_5-%E4%B8%8A%E4%B8%8B%E5%9E%82%E7%9B%B4%E5%B1%85%E4%B8%AD%E6%96%B9%E6%A1%88" class="header-anchor">#</a> 5 ä¸Šä¸‹å‚ç›´å±…ä¸­æ–¹æ¡ˆ</h3> <ul><li>å®šé«˜ï¼š<code>margin</code>ï¼Œ<code>position + margin</code>(è´Ÿå€¼)</li> <li>ä¸å®šé«˜ï¼š<code>position</code> + <code>transform</code>ï¼Œ<code>flex</code>ï¼Œ<code>IFC + vertical-align:middle</code></li></ul> <div class="language-css extra-class"><pre class="language-css"><code><span class="token comment">/* å®šé«˜æ–¹æ¡ˆ1 */</span>
<span class="token selector">.center</span> <span class="token punctuation">{</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 100px<span class="token punctuation">;</span>
  <span class="token property">margin</span><span class="token punctuation">:</span> 50px 0<span class="token punctuation">;</span>   
<span class="token punctuation">}</span>
<span class="token comment">/* å®šé«˜æ–¹æ¡ˆ2 */</span>
<span class="token selector">.center</span> <span class="token punctuation">{</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 100px<span class="token punctuation">;</span>
  <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
  <span class="token property">top</span><span class="token punctuation">:</span> 50%<span class="token punctuation">;</span>
  <span class="token property">margin-top</span><span class="token punctuation">:</span> -25px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/* ä¸å®šé«˜æ–¹æ¡ˆ1 */</span>
<span class="token selector">.center</span> <span class="token punctuation">{</span>
  <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
  <span class="token property">top</span><span class="token punctuation">:</span> 50%<span class="token punctuation">;</span>
  <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">translateY</span><span class="token punctuation">(</span>-50%<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/* ä¸å®šé«˜æ–¹æ¡ˆ2 */</span>
<span class="token selector">.wrap</span> <span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token property">align-items</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.center</span> <span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/* ä¸å®šé«˜æ–¹æ¡ˆ3 */</span>
<span class="token comment">/* è®¾ç½® inline-block åˆ™ä¼šåœ¨å¤–å±‚äº§ç”Ÿ IFCï¼Œé«˜åº¦è®¾ä¸º 100% æ’‘å¼€ wrap çš„é«˜åº¦ */</span>
<span class="token selector">.wrap::before</span> <span class="token punctuation">{</span>
  <span class="token property">content</span><span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
  <span class="token property">display</span><span class="token punctuation">:</span> inline-block<span class="token punctuation">;</span>
  <span class="token property">vertical-align</span><span class="token punctuation">:</span> middle<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.wrap</span> <span class="token punctuation">{</span>
  <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.center</span> <span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> inline-block<span class="token punctuation">;</span>  
  <span class="token property">vertical-align</span><span class="token punctuation">:</span> middle<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_6-é€‰æ‹©å™¨æƒé‡è®¡ç®—æ–¹å¼"><a href="http://interview.poetries.top/docs/simply.html#_6-%E9%80%89%E6%8B%A9%E5%99%A8%E6%9D%83%E9%87%8D%E8%AE%A1%E7%AE%97%E6%96%B9%E5%BC%8F" class="header-anchor">#</a> 6 é€‰æ‹©å™¨æƒé‡è®¡ç®—æ–¹å¼</h3> <blockquote><p>!important &gt; å†…è”æ ·å¼ = å¤–è”æ ·å¼ &gt; IDé€‰æ‹©å™¨ &gt; ç±»é€‰æ‹©å™¨ = ä¼ªç±»é€‰æ‹©å™¨ = å±æ€§é€‰æ‹©å™¨ &gt; å…ƒç´ é€‰æ‹©å™¨ = ä¼ªå…ƒç´ é€‰æ‹©å™¨ &gt; é€šé…é€‰æ‹©å™¨ = åä»£é€‰æ‹©å™¨ = å…„å¼Ÿé€‰æ‹©å™¨</p></blockquote> <ol><li>å±æ€§åé¢åŠ <code>!import</code>ä¼šè¦†ç›–é¡µé¢å†…ä»»ä½•ä½ç½®å®šä¹‰çš„å…ƒç´ æ ·å¼</li> <li>ä½œä¸º<code>style</code>å±æ€§å†™åœ¨å…ƒç´ å†…çš„æ ·å¼</li> <li><code>id</code>é€‰æ‹©å™¨</li> <li>ç±»é€‰æ‹©å™¨</li> <li>æ ‡ç­¾é€‰æ‹©å™¨</li> <li>é€šé…ç¬¦é€‰æ‹©å™¨ï¼ˆ<code>*</code>ï¼‰</li> <li>æµè§ˆå™¨è‡ªå®šä¹‰æˆ–ç»§æ‰¿</li></ol> <p><strong>åŒä¸€çº§åˆ«ï¼šåå†™çš„ä¼šè¦†ç›–å…ˆå†™çš„</strong></p> <blockquote><p>cssé€‰æ‹©å™¨çš„è§£æåŸåˆ™ï¼šé€‰æ‹©å™¨å®šä½DOMå…ƒç´ æ˜¯ä»å³å¾€å·¦çš„æ–¹å‘ï¼Œè¿™æ ·å¯ä»¥å°½æ—©çš„è¿‡æ»¤æ‰ä¸€äº›ä¸å¿…è¦çš„æ ·å¼è§„åˆ™å’Œå…ƒç´ </p></blockquote> <h3 id="_7-æ¸…é™¤æµ®åŠ¨"><a href="http://interview.poetries.top/docs/simply.html#_7-%E6%B8%85%E9%99%A4%E6%B5%AE%E5%8A%A8" class="header-anchor">#</a> 7 æ¸…é™¤æµ®åŠ¨</h3> <ol><li>åœ¨æµ®åŠ¨å…ƒç´ åé¢æ·»åŠ  <code>clear:both</code>çš„ç©º <code>div</code> å…ƒç´ </li></ol> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>container<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>left<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>right<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token style-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token style language-css"><span class="token property">clear</span><span class="token punctuation">:</span>both</span><span class="token punctuation">"</span></span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ol start="2"><li>ç»™çˆ¶å…ƒç´ æ·»åŠ  <code>overflow:hidden</code> æˆ–è€… <code>auto</code> æ ·å¼ï¼Œè§¦å‘<code>BFC</code></li></ol> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>container<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>left<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>right<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">.container</span><span class="token punctuation">{</span>
    <span class="token property">width</span><span class="token punctuation">:</span> 300px<span class="token punctuation">;</span>
    <span class="token property">background-color</span><span class="token punctuation">:</span> #aaa<span class="token punctuation">;</span>
    <span class="token property">overflow</span><span class="token punctuation">:</span>hidden<span class="token punctuation">;</span>
    <span class="token property">zoom</span><span class="token punctuation">:</span>1<span class="token punctuation">;</span>   <span class="token comment">/*IE6*/</span>
<span class="token punctuation">}</span>
</code></pre></div><ol start="3"><li>ä½¿ç”¨ä¼ªå…ƒç´ ï¼Œä¹Ÿæ˜¯åœ¨å…ƒç´ æœ«å°¾æ·»åŠ ä¸€ä¸ªç‚¹å¹¶å¸¦æœ‰ <code>clear: both</code> å±æ€§çš„å…ƒç´ å®ç°çš„ã€‚</li></ol> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>container clearfix<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>left<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>right<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">.clearfix</span><span class="token punctuation">{</span>
    <span class="token property">zoom</span><span class="token punctuation">:</span> 1<span class="token punctuation">;</span> <span class="token comment">/*IE6*/</span>
<span class="token punctuation">}</span>
<span class="token selector">.clearfix:after</span><span class="token punctuation">{</span>
    <span class="token property">content</span><span class="token punctuation">:</span> <span class="token string">"."</span><span class="token punctuation">;</span>
    <span class="token property">height</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
    <span class="token property">clear</span><span class="token punctuation">:</span> both<span class="token punctuation">;</span>
    <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span>
    <span class="token property">visibility</span><span class="token punctuation">:</span> hidden<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>æ¨èä½¿ç”¨ç¬¬ä¸‰ç§æ–¹æ³•ï¼Œä¸ä¼šåœ¨é¡µé¢æ–°å¢divï¼Œæ–‡æ¡£ç»“æ„æ›´åŠ æ¸…æ™°</p></blockquote> <h3 id="_8-å·¦è¾¹å®šå®½-å³è¾¹è‡ªé€‚åº”æ–¹æ¡ˆ"><a href="http://interview.poetries.top/docs/simply.html#_8-%E5%B7%A6%E8%BE%B9%E5%AE%9A%E5%AE%BD-%E5%8F%B3%E8%BE%B9%E8%87%AA%E9%80%82%E5%BA%94%E6%96%B9%E6%A1%88" class="header-anchor">#</a> 8 å·¦è¾¹å®šå®½ï¼Œå³è¾¹è‡ªé€‚åº”æ–¹æ¡ˆ</h3> <blockquote><p>float + marginï¼Œfloat + calc</p></blockquote> <div class="language-css extra-class"><pre class="language-css"><code><span class="token comment">/* æ–¹æ¡ˆ1 */</span> 
<span class="token selector">.left</span> <span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 120px<span class="token punctuation">;</span>
  <span class="token property">float</span><span class="token punctuation">:</span> left<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.right</span> <span class="token punctuation">{</span>
  <span class="token property">margin-left</span><span class="token punctuation">:</span> 120px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/* æ–¹æ¡ˆ2 */</span> 
<span class="token selector">.left</span> <span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 120px<span class="token punctuation">;</span>
  <span class="token property">float</span><span class="token punctuation">:</span> left<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.right</span> <span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> <span class="token function">calc</span><span class="token punctuation">(</span>100% - 120px<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">float</span><span class="token punctuation">:</span> left<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_9-å·¦å³ä¸¤è¾¹å®šå®½-ä¸­é—´è‡ªé€‚åº”"><a href="http://interview.poetries.top/docs/simply.html#_9-%E5%B7%A6%E5%8F%B3%E4%B8%A4%E8%BE%B9%E5%AE%9A%E5%AE%BD-%E4%B8%AD%E9%97%B4%E8%87%AA%E9%80%82%E5%BA%94" class="header-anchor">#</a> 9 å·¦å³ä¸¤è¾¹å®šå®½ï¼Œä¸­é—´è‡ªé€‚åº”</h3> <blockquote><p>floatï¼Œ<code>float + calc</code>, åœ£æ¯å¸ƒå±€ï¼ˆè®¾ç½®BFCï¼Œmarginè´Ÿå€¼æ³•ï¼‰ï¼Œflex</p></blockquote> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">.wrap</span> <span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 200px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.wrap &gt; div</span> <span class="token punctuation">{</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/* æ–¹æ¡ˆ1 */</span>
<span class="token selector">.left</span> <span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 120px<span class="token punctuation">;</span>
  <span class="token property">float</span><span class="token punctuation">:</span> left<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.right</span> <span class="token punctuation">{</span>
  <span class="token property">float</span><span class="token punctuation">:</span> right<span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 120px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.center</span> <span class="token punctuation">{</span>
  <span class="token property">margin</span><span class="token punctuation">:</span> 0 120px<span class="token punctuation">;</span> 
<span class="token punctuation">}</span>
<span class="token comment">/* æ–¹æ¡ˆ2 */</span>
<span class="token selector">.left</span> <span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 120px<span class="token punctuation">;</span>
  <span class="token property">float</span><span class="token punctuation">:</span> left<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.right</span> <span class="token punctuation">{</span>
  <span class="token property">float</span><span class="token punctuation">:</span> right<span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 120px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.center</span> <span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> <span class="token function">calc</span><span class="token punctuation">(</span>100% - 240px<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">margin-left</span><span class="token punctuation">:</span> 120px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/* æ–¹æ¡ˆ3 */</span>
<span class="token selector">.wrap</span> <span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.left</span> <span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 120px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.right</span> <span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 120px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.center</span> <span class="token punctuation">{</span>
  <span class="token property">flex</span><span class="token punctuation">:</span> 1<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_10-cssåŠ¨ç”»å’Œè¿‡æ¸¡"><a href="http://interview.poetries.top/docs/simply.html#_10-css%E5%8A%A8%E7%94%BB%E5%92%8C%E8%BF%87%E6%B8%A1" class="header-anchor">#</a> 10 CSSåŠ¨ç”»å’Œè¿‡æ¸¡</h3> <p><strong>animation / keyframes</strong></p> <ul><li><code>animation-name</code>: åŠ¨ç”»åç§°ï¼Œå¯¹åº”<code>@keyframes</code></li> <li><code>animation-duration</code>: é—´éš”</li> <li><code>animation-timing-function</code>: æ›²çº¿</li> <li><code>animation-delay</code>: å»¶è¿Ÿ</li> <li><code>animation-iteration-count</code>: æ¬¡æ•°
<ul><li><code>infinite</code>: å¾ªç¯åŠ¨ç”»</li></ul></li> <li><code>animation-direction</code>: æ–¹å‘
<ul><li><code>alternate</code>: åå‘æ’­æ”¾</li></ul></li> <li><code>animation-fill-mode</code>: é™æ­¢æ¨¡å¼
<ul><li><code>forwards</code>: åœæ­¢æ—¶ï¼Œä¿ç•™æœ€åä¸€å¸§</li> <li><code>backwards</code>: åœæ­¢æ—¶ï¼Œå›åˆ°ç¬¬ä¸€å¸§</li> <li><code>both</code>: åŒæ—¶è¿ç”¨ <code>forwards / backwards</code></li></ul></li> <li>å¸¸ç”¨é’©å­: <code>animationend</code></li></ul> <blockquote><p>åŠ¨ç”»å±æ€§: å°½é‡ä½¿ç”¨åŠ¨ç”»å±æ€§è¿›è¡ŒåŠ¨ç”»ï¼Œèƒ½æ‹¥æœ‰è¾ƒå¥½çš„æ€§èƒ½è¡¨ç°</p></blockquote> <ul><li><code>translate</code></li> <li><code>scale</code></li> <li><code>rotate</code></li> <li><code>skew</code></li> <li><code>opacity</code></li> <li><code>color</code></li></ul> <p><strong>transform</strong></p> <ul><li>ä½ç§»å±æ€§ <code>translate( x , y )</code></li> <li>æ—‹è½¬å±æ€§ <code>rotate()</code></li> <li>ç¼©æ”¾å±æ€§ <code>scale()</code></li> <li>å€¾æ–œå±æ€§ <code>skew()</code></li></ul> <p><strong>transition</strong></p> <ul><li><code>transition-property</code>ï¼ˆè¿‡æ¸¡çš„å±æ€§çš„åç§°ï¼‰ã€‚</li> <li><code>transition-duration</code>ï¼ˆå®šä¹‰è¿‡æ¸¡æ•ˆæœèŠ±è´¹çš„æ—¶é—´,é»˜è®¤æ˜¯ <code>0</code>ï¼‰ã€‚</li> <li><code>transition-timing-function:linear(åŒ€é€Ÿ) ease</code>(æ…¢é€Ÿå¼€å§‹ï¼Œç„¶åå˜å¿«ï¼Œç„¶åæ…¢é€Ÿç»“æŸ)ï¼ˆè§„å®šè¿‡æ¸¡æ•ˆæœçš„æ—¶é—´æ›²çº¿ï¼Œæœ€å¸¸ç”¨çš„æ˜¯è¿™ä¸¤ä¸ªï¼‰ã€‚</li> <li><code>transition-delay</code>ï¼ˆè§„å®šè¿‡æ¸¡æ•ˆæœä½•æ—¶å¼€å§‹ã€‚é»˜è®¤æ˜¯ 0ï¼‰</li></ul> <blockquote><p>èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éƒ½æ˜¯å†™ä¸€èµ·çš„ï¼Œæ¯”å¦‚ï¼š<code>transitionï¼š width 2s ease 1s</code></p></blockquote> <p><strong>å…³é”®å¸§åŠ¨ç”»animation</strong></p> <blockquote><p>ä¸€ä¸ªå…³é”®å¸§åŠ¨ç”»ï¼Œæœ€å°‘åŒ…å«ä¸¤éƒ¨åˆ†ï¼Œanimation å±æ€§åŠå±æ€§å€¼ï¼ˆåŠ¨ç”»çš„åç§°å’Œè¿è¡Œæ–¹å¼è¿è¡Œæ—¶é—´ç­‰ï¼‰ã€‚@keyframesï¼ˆè§„å®šåŠ¨ç”»çš„å…·ä½“å®ç°è¿‡ç¨‹ï¼‰</p></blockquote> <p><strong>animation å±æ€§å¯ä»¥æ‹†åˆ†ä¸º</strong></p> <ul><li><code>animation-name</code> è§„å®š@keyframes åŠ¨ç”»çš„åç§°ã€‚</li> <li><code>animation-duration</code> è§„å®šåŠ¨ç”»å®Œæˆä¸€ä¸ªå‘¨æœŸæ‰€èŠ±è´¹çš„ç§’æˆ–æ¯«ç§’ã€‚é»˜è®¤æ˜¯ <code>0</code>ã€‚</li> <li><code>animation-timing-function</code> è§„å®šåŠ¨ç”»çš„é€Ÿåº¦æ›²çº¿ã€‚é»˜è®¤æ˜¯ â€œeaseâ€ï¼Œå¸¸ç”¨çš„è¿˜æœ‰<code>linear</code>ï¼ŒåŒ<code>transtion</code> ã€‚</li> <li><code>animation-delay</code> è§„å®šåŠ¨ç”»ä½•æ—¶å¼€å§‹ã€‚é»˜è®¤æ˜¯ 0ã€‚</li> <li><code>animation-iteration-count</code> è§„å®šåŠ¨ç”»è¢«æ’­æ”¾çš„æ¬¡æ•°ã€‚é»˜è®¤æ˜¯ 1ï¼Œä½†æˆ‘ä»¬ä¸€èˆ¬ç”¨<code>infinite</code>ï¼Œä¸€ç›´æ’­æ”¾</li></ul> <blockquote><p>è€Œ<code>@keyframes</code>çš„ä½¿ç”¨æ–¹æ³•ï¼Œå¯ä»¥æ˜¯<code>from-&gt;to</code>ï¼ˆç­‰åŒäº0%å’Œ100%ï¼‰ï¼Œä¹Ÿå¯ä»¥æ˜¯ä»<code>0%-&gt;100%</code>ä¹‹é—´ä»»æ„ä¸ªçš„åˆ†å±‚è®¾ç½®ã€‚æˆ‘ä»¬é€šè¿‡ä¸‹é¢ä¸€ä¸ªç¨å¾®å¤æ‚ç‚¹çš„<code>demo</code>æ¥çœ‹ä¸€ä¸‹ï¼ŒåŸºæœ¬ä¸Šç”¨åˆ°äº†ä¸Šé¢è¯´åˆ°çš„å¤§éƒ¨åˆ†çŸ¥è¯†</p></blockquote> <div class="language-css extra-class"><pre class="language-css"><code><span class="token property">eg</span><span class="token punctuation">:</span>
   <span class="token atrule"><span class="token rule">@keyframes</span> mymove</span>
  <span class="token punctuation">{</span>
      <span class="token selector">from</span> <span class="token punctuation">{</span><span class="token property">top</span><span class="token punctuation">:</span>0px<span class="token punctuation">;</span><span class="token punctuation">}</span>
      <span class="token selector">to</span> <span class="token punctuation">{</span><span class="token property">top</span><span class="token punctuation">:</span>200px<span class="token punctuation">;</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
 
<span class="token comment">/* ç­‰åŒäºï¼š */</span>
 
<span class="token atrule"><span class="token rule">@keyframes</span> mymove</span>
<span class="token punctuation">{</span>
 <span class="token selector">0%</span>   <span class="token punctuation">{</span><span class="token property">top</span><span class="token punctuation">:</span>0px<span class="token punctuation">;</span><span class="token punctuation">}</span>
 <span class="token selector">25%</span>  <span class="token punctuation">{</span><span class="token property">top</span><span class="token punctuation">:</span>200px<span class="token punctuation">;</span><span class="token punctuation">}</span>
 <span class="token selector">50%</span>  <span class="token punctuation">{</span><span class="token property">top</span><span class="token punctuation">:</span>100px<span class="token punctuation">;</span><span class="token punctuation">}</span>
 <span class="token selector">75%</span>  <span class="token punctuation">{</span><span class="token property">top</span><span class="token punctuation">:</span>200px<span class="token punctuation">;</span><span class="token punctuation">}</span>
 <span class="token selector">100%</span> <span class="token punctuation">{</span><span class="token property">top</span><span class="token punctuation">:</span>0px<span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>ç”¨css3åŠ¨ç”»ä½¿ä¸€ä¸ªå›¾ç‰‡æ—‹è½¬</strong></p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">#loader</span> <span class="token punctuation">{</span>

    <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span>

    <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span>

    <span class="token property">-webkit-animation</span><span class="token punctuation">:</span> spin 2s linear infinite<span class="token punctuation">;</span>

    <span class="token property">animation</span><span class="token punctuation">:</span> spin 2s linear infinite<span class="token punctuation">;</span>

<span class="token punctuation">}</span>

<span class="token atrule"><span class="token rule">@-webkit-keyframes</span> spin</span> <span class="token punctuation">{</span>

    <span class="token selector">0%</span>   <span class="token punctuation">{</span>

        <span class="token property">-webkit-transform</span><span class="token punctuation">:</span> <span class="token function">rotate</span><span class="token punctuation">(</span>0deg<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token property">-ms-transform</span><span class="token punctuation">:</span> <span class="token function">rotate</span><span class="token punctuation">(</span>0deg<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">rotate</span><span class="token punctuation">(</span>0deg<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>

    <span class="token selector">100%</span> <span class="token punctuation">{</span>

        <span class="token property">-webkit-transform</span><span class="token punctuation">:</span> <span class="token function">rotate</span><span class="token punctuation">(</span>360deg<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token property">-ms-transform</span><span class="token punctuation">:</span> <span class="token function">rotate</span><span class="token punctuation">(</span>360deg<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">rotate</span><span class="token punctuation">(</span>360deg<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

<span class="token atrule"><span class="token rule">@keyframes</span> spin</span> <span class="token punctuation">{</span>

    <span class="token selector">0%</span>   <span class="token punctuation">{</span>

        <span class="token property">-webkit-transform</span><span class="token punctuation">:</span> <span class="token function">rotate</span><span class="token punctuation">(</span>0deg<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token property">-ms-transform</span><span class="token punctuation">:</span> <span class="token function">rotate</span><span class="token punctuation">(</span>0deg<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">rotate</span><span class="token punctuation">(</span>0deg<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>

    <span class="token selector">100%</span> <span class="token punctuation">{</span>

        <span class="token property">-webkit-transform</span><span class="token punctuation">:</span> <span class="token function">rotate</span><span class="token punctuation">(</span>360deg<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token property">-ms-transform</span><span class="token punctuation">:</span> <span class="token function">rotate</span><span class="token punctuation">(</span>360deg<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">rotate</span><span class="token punctuation">(</span>360deg<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div><h3 id="_11-css3çš„æ–°ç‰¹æ€§"><a href="http://interview.poetries.top/docs/simply.html#_11-css3%E7%9A%84%E6%96%B0%E7%89%B9%E6%80%A7" class="header-anchor">#</a> 11 CSS3çš„æ–°ç‰¹æ€§</h3> <ul><li><code>transition</code>ï¼šè¿‡æ¸¡</li> <li><code>transform</code>: æ—‹è½¬ã€ç¼©æ”¾ã€ç§»åŠ¨æˆ–å€¾æ–œ</li> <li><code>animation</code>: åŠ¨ç”»</li> <li><code>gradient</code>: æ¸å˜</li> <li><code>box-shadow</code>: é˜´å½±</li> <li><code>border-radius</code>: åœ†è§’</li> <li><code>word-break</code>: <code>normal|break-all|keep-all</code>; æ–‡å­—æ¢è¡Œ(é»˜è®¤è§„åˆ™|å•è¯ä¹Ÿå¯ä»¥æ¢è¡Œ|åªåœ¨åŠè§’ç©ºæ ¼æˆ–è¿å­—ç¬¦æ¢è¡Œ)</li> <li><code>text-overflow</code>: æ–‡å­—è¶…å‡ºéƒ¨åˆ†å¤„ç†</li> <li><code>text-shadow</code>: æ°´å¹³é˜´å½±ï¼Œå‚ç›´é˜´å½±ï¼Œæ¨¡ç³Šçš„è·ç¦»ï¼Œä»¥åŠé˜´å½±çš„é¢œè‰²ã€‚</li> <li><code>box-sizing</code>: <code>content-box|border-box</code> ç›’æ¨¡å‹</li> <li>åª’ä½“æŸ¥è¯¢ <code>@media screen and (max-width: 960px) {}</code>è¿˜æœ‰æ‰“å°<code>print</code></li></ul> <h3 id="_12-åˆ—ä¸¾å‡ ä¸ªcssä¸­å¯ç»§æ‰¿å’Œä¸å¯ç»§æ‰¿çš„å…ƒç´ "><a href="http://interview.poetries.top/docs/simply.html#_12-%E5%88%97%E4%B8%BE%E5%87%A0%E4%B8%AAcss%E4%B8%AD%E5%8F%AF%E7%BB%A7%E6%89%BF%E5%92%8C%E4%B8%8D%E5%8F%AF%E7%BB%A7%E6%89%BF%E7%9A%84%E5%85%83%E7%B4%A0" class="header-anchor">#</a> 12 åˆ—ä¸¾å‡ ä¸ªcssä¸­å¯ç»§æ‰¿å’Œä¸å¯ç»§æ‰¿çš„å…ƒç´ </h3> <ul><li>ä¸å¯ç»§æ‰¿çš„ï¼š<code>displayã€marginã€borderã€paddingã€backgroundã€heightã€min-heightã€max-heightã€widthã€min-widthã€max-widthã€overflowã€positionã€leftã€rightã€topã€bottomã€z-indexã€floatã€clearã€table-layoutã€vertical-align</code></li> <li>æ‰€æœ‰å…ƒç´ å¯ç»§æ‰¿ï¼š<code>visibility</code>å’Œ<code>cursor</code>ã€‚</li> <li>å†…è”å…ƒç´ å¯ç»§æ‰¿ï¼š<code>letter-spacingã€word-spacingã€white-spaceã€line-heightã€colorã€fontã€font-familyã€font-sizeã€font-styleã€font-variantã€font-weightã€text-decorationã€text-transformã€direction</code>ã€‚</li> <li>ç»ˆç«¯å—çŠ¶å…ƒç´ å¯ç»§æ‰¿ï¼š<code>text-indentå’Œtext-align</code>ã€‚</li> <li>åˆ—è¡¨å…ƒç´ å¯ç»§æ‰¿ï¼š<code>list-styleã€list-style-typeã€list-style-positionã€list-style-imag</code>e`ã€‚</li></ul> <p><strong>transitionå’Œanimationçš„åŒºåˆ«</strong></p> <blockquote><p><code>Animation</code>å’Œ<code>transition</code>å¤§éƒ¨åˆ†å±æ€§æ˜¯ç›¸åŒçš„ï¼Œä»–ä»¬éƒ½æ˜¯éšæ—¶é—´æ”¹å˜å…ƒç´ çš„å±æ€§å€¼ï¼Œä»–ä»¬çš„ä¸»è¦åŒºåˆ«æ˜¯<code>transition</code>éœ€è¦è§¦å‘ä¸€ä¸ªäº‹ä»¶æ‰èƒ½æ”¹å˜å±æ€§ï¼Œè€Œ<code>animation</code>ä¸éœ€è¦è§¦å‘ä»»ä½•äº‹ä»¶çš„æƒ…å†µä¸‹æ‰ä¼šéšæ—¶é—´æ”¹å˜å±æ€§å€¼ï¼Œå¹¶ä¸”<code>transition</code>ä¸º2å¸§ï¼Œä»<code>from .... to</code>ï¼Œè€Œ<code>animation</code>å¯ä»¥ä¸€å¸§ä¸€å¸§çš„</p></blockquote> <h2 id="ä¸‰ã€æµè§ˆå™¨"><a href="http://interview.poetries.top/docs/simply.html#%E4%B8%89%E3%80%81%E6%B5%8F%E8%A7%88%E5%99%A8" class="header-anchor">#</a> ä¸‰ã€æµè§ˆå™¨</h2> <h3 id="_1-æµè§ˆå™¨æ¶æ„"><a href="http://interview.poetries.top/docs/simply.html#_1-%E6%B5%8F%E8%A7%88%E5%99%A8%E6%9E%B6%E6%9E%84" class="header-anchor">#</a> 1 æµè§ˆå™¨æ¶æ„</h3> <ul><li>ç”¨æˆ·ç•Œé¢</li> <li>ä¸»è¿›ç¨‹</li> <li>å†…æ ¸
<ul><li>æ¸²æŸ“å¼•æ“</li> <li><code>JS</code> å¼•æ“
<ul><li>æ‰§è¡Œæ ˆ</li></ul></li></ul></li> <li>äº‹ä»¶è§¦å‘çº¿ç¨‹
<ul><li>æ¶ˆæ¯é˜Ÿåˆ—
<ul><li>å¾®ä»»åŠ¡</li> <li>å®ä»»åŠ¡</li></ul></li></ul></li> <li>ç½‘ç»œå¼‚æ­¥çº¿ç¨‹</li> <li>å®šæ—¶å™¨çº¿ç¨‹</li></ul> <h3 id="_2-æ¸²æŸ“æœºåˆ¶"><a href="http://interview.poetries.top/docs/simply.html#_2-%E6%B8%B2%E6%9F%93%E6%9C%BA%E5%88%B6" class="header-anchor">#</a> 2 æ¸²æŸ“æœºåˆ¶</h3> <p><strong>1. æµè§ˆå™¨å¦‚ä½•æ¸²æŸ“ç½‘é¡µ</strong></p> <p><strong>æ¦‚è¿°ï¼šæµè§ˆå™¨æ¸²æŸ“ä¸€å…±æœ‰äº”æ­¥</strong></p> <ol><li>å¤„ç† <code>HTML</code> å¹¶æ„å»º <code>DOM</code> æ ‘ã€‚</li> <li>å¤„ç† <code>CSS</code>æ„å»º <code>CSSOM</code> æ ‘ã€‚</li> <li>å°† <code>DOM</code> ä¸ <code>CSSOM</code> åˆå¹¶æˆä¸€ä¸ªæ¸²æŸ“æ ‘ã€‚</li> <li>æ ¹æ®æ¸²æŸ“æ ‘æ¥å¸ƒå±€ï¼Œè®¡ç®—æ¯ä¸ªèŠ‚ç‚¹çš„ä½ç½®ã€‚</li> <li>è°ƒç”¨ <code>GPU</code> ç»˜åˆ¶ï¼Œåˆæˆå›¾å±‚ï¼Œæ˜¾ç¤ºåœ¨å±å¹•ä¸Š</li></ol> <blockquote><p>ç¬¬å››æ­¥å’Œç¬¬äº”æ­¥æ˜¯æœ€è€—æ—¶çš„éƒ¨åˆ†ï¼Œè¿™ä¸¤æ­¥åˆèµ·æ¥ï¼Œå°±æ˜¯æˆ‘ä»¬é€šå¸¸æ‰€è¯´çš„æ¸²æŸ“</p></blockquote> <p>å…·ä½“å¦‚ä¸‹å›¾è¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤º</p> <p><img src="./è¿›é˜¶_files/19.png" alt="img" class="medium-zoom-image"></p> <p><img src="./è¿›é˜¶_files/20.png" alt="img" class="medium-zoom-image"></p> <p><strong>æ¸²æŸ“</strong></p> <ul><li>ç½‘é¡µç”Ÿæˆçš„æ—¶å€™ï¼Œè‡³å°‘ä¼šæ¸²æŸ“ä¸€æ¬¡</li> <li>åœ¨ç”¨æˆ·è®¿é—®çš„è¿‡ç¨‹ä¸­ï¼Œè¿˜ä¼šä¸æ–­é‡æ–°æ¸²æŸ“</li></ul> <blockquote><p>é‡æ–°æ¸²æŸ“éœ€è¦é‡å¤ä¹‹å‰çš„ç¬¬å››æ­¥(é‡æ–°ç”Ÿæˆå¸ƒå±€)+ç¬¬äº”æ­¥(é‡æ–°ç»˜åˆ¶)æˆ–è€…åªæœ‰ç¬¬äº”ä¸ªæ­¥(é‡æ–°ç»˜åˆ¶)</p></blockquote> <ul><li>åœ¨æ„å»º <code>CSSOM</code> æ ‘æ—¶ï¼Œä¼šé˜»å¡æ¸²æŸ“ï¼Œç›´è‡³ <code>CSSOM</code>æ ‘æ„å»ºå®Œæˆã€‚å¹¶ä¸”æ„å»º <code>CSSOM</code> æ ‘æ˜¯ä¸€ä¸ªååˆ†æ¶ˆè€—æ€§èƒ½çš„è¿‡ç¨‹ï¼Œæ‰€ä»¥åº”è¯¥å°½é‡ä¿è¯å±‚çº§æ‰å¹³ï¼Œå‡å°‘è¿‡åº¦å±‚å ï¼Œè¶Šæ˜¯å…·ä½“çš„ <code>CSS</code> é€‰æ‹©å™¨ï¼Œæ‰§è¡Œé€Ÿåº¦è¶Šæ…¢</li> <li>å½“ <code>HTML</code> è§£æåˆ° <code>script</code> æ ‡ç­¾æ—¶ï¼Œä¼šæš‚åœæ„å»º <code>DOM</code>ï¼Œå®Œæˆåæ‰ä¼šä»æš‚åœçš„åœ°æ–¹é‡æ–°å¼€å§‹ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœä½ æƒ³é¦–å±æ¸²æŸ“çš„è¶Šå¿«ï¼Œå°±è¶Šä¸åº”è¯¥åœ¨é¦–å±å°±åŠ è½½ <code>JS</code> æ–‡ä»¶ã€‚å¹¶ä¸”<code>CSS</code>ä¹Ÿä¼šå½±å“ <code>JS</code> çš„æ‰§è¡Œï¼Œåªæœ‰å½“è§£æå®Œæ ·å¼è¡¨æ‰ä¼šæ‰§è¡Œ <code>JS</code>ï¼Œæ‰€ä»¥ä¹Ÿå¯ä»¥è®¤ä¸ºè¿™ç§æƒ…å†µä¸‹ï¼Œ<code>CSS</code> ä¹Ÿä¼šæš‚åœæ„å»º <code>DOM</code></li></ul> <p><strong>2. æµè§ˆå™¨æ¸²æŸ“äº”ä¸ªé˜¶æ®µ</strong></p> <p><strong>2.1 ç¬¬ä¸€æ­¥ï¼šè§£æHTMLæ ‡ç­¾ï¼Œæ„å»ºDOMæ ‘</strong></p> <blockquote><p>åœ¨è¿™ä¸ªé˜¶æ®µï¼Œå¼•æ“å¼€å§‹è§£æ<code>html</code>ï¼Œè§£æå‡ºæ¥çš„ç»“æœä¼šæˆä¸ºä¸€æ£µ<code>dom</code>æ ‘
<code>dom</code>çš„ç›®çš„è‡³å°‘æœ‰<code>2</code>ä¸ª</p></blockquote> <ul><li>ä½œä¸ºä¸‹ä¸ªé˜¶æ®µæ¸²æŸ“æ ‘çŠ¶å›¾çš„è¾“å…¥</li> <li>æˆä¸ºç½‘é¡µå’Œè„šæœ¬çš„äº¤äº’ç•Œé¢ã€‚(æœ€å¸¸ç”¨çš„å°±æ˜¯<code>getElementById</code>ç­‰ç­‰)</li></ul> <p><strong>å½“è§£æå™¨åˆ°è¾¾scriptæ ‡ç­¾çš„æ—¶å€™ï¼Œå‘ç”Ÿä¸‹é¢å››ä»¶äº‹æƒ…</strong></p> <ol><li><code>html</code>è§£æå™¨åœæ­¢è§£æ,</li> <li>å¦‚æœæ˜¯å¤–éƒ¨è„šæœ¬ï¼Œå°±ä»å¤–éƒ¨ç½‘ç»œè·å–è„šæœ¬ä»£ç </li> <li>å°†æ§åˆ¶æƒäº¤ç»™<code>js</code>å¼•æ“ï¼Œæ‰§è¡Œ<code>js</code>ä»£ç </li> <li>æ¢å¤<code>html</code>è§£æå™¨çš„æ§åˆ¶æƒ</li></ol> <blockquote><p>ç”±æ­¤å¯ä»¥å¾—åˆ°ç¬¬ä¸€ä¸ªç»“è®º1</p></blockquote> <ul><li>ç”±äº<code>&lt;script&gt;</code>æ ‡ç­¾æ˜¯é˜»å¡è§£æçš„ï¼Œå°†è„šæœ¬æ”¾åœ¨ç½‘é¡µå°¾éƒ¨ä¼šåŠ é€Ÿä»£ç æ¸²æŸ“ã€‚</li> <li><code>defer</code>å’Œ<code>async</code>å±æ€§ä¹Ÿèƒ½æœ‰åŠ©äºåŠ è½½å¤–éƒ¨è„šæœ¬ã€‚</li> <li><code>defer</code>ä½¿å¾—è„šæœ¬ä¼šåœ¨<code>dom</code>å®Œæ•´æ„å»ºä¹‹åæ‰§è¡Œï¼›</li> <li><code>async</code>æ ‡ç­¾ä½¿å¾—è„šæœ¬åªæœ‰åœ¨å®Œå…¨<code>available</code>æ‰æ‰§è¡Œï¼Œå¹¶ä¸”æ˜¯ä»¥éé˜»å¡çš„æ–¹å¼è¿›è¡Œçš„</li></ul> <p><strong>2.2 ç¬¬äºŒæ­¥ï¼šè§£æCSSæ ‡ç­¾ï¼Œæ„å»ºCSSOMæ ‘</strong></p> <ul><li>æˆ‘ä»¬å·²ç»çœ‹åˆ°<code>html</code>è§£æå™¨ç¢°åˆ°è„šæœ¬åä¼šåšçš„äº‹æƒ…ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬çœ‹ä¸‹<code>html</code>è§£æå™¨ç¢°åˆ°æ ·å¼è¡¨ä¼šå‘ç”Ÿçš„æƒ…å†µ</li> <li><code>js</code>ä¼šé˜»å¡è§£æï¼Œå› ä¸ºå®ƒä¼šä¿®æ”¹æ–‡æ¡£(<code>document</code>)ã€‚<code>css</code>ä¸ä¼šä¿®æ”¹æ–‡æ¡£çš„ç»“æ„ï¼Œå¦‚æœè¿™æ ·çš„è¯ï¼Œä¼¼ä¹çœ‹èµ·æ¥<code>css</code>æ ·å¼ä¸ä¼šé˜»å¡æµè§ˆå™¨<code>html</code>è§£æã€‚ä½†æ˜¯äº‹å®ä¸Š <code>css</code>æ ·å¼è¡¨æ˜¯é˜»å¡çš„ã€‚é˜»å¡æ˜¯æŒ‡å½“<code>cssom</code>æ ‘å»ºç«‹å¥½ä¹‹åæ‰ä¼šè¿›è¡Œä¸‹ä¸€æ­¥çš„è§£ææ¸²æŸ“</li></ul> <p><strong>é€šè¿‡ä»¥ä¸‹æ‰‹æ®µå¯ä»¥å‡è½»cssomå¸¦æ¥çš„å½±å“</strong></p> <ul><li>å°†<code>script</code>è„šæœ¬æ”¾åœ¨é¡µé¢åº•éƒ¨</li> <li>å°½å¯èƒ½å¿«çš„åŠ è½½<code>css</code>æ ·å¼è¡¨</li> <li>å°†æ ·å¼è¡¨æŒ‰ç…§<code>media type</code>å’Œ<code>media query</code>åŒºåˆ†ï¼Œè¿™æ ·æœ‰åŠ©äºæˆ‘ä»¬å°†<code>css</code>èµ„æºæ ‡è®°æˆéé˜»å¡æ¸²æŸ“çš„èµ„æºã€‚</li> <li>éé˜»å¡çš„èµ„æºè¿˜æ˜¯ä¼šè¢«æµè§ˆå™¨ä¸‹è½½ï¼Œåªæ˜¯ä¼˜å…ˆçº§è¾ƒä½</li></ul> <p><strong>2.3 ç¬¬ä¸‰æ­¥ï¼šæŠŠDOMå’ŒCSSOMç»„åˆæˆæ¸²æŸ“æ ‘ï¼ˆrender treeï¼‰</strong></p> <p><img src="./è¿›é˜¶_files/21.png" alt="img" class="medium-zoom-image"></p> <p><strong>2.4 ç¬¬å››æ­¥ï¼šåœ¨æ¸²æŸ“æ ‘çš„åŸºç¡€ä¸Šè¿›è¡Œå¸ƒå±€ï¼Œè®¡ç®—æ¯ä¸ªèŠ‚ç‚¹çš„å‡ ä½•ç»“æ„</strong></p> <blockquote><p>å¸ƒå±€(<code>layout</code>)ï¼šå®šä½åæ ‡å’Œå¤§å°ï¼Œæ˜¯å¦æ¢è¡Œï¼Œå„ç§<code>position</code>, <code>overflow</code>, <code>z-index</code>å±æ€§</p></blockquote> <p><strong>2.5 è°ƒç”¨ GPU ç»˜åˆ¶ï¼Œåˆæˆå›¾å±‚ï¼Œæ˜¾ç¤ºåœ¨å±å¹•ä¸Š</strong></p> <blockquote><p>å°†æ¸²æŸ“æ ‘çš„å„ä¸ªèŠ‚ç‚¹ç»˜åˆ¶åˆ°å±å¹•ä¸Šï¼Œè¿™ä¸€æ­¥è¢«ç§°ä¸ºç»˜åˆ¶<code>painting</code></p></blockquote> <p><strong>3. æ¸²æŸ“ä¼˜åŒ–ç›¸å…³</strong></p> <p><strong>3.1 Load å’Œ DOMContentLoaded åŒºåˆ«</strong></p> <ul><li><code>Load</code> äº‹ä»¶è§¦å‘ä»£è¡¨é¡µé¢ä¸­çš„ <code>DOM</code>ï¼Œ<code>CSS</code>ï¼Œ<code>JS</code>ï¼Œå›¾ç‰‡å·²ç»å…¨éƒ¨åŠ è½½å®Œæ¯•ã€‚</li> <li><code>DOMContentLoaded</code> äº‹ä»¶è§¦å‘ä»£è¡¨åˆå§‹çš„ <code>HTML</code> è¢«å®Œå…¨åŠ è½½å’Œè§£æï¼Œä¸éœ€è¦ç­‰å¾… <code>CSS</code>ï¼Œ<code>JS</code>ï¼Œå›¾ç‰‡åŠ è½½</li></ul> <p><strong>3.2 å›¾å±‚</strong></p> <blockquote><p>ä¸€èˆ¬æ¥è¯´ï¼Œå¯ä»¥æŠŠæ™®é€šæ–‡æ¡£æµçœ‹æˆä¸€ä¸ªå›¾å±‚ã€‚ç‰¹å®šçš„å±æ€§å¯ä»¥ç”Ÿæˆä¸€ä¸ªæ–°çš„å›¾å±‚ã€‚ä¸åŒçš„å›¾å±‚æ¸²æŸ“äº’ä¸å½±å“ï¼Œæ‰€ä»¥å¯¹äºæŸäº›é¢‘ç¹éœ€è¦æ¸²æŸ“çš„å»ºè®®å•ç‹¬ç”Ÿæˆä¸€ä¸ªæ–°å›¾å±‚ï¼Œæé«˜æ€§èƒ½ã€‚ä½†ä¹Ÿä¸èƒ½ç”Ÿæˆè¿‡å¤šçš„å›¾å±‚ï¼Œä¼šå¼•èµ·åä½œç”¨ã€‚</p></blockquote> <p><strong>é€šè¿‡ä»¥ä¸‹å‡ ä¸ªå¸¸ç”¨å±æ€§å¯ä»¥ç”Ÿæˆæ–°å›¾å±‚</strong></p> <ul><li><code>3D</code> å˜æ¢ï¼š<code>translate3d</code>ã€<code>translateZ</code></li> <li><code>will-change</code></li> <li><code>video</code>ã€<code>iframe</code> æ ‡ç­¾</li> <li>é€šè¿‡åŠ¨ç”»å®ç°çš„ <code>opacity</code> åŠ¨ç”»è½¬æ¢</li> <li><code>position: fixed</code></li></ul> <p><strong>3.3 é‡ç»˜ï¼ˆRepaintï¼‰å’Œå›æµï¼ˆReflowï¼‰</strong></p> <blockquote><p>é‡ç»˜å’Œå›æµæ˜¯æ¸²æŸ“æ­¥éª¤ä¸­çš„ä¸€å°èŠ‚ï¼Œä½†æ˜¯è¿™ä¸¤ä¸ªæ­¥éª¤å¯¹äºæ€§èƒ½å½±å“å¾ˆå¤§</p></blockquote> <ul><li>é‡ç»˜æ˜¯å½“èŠ‚ç‚¹éœ€è¦æ›´æ”¹å¤–è§‚è€Œä¸ä¼šå½±å“å¸ƒå±€çš„ï¼Œæ¯”å¦‚æ”¹å˜ <code>color</code> å°±å«ç§°ä¸ºé‡ç»˜</li> <li>å›æµæ˜¯å¸ƒå±€æˆ–è€…å‡ ä½•å±æ€§éœ€è¦æ”¹å˜å°±ç§°ä¸ºå›æµã€‚</li></ul> <blockquote><p>å›æµå¿…å®šä¼šå‘ç”Ÿé‡ç»˜ï¼Œé‡ç»˜ä¸ä¸€å®šä¼šå¼•å‘å›æµã€‚å›æµæ‰€éœ€çš„æˆæœ¬æ¯”é‡ç»˜é«˜çš„å¤šï¼Œæ”¹å˜æ·±å±‚æ¬¡çš„èŠ‚ç‚¹å¾ˆå¯èƒ½å¯¼è‡´çˆ¶èŠ‚ç‚¹çš„ä¸€ç³»åˆ—å›æµ</p></blockquote> <p><strong>ä»¥ä¸‹å‡ ä¸ªåŠ¨ä½œå¯èƒ½ä¼šå¯¼è‡´æ€§èƒ½é—®é¢˜</strong></p> <ul><li>æ”¹å˜ <code>window</code> å¤§å°</li> <li>æ”¹å˜å­—ä½“</li> <li>æ·»åŠ æˆ–åˆ é™¤æ ·å¼</li> <li>æ–‡å­—æ”¹å˜</li> <li>å®šä½æˆ–è€…æµ®åŠ¨</li> <li>ç›’æ¨¡å‹</li></ul> <p><strong>å¾ˆå¤šäººä¸çŸ¥é“çš„æ˜¯ï¼Œé‡ç»˜å’Œå›æµå…¶å®å’Œ Event loop æœ‰å…³</strong></p> <ul><li>å½“ <code>Event loop</code> æ‰§è¡Œå®Œ<code>Microtasks</code> åï¼Œä¼šåˆ¤æ–­ <code>document</code> æ˜¯å¦éœ€è¦æ›´æ–°ã€‚å› ä¸ºæµè§ˆå™¨æ˜¯ <code>60Hz</code> çš„åˆ·æ–°ç‡ï¼Œæ¯ <code>16ms</code> æ‰ä¼šæ›´æ–°ä¸€æ¬¡ã€‚</li> <li>ç„¶ååˆ¤æ–­æ˜¯å¦æœ‰ <code>resize</code> æˆ–è€… <code>scroll</code> ï¼Œæœ‰çš„è¯ä¼šå»è§¦å‘äº‹ä»¶ï¼Œæ‰€ä»¥ <code>resize</code> å’Œ <code>scroll</code> äº‹ä»¶ä¹Ÿæ˜¯è‡³å°‘ <code>16ms</code>æ‰ä¼šè§¦å‘ä¸€æ¬¡ï¼Œå¹¶ä¸”è‡ªå¸¦èŠ‚æµåŠŸèƒ½ã€‚</li> <li>åˆ¤æ–­æ˜¯å¦è§¦å‘äº† <code>media query</code></li> <li>æ›´æ–°åŠ¨ç”»å¹¶ä¸”å‘é€äº‹ä»¶</li> <li>åˆ¤æ–­æ˜¯å¦æœ‰å…¨å±æ“ä½œäº‹ä»¶</li> <li>æ‰§è¡Œ <code>requestAnimationFrame</code> å›è°ƒ</li> <li>æ‰§è¡Œ <code>IntersectionObserver</code> å›è°ƒï¼Œè¯¥æ–¹æ³•ç”¨äºåˆ¤æ–­å…ƒç´ æ˜¯å¦å¯è§ï¼Œå¯ä»¥ç”¨äºæ‡’åŠ è½½ä¸Šï¼Œä½†æ˜¯å…¼å®¹æ€§ä¸å¥½</li> <li>æ›´æ–°ç•Œé¢</li> <li>ä»¥ä¸Šå°±æ˜¯ä¸€å¸§ä¸­å¯èƒ½ä¼šåšçš„äº‹æƒ…ã€‚å¦‚æœåœ¨ä¸€å¸§ä¸­æœ‰ç©ºé—²æ—¶é—´ï¼Œå°±ä¼šå»æ‰§è¡Œ <code>requestIdleCallback</code> å›è°ƒ</li></ul> <p><strong>å¸¸è§çš„å¼•èµ·é‡ç»˜çš„å±æ€§</strong></p> <ul><li><code>color</code></li> <li><code>border-style</code></li> <li><code>visibility</code></li> <li><code>background</code></li> <li><code>text-decoration</code></li> <li><code>background-image</code></li> <li><code>background-position</code></li> <li><code>background-repeat</code></li> <li><code>outline-color</code></li> <li><code>outline</code></li> <li><code>outline-style</code></li> <li><code>border-radius</code></li> <li><code>outline-width</code></li> <li><code>box-shadow</code></li> <li><code>background-size</code></li></ul> <p><strong>3.4 å¸¸è§å¼•èµ·å›æµå±æ€§å’Œæ–¹æ³•</strong></p> <blockquote><p>ä»»ä½•ä¼šæ”¹å˜å…ƒç´ å‡ ä½•ä¿¡æ¯(å…ƒç´ çš„ä½ç½®å’Œå°ºå¯¸å¤§å°)çš„æ“ä½œï¼Œéƒ½ä¼šè§¦å‘é‡æ’ï¼Œä¸‹é¢åˆ—ä¸€äº›æ —å­</p></blockquote> <ul><li>æ·»åŠ æˆ–è€…åˆ é™¤å¯è§çš„<code>DOM</code>å…ƒç´ ï¼›</li> <li>å…ƒç´ å°ºå¯¸æ”¹å˜â€”â€”è¾¹è·ã€å¡«å……ã€è¾¹æ¡†ã€å®½åº¦å’Œé«˜åº¦</li> <li>å†…å®¹å˜åŒ–ï¼Œæ¯”å¦‚ç”¨æˆ·åœ¨<code>input</code>æ¡†ä¸­è¾“å…¥æ–‡å­—</li> <li>æµè§ˆå™¨çª—å£å°ºå¯¸æ”¹å˜â€”â€”<code>resize</code>äº‹ä»¶å‘ç”Ÿæ—¶</li> <li>è®¡ç®— <code>offsetWidth</code> å’Œ <code>offsetHeight</code> å±æ€§</li> <li>è®¾ç½® <code>style</code> å±æ€§çš„å€¼</li></ul> <p><strong>å›æµå½±å“çš„èŒƒå›´</strong></p> <blockquote><p>ç”±äºæµè§ˆå™¨æ¸²æŸ“ç•Œé¢æ˜¯åŸºäºæµå¤±å¸ƒå±€æ¨¡å‹çš„ï¼Œæ‰€ä»¥è§¦å‘é‡æ’æ—¶ä¼šå¯¹å‘¨å›´DOMé‡æ–°æ’åˆ—ï¼Œå½±å“çš„èŒƒå›´æœ‰ä¸¤ç§</p></blockquote> <ul><li>å…¨å±€èŒƒå›´ï¼šä»æ ¹èŠ‚ç‚¹<code>html</code>å¼€å§‹å¯¹æ•´ä¸ªæ¸²æŸ“æ ‘è¿›è¡Œé‡æ–°å¸ƒå±€ã€‚</li> <li>å±€éƒ¨èŒƒå›´ï¼šå¯¹æ¸²æŸ“æ ‘çš„æŸéƒ¨åˆ†æˆ–æŸä¸€ä¸ªæ¸²æŸ“å¯¹è±¡è¿›è¡Œé‡æ–°å¸ƒå±€</li></ul> <p><strong>å…¨å±€èŒƒå›´å›æµ</strong></p> <div class="language- extra-class"><pre class="language-text"><code>&lt;body&gt;
  &lt;div class="hello"&gt;
    &lt;h4&gt;hello&lt;/h4&gt;
    &lt;p&gt;&lt;strong&gt;Name:&lt;/strong&gt;BDing&lt;/p&gt;
    &lt;h5&gt;male&lt;/h5&gt;
    &lt;ol&gt;
      &lt;li&gt;coding&lt;/li&gt;
      &lt;li&gt;loving&lt;/li&gt;
    &lt;/ol&gt;
  &lt;/div&gt;
&lt;/body&gt;
</code></pre></div><blockquote><p>å½“<code>p</code>èŠ‚ç‚¹ä¸Šå‘ç”Ÿ<code>reflow</code>æ—¶ï¼Œ<code>hello</code>å’Œ<code>body</code>ä¹Ÿä¼šé‡æ–°æ¸²æŸ“ï¼Œç”šè‡³<code>h5</code>å’Œ<code>ol</code>éƒ½ä¼šæ”¶åˆ°å½±å“</p></blockquote> <p><strong>å±€éƒ¨èŒƒå›´å›æµ</strong></p> <blockquote><p>ç”¨å±€éƒ¨å¸ƒå±€æ¥è§£é‡Šè¿™ç§ç°è±¡ï¼šæŠŠä¸€ä¸ª<code>dom</code>çš„å®½é«˜ä¹‹ç±»çš„å‡ ä½•ä¿¡æ¯å®šæ­»ï¼Œç„¶ååœ¨<code>dom</code>å†…éƒ¨è§¦å‘é‡æ’ï¼Œå°±åªä¼šé‡æ–°æ¸²æŸ“è¯¥<code>dom</code>å†…éƒ¨çš„å…ƒç´ ï¼Œè€Œä¸ä¼šå½±å“åˆ°å¤–ç•Œ</p></blockquote> <p><strong>3.5 å‡å°‘é‡ç»˜å’Œå›æµ</strong></p> <blockquote><p>ä½¿ç”¨ <code>translate</code> æ›¿ä»£ <code>top</code></p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>&lt;div class="test"&gt;&lt;/div&gt;
&lt;style&gt;
    .test {
        position: absolute;
        top: 10px;
        width: 100px;
        height: 100px;
        background: red;
    }
&lt;/style&gt;
&lt;script&gt;
    setTimeout(() =&gt; {
        // å¼•èµ·å›æµ
        document.querySelector('.test').style.top = '100px'
    }, 1000)
&lt;/script&gt;
</code></pre></div><ul><li>ä½¿ç”¨ <code>visibility</code> æ›¿æ¢ <code>display: none</code> ï¼Œå› ä¸ºå‰è€…åªä¼šå¼•èµ·é‡ç»˜ï¼Œåè€…ä¼šå¼•å‘å›æµï¼ˆæ”¹å˜äº†å¸ƒå±€ï¼‰</li> <li>æŠŠ <code>DOM</code> ç¦»çº¿åä¿®æ”¹ï¼Œæ¯”å¦‚ï¼šå…ˆæŠŠ <code>DOM</code> ç»™ <code>display:none</code> (æœ‰ä¸€æ¬¡ <code>Reflow)</code>ï¼Œç„¶åä½ ä¿®æ”¹<code>100</code>æ¬¡ï¼Œç„¶åå†æŠŠå®ƒæ˜¾ç¤ºå‡ºæ¥</li> <li>ä¸è¦æŠŠ <code>DOM</code> ç»“ç‚¹çš„å±æ€§å€¼æ”¾åœ¨ä¸€ä¸ªå¾ªç¯é‡Œå½“æˆå¾ªç¯é‡Œçš„å˜é‡</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">1000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// è·å– offsetTop ä¼šå¯¼è‡´å›æµï¼Œå› ä¸ºéœ€è¦å»è·å–æ­£ç¡®çš„å€¼</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'.test'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>style<span class="token punctuation">.</span>offsetTop<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>ä¸è¦ä½¿ç”¨ <code>table</code> å¸ƒå±€ï¼Œå¯èƒ½å¾ˆå°çš„ä¸€ä¸ªå°æ”¹åŠ¨ä¼šé€ æˆæ•´ä¸ª <code>table</code> çš„é‡æ–°å¸ƒå±€</li> <li>åŠ¨ç”»å®ç°çš„é€Ÿåº¦çš„é€‰æ‹©ï¼ŒåŠ¨ç”»é€Ÿåº¦è¶Šå¿«ï¼Œå›æµæ¬¡æ•°è¶Šå¤šï¼Œä¹Ÿå¯ä»¥é€‰æ‹©ä½¿ç”¨ <code>requestAnimationFrame</code></li> <li><code>CSS</code>é€‰æ‹©ç¬¦ä»å³å¾€å·¦åŒ¹é…æŸ¥æ‰¾ï¼Œé¿å… <code>DOM</code>æ·±åº¦è¿‡æ·±</li> <li>å°†é¢‘ç¹è¿è¡Œçš„åŠ¨ç”»å˜ä¸ºå›¾å±‚ï¼Œå›¾å±‚èƒ½å¤Ÿé˜»æ­¢è¯¥èŠ‚ç‚¹å›æµå½±å“åˆ«çš„å…ƒç´ ã€‚æ¯”å¦‚å¯¹äº <code>video</code>æ ‡ç­¾ï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨å°†è¯¥èŠ‚ç‚¹å˜ä¸ºå›¾å±‚ã€‚</li></ul> <p><img src="./è¿›é˜¶_files/22.png" alt="img" class="medium-zoom-image"></p> <p><img src="./è¿›é˜¶_files/23.png" alt="img" class="medium-zoom-image"></p> <h3 id="_3-ç¼“å­˜æœºåˆ¶"><a href="http://interview.poetries.top/docs/simply.html#_3-%E7%BC%93%E5%AD%98%E6%9C%BA%E5%88%B6" class="header-anchor">#</a> 3 ç¼“å­˜æœºåˆ¶</h3> <p><strong>1. é¦–å…ˆå¾—æ˜ç¡® http ç¼“å­˜çš„å¥½å¤„</strong></p> <ul><li>å‡å°‘äº†å†—ä½™çš„æ•°æ®ä¼ è¾“ï¼Œå‡å°‘ç½‘è´¹</li> <li>å‡å°‘æœåŠ¡å™¨ç«¯çš„å‹åŠ›</li> <li><code>Web</code> ç¼“å­˜èƒ½å¤Ÿå‡å°‘å»¶è¿Ÿä¸ç½‘ç»œé˜»å¡ï¼Œè¿›è€Œå‡å°‘æ˜¾ç¤ºæŸä¸ªèµ„æºæ‰€ç”¨çš„æ—¶é—´</li> <li>åŠ å¿«å®¢æˆ·ç«¯åŠ è½½ç½‘é¡µçš„é€Ÿåº¦</li></ul> <p><strong>2. å¸¸è§ http ç¼“å­˜çš„ç±»å‹</strong></p> <ul><li>ç§æœ‰ç¼“å­˜ï¼ˆä¸€èˆ¬ä¸ºæœ¬åœ°æµè§ˆå™¨ç¼“å­˜ï¼‰</li> <li>ä»£ç†ç¼“å­˜</li></ul> <p><strong>3. ç„¶åè°ˆè°ˆæœ¬åœ°ç¼“å­˜</strong></p> <blockquote><p>æœ¬åœ°ç¼“å­˜æ˜¯æŒ‡æµè§ˆå™¨è¯·æ±‚èµ„æºæ—¶å‘½ä¸­äº†æµè§ˆå™¨æœ¬åœ°çš„ç¼“å­˜èµ„æºï¼Œæµè§ˆå™¨å¹¶ä¸ä¼šå‘é€çœŸæ­£çš„è¯·æ±‚ç»™æœåŠ¡å™¨äº†ã€‚å®ƒçš„æ‰§è¡Œè¿‡ç¨‹æ˜¯</p></blockquote> <ul><li>ç¬¬ä¸€æ¬¡æµè§ˆå™¨å‘é€è¯·æ±‚ç»™æœåŠ¡å™¨æ—¶ï¼Œæ­¤æ—¶æµè§ˆå™¨è¿˜æ²¡æœ‰æœ¬åœ°ç¼“å­˜å‰¯æœ¬ï¼ŒæœåŠ¡å™¨è¿”å›èµ„æºç»™æµè§ˆå™¨ï¼Œå“åº”ç æ˜¯<code>200 OK</code>ï¼Œæµè§ˆå™¨æ”¶åˆ°èµ„æºåï¼ŒæŠŠèµ„æºå’Œå¯¹åº”çš„å“åº”å¤´ä¸€èµ·ç¼“å­˜ä¸‹æ¥</li> <li>ç¬¬äºŒæ¬¡æµè§ˆå™¨å‡†å¤‡å‘é€è¯·æ±‚ç»™æœåŠ¡å™¨æ—¶å€™ï¼Œæµè§ˆå™¨ä¼šå…ˆæ£€æŸ¥ä¸Šä¸€æ¬¡æœåŠ¡ç«¯è¿”å›çš„å“åº”å¤´ä¿¡æ¯ä¸­çš„<code>Cache-Control</code>ï¼Œå®ƒçš„å€¼æ˜¯ä¸€ä¸ªç›¸å¯¹å€¼ï¼Œå•ä½ä¸ºç§’ï¼Œè¡¨ç¤ºèµ„æºåœ¨å®¢æˆ·ç«¯ç¼“å­˜çš„æœ€å¤§æœ‰æ•ˆæœŸï¼Œè¿‡æœŸæ—¶é—´ä¸ºç¬¬ä¸€æ¬¡è¯·æ±‚çš„æ—¶é—´å‡å»<code>Cache-Control</code>çš„å€¼ï¼Œè¿‡æœŸæ—¶é—´è·Ÿå½“å‰çš„è¯·æ±‚æ—¶é—´æ¯”è¾ƒï¼Œå¦‚æœæœ¬åœ°ç¼“å­˜èµ„æºæ²¡è¿‡æœŸï¼Œé‚£ä¹ˆå‘½ä¸­ç¼“å­˜ï¼Œä¸å†è¯·æ±‚æœåŠ¡å™¨</li> <li>å¦‚æœæ²¡æœ‰å‘½ä¸­ï¼Œæµè§ˆå™¨å°±ä¼šæŠŠè¯·æ±‚å‘é€ç»™æœåŠ¡å™¨ï¼Œè¿›å…¥ç¼“å­˜åå•†é˜¶æ®µã€‚</li></ul> <blockquote><p>ä¸æœ¬åœ°ç¼“å­˜ç›¸å…³çš„å¤´æœ‰ï¼š<code>Cache-Control</code>ã€<code>Expires</code>ï¼Œ<code>Cache-Control</code>æœ‰å¤šä¸ªå¯é€‰å€¼ä»£è¡¨ä¸åŒçš„æ„ä¹‰ï¼Œè€Œ<code>Expires</code>å°±æ˜¯ä¸€ä¸ªæ—¥æœŸæ ¼å¼çš„ç»å¯¹å€¼ã€‚</p></blockquote> <p><strong>3.1 Cache-Control</strong></p> <blockquote><p><code>Cache-Control</code>æ˜¯<code>HTPP</code>ç¼“å­˜ç­–ç•¥ä¸­æœ€é‡è¦çš„å¤´ï¼Œå®ƒæ˜¯<code>HTTP/1.1</code>ä¸­å‡ºç°çš„ï¼Œå®ƒç”±å¦‚ä¸‹å‡ ä¸ªå€¼</p></blockquote> <ul><li><code>no-cache</code>ï¼šä¸ä½¿ç”¨æœ¬åœ°ç¼“å­˜ã€‚éœ€è¦ä½¿ç”¨ç¼“å­˜åå•†ï¼Œå…ˆä¸æœåŠ¡å™¨ç¡®è®¤è¿”å›çš„å“åº”æ˜¯å¦è¢«æ›´æ”¹ï¼Œå¦‚æœä¹‹å‰çš„å“åº”ä¸­å­˜åœ¨<code>ETag</code>ï¼Œé‚£ä¹ˆè¯·æ±‚çš„æ—¶å€™ä¼šä¸æœåŠ¡ç«¯éªŒè¯ï¼Œå¦‚æœèµ„æºæœªè¢«æ›´æ”¹ï¼Œåˆ™å¯ä»¥é¿å…é‡æ–°ä¸‹è½½</li> <li><code>no-store</code>ï¼šç›´æ¥ç¦æ­¢æ¸¸è§ˆå™¨ç¼“å­˜æ•°æ®ï¼Œæ¯æ¬¡ç”¨æˆ·è¯·æ±‚è¯¥èµ„æºï¼Œéƒ½ä¼šå‘æœåŠ¡å™¨å‘é€ä¸€ä¸ªè¯·æ±‚ï¼Œæ¯æ¬¡éƒ½ä¼šä¸‹è½½å®Œæ•´çš„èµ„æº</li> <li><code>public</code>ï¼šå¯ä»¥è¢«æ‰€æœ‰çš„ç”¨æˆ·ç¼“å­˜ï¼ŒåŒ…æ‹¬ç»ˆç«¯ç”¨æˆ·å’Œ<code>CDN</code>ç­‰ä¸­é—´ä»£ç†æœåŠ¡å™¨ã€‚</li> <li><code>private</code>ï¼šåªèƒ½è¢«ç»ˆç«¯ç”¨æˆ·çš„æµè§ˆå™¨ç¼“å­˜ï¼Œä¸å…è®¸<code>CDN</code>ç­‰ä¸­ç»§ç¼“å­˜æœåŠ¡å™¨å¯¹å…¶ç¼“å­˜ã€‚</li> <li><code>max-age</code>ï¼šä»å½“å‰è¯·æ±‚å¼€å§‹ï¼Œå…è®¸è·å–çš„å“åº”è¢«é‡ç”¨çš„æœ€é•¿æ—¶é—´ï¼ˆç§’ï¼‰ã€‚</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># ä¾‹å¦‚ï¼š</span>

Cache-Control: public, max-age<span class="token operator">=</span><span class="token number">1000</span> 
<span class="token comment"># è¡¨ç¤ºèµ„æºå¯ä»¥è¢«æ‰€æœ‰ç”¨æˆ·ä»¥åŠä»£ç†æœåŠ¡å™¨ç¼“å­˜ï¼Œæœ€é•¿æ—¶é—´ä¸º1000ç§’ã€‚</span>
</code></pre></div><p><strong>3.2 Expires</strong></p> <blockquote><p><code>Expires</code>æ˜¯<code>HTTP/1.0</code>å‡ºç°çš„å¤´ä¿¡æ¯ï¼ŒåŒæ ·æ˜¯ç”¨äºå†³å®šæœ¬åœ°ç¼“å­˜ç­–ç•¥çš„å¤´ï¼Œå®ƒæ˜¯ä¸€ä¸ªç»å¯¹æ—¶é—´ï¼Œæ—¶é—´æ ¼å¼æ˜¯å¦‚<code>Mon, 10 Jun 2015 21:31:12 GMT</code>ï¼Œåªè¦å‘é€è¯·æ±‚æ—¶é—´æ˜¯åœ¨<code>Expires</code>ä¹‹å‰ï¼Œé‚£ä¹ˆæœ¬åœ°ç¼“å­˜å§‹ç»ˆæœ‰æ•ˆï¼Œå¦åˆ™å°±ä¼šå»æœåŠ¡å™¨å‘é€è¯·æ±‚è·å–æ–°çš„èµ„æºã€‚å¦‚æœåŒæ—¶å‡ºç°<code>Cache-Controlï¼šmax-age</code>å’Œ<code>Expires</code>ï¼Œé‚£ä¹ˆ<code>max-age</code>ä¼˜å…ˆçº§æ›´é«˜ã€‚ä»–ä»¬å¯ä»¥è¿™æ ·ç»„åˆä½¿ç”¨</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>Cache-Control: public
Expires: Wed, Jan 10 2018 00:27:04 GMT
</code></pre></div><p><strong>3.3 æ‰€è°“çš„ç¼“å­˜åå•†</strong></p> <blockquote><p>å½“ç¬¬ä¸€æ¬¡è¯·æ±‚æ—¶æœåŠ¡å™¨è¿”å›çš„å“åº”å¤´ä¸­å­˜åœ¨ä»¥ä¸‹æƒ…å†µæ—¶</p></blockquote> <ul><li>æ²¡æœ‰ <code>Cache-Control</code> å’Œ <code>Expires</code></li> <li><code>Cache-Control</code> å’Œ <code>Expires</code> è¿‡æœŸäº†</li> <li><code>Cache-Control</code> çš„å±æ€§è®¾ç½®ä¸º <code>no-cache</code> æ—¶</li></ul> <blockquote><p>é‚£ä¹ˆæµè§ˆå™¨ç¬¬äºŒæ¬¡è¯·æ±‚æ—¶å°±ä¼šä¸æœåŠ¡å™¨è¿›è¡Œåå•†ï¼Œè¯¢é—®æµè§ˆå™¨ä¸­çš„ç¼“å­˜èµ„æºæ˜¯ä¸æ˜¯æ—§ç‰ˆæœ¬ï¼Œéœ€ä¸éœ€è¦æ›´æ–°ï¼Œæ­¤æ—¶ï¼ŒæœåŠ¡å™¨å°±ä¼šåšå‡ºåˆ¤æ–­ï¼Œå¦‚æœç¼“å­˜å’ŒæœåŠ¡ç«¯èµ„æºçš„æœ€æ–°ç‰ˆæœ¬æ˜¯ä¸€è‡´çš„ï¼Œé‚£ä¹ˆå°±æ— éœ€å†æ¬¡ä¸‹è½½è¯¥èµ„æºï¼ŒæœåŠ¡ç«¯ç›´æ¥è¿”å›<code>304 Not Modified</code> çŠ¶æ€ç ï¼Œå¦‚æœæœåŠ¡å™¨å‘ç°æµè§ˆå™¨ä¸­çš„ç¼“å­˜å·²ç»æ˜¯æ—§ç‰ˆæœ¬äº†ï¼Œé‚£ä¹ˆæœåŠ¡å™¨å°±ä¼šæŠŠæœ€æ–°èµ„æºçš„å®Œæ•´å†…å®¹è¿”å›ç»™æµè§ˆå™¨ï¼ŒçŠ¶æ€ç å°±æ˜¯<code>200 Ok</code>ï¼Œé‚£ä¹ˆæœåŠ¡ç«¯æ˜¯æ ¹æ®ä»€ä¹ˆæ¥åˆ¤æ–­æµè§ˆå™¨çš„ç¼“å­˜æ˜¯ä¸æ˜¯æœ€æ–°çš„å‘¢ï¼Ÿå…¶å®æ˜¯æ ¹æ®<code>HTTP</code>çš„å¦å¤–ä¸¤ç»„å¤´ä¿¡æ¯ï¼Œåˆ†åˆ«æ˜¯ï¼š<code>Last-Modified/If-Modified-Since</code> ä¸ <code>ETag/If-None-Match</code>ã€‚</p></blockquote> <p><strong>Last-Modified ä¸ If-Modified-Since</strong></p> <ul><li>æµè§ˆå™¨ç¬¬ä¸€æ¬¡è¯·æ±‚èµ„æºæ—¶ï¼ŒæœåŠ¡å™¨ä¼šæŠŠèµ„æºçš„æœ€æ–°ä¿®æ”¹æ—¶é—´<code>Last-Modified:Thu, 29 Dec 2011 18:23:55 GMT</code>æ”¾åœ¨å“åº”å¤´ä¸­è¿”å›ç»™æµè§ˆå™¨</li> <li>ç¬¬äºŒæ¬¡è¯·æ±‚æ—¶ï¼Œæµè§ˆå™¨å°±ä¼šæŠŠä¸Šä¸€æ¬¡æœåŠ¡å™¨è¿”å›çš„ä¿®æ”¹æ—¶é—´æ”¾åœ¨è¯·æ±‚å¤´<code>If-Modified-Since:Thu, 29 Dec 2011 18:23:55</code>å‘é€ç»™æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨å°±ä¼šæ‹¿è¿™ä¸ªæ—¶é—´è·ŸæœåŠ¡å™¨ä¸Šçš„èµ„æºçš„æœ€æ–°ä¿®æ”¹æ—¶é—´è¿›è¡Œå¯¹æ¯”</li></ul> <blockquote><p>å¦‚æœä¸¤è€…ç›¸ç­‰æˆ–è€…å¤§äºæœåŠ¡å™¨ä¸Šçš„æœ€æ–°ä¿®æ”¹æ—¶é—´ï¼Œé‚£ä¹ˆè¡¨ç¤ºæµè§ˆå™¨çš„ç¼“å­˜æ˜¯æœ‰æ•ˆçš„ï¼Œæ­¤æ—¶ç¼“å­˜ä¼šå‘½ä¸­ï¼ŒæœåŠ¡å™¨å°±ä¸å†è¿”å›å†…å®¹ç»™æµè§ˆå™¨äº†ï¼ŒåŒæ—¶<code>Last-Modified</code>å¤´ä¹Ÿä¸ä¼šè¿”å›ï¼Œå› ä¸ºèµ„æºæ²¡è¢«ä¿®æ”¹ï¼Œè¿”å›äº†ä¹Ÿæ²¡ä»€ä¹ˆæ„ä¹‰ã€‚å¦‚æœæ²¡å‘½ä¸­ç¼“å­˜åˆ™æœ€æ–°ä¿®æ”¹çš„èµ„æºè¿åŒ<code>Last-Modified</code>å¤´ä¸€èµ·è¿”å›</p></blockquote> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># ç¬¬ä¸€æ¬¡è¯·æ±‚è¿”å›çš„å“åº”å¤´</span>
Cache-Control:max-age<span class="token operator">=</span><span class="token number">3600</span>
Expires: Fri, Jan <span class="token number">12</span> <span class="token number">2018</span> 00:27:04 GMT
Last-Modified: Wed, Jan <span class="token number">10</span> <span class="token number">2018</span> 00:27:04 GMT
</code></pre></div><div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># ç¬¬äºŒæ¬¡è¯·æ±‚çš„è¯·æ±‚å¤´ä¿¡æ¯</span>
If-Modified-Since: Wed, Jan <span class="token number">10</span> <span class="token number">2018</span> 00:27:04 GMT
</code></pre></div><blockquote><p>è¿™ç»„å¤´ä¿¡æ¯æ˜¯åŸºäºèµ„æºçš„ä¿®æ”¹æ—¶é—´æ¥åˆ¤æ–­èµ„æºæœ‰æ²¡æœ‰æ›´æ–°ï¼Œå¦ä¸€ç§æ–¹å¼å°±æ˜¯æ ¹æ®èµ„æºçš„å†…å®¹æ¥åˆ¤æ–­ï¼Œå°±æ˜¯æ¥ä¸‹æ¥è¦è®¨è®ºçš„ <code>ETag</code> ä¸ <code>If-None-Match</code></p></blockquote> <p><strong>ETagä¸If-None-Match</strong></p> <blockquote><p><code>ETag/If-None-Match</code>ä¸<code>Last-Modified/If-Modified-Since</code>çš„æµç¨‹å…¶å®æ˜¯ç±»ä¼¼çš„ï¼Œå”¯ä¸€çš„åŒºåˆ«æ˜¯å®ƒåŸºäºèµ„æºçš„å†…å®¹çš„æ‘˜è¦ä¿¡æ¯ï¼ˆæ¯”å¦‚<code>MD5 hash</code>ï¼‰æ¥åˆ¤æ–­</p></blockquote> <blockquote><p>æµè§ˆå™¨å‘é€ç¬¬äºŒæ¬¡è¯·æ±‚æ—¶ï¼Œä¼šæŠŠç¬¬ä¸€æ¬¡çš„å“åº”å¤´ä¿¡æ¯<code>ETag</code>çš„å€¼æ”¾åœ¨<code>If-None-Match</code>çš„è¯·æ±‚å¤´ä¸­å‘é€åˆ°æœåŠ¡å™¨ï¼Œä¸æœ€æ–°çš„èµ„æºçš„æ‘˜è¦ä¿¡æ¯å¯¹æ¯”ï¼Œå¦‚æœç›¸ç­‰ï¼Œå–æµè§ˆå™¨ç¼“å­˜ï¼Œå¦åˆ™å†…å®¹æœ‰æ›´æ–°ï¼Œæœ€æ–°çš„èµ„æºè¿åŒæœ€æ–°çš„æ‘˜è¦ä¿¡æ¯è¿”å›ã€‚ç”¨<code>ETag</code>çš„å¥½å¤„æ˜¯å¦‚æœå› ä¸ºæŸç§åŸå› åˆ°æ—¶èµ„æºçš„ä¿®æ”¹æ—¶é—´æ²¡æ”¹å˜ï¼Œé‚£ä¹ˆç”¨<code>ETag</code>å°±èƒ½åŒºåˆ†èµ„æºæ˜¯ä¸æ˜¯æœ‰è¢«æ›´æ–°ã€‚</p></blockquote> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># ç¬¬ä¸€æ¬¡è¯·æ±‚è¿”å›çš„å“åº”å¤´ï¼š</span>

Cache-Control: public, max-age<span class="token operator">=</span><span class="token number">31536000</span>
ETag: <span class="token string">"15f0fff99ed5aae4edffdd6496d7131f"</span>
</code></pre></div><div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># ç¬¬äºŒæ¬¡è¯·æ±‚çš„è¯·æ±‚å¤´ä¿¡æ¯ï¼š</span>

If-None-Match: <span class="token string">"15f0fff99ed5aae4edffdd6496d7131f"</span>
</code></pre></div><p><strong>ç¼“å­˜ä½ç½®</strong></p> <p>æµè§ˆå™¨ç¼“å­˜çš„ä½ç½®çš„è¯ï¼Œå¯ä»¥åˆ†ä¸ºå››ç§,ä¼˜å…ˆçº§ä»é«˜åˆ°ä½æ’åˆ—åˆ†åˆ«ğŸ‘‡</p> <ul><li><code>Service Worker</code></li> <li><code>Memory Cache</code></li> <li><code>Disk Cache</code></li> <li><code>Push Cache</code></li></ul> <p><strong>Service Worker</strong></p> <blockquote><p>è¿™ä¸ªåº”ç”¨åœºæ™¯æ¯”å¦‚PWAï¼Œå®ƒå€Ÿé‰´äº†Web Workeræ€è·¯ï¼Œç”±äºå®ƒè„±ç¦»äº†æµè§ˆå™¨çš„çª—ä½“ï¼Œå› æ­¤æ— æ³•ç›´æ¥è®¿é—®DOMã€‚å®ƒèƒ½å®Œæˆçš„åŠŸèƒ½æ¯”å¦‚ï¼š<code>ç¦»çº¿ç¼“å­˜</code>ã€<code>æ¶ˆæ¯æ¨é€</code>å’Œ<code>ç½‘ç»œä»£ç†</code>ï¼Œå…¶ä¸­<code>ç¦»çº¿ç¼“å­˜</code>å°±æ˜¯<strong>Service Worker Cache</strong>ã€‚</p></blockquote> <p><strong>Memory Cache</strong></p> <blockquote><p>æŒ‡çš„æ˜¯å†…å­˜ç¼“å­˜ï¼Œä»æ•ˆç‡ä¸Šè®²å®ƒæ˜¯æœ€å¿«çš„ï¼Œä»å­˜æ´»æ—¶é—´æ¥è®²åˆæ˜¯æœ€çŸ­çš„ï¼Œå½“æ¸²æŸ“è¿›ç¨‹ç»“æŸåï¼Œå†…å­˜ç¼“å­˜ä¹Ÿå°±ä¸å­˜åœ¨äº†ã€‚</p></blockquote> <p><strong>Disk Cache</strong></p> <blockquote><p>å­˜å‚¨åœ¨ç£ç›˜ä¸­çš„ç¼“å­˜ï¼Œä»å­˜å–æ•ˆç‡ä¸Šè®²æ˜¯æ¯”å†…å­˜ç¼“å­˜æ…¢çš„ï¼Œä¼˜åŠ¿åœ¨äºå­˜å‚¨å®¹é‡å’Œå­˜å‚¨æ—¶é•¿ã€‚</p></blockquote> <p><strong>Disk Cache VS Memory Cache</strong></p> <p>ä¸¤è€…å¯¹æ¯”ï¼Œä¸»è¦çš„ç­–ç•¥ğŸ‘‡</p> <ul><li>å†…å®¹ä½¿ç”¨ç‡é«˜çš„è¯ï¼Œæ–‡ä»¶ä¼˜å…ˆè¿›å…¥ç£ç›˜</li> <li>æ¯”è¾ƒå¤§çš„JSï¼ŒCSSæ–‡ä»¶ä¼šç›´æ¥æ”¾å…¥ç£ç›˜ï¼Œåä¹‹æ”¾å…¥å†…å­˜ã€‚</li></ul> <p><strong>Push Cache</strong></p> <blockquote><p>æ¨é€ç¼“å­˜ï¼Œè¿™ç®—æ˜¯æµè§ˆå™¨ä¸­æœ€åä¸€é“é˜²çº¿å§ï¼Œå®ƒæ˜¯<code>HTTP/2</code>çš„å†…å®¹</p></blockquote> <p><strong>æµè§ˆå™¨ç¼“å­˜æ€»ç»“</strong></p> <blockquote><p>æµè§ˆå™¨ç¼“å­˜åˆ†ä¸ºå¼ºç¼“å­˜å’Œåå•†ç¼“å­˜ã€‚å½“å®¢æˆ·ç«¯è¯·æ±‚æŸä¸ªèµ„æºæ—¶ï¼Œè·å–ç¼“å­˜çš„æµç¨‹å¦‚ä¸‹</p></blockquote> <ul><li>å…ˆæ ¹æ®è¿™ä¸ªèµ„æºçš„ä¸€äº› http header åˆ¤æ–­å®ƒæ˜¯å¦å‘½ä¸­å¼ºç¼“å­˜ï¼Œå…ˆæ£€æŸ¥<code>Cache-Control</code>ï¼Œå¦‚æœå‘½ä¸­ï¼Œåˆ™ç›´æ¥ä»æœ¬åœ°è·å–ç¼“å­˜èµ„æºï¼Œä¸ä¼šå‘è¯·æ±‚åˆ°æœåŠ¡å™¨ï¼›</li> <li>å½“å¼ºç¼“å­˜æ²¡æœ‰å‘½ä¸­æ—¶ï¼Œå®¢æˆ·ç«¯ä¼šå‘é€è¯·æ±‚åˆ°æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨é€šè¿‡å¦ä¸€äº›request headeréªŒè¯è¿™ä¸ªèµ„æºæ˜¯å¦å‘½ä¸­åå•†ç¼“å­˜ï¼Œç§°ä¸ºhttpå†éªŒè¯ï¼Œå¦‚æœå‘½ä¸­ï¼ŒæœåŠ¡å™¨å°†è¯·æ±‚è¿”å›ï¼Œä½†ä¸è¿”å›èµ„æºï¼Œè€Œæ˜¯è¿”å›304å‘Šè¯‰å®¢æˆ·ç«¯ç›´æ¥ä»ç¼“å­˜ä¸­è·å–ï¼Œå®¢æˆ·ç«¯æ”¶åˆ°è¿”å›åå°±ä¼šä»ç¼“å­˜ä¸­è·å–èµ„æºï¼›ï¼ˆæœåŠ¡å™¨é€šè¿‡è¯·æ±‚å¤´ä¸­çš„<code>If-Modified-Since</code>æˆ–è€…<code>If-None-Match</code>å­—æ®µæ£€æŸ¥èµ„æºæ˜¯å¦æ›´æ–°ï¼‰</li> <li>å¼ºç¼“å­˜å’Œåå•†ç¼“å­˜å…±åŒä¹‹å¤„åœ¨äºï¼Œå¦‚æœå‘½ä¸­ç¼“å­˜ï¼ŒæœåŠ¡å™¨éƒ½ä¸ä¼šè¿”å›èµ„æºï¼› åŒºåˆ«æ˜¯ï¼Œå¼ºç¼“å­˜ä¸å¯¹å‘é€è¯·æ±‚åˆ°æœåŠ¡å™¨ï¼Œä½†åå•†ç¼“å­˜ä¼šã€‚</li> <li>å½“åå•†ç¼“å­˜ä¹Ÿæ²¡å‘½ä¸­æ—¶ï¼ŒæœåŠ¡å™¨å°±ä¼šå°†èµ„æºå‘é€å›å®¢æˆ·ç«¯ã€‚</li> <li>å½“ ctrl+f5 å¼ºåˆ¶åˆ·æ–°ç½‘é¡µæ—¶ï¼Œç›´æ¥ä»æœåŠ¡å™¨åŠ è½½ï¼Œè·³è¿‡å¼ºç¼“å­˜å’Œåå•†ç¼“å­˜ï¼›</li> <li>å½“ f5åˆ·æ–°ç½‘é¡µæ—¶ï¼Œè·³è¿‡å¼ºç¼“å­˜ï¼Œä½†æ˜¯ä¼šæ£€æŸ¥åå•†ç¼“å­˜ï¼›</li></ul> <p><strong>å¼ºç¼“å­˜</strong></p> <ul><li>Expiresï¼ˆè¯¥å­—æ®µæ˜¯ http1.0 æ—¶çš„è§„èŒƒï¼Œå€¼ä¸ºä¸€ä¸ªç»å¯¹æ—¶é—´çš„ GMT æ ¼å¼çš„æ—¶é—´å­—ç¬¦ä¸²ï¼Œä»£è¡¨ç¼“å­˜èµ„æºçš„è¿‡æœŸæ—¶é—´ï¼‰</li> <li>Cache-Control:max-ageï¼ˆè¯¥å­—æ®µæ˜¯ http1.1çš„è§„èŒƒï¼Œå¼ºç¼“å­˜åˆ©ç”¨å…¶ max-age å€¼æ¥åˆ¤æ–­ç¼“å­˜èµ„æºçš„æœ€å¤§ç”Ÿå‘½å‘¨æœŸï¼Œå®ƒçš„å€¼å•ä½ä¸ºç§’ï¼‰</li></ul> <p><strong>åå•†ç¼“</strong></p> <ul><li>Last-Modifiedï¼ˆå€¼ä¸ºèµ„æºæœ€åæ›´æ–°æ—¶é—´ï¼ŒéšæœåŠ¡å™¨responseè¿”å›ï¼Œå³ä½¿æ–‡ä»¶æ”¹å›å»ï¼Œæ—¥æœŸä¹Ÿä¼šå˜åŒ–ï¼‰</li> <li>If-Modified-Sinceï¼ˆé€šè¿‡æ¯”è¾ƒä¸¤ä¸ªæ—¶é—´æ¥åˆ¤æ–­èµ„æºåœ¨ä¸¤æ¬¡è¯·æ±‚æœŸé—´æ˜¯å¦æœ‰è¿‡ä¿®æ”¹ï¼Œå¦‚æœæ²¡æœ‰ä¿®æ”¹ï¼Œåˆ™å‘½ä¸­åå•†ç¼“å­˜ï¼‰</li> <li>ETagï¼ˆè¡¨ç¤ºèµ„æºå†…å®¹çš„å”¯ä¸€æ ‡è¯†ï¼ŒéšæœåŠ¡å™¨responseè¿”å›ï¼Œä»…æ ¹æ®æ–‡ä»¶å†…å®¹æ˜¯å¦å˜åŒ–åˆ¤æ–­ï¼‰</li> <li>If-None-Matchï¼ˆæœåŠ¡å™¨é€šè¿‡æ¯”è¾ƒè¯·æ±‚å¤´éƒ¨çš„If-None-Matchä¸å½“å‰èµ„æºçš„ETagæ˜¯å¦ä¸€è‡´æ¥åˆ¤æ–­èµ„æºæ˜¯å¦åœ¨ä¸¤æ¬¡è¯·æ±‚ä¹‹é—´æœ‰è¿‡ä¿®æ”¹ï¼Œå¦‚æœæ²¡æœ‰ä¿®æ”¹ï¼Œåˆ™å‘½ä¸­åå•†ç¼“å­˜ï¼‰</li></ul> <h3 id="_4-æµè§ˆå™¨å­˜å‚¨"><a href="http://interview.poetries.top/docs/simply.html#_4-%E6%B5%8F%E8%A7%88%E5%99%A8%E5%AD%98%E5%82%A8" class="header-anchor">#</a> 4 æµè§ˆå™¨å­˜å‚¨</h3> <blockquote><p>æˆ‘ä»¬ç»å¸¸éœ€è¦å¯¹ä¸šåŠ¡ä¸­çš„ä¸€äº›æ•°æ®è¿›è¡Œå­˜å‚¨ï¼Œé€šå¸¸å¯ä»¥åˆ†ä¸º çŸ­æš‚æ€§å­˜å‚¨ å’Œ æŒä¹…æ€§å‚¨å­˜ã€‚</p></blockquote> <ul><li>çŸ­æš‚æ€§çš„æ—¶å€™ï¼Œæˆ‘ä»¬åªéœ€è¦å°†æ•°æ®å­˜åœ¨å†…å­˜ä¸­ï¼Œåªåœ¨è¿è¡Œæ—¶å¯ç”¨</li> <li>æŒä¹…æ€§å­˜å‚¨ï¼Œå¯ä»¥åˆ†ä¸º æµè§ˆå™¨ç«¯ ä¸ æœåŠ¡å™¨ç«¯
<ul><li>æµè§ˆå™¨:
<ul><li><code>cookie</code>: é€šå¸¸ç”¨äºå­˜å‚¨ç”¨æˆ·èº«ä»½ï¼Œç™»å½•çŠ¶æ€ç­‰
<ul><li><code>http</code> ä¸­è‡ªåŠ¨æºå¸¦ï¼Œ ä½“ç§¯ä¸Šé™ä¸º <code>4K</code>ï¼Œ å¯è‡ªè¡Œè®¾ç½®è¿‡æœŸæ—¶é—´</li></ul></li> <li><code>localStorage / sessionStorage</code>: é•¿ä¹…å‚¨å­˜/çª—å£å…³é—­åˆ é™¤ï¼Œ ä½“ç§¯é™åˆ¶ä¸º <code>4~5M</code></li> <li><code>indexDB</code></li></ul></li> <li>æœåŠ¡å™¨:
<ul><li>åˆ†å¸ƒå¼ç¼“å­˜ <code>redis</code></li> <li>æ•°æ®åº“</li></ul></li></ul></li></ul> <p><strong>cookieå’ŒlocalSrorageã€sessionã€indexDB çš„åŒºåˆ«</strong></p> <table><thead><tr><th>ç‰¹æ€§</th> <th>cookie</th> <th>localStorage</th> <th>sessionStorage</th> <th>indexDB</th></tr></thead> <tbody><tr><td>æ•°æ®ç”Ÿå‘½å‘¨æœŸ</td> <td>ä¸€èˆ¬ç”±æœåŠ¡å™¨ç”Ÿæˆï¼Œå¯ä»¥è®¾ç½®è¿‡æœŸæ—¶é—´</td> <td>é™¤éè¢«æ¸…ç†ï¼Œå¦åˆ™ä¸€ç›´å­˜åœ¨</td> <td>é¡µé¢å…³é—­å°±æ¸…ç†</td> <td>é™¤éè¢«æ¸…ç†ï¼Œå¦åˆ™ä¸€ç›´å­˜åœ¨</td></tr> <tr><td>æ•°æ®å­˜å‚¨å¤§å°</td> <td><code>4K</code></td> <td><code>5M</code></td> <td><code>5M</code></td> <td>æ— é™</td></tr> <tr><td>ä¸æœåŠ¡ç«¯é€šä¿¡</td> <td>æ¯æ¬¡éƒ½ä¼šæºå¸¦åœ¨ header ä¸­ï¼Œå¯¹äºè¯·æ±‚æ€§èƒ½å½±å“</td> <td>ä¸å‚ä¸</td> <td>ä¸å‚ä¸</td> <td>ä¸å‚ä¸</td></tr></tbody></table> <blockquote><p>ä»ä¸Šè¡¨å¯ä»¥çœ‹åˆ°ï¼Œ<code>cookie</code> å·²ç»ä¸å»ºè®®ç”¨äºå­˜å‚¨ã€‚å¦‚æœæ²¡æœ‰å¤§é‡æ•°æ®å­˜å‚¨éœ€æ±‚çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨ <code>localStorage</code>å’Œ <code>sessionStorage</code> ã€‚å¯¹äºä¸æ€ä¹ˆæ”¹å˜çš„æ•°æ®å°½é‡ä½¿ç”¨ <code>localStorage</code> å­˜å‚¨ï¼Œå¦åˆ™å¯ä»¥ç”¨ <code>sessionStorage</code> å­˜å‚¨ã€‚</p></blockquote> <p><strong>å¯¹äº <code>cookie</code>ï¼Œæˆ‘ä»¬è¿˜éœ€è¦æ³¨æ„å®‰å…¨æ€§</strong></p> <table><thead><tr><th>å±æ€§</th> <th>ä½œç”¨</th></tr></thead> <tbody><tr><td><code>value</code></td> <td>å¦‚æœç”¨äºä¿å­˜ç”¨æˆ·ç™»å½•æ€ï¼Œåº”è¯¥å°†è¯¥å€¼åŠ å¯†ï¼Œä¸èƒ½ä½¿ç”¨æ˜æ–‡çš„ç”¨æˆ·æ ‡è¯†</td></tr> <tr><td><code>http-only</code></td> <td>ä¸èƒ½é€šè¿‡ <code>JS</code>è®¿é—® <code>Cookie</code>ï¼Œå‡å°‘ <code>XSS</code>æ”»å‡»</td></tr> <tr><td><code>secure</code></td> <td>åªèƒ½åœ¨åè®®ä¸º <code>HTTPS</code> çš„è¯·æ±‚ä¸­æºå¸¦</td></tr> <tr><td><code>same-site</code></td> <td>è§„å®šæµè§ˆå™¨ä¸èƒ½åœ¨è·¨åŸŸè¯·æ±‚ä¸­æºå¸¦ <code>Cookie</code>ï¼Œå‡å°‘ <code>CSRF</code> æ”»å‡»</td></tr></tbody></table> <h3 id="_5-è·¨åŸŸæ–¹æ¡ˆ"><a href="http://interview.poetries.top/docs/simply.html#_5-%E8%B7%A8%E5%9F%9F%E6%96%B9%E6%A1%88" class="header-anchor">#</a> 5 è·¨åŸŸæ–¹æ¡ˆ</h3> <blockquote><p>å¾ˆå¤šç§æ–¹æ³•ï¼Œä½†ä¸‡å˜ä¸ç¦»å…¶å®—ï¼Œéƒ½æ˜¯ä¸ºäº†æå®šåŒæºç­–ç•¥ã€‚é‡ç”¨çš„æœ‰ <code>jsonp</code>ã€<code>iframe</code>ã€<code>cors</code>ã€<code>img</code>ã€<code>HTML5 postMessage</code>ç­‰ç­‰ã€‚å…¶ä¸­ç”¨åˆ° <code>html</code> æ ‡ç­¾è¿›è¡Œè·¨åŸŸçš„åŸç†å°±æ˜¯ <code>html</code> ä¸å—åŒæºç­–ç•¥å½±å“ã€‚ä½†åªæ˜¯æ¥å— <code>Get</code> çš„è¯·æ±‚æ–¹å¼ï¼Œè¿™ä¸ªå¾—æ¸…æ¥šã€‚</p></blockquote> <blockquote><p><strong>å»¶ä¼¸1ï¼šimg iframe script æ¥å‘é€è·¨åŸŸè¯·æ±‚æœ‰ä»€ä¹ˆä¼˜ç¼ºç‚¹ï¼Ÿ</strong></p></blockquote> <p><strong>1. <code>iframe</code></strong></p> <ul><li>ä¼˜ç‚¹ï¼šè·¨åŸŸå®Œæ¯•ä¹‹å<code>DOM</code>æ“ä½œå’Œäº’ç›¸ä¹‹é—´çš„<code>JavaScript</code>è°ƒç”¨éƒ½æ˜¯æ²¡æœ‰é—®é¢˜çš„</li> <li>ç¼ºç‚¹ï¼š1.è‹¥ç»“æœè¦ä»¥<code>URL</code>å‚æ•°ä¼ é€’ï¼Œè¿™å°±æ„å‘³ç€åœ¨ç»“æœæ•°æ®é‡å¾ˆå¤§çš„æ—¶å€™éœ€è¦åˆ†å‰²ä¼ é€’ï¼Œå·¨çƒ¦ã€‚2.è¿˜æœ‰ä¸€ä¸ªæ˜¯<code>iframe</code>æœ¬èº«å¸¦æ¥çš„ï¼Œæ¯é¡µé¢å’Œ<code>iframe</code>æœ¬èº«çš„äº¤äº’æœ¬èº«å°±æœ‰å®‰å…¨æ€§é™åˆ¶ã€‚</li></ul> <p><strong>2. script</strong></p> <ul><li>ä¼˜ç‚¹ï¼šå¯ä»¥ç›´æ¥è¿”å›<code>json</code>æ ¼å¼çš„æ•°æ®ï¼Œæ–¹ä¾¿å¤„ç†</li> <li>ç¼ºç‚¹ï¼šåªæ¥å—<code>GET</code>è¯·æ±‚æ–¹å¼</li></ul> <p><strong>3. å›¾ç‰‡ping</strong></p> <ul><li>ä¼˜ç‚¹ï¼šå¯ä»¥è®¿é—®ä»»ä½•<code>url</code>ï¼Œä¸€èˆ¬ç”¨æ¥è¿›è¡Œç‚¹å‡»è¿½è¸ªï¼Œåšé¡µé¢åˆ†æå¸¸ç”¨çš„æ–¹æ³•</li> <li>ç¼ºç‚¹ï¼šä¸èƒ½è®¿é—®å“åº”æ–‡æœ¬ï¼Œåªèƒ½ç›‘å¬æ˜¯å¦å“åº”</li></ul> <blockquote><p><strong>å»¶ä¼¸2ï¼šé…åˆ webpack è¿›è¡Œåå‘ä»£ç†ï¼Ÿ</strong></p></blockquote> <p><code>webpack</code> åœ¨ <code>devServer</code> é€‰é¡¹é‡Œé¢æä¾›äº†ä¸€ä¸ª <code>proxy</code> çš„å‚æ•°ä¾›å¼€å‘äººå‘˜è¿›è¡Œåå‘ä»£ç†</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token string">'/api'</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  target<span class="token operator">:</span> <span class="token string">'http://www.example.com'</span><span class="token punctuation">,</span> <span class="token comment">// your target host</span>
  changeOrigin<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// needed for virtual hosted sites</span>
  pathRewrite<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">'^/api'</span><span class="token operator">:</span> <span class="token string">''</span>  <span class="token comment">// rewrite path</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><blockquote><p>ç„¶åå†é…åˆ <code>http-proxy-middleware</code> æ’ä»¶å¯¹ <code>api</code> è¯·æ±‚åœ°å€è¿›è¡Œä»£ç†</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> proxy <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http-proxy-middleware'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// proxy api requests</span>
<span class="token keyword">const</span> exampleProxy <span class="token operator">=</span> <span class="token function">proxy</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è¿™é‡Œçš„ options å°±æ˜¯ webpack é‡Œé¢çš„ proxy é€‰é¡¹å¯¹åº”çš„æ¯ä¸ªé€‰é¡¹</span>

<span class="token comment">// mount `exampleProxy` in web server</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">'/api'</span><span class="token punctuation">,</span> exampleProxy<span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><blockquote><p>ç„¶åå†ç”¨ <code>nginx</code> æŠŠå…è®¸è·¨åŸŸçš„æºåœ°å€æ·»åŠ åˆ°æŠ¥å¤´é‡Œé¢å³å¯</p></blockquote> <blockquote><p>è¯´åˆ° <code>nginx</code> ï¼Œå¯ä»¥å†è°ˆè°ˆ <code>CORS</code> é…ç½®ï¼Œå¤§è‡´å¦‚ä¸‹</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code>location <span class="token operator">/</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>$request_method <span class="token operator">=</span> <span class="token string">'OPTIONS'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    add_header <span class="token string">'Access-Control-Allow-Origin'</span> <span class="token string">'*'</span><span class="token punctuation">;</span>  
    add_header <span class="token string">'Access-Control-Allow-Methods'</span> <span class="token string">'GET, POST, OPTIONS'</span><span class="token punctuation">;</span> 
    add_header <span class="token string">'Access-Control-Allow-Credentials'</span> <span class="token string">'true'</span><span class="token punctuation">;</span>
    add_header <span class="token string">'Access-Control-Allow-Headers'</span> <span class="token string">'DNT, X-Mx-ReqToken, Keep-Alive, User-Agent, X-Requested-With, If-Modified-Since, Cache-Control, Content-Type'</span><span class="token punctuation">;</span>  
    add_header <span class="token string">'Access-Control-Max-Age'</span> <span class="token number">86400</span><span class="token punctuation">;</span>  
    add_header <span class="token string">'Content-Type'</span> <span class="token string">'text/plain charset=UTF-8'</span><span class="token punctuation">;</span>  
    add_header <span class="token string">'Content-Length'</span> <span class="token number">0</span><span class="token punctuation">;</span>  
    <span class="token keyword">return</span> <span class="token number">200</span><span class="token punctuation">;</span>  
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_6-xss-å’Œ-csrf"><a href="http://interview.poetries.top/docs/simply.html#_6-xss-%E5%92%8C-csrf" class="header-anchor">#</a> 6 XSS å’Œ CSRF</h3> <p><strong>1. XSS</strong></p> <blockquote><p>è·¨ç½‘ç«™æŒ‡ä»¤ç ï¼ˆè‹±è¯­ï¼š<code>Cross-site scripting</code>ï¼Œé€šå¸¸ç®€ç§°ä¸ºï¼š<code>XSS</code>ï¼‰æ˜¯ä¸€ç§ç½‘ç«™åº”ç”¨ç¨‹å¼çš„å®‰å…¨æ¼æ´æ”»å‡»ï¼Œæ˜¯ä»£ç æ³¨å…¥çš„ä¸€ç§ã€‚å®ƒå…è®¸æ¶æ„ä½¿ç”¨è€…å°†ç¨‹å¼ç æ³¨å…¥åˆ°ç½‘é¡µä¸Šï¼Œå…¶ä»–ä½¿ç”¨è€…åœ¨è§‚çœ‹ç½‘é¡µæ—¶å°±ä¼šå—åˆ°å½±å“ã€‚è¿™ç±»æ”»å‡»é€šå¸¸åŒ…å«äº† <code>HTML</code> ä»¥åŠä½¿ç”¨è€…ç«¯è„šæœ¬è¯­è¨€</p></blockquote> <blockquote><p><code>XSS</code> åˆ†ä¸ºä¸‰ç§ï¼šåå°„å‹ï¼Œå­˜å‚¨å‹å’Œ <code>DOM-based</code></p></blockquote> <p><strong>å¦‚ä½•æ”»å‡»</strong></p> <ul><li><code>XSS</code> é€šè¿‡ä¿®æ”¹ <code>HTML</code>èŠ‚ç‚¹æˆ–è€…æ‰§è¡Œ <code>JS</code>ä»£ç æ¥æ”»å‡»ç½‘ç«™ã€‚</li> <li>ä¾‹å¦‚é€šè¿‡ <code>URL</code> è·å–æŸäº›å‚æ•°</li></ul> <div class="language-html extra-class"><pre class="language-html"><code><span class="token comment">&lt;!-- http://www.domain.com?name=&lt;script&gt;alert(1)&lt;/script&gt; --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>{{name}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>    
</code></pre></div><blockquote><p>ä¸Šè¿° <code>URL</code> è¾“å…¥å¯èƒ½ä¼šå°† <code>HTML</code> æ”¹ä¸º <code>&lt;div&gt;&lt;script&gt;alert(1)&lt;/script&gt;&lt;/div&gt;</code> ï¼Œè¿™æ ·é¡µé¢ä¸­å°±å‡­ç©ºå¤šäº†ä¸€æ®µå¯æ‰§è¡Œè„šæœ¬ã€‚è¿™ç§æ”»å‡»ç±»å‹æ˜¯åå°„å‹æ”»å‡»ï¼Œä¹Ÿå¯ä»¥è¯´æ˜¯ <code>DOM-based</code> æ”»å‡»</p></blockquote> <p><strong>å¦‚ä½•é˜²å¾¡</strong></p> <blockquote><p>æœ€æ™®éçš„åšæ³•æ˜¯è½¬ä¹‰è¾“å…¥è¾“å‡ºçš„å†…å®¹ï¼Œå¯¹äºå¼•å·ï¼Œå°–æ‹¬å·ï¼Œæ–œæ è¿›è¡Œè½¬ä¹‰</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">escape</span><span class="token punctuation">(</span><span class="token parameter">str</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	str <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">&amp;</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span> <span class="token string">"&amp;amp;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	str <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">&lt;</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span> <span class="token string">"&amp;lt;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	str <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">&gt;</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span> <span class="token string">"&amp;gt;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	str <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">"</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span> <span class="token string">"&amp;quto;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	str <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">'</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span> <span class="token string">"&amp;##39;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	str <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">`</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span> <span class="token string">"&amp;##96;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    str <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\/</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span> <span class="token string">"&amp;##x2F;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> str
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>é€šè¿‡è½¬ä¹‰å¯ä»¥å°†æ”»å‡»ä»£ç  <code>&lt;script&gt;alert(1)&lt;/script&gt;</code> å˜æˆ</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// -&gt; &amp;lt;script&amp;gt;alert(1)&amp;lt;&amp;##x2F;script&amp;gt;</span>
<span class="token function">escape</span><span class="token punctuation">(</span><span class="token string">'&lt;script&gt;alert(1)&lt;/script&gt;'</span><span class="token punctuation">)</span>
</code></pre></div><blockquote><p>å¯¹äºæ˜¾ç¤ºå¯Œæ–‡æœ¬æ¥è¯´ï¼Œä¸èƒ½é€šè¿‡ä¸Šé¢çš„åŠæ³•æ¥è½¬ä¹‰æ‰€æœ‰å­—ç¬¦ï¼Œå› ä¸ºè¿™æ ·ä¼šæŠŠéœ€è¦çš„æ ¼å¼ä¹Ÿè¿‡æ»¤æ‰ã€‚è¿™ç§æƒ…å†µé€šå¸¸é‡‡ç”¨ç™½åå•è¿‡æ»¤çš„åŠæ³•ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥é€šè¿‡é»‘åå•è¿‡æ»¤ï¼Œä½†æ˜¯è€ƒè™‘åˆ°éœ€è¦è¿‡æ»¤çš„æ ‡ç­¾å’Œæ ‡ç­¾å±æ€§å®åœ¨å¤ªå¤šï¼Œæ›´åŠ æ¨èä½¿ç”¨ç™½åå•çš„æ–¹å¼</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> xss <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"xss"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> html <span class="token operator">=</span> <span class="token function">xss</span><span class="token punctuation">(</span><span class="token string">'&lt;h1 id="title"&gt;XSS Demo&lt;/h1&gt;&lt;script&gt;alert("xss");&lt;/script&gt;'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// -&gt; &lt;h1&gt;XSS Demo&lt;/h1&gt;&amp;lt;script&amp;gt;alert("xss");&amp;lt;/script&amp;gt;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><blockquote><p>ä»¥ä¸Šç¤ºä¾‹ä½¿ç”¨äº† <code>js-xss</code>æ¥å®ç°ã€‚å¯ä»¥çœ‹åˆ°åœ¨è¾“å‡ºä¸­ä¿ç•™äº† <code>h1</code> æ ‡ç­¾ä¸”è¿‡æ»¤äº† <code>script</code> æ ‡ç­¾</p></blockquote> <p><strong>2 CSRF</strong></p> <blockquote><p>è·¨ç«™è¯·æ±‚ä¼ªé€ ï¼ˆè‹±è¯­ï¼š<code>Cross-site request forgery</code>ï¼‰ï¼Œä¹Ÿè¢«ç§°ä¸º <code>one-click attack</code>æˆ–è€… <code>session riding</code>ï¼Œé€šå¸¸ç¼©å†™ä¸º <code>CSRF</code> æˆ–è€… <code>XSRF</code>ï¼Œ æ˜¯ä¸€ç§æŒŸåˆ¶ç”¨æˆ·åœ¨å½“å‰å·²ç™»å½•çš„<code>Web</code>åº”ç”¨ç¨‹åºä¸Šæ‰§è¡Œéæœ¬æ„çš„æ“ä½œçš„æ”»å‡»æ–¹æ³•</p></blockquote> <blockquote><p><code>CSRF</code> å°±æ˜¯åˆ©ç”¨ç”¨æˆ·çš„ç™»å½•æ€å‘èµ·æ¶æ„è¯·æ±‚</p></blockquote> <p><strong>å¦‚ä½•æ”»å‡»</strong></p> <blockquote><p>å‡è®¾ç½‘ç«™ä¸­æœ‰ä¸€ä¸ªé€šè¿‡ Get è¯·æ±‚æäº¤ç”¨æˆ·è¯„è®ºçš„æ¥å£ï¼Œé‚£ä¹ˆæ”»å‡»è€…å°±å¯ä»¥åœ¨é’“é±¼ç½‘ç«™ä¸­åŠ å…¥ä¸€ä¸ªå›¾ç‰‡ï¼Œå›¾ç‰‡çš„åœ°å€å°±æ˜¯è¯„è®ºæ¥å£</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>&lt;img src="http://www.domain.com/xxx?comment='attack'"/&gt;
</code></pre></div><p><strong>å¦‚ä½•é˜²å¾¡</strong></p> <ul><li><code>Get</code> è¯·æ±‚ä¸å¯¹æ•°æ®è¿›è¡Œä¿®æ”¹</li> <li>ä¸è®©ç¬¬ä¸‰æ–¹ç½‘ç«™è®¿é—®åˆ°ç”¨æˆ· <code>Cookie</code></li> <li>é˜»æ­¢ç¬¬ä¸‰æ–¹ç½‘ç«™è¯·æ±‚æ¥å£</li> <li>è¯·æ±‚æ—¶é™„å¸¦éªŒè¯ä¿¡æ¯ï¼Œæ¯”å¦‚éªŒè¯ç æˆ–è€… <code>token</code></li></ul> <p><strong>3 å¯†ç å®‰å…¨</strong></p> <p><strong>åŠ ç›</strong></p> <blockquote><p>å¯¹äºå¯†ç å­˜å‚¨æ¥è¯´ï¼Œå¿…ç„¶æ˜¯ä¸èƒ½æ˜æ–‡å­˜å‚¨åœ¨æ•°æ®åº“ä¸­çš„ï¼Œå¦åˆ™ä¸€æ—¦æ•°æ®åº“æ³„éœ²ï¼Œä¼šå¯¹ç”¨æˆ·é€ æˆå¾ˆå¤§çš„æŸå¤±ã€‚å¹¶ä¸”ä¸å»ºè®®åªå¯¹å¯†ç å•çº¯é€šè¿‡åŠ å¯†ç®—æ³•åŠ å¯†ï¼Œå› ä¸ºå­˜åœ¨å½©è™¹è¡¨çš„å…³ç³»</p></blockquote> <ul><li>é€šå¸¸éœ€è¦å¯¹å¯†ç åŠ ç›ï¼Œç„¶åè¿›è¡Œå‡ æ¬¡ä¸åŒåŠ å¯†ç®—æ³•çš„åŠ å¯†</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// åŠ ç›ä¹Ÿå°±æ˜¯ç»™åŸå¯†ç æ·»åŠ å­—ç¬¦ä¸²ï¼Œå¢åŠ åŸå¯†ç é•¿åº¦</span>
<span class="token function">sha256</span><span class="token punctuation">(</span><span class="token function">sha1</span><span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span>salt <span class="token operator">+</span> password <span class="token operator">+</span> salt<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><blockquote><p>ä½†æ˜¯åŠ ç›å¹¶ä¸èƒ½é˜»æ­¢åˆ«äººç›—å–è´¦å·ï¼Œåªèƒ½ç¡®ä¿å³ä½¿æ•°æ®åº“æ³„éœ²ï¼Œä¹Ÿä¸ä¼šæš´éœ²ç”¨æˆ·çš„çœŸå®å¯†ç ã€‚ä¸€æ—¦æ”»å‡»è€…å¾—åˆ°äº†ç”¨æˆ·çš„è´¦å·ï¼Œå¯ä»¥é€šè¿‡æš´åŠ›ç ´è§£çš„æ–¹å¼ç ´è§£å¯†ç ã€‚å¯¹äºè¿™ç§æƒ…å†µï¼Œé€šå¸¸ä½¿ç”¨éªŒè¯ç å¢åŠ å»¶æ—¶æˆ–è€…é™åˆ¶å°è¯•æ¬¡æ•°çš„æ–¹å¼ã€‚å¹¶ä¸”ä¸€æ—¦ç”¨æˆ·è¾“å…¥äº†é”™è¯¯çš„å¯†ç ï¼Œä¹Ÿä¸èƒ½ç›´æ¥æç¤ºç”¨æˆ·è¾“é”™å¯†ç ï¼Œè€Œåº”è¯¥æç¤ºè´¦å·æˆ–å¯†ç é”™è¯¯</p></blockquote> <p><strong>å‰ç«¯åŠ å¯†</strong></p> <blockquote><p>è™½ç„¶å‰ç«¯åŠ å¯†å¯¹äºå®‰å…¨é˜²æŠ¤æ¥è¯´æ„ä¹‰ä¸å¤§ï¼Œä½†æ˜¯åœ¨é‡åˆ°ä¸­é—´äººæ”»å‡»çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥é¿å…æ˜æ–‡å¯†ç è¢«ç¬¬ä¸‰æ–¹è·å–</p></blockquote> <p><strong>4. æ€»ç»“</strong></p> <ul><li><code>XSS</code>ï¼šè·¨ç«™è„šæœ¬æ”»å‡»ï¼Œæ˜¯ä¸€ç§ç½‘ç«™åº”ç”¨ç¨‹åºçš„å®‰å…¨æ¼æ´æ”»å‡»ï¼Œæ˜¯ä»£ç æ³¨å…¥çš„ä¸€ç§ã€‚å¸¸è§æ–¹å¼æ˜¯å°†æ¶æ„ä»£ç æ³¨å…¥åˆæ³•ä»£ç é‡Œéšè—èµ·æ¥ï¼Œå†è¯±å‘æ¶æ„ä»£ç ï¼Œä»è€Œè¿›è¡Œå„ç§å„æ ·çš„éæ³•æ´»åŠ¨</li></ul> <blockquote><p>é˜²èŒƒï¼šè®°ä½ä¸€ç‚¹ â€œæ‰€æœ‰ç”¨æˆ·è¾“å…¥éƒ½æ˜¯ä¸å¯ä¿¡çš„â€ï¼Œæ‰€ä»¥å¾—åšè¾“å…¥è¿‡æ»¤å’Œè½¬ä¹‰</p></blockquote> <ul><li><code>CSRF</code>ï¼šè·¨ç«™è¯·æ±‚ä¼ªé€ ï¼Œä¹Ÿç§° <code>XSRF</code>ï¼Œæ˜¯ä¸€ç§æŒŸåˆ¶ç”¨æˆ·åœ¨å½“å‰å·²ç™»å½•çš„<code>Web</code>åº”ç”¨ç¨‹åºä¸Šæ‰§è¡Œéæœ¬æ„çš„æ“ä½œçš„æ”»å‡»æ–¹æ³•ã€‚ä¸ <code>XSS</code> ç›¸æ¯”ï¼Œ<code>XSS</code>åˆ©ç”¨çš„æ˜¯ç”¨æˆ·å¯¹æŒ‡å®šç½‘ç«™çš„ä¿¡ä»»ï¼Œ<code>CSRF</code>åˆ©ç”¨çš„æ˜¯ç½‘ç«™å¯¹ç”¨æˆ·ç½‘é¡µæµè§ˆå™¨çš„ä¿¡ä»»ã€‚</li></ul> <blockquote><p>é˜²èŒƒï¼šç”¨æˆ·æ“ä½œéªŒè¯ï¼ˆéªŒè¯ç ï¼‰ï¼Œé¢å¤–éªŒè¯æœºåˆ¶ï¼ˆ<code>token</code>ä½¿ç”¨ï¼‰ç­‰</p></blockquote> <h3 id="_7-æ€ä¹ˆåˆ¤æ–­é¡µé¢æ˜¯å¦åŠ è½½å®Œæˆ"><a href="http://interview.poetries.top/docs/simply.html#_7-%E6%80%8E%E4%B9%88%E5%88%A4%E6%96%AD%E9%A1%B5%E9%9D%A2%E6%98%AF%E5%90%A6%E5%8A%A0%E8%BD%BD%E5%AE%8C%E6%88%90" class="header-anchor">#</a> 7 æ€ä¹ˆåˆ¤æ–­é¡µé¢æ˜¯å¦åŠ è½½å®Œæˆ</h3> <ul><li><code>Load</code> äº‹ä»¶è§¦å‘ä»£è¡¨é¡µé¢ä¸­çš„ <code>DOM</code>ï¼Œ<code>CSS</code>ï¼Œ<code>JS</code>ï¼Œå›¾ç‰‡å·²ç»å…¨éƒ¨åŠ è½½å®Œæ¯•ã€‚</li> <li><code>DOMContentLoaded</code> äº‹ä»¶è§¦å‘ä»£è¡¨åˆå§‹çš„ <code>HTML</code> è¢«å®Œå…¨åŠ è½½å’Œè§£æï¼Œä¸éœ€è¦ç­‰å¾… <code>CSS</code>ï¼Œ<code>JS</code>ï¼Œå›¾ç‰‡åŠ è½½</li></ul> <h3 id="_8-service-worker"><a href="http://interview.poetries.top/docs/simply.html#_8-service-worker" class="header-anchor">#</a> 8 Service Worker</h3> <blockquote><p><code>Service workers</code> æœ¬è´¨ä¸Šå……å½“Webåº”ç”¨ç¨‹åºä¸æµè§ˆå™¨ä¹‹é—´çš„ä»£ç†æœåŠ¡å™¨ï¼Œä¹Ÿå¯ä»¥åœ¨ç½‘ç»œå¯ç”¨æ—¶ä½œä¸ºæµè§ˆå™¨å’Œç½‘ç»œé—´çš„ä»£ç†ã€‚å®ƒä»¬æ—¨åœ¨ï¼ˆé™¤å…¶ä»–ä¹‹å¤–ï¼‰ä½¿å¾—èƒ½å¤Ÿåˆ›å»ºæœ‰æ•ˆçš„ç¦»çº¿ä½“éªŒï¼Œæ‹¦æˆªç½‘ç»œè¯·æ±‚å¹¶åŸºäºç½‘ç»œæ˜¯å¦å¯ç”¨ä»¥åŠæ›´æ–°çš„èµ„æºæ˜¯å¦é©»ç•™åœ¨æœåŠ¡å™¨ä¸Šæ¥é‡‡å–é€‚å½“çš„åŠ¨ä½œã€‚ä»–ä»¬è¿˜å…è®¸è®¿é—®æ¨é€é€šçŸ¥å’Œåå°åŒæ­¥API</p></blockquote> <p><strong>ç›®å‰è¯¥æŠ€æœ¯é€šå¸¸ç”¨æ¥åšç¼“å­˜æ–‡ä»¶ï¼Œæé«˜é¦–å±é€Ÿåº¦</strong></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// index.js</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>navigator<span class="token punctuation">.</span>serviceWorker<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  navigator<span class="token punctuation">.</span>serviceWorker
    <span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token string">"sw.js"</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">registration</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"service worker æ³¨å†ŒæˆåŠŸ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"servcie worker æ³¨å†Œå¤±è´¥"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// sw.js</span>
<span class="token comment">// ç›‘å¬ `install` äº‹ä»¶ï¼Œå›è°ƒä¸­ç¼“å­˜æ‰€éœ€æ–‡ä»¶</span>
self<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"install"</span><span class="token punctuation">,</span> <span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  e<span class="token punctuation">.</span><span class="token function">waitUntil</span><span class="token punctuation">(</span>
    caches<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">"my-cache"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">cache</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> cache<span class="token punctuation">.</span><span class="token function">addAll</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"./index.html"</span><span class="token punctuation">,</span> <span class="token string">"./index.js"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// æ‹¦æˆªæ‰€æœ‰è¯·æ±‚äº‹ä»¶</span>
<span class="token comment">// å¦‚æœç¼“å­˜ä¸­å·²ç»æœ‰è¯·æ±‚çš„æ•°æ®å°±ç›´æ¥ç”¨ç¼“å­˜ï¼Œå¦åˆ™å»è¯·æ±‚æ•°æ®</span>
self<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"fetch"</span><span class="token punctuation">,</span> <span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  e<span class="token punctuation">.</span><span class="token function">respondWith</span><span class="token punctuation">(</span>
    caches<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>request<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">response</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>response<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> response<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"fetch source"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><blockquote><p>æ‰“å¼€é¡µé¢ï¼Œå¯ä»¥åœ¨å¼€å‘è€…å·¥å…·ä¸­çš„ <code>Application</code> çœ‹åˆ° <code>Service Worker</code> å·²ç»å¯åŠ¨äº†</p></blockquote> <p><img src="./è¿›é˜¶_files/96.png" alt="" class="medium-zoom-image"></p> <blockquote><p>åœ¨ Cache ä¸­ä¹Ÿå¯ä»¥å‘ç°æˆ‘ä»¬æ‰€éœ€çš„æ–‡ä»¶å·²è¢«ç¼“å­˜</p></blockquote> <p><img src="./è¿›é˜¶_files/97.png" alt="" class="medium-zoom-image"></p> <blockquote><p>å½“æˆ‘ä»¬é‡æ–°åˆ·æ–°é¡µé¢å¯ä»¥å‘ç°æˆ‘ä»¬ç¼“å­˜çš„æ•°æ®æ˜¯ä» <code>Service</code> <code>Worker</code> ä¸­è¯»å–çš„</p></blockquote> <h3 id="_9-dom-èŠ‚ç‚¹æ“ä½œ"><a href="http://interview.poetries.top/docs/simply.html#_9-dom-%E8%8A%82%E7%82%B9%E6%93%8D%E4%BD%9C" class="header-anchor">#</a> 9 DOM èŠ‚ç‚¹æ“ä½œ</h3> <p><strong>ï¼ˆ1ï¼‰åˆ›å»ºæ–°èŠ‚ç‚¹</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">createDocumentFragment</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment">//åˆ›å»ºä¸€ä¸ªDOMç‰‡æ®µ</span>
<span class="token function">createElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span>   <span class="token comment">//åˆ›å»ºä¸€ä¸ªå…·ä½“çš„å…ƒç´ </span>
<span class="token function">createTextNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span>   <span class="token comment">//åˆ›å»ºä¸€ä¸ªæ–‡æœ¬èŠ‚ç‚¹</span>
</code></pre></div><p><strong>ï¼ˆ2ï¼‰æ·»åŠ ã€ç§»é™¤ã€æ›¿æ¢ã€æ’å…¥</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">appendChild</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span>
<span class="token function">removeChild</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span>
<span class="token function">replaceChild</span><span class="token punctuation">(</span><span class="token keyword">new</span><span class="token punctuation">,</span>old<span class="token punctuation">)</span>
<span class="token function">insertBefore</span><span class="token punctuation">(</span><span class="token keyword">new</span><span class="token punctuation">,</span>old<span class="token punctuation">)</span>
</code></pre></div><p><strong>ï¼ˆ3ï¼‰æŸ¥æ‰¾</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">getElementsByName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">getElementsByClassName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">querySelectorAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>ï¼ˆ4ï¼‰å±æ€§æ“ä½œ</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">getAttribute</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">setAttribute</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">hasAttribute</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">removeAttribute</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_10-å»¶è¿ŸåŠ è½½çš„æ–¹å¼æœ‰å“ªäº›"><a href="http://interview.poetries.top/docs/simply.html#_10-%E5%BB%B6%E8%BF%9F%E5%8A%A0%E8%BD%BD%E7%9A%84%E6%96%B9%E5%BC%8F%E6%9C%89%E5%93%AA%E4%BA%9B" class="header-anchor">#</a> 10 å»¶è¿ŸåŠ è½½çš„æ–¹å¼æœ‰å“ªäº›</h3> <blockquote><p>js çš„åŠ è½½ã€è§£æå’Œæ‰§è¡Œä¼šé˜»å¡é¡µé¢çš„æ¸²æŸ“è¿‡ç¨‹ï¼Œå› æ­¤æˆ‘ä»¬å¸Œæœ› js è„šæœ¬èƒ½å¤Ÿå°½å¯èƒ½çš„å»¶è¿ŸåŠ è½½ï¼Œæé«˜é¡µé¢çš„æ¸²æŸ“é€Ÿåº¦ã€‚</p></blockquote> <p><strong>å‡ ç§æ–¹å¼æ˜¯ï¼š</strong></p> <ul><li>å°† js è„šæœ¬æ”¾åœ¨æ–‡æ¡£çš„åº•éƒ¨ï¼Œæ¥ä½¿ js è„šæœ¬å°½å¯èƒ½çš„åœ¨æœ€åæ¥åŠ è½½æ‰§è¡Œ</li> <li>ç»™ js è„šæœ¬æ·»åŠ  <code>defer</code> å±æ€§ï¼Œè¿™ä¸ªå±æ€§ä¼šè®©è„šæœ¬çš„åŠ è½½ä¸æ–‡æ¡£çš„è§£æåŒæ­¥è§£æï¼Œç„¶ååœ¨æ–‡æ¡£è§£æå®Œæˆåå†æ‰§è¡Œè¿™ä¸ªè„šæœ¬æ–‡ä»¶ï¼Œè¿™æ ·çš„è¯å°±èƒ½ä½¿é¡µé¢çš„æ¸²æŸ“ä¸è¢«é˜»å¡ã€‚å¤šä¸ªè®¾ç½®äº† <code>defer</code> å±æ€§çš„è„šæœ¬æŒ‰è§„èŒƒæ¥è¯´æœ€åæ˜¯é¡ºåºæ‰§è¡Œçš„ï¼Œä½†æ˜¯åœ¨ä¸€äº›æµè§ˆå™¨ä¸­å¯èƒ½ä¸æ˜¯è¿™æ ·</li> <li>ç»™ js è„šæœ¬æ·»åŠ  <code>async</code>å±æ€§ï¼Œè¿™ä¸ªå±æ€§ä¼šä½¿è„šæœ¬å¼‚æ­¥åŠ è½½ï¼Œä¸ä¼šé˜»å¡é¡µé¢çš„è§£æè¿‡ç¨‹ï¼Œä½†æ˜¯å½“è„šæœ¬åŠ è½½å®Œæˆåç«‹å³æ‰§è¡Œ jsè„šæœ¬ï¼Œè¿™ä¸ªæ—¶å€™å¦‚æœæ–‡æ¡£æ²¡æœ‰è§£æå®Œæˆçš„è¯åŒæ ·ä¼šé˜»å¡ã€‚å¤šä¸ª <code>async</code> å±æ€§çš„è„šæœ¬çš„æ‰§è¡Œé¡ºåºæ˜¯ä¸å¯é¢„æµ‹çš„ï¼Œä¸€èˆ¬ä¸ä¼šæŒ‰ç…§ä»£ç çš„é¡ºåºä¾æ¬¡æ‰§è¡Œ</li> <li>åŠ¨æ€åˆ›å»º <code>DOM</code> æ ‡ç­¾çš„æ–¹å¼ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹æ–‡æ¡£çš„åŠ è½½äº‹ä»¶è¿›è¡Œç›‘å¬ï¼Œå½“æ–‡æ¡£åŠ è½½å®Œæˆåå†åŠ¨æ€çš„åˆ›å»º <code>script</code> æ ‡ç­¾æ¥å¼•å…¥ js è„šæœ¬</li></ul> <h2 id="å››ã€æ¡†æ¶é€šè¯†"><a href="http://interview.poetries.top/docs/simply.html#%E5%9B%9B%E3%80%81%E6%A1%86%E6%9E%B6%E9%80%9A%E8%AF%86" class="header-anchor">#</a> å››ã€æ¡†æ¶é€šè¯†</h2> <p><a href="http://interview.poetries.top/excellent-docs/16-%E6%A1%86%E6%9E%B6%E9%80%9A%E8%AF%86.html" target="_blank" rel="noopener noreferrer">æ¡†æ¶é€šè¯†<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="äº”ã€vue"><a href="http://interview.poetries.top/docs/simply.html#%E4%BA%94%E3%80%81vue" class="header-anchor">#</a> äº”ã€Vue</h2> <h3 id="_1-vue-å“åº”å¼åŸç†"><a href="http://interview.poetries.top/docs/simply.html#_1-vue-%E5%93%8D%E5%BA%94%E5%BC%8F%E5%8E%9F%E7%90%86" class="header-anchor">#</a> 1 Vue å“åº”å¼åŸç†</h3> <blockquote><p>Vue çš„å“åº”å¼åŸç†æ˜¯æ ¸å¿ƒæ˜¯é€šè¿‡ ES5 çš„ä¿æŠ¤å¯¹è±¡çš„ <code>Object.defindeProperty</code> ä¸­çš„è®¿é—®å™¨å±æ€§ä¸­çš„ get å’Œ set æ–¹æ³•ï¼Œdata ä¸­å£°æ˜çš„å±æ€§éƒ½è¢«æ·»åŠ äº†è®¿é—®å™¨å±æ€§ï¼Œå½“è¯»å– data ä¸­çš„æ•°æ®æ—¶è‡ªåŠ¨è°ƒç”¨ get æ–¹æ³•ï¼Œå½“ä¿®æ”¹ data ä¸­çš„æ•°æ®æ—¶ï¼Œè‡ªåŠ¨è°ƒç”¨ set æ–¹æ³•ï¼Œæ£€æµ‹åˆ°æ•°æ®çš„å˜åŒ–ï¼Œä¼šé€šçŸ¥è§‚å¯Ÿè€… Wacherï¼Œè§‚å¯Ÿè€… Wacherè‡ªåŠ¨è§¦å‘é‡æ–°render å½“å‰ç»„ä»¶ï¼ˆå­ç»„ä»¶ä¸ä¼šé‡æ–°æ¸²æŸ“ï¼‰,ç”Ÿæˆæ–°çš„è™šæ‹Ÿ DOM æ ‘ï¼ŒVue æ¡†æ¶ä¼šéå†å¹¶å¯¹æ¯”æ–°è™šæ‹Ÿ DOM æ ‘å’Œæ—§è™šæ‹Ÿ DOM æ ‘ä¸­æ¯ä¸ªèŠ‚ç‚¹çš„å·®åˆ«ï¼Œå¹¶è®°å½•ä¸‹æ¥ï¼Œæœ€åï¼ŒåŠ è½½æ“ä½œï¼Œå°†æ‰€æœ‰è®°å½•çš„ä¸åŒç‚¹ï¼Œå±€éƒ¨ä¿®æ”¹åˆ°çœŸå® DOMæ ‘ä¸Šã€‚</p></blockquote> <p><img src="./è¿›é˜¶_files/15.png" alt="" class="medium-zoom-image"></p> <ul><li>è™šæ‹ŸDOM (Virtaul DOM): ç”¨ js å¯¹è±¡æ¨¡æ‹Ÿçš„ï¼Œä¿å­˜å½“å‰è§†å›¾å†…æ‰€æœ‰ DOM èŠ‚ç‚¹å¯¹è±¡åŸºæœ¬æè¿°å±æ€§å’ŒèŠ‚ç‚¹é—´å…³ç³»çš„æ ‘ç»“æ„ã€‚ç”¨ js å¯¹è±¡ï¼Œæè¿°æ¯ä¸ªèŠ‚ç‚¹ï¼ŒåŠå…¶çˆ¶å­å…³ç³»ï¼Œå½¢æˆè™šæ‹Ÿ DOM å¯¹è±¡æ ‘ç»“æ„ã€‚</li> <li>å› ä¸ºåªè¦åœ¨ <code>data</code> ä¸­å£°æ˜çš„åŸºæœ¬æ•°æ®ç±»å‹çš„æ•°æ®ï¼ŒåŸºæœ¬ä¸å­˜åœ¨æ•°æ®ä¸å“åº”é—®é¢˜ï¼Œæ‰€ä»¥é‡ç‚¹ä»‹ç»æ•°ç»„å’Œå¯¹è±¡åœ¨<code>vue</code>ä¸­çš„æ•°æ®å“åº”é—®é¢˜ï¼Œvueå¯ä»¥æ£€æµ‹å¯¹è±¡å±æ€§çš„ä¿®æ”¹ï¼Œä½†æ— æ³•ç›‘å¬æ•°ç»„çš„æ‰€æœ‰å˜åŠ¨åŠå¯¹è±¡çš„æ–°å¢å’Œåˆ é™¤ï¼Œåªèƒ½ä½¿ç”¨æ•°ç»„å˜å¼‚æ–¹æ³•åŠ<code>$set</code>æ–¹æ³•ã€‚</li></ul> <p><img src="./è¿›é˜¶_files/16.png" alt="" class="medium-zoom-image"></p> <blockquote><p>å¯ä»¥çœ‹åˆ°ï¼Œ<code>arrayMethods</code> é¦–å…ˆç»§æ‰¿äº† <code>Array</code>ï¼Œç„¶åå¯¹æ•°ç»„ä¸­æ‰€æœ‰èƒ½æ”¹å˜æ•°ç»„è‡ªèº«çš„æ–¹æ³•ï¼Œå¦‚ <code>push</code>ã€<code>pop</code> ç­‰è¿™äº›æ–¹æ³•è¿›è¡Œé‡å†™ã€‚é‡å†™åçš„æ–¹æ³•ä¼šå…ˆæ‰§è¡Œå®ƒä»¬æœ¬èº«åŸæœ‰çš„é€»è¾‘ï¼Œå¹¶å¯¹èƒ½å¢åŠ æ•°ç»„é•¿åº¦çš„ 3 ä¸ªæ–¹æ³• <code>push</code>ã€<code>unshift</code>ã€<code>splice</code> æ–¹æ³•åšäº†åˆ¤æ–­ï¼Œè·å–åˆ°æ’å…¥çš„å€¼ï¼Œç„¶åæŠŠæ–°æ·»åŠ çš„å€¼å˜æˆä¸€ä¸ªå“åº”å¼å¯¹è±¡ï¼Œå¹¶ä¸”å†è°ƒç”¨ <code>ob.dep.notify()</code> æ‰‹åŠ¨è§¦å‘ä¾èµ–é€šçŸ¥ï¼Œè¿™å°±å¾ˆå¥½åœ°è§£é‡Šäº†ç”¨ <code>vm.items.splice</code>(<code>newLength</code>) æ–¹æ³•å¯ä»¥æ£€æµ‹åˆ°å˜åŒ–</p></blockquote> <blockquote><p>æ€»ç»“ï¼šVue é‡‡ç”¨æ•°æ®åŠ«æŒç»“åˆå‘å¸ƒâ€”è®¢é˜…æ¨¡å¼çš„æ–¹æ³•ï¼Œé€šè¿‡ <code>Object.defineProperty()</code> æ¥åŠ«æŒå„ä¸ªå±æ€§çš„ setterï¼Œgetterï¼Œåœ¨æ•°æ®å˜åŠ¨æ—¶å‘å¸ƒæ¶ˆæ¯ç»™è®¢é˜…è€…ï¼Œè§¦å‘ç›¸åº”çš„ç›‘å¬å›è°ƒã€‚</p></blockquote> <p><img src="./è¿›é˜¶_files/vue.jpeg" alt="" class="medium-zoom-image"></p> <ul><li><code>Observer</code> éå†æ•°æ®å¯¹è±¡ï¼Œç»™æ‰€æœ‰å±æ€§åŠ ä¸Š <code>setter</code> å’Œ <code>getter</code>ï¼Œç›‘å¬æ•°æ®çš„å˜åŒ–</li> <li><code>compile</code> è§£ææ¨¡æ¿æŒ‡ä»¤ï¼Œå°†æ¨¡æ¿ä¸­çš„å˜é‡æ›¿æ¢æˆæ•°æ®ï¼Œç„¶ååˆå§‹åŒ–æ¸²æŸ“é¡µé¢è§†å›¾ï¼Œå¹¶å°†æ¯ä¸ªæŒ‡ä»¤å¯¹åº”çš„èŠ‚ç‚¹ç»‘å®šæ›´æ–°å‡½æ•°ï¼Œæ·»åŠ ç›‘å¬æ•°æ®çš„è®¢é˜…è€…ï¼Œä¸€æ—¦æ•°æ®æœ‰å˜åŠ¨ï¼Œæ”¶åˆ°é€šçŸ¥ï¼Œæ›´æ–°è§†å›¾</li></ul> <blockquote><p><code>Watcher</code> è®¢é˜…è€…æ˜¯ <code>Observer</code> å’Œ <code>Compile</code> ä¹‹é—´é€šä¿¡çš„æ¡¥æ¢ï¼Œä¸»è¦åšçš„äº‹æƒ…</p></blockquote> <ul><li>åœ¨è‡ªèº«å®ä¾‹åŒ–æ—¶å¾€å±æ€§è®¢é˜…å™¨ (<code>dep</code>) é‡Œé¢æ·»åŠ è‡ªå·±</li> <li>å¾…å±æ€§å˜åŠ¨ <code>dep.notice()</code> é€šçŸ¥æ—¶ï¼Œè°ƒç”¨è‡ªèº«çš„ <code>update()</code> æ–¹æ³•ï¼Œå¹¶è§¦å‘ <code>Compile</code> ä¸­ç»‘å®šçš„å›è°ƒ</li></ul> <p><strong>Object.defineProperty()</strong>ï¼Œé‚£ä¹ˆå®ƒçš„ç”¨æ³•æ˜¯ä»€ä¹ˆï¼Œä»¥åŠä¼˜ç¼ºç‚¹æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</p> <ul><li>å¯ä»¥æ£€æµ‹å¯¹è±¡ä¸­æ•°æ®å‘ç”Ÿçš„ä¿®æ”¹</li> <li>å¯¹äºå¤æ‚çš„å¯¹è±¡ï¼Œå±‚çº§å¾ˆæ·±çš„è¯ï¼Œæ˜¯ä¸å‹å¥½çš„ï¼Œéœ€è¦ç»è¡Œæ·±åº¦ç›‘å¬ï¼Œè¿™æ ·å­å°±éœ€è¦é€’å½’åˆ°åº•ï¼Œè¿™ä¹Ÿæ˜¯å®ƒçš„ç¼ºç‚¹ã€‚</li> <li>å¯¹äºä¸€ä¸ªå¯¹è±¡ä¸­ï¼Œå¦‚æœä½ æ–°å¢åŠ å±æ€§ï¼Œåˆ é™¤å±æ€§ï¼Œ**Object.defineProperty()**æ˜¯ä¸èƒ½è§‚æµ‹åˆ°çš„ï¼Œé‚£ä¹ˆåº”è¯¥å¦‚ä½•è§£å†³å‘¢ï¼Ÿå¯ä»¥é€šè¿‡<code>Vue.set()</code>å’Œ<code>Vue.delete()</code>æ¥å®ç°ã€‚</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// æ¨¡æ‹Ÿ Vue ä¸­çš„ data é€‰é¡¹ </span>
<span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
    msg<span class="token operator">:</span> <span class="token string">'hello'</span>
<span class="token punctuation">}</span>
<span class="token comment">// æ¨¡æ‹Ÿ Vue çš„å®ä¾‹ </span>
<span class="token keyword">let</span> vm <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token comment">// æ•°æ®åŠ«æŒ:å½“è®¿é—®æˆ–è€…è®¾ç½® vm ä¸­çš„æˆå‘˜çš„æ—¶å€™ï¼Œåšä¸€äº›å¹²é¢„æ“ä½œ</span>
Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>vm<span class="token punctuation">,</span> <span class="token string">'msg'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token comment">// å¯æšä¸¾(å¯éå†)</span>
  enumerable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token comment">// å¯é…ç½®(å¯ä»¥ä½¿ç”¨ delete åˆ é™¤ï¼Œå¯ä»¥é€šè¿‡ defineProperty é‡æ–°å®šä¹‰) </span>
  configurable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token comment">// å½“è·å–å€¼çš„æ—¶å€™æ‰§è¡Œ </span>
  <span class="token function">get</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'get: '</span><span class="token punctuation">,</span> data<span class="token punctuation">.</span>msg<span class="token punctuation">)</span>
    <span class="token keyword">return</span> data<span class="token punctuation">.</span>msg 
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// å½“è®¾ç½®å€¼çš„æ—¶å€™æ‰§è¡Œ </span>
  <span class="token function">set</span> <span class="token punctuation">(</span>newValue<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'set: '</span><span class="token punctuation">,</span> newValue<span class="token punctuation">)</span> 
    <span class="token keyword">if</span> <span class="token punctuation">(</span>newValue <span class="token operator">===</span> data<span class="token punctuation">.</span>msg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span>
    <span class="token punctuation">}</span>
    data<span class="token punctuation">.</span>msg <span class="token operator">=</span> newValue
    <span class="token comment">// æ•°æ®æ›´æ”¹ï¼Œæ›´æ–° DOM çš„å€¼ </span>
    document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#app'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>textContent <span class="token operator">=</span> data<span class="token punctuation">.</span>msg
  <span class="token punctuation">}</span> 
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// æµ‹è¯•</span>
vm<span class="token punctuation">.</span>msg <span class="token operator">=</span> <span class="token string">'Hello World'</span> 
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>vm<span class="token punctuation">.</span>msg<span class="token punctuation">)</span>
</code></pre></div><p><strong>Vue3.xå“åº”å¼æ•°æ®åŸç†</strong></p> <blockquote><p><code>Vue3.x</code>æ”¹ç”¨<code>Proxy</code>æ›¿ä»£<code>Object.defineProperty</code>ã€‚å› ä¸º<code>Proxy</code>å¯ä»¥ç›´æ¥ç›‘å¬<code>å¯¹è±¡å’Œæ•°ç»„</code>çš„å˜åŒ–ï¼Œå¹¶ä¸”æœ‰å¤šè¾¾13ç§æ‹¦æˆªæ–¹æ³•ã€‚å¹¶ä¸”ä½œä¸ºæ–°æ ‡å‡†å°†å—åˆ°æµè§ˆå™¨å‚å•†é‡ç‚¹æŒç»­çš„æ€§èƒ½ä¼˜åŒ–ã€‚</p></blockquote> <p><code>Proxy</code>åªä¼šä»£ç†å¯¹è±¡çš„ç¬¬ä¸€å±‚ï¼Œé‚£ä¹ˆ<code>Vue3</code>åˆæ˜¯æ€æ ·å¤„ç†è¿™ä¸ªé—®é¢˜çš„å‘¢ï¼Ÿ</p> <blockquote><p>åˆ¤æ–­å½“å‰<code>Reflect.getçš„</code>è¿”å›å€¼æ˜¯å¦ä¸º<code>Object</code>ï¼Œå¦‚æœæ˜¯åˆ™å†é€šè¿‡<code>reactive</code>æ–¹æ³•åšä»£ç†ï¼Œ è¿™æ ·å°±å®ç°äº†æ·±åº¦è§‚æµ‹ã€‚</p></blockquote> <p><strong>ç›‘æµ‹æ•°ç»„çš„æ—¶å€™å¯èƒ½è§¦å‘å¤šæ¬¡get/setï¼Œé‚£ä¹ˆå¦‚ä½•é˜²æ­¢è§¦å‘å¤šæ¬¡å‘¢ï¼Ÿ</strong></p> <blockquote><p>æˆ‘ä»¬å¯ä»¥åˆ¤æ–­<code>key</code>æ˜¯å¦ä¸ºå½“å‰è¢«ä»£ç†å¯¹è±¡<code>target</code>è‡ªèº«å±æ€§ï¼Œä¹Ÿå¯ä»¥åˆ¤æ–­æ—§å€¼ä¸æ–°å€¼æ˜¯å¦ç›¸ç­‰ï¼Œåªæœ‰æ»¡è¶³ä»¥ä¸Šä¸¤ä¸ªæ¡ä»¶ä¹‹ä¸€æ—¶ï¼Œæ‰æœ‰å¯èƒ½æ‰§è¡Œ<code>trigger</code></p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// æ¨¡æ‹Ÿ Vue ä¸­çš„ data é€‰é¡¹ </span>
<span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
  msg<span class="token operator">:</span> <span class="token string">'hello'</span><span class="token punctuation">,</span>
  count<span class="token operator">:</span> <span class="token number">0</span> 
<span class="token punctuation">}</span>
<span class="token comment">// æ¨¡æ‹Ÿ Vue å®ä¾‹</span>
<span class="token keyword">let</span> vm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token comment">// å½“è®¿é—® vm çš„æˆå‘˜ä¼šæ‰§è¡Œ</span>
  <span class="token function">get</span> <span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'get, key: '</span><span class="token punctuation">,</span> key<span class="token punctuation">,</span> target<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> target<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// å½“è®¾ç½® vm çš„æˆå‘˜ä¼šæ‰§è¡Œ</span>
  <span class="token function">set</span> <span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> newValue<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'set, key: '</span><span class="token punctuation">,</span> key<span class="token punctuation">,</span> newValue<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>target<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">===</span> newValue<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span>
    <span class="token punctuation">}</span>
    target<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> newValue
    document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#app'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>textContent <span class="token operator">=</span> target<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// æµ‹è¯•</span>
vm<span class="token punctuation">.</span>msg <span class="token operator">=</span> <span class="token string">'Hello World'</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>vm<span class="token punctuation">.</span>msg<span class="token punctuation">)</span>
</code></pre></div><p><strong>Proxy ç›¸æ¯”äº defineProperty çš„ä¼˜åŠ¿</strong></p> <ul><li>æ•°ç»„å˜åŒ–ä¹Ÿèƒ½ç›‘å¬åˆ°</li> <li>ä¸éœ€è¦æ·±åº¦éå†ç›‘å¬</li></ul> <blockquote><p><code>Proxy</code> æ˜¯ <code>ES6</code> ä¸­æ–°å¢çš„åŠŸèƒ½ï¼Œå¯ä»¥ç”¨æ¥è‡ªå®šä¹‰å¯¹è±¡ä¸­çš„æ“ä½œ</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> handler<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// `target` ä»£è¡¨éœ€è¦æ·»åŠ ä»£ç†çš„å¯¹è±¡</span>
<span class="token comment">// `handler` ç”¨æ¥è‡ªå®šä¹‰å¯¹è±¡ä¸­çš„æ“ä½œ</span>
<span class="token comment">// å¯ä»¥å¾ˆæ–¹ä¾¿çš„ä½¿ç”¨ Proxy æ¥å®ç°ä¸€ä¸ªæ•°æ®ç»‘å®šå’Œç›‘å¬</span>

<span class="token keyword">let</span> <span class="token function-variable function">onWatch</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">obj<span class="token punctuation">,</span> setBind<span class="token punctuation">,</span> getLogger</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token function">get</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> property<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">getLogger</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> property<span class="token punctuation">)</span>
      <span class="token keyword">return</span> Reflect<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> property<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">set</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> property<span class="token punctuation">,</span> value<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">setBind</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> Reflect<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> property<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> handler<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span>
<span class="token keyword">let</span> value
<span class="token keyword">let</span> p <span class="token operator">=</span> <span class="token function">onWatch</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">v</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  value <span class="token operator">=</span> v
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> property</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Get '</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>property<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">' = </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>target<span class="token punctuation">[</span>property<span class="token punctuation">]</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
p<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">2</span> <span class="token comment">// bind `value` to `2`</span>
p<span class="token punctuation">.</span>a <span class="token comment">// -&gt; Get 'a' = 2</span>

</code></pre></div><p><strong>æ€»ç»“</strong></p> <p><img src="./è¿›é˜¶_files/20210408091523.png" alt="" class="medium-zoom-image"></p> <ul><li>Vue
<ul><li>è®°å½•ä¼ å…¥çš„é€‰é¡¹ï¼Œè®¾ç½® <code>$data/$el</code></li> <li>æŠŠ <code>data</code> çš„æˆå‘˜æ³¨å…¥åˆ° <code>Vue</code> å®ä¾‹</li> <li>è´Ÿè´£è°ƒç”¨ <code>Observer</code> å®ç°æ•°æ®å“åº”å¼å¤„ç†(æ•°æ®åŠ«æŒ)</li> <li>è´Ÿè´£è°ƒç”¨ <code>Compiler</code> ç¼–è¯‘æŒ‡ä»¤/æ’å€¼è¡¨è¾¾å¼ç­‰</li></ul></li> <li><code>Observer</code> <ul><li>æ•°æ®åŠ«æŒ
<ul><li>è´Ÿè´£æŠŠ <code>data</code> ä¸­çš„æˆå‘˜è½¬æ¢æˆ <code>getter/setter</code></li> <li>è´Ÿè´£æŠŠå¤šå±‚å±æ€§è½¬æ¢æˆ <code>getter/setter</code></li> <li>å¦‚æœç»™å±æ€§èµ‹å€¼ä¸ºæ–°å¯¹è±¡ï¼ŒæŠŠæ–°å¯¹è±¡çš„æˆå‘˜è®¾ç½®ä¸º <code>getter/setter</code></li></ul></li> <li>æ·»åŠ  <code>Dep</code> å’Œ <code>Watcher</code> çš„ä¾èµ–å…³ç³»</li> <li>æ•°æ®å˜åŒ–å‘é€é€šçŸ¥</li></ul></li> <li><code>Compiler</code> <ul><li>è´Ÿè´£ç¼–è¯‘æ¨¡æ¿ï¼Œè§£ææŒ‡ä»¤/æ’å€¼è¡¨è¾¾å¼</li> <li>è´Ÿè´£é¡µé¢çš„é¦–æ¬¡æ¸²æŸ“è¿‡ç¨‹</li> <li>å½“æ•°æ®å˜åŒ–åé‡æ–°æ¸²æŸ“</li></ul></li> <li><code>Dep</code> <ul><li>æ”¶é›†ä¾èµ–ï¼Œæ·»åŠ è®¢é˜…è€…(<code>watcher</code>)</li> <li>é€šçŸ¥æ‰€æœ‰è®¢é˜…è€…</li></ul></li> <li><code>Watcher</code> <ul><li>è‡ªèº«å®ä¾‹åŒ–çš„æ—¶å€™å¾€<code>dep</code>å¯¹è±¡ä¸­æ·»åŠ è‡ªå·±</li> <li>å½“æ•°æ®å˜åŒ–<code>dep</code>é€šçŸ¥æ‰€æœ‰çš„ <code>Watcher</code> å®ä¾‹æ›´æ–°è§†å›¾</li></ul></li></ul> <h3 id="_2-å‘å¸ƒè®¢é˜…æ¨¡å¼å’Œè§‚å¯Ÿè€…æ¨¡å¼"><a href="http://interview.poetries.top/docs/simply.html#_2-%E5%8F%91%E5%B8%83%E8%AE%A2%E9%98%85%E6%A8%A1%E5%BC%8F%E5%92%8C%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F" class="header-anchor">#</a> 2 å‘å¸ƒè®¢é˜…æ¨¡å¼å’Œè§‚å¯Ÿè€…æ¨¡å¼</h3> <p><strong>1. å‘å¸ƒ/è®¢é˜…æ¨¡å¼</strong></p> <ul><li><strong>å‘å¸ƒ/è®¢é˜…æ¨¡å¼</strong> <ul><li>è®¢é˜…è€…</li> <li>å‘å¸ƒè€…</li> <li>ä¿¡å·ä¸­å¿ƒ</li></ul></li></ul> <blockquote><p>æˆ‘ä»¬å‡å®šï¼Œå­˜åœ¨ä¸€ä¸ª"ä¿¡å·ä¸­å¿ƒ"ï¼ŒæŸä¸ªä»»åŠ¡æ‰§è¡Œå®Œæˆï¼Œå°±å‘ä¿¡å·ä¸­å¿ƒ"å‘å¸ƒ"(publish)ä¸€ä¸ªä¿¡ å·ï¼Œå…¶ä»–ä»»åŠ¡å¯ä»¥å‘ä¿¡å·ä¸­å¿ƒ"è®¢é˜…"(subscribe)è¿™ä¸ªä¿¡å·ï¼Œä»è€ŒçŸ¥é“ä»€ä¹ˆæ—¶å€™è‡ªå·±å¯ä»¥å¼€å§‹æ‰§ è¡Œã€‚è¿™å°±å«åš"å‘å¸ƒ/è®¢é˜…æ¨¡å¼"(publish-subscribe pattern)</p></blockquote> <blockquote><p>Vue çš„è‡ªå®šä¹‰äº‹ä»¶</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> vm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
vm<span class="token punctuation">.</span><span class="token function">$on</span><span class="token punctuation">(</span><span class="token string">'dataChange'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'dataChange'</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
vm<span class="token punctuation">.</span><span class="token function">$on</span><span class="token punctuation">(</span><span class="token string">'dataChange'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> 
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'dataChange1'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span> 
vm<span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'dataChange'</span><span class="token punctuation">)</span>
</code></pre></div><p>å…„å¼Ÿç»„ä»¶é€šä¿¡è¿‡ç¨‹</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// eventBus.js</span>
<span class="token comment">// äº‹ä»¶ä¸­å¿ƒ</span>
<span class="token keyword">let</span> eventHub <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// ComponentA.vue</span>
<span class="token comment">// å‘å¸ƒè€…</span>
<span class="token function-variable function">addTodo</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// å‘å¸ƒæ¶ˆæ¯(äº‹ä»¶)</span>
  eventHub<span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'add-todo'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> text<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>newTodoText <span class="token punctuation">}</span><span class="token punctuation">)</span> 
  <span class="token keyword">this</span><span class="token punctuation">.</span>newTodoText <span class="token operator">=</span> <span class="token string">''</span>
<span class="token punctuation">}</span>
<span class="token comment">// ComponentB.vue</span>
<span class="token comment">// è®¢é˜…è€…</span>
<span class="token function-variable function">created</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// è®¢é˜…æ¶ˆæ¯(äº‹ä»¶)</span>
  eventHub<span class="token punctuation">.</span><span class="token function">$on</span><span class="token punctuation">(</span><span class="token string">'add-todo'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>addTodo<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>æ¨¡æ‹Ÿ Vue è‡ªå®šä¹‰äº‹ä»¶çš„å®ç°</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">EventEmitter</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// { eventType: [ handler1, handler2 ] }</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>subs <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// è®¢é˜…é€šçŸ¥</span>
  <span class="token function">$on</span><span class="token punctuation">(</span><span class="token parameter">eventType<span class="token punctuation">,</span> fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>subs<span class="token punctuation">[</span>eventType<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>subs<span class="token punctuation">[</span>eventType<span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>subs<span class="token punctuation">[</span>eventType<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>fn<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// å‘å¸ƒé€šçŸ¥</span>
  <span class="token function">$emit</span><span class="token punctuation">(</span><span class="token parameter">eventType</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>subs<span class="token punctuation">[</span>eventType<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>subs<span class="token punctuation">[</span>eventType<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">v</span><span class="token operator">=&gt;</span><span class="token function">v</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// æµ‹è¯•</span>
<span class="token keyword">var</span> bus <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">EventEmitter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// æ³¨å†Œäº‹ä»¶</span>
bus<span class="token punctuation">.</span><span class="token function">$on</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

bus<span class="token punctuation">.</span><span class="token function">$on</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'click1'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// è§¦å‘äº‹ä»¶ </span>
bus<span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>2. è§‚å¯Ÿè€…æ¨¡å¼</strong></p> <ul><li>è§‚å¯Ÿè€…(è®¢é˜…è€…) -- <code>Watcher</code> <ul><li><code>update()</code>:å½“äº‹ä»¶å‘ç”Ÿæ—¶ï¼Œå…·ä½“è¦åšçš„äº‹æƒ…</li></ul></li> <li>ç›®æ ‡(å‘å¸ƒè€…) -- <code>Dep</code> <ul><li><code>subs</code> æ•°ç»„:å­˜å‚¨æ‰€æœ‰çš„è§‚å¯Ÿè€…</li> <li><code>addSub()</code>:æ·»åŠ è§‚å¯Ÿè€…</li> <li><code>notify()</code>:å½“äº‹ä»¶å‘ç”Ÿï¼Œè°ƒç”¨æ‰€æœ‰è§‚å¯Ÿè€…çš„ <code>update()</code> æ–¹æ³•</li></ul></li> <li>æ²¡æœ‰äº‹ä»¶ä¸­å¿ƒ</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// ç›®æ ‡(å‘å¸ƒè€…) </span>
<span class="token comment">// Dependency</span>
<span class="token keyword">class</span> <span class="token class-name">Dep</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// å­˜å‚¨æ‰€æœ‰çš„è§‚å¯Ÿè€…</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>subs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// æ·»åŠ è§‚å¯Ÿè€…</span>
  <span class="token function">addSub</span> <span class="token punctuation">(</span><span class="token parameter">sub</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>sub <span class="token operator">&amp;&amp;</span> sub<span class="token punctuation">.</span>update<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>subs<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>sub<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// é€šçŸ¥æ‰€æœ‰è§‚å¯Ÿè€…</span>
  <span class="token function">notify</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>subs<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">sub</span> <span class="token operator">=&gt;</span> sub<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// è§‚å¯Ÿè€…(è®¢é˜…è€…)</span>
<span class="token keyword">class</span> <span class="token class-name">Watcher</span> <span class="token punctuation">{</span>
  <span class="token function">update</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'update'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// æµ‹è¯•</span>
<span class="token keyword">let</span> dep <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Dep</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> watcher <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Watcher</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
dep<span class="token punctuation">.</span><span class="token function">addSub</span><span class="token punctuation">(</span>watcher<span class="token punctuation">)</span> 
dep<span class="token punctuation">.</span><span class="token function">notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>3. æ€»ç»“</strong></p> <ul><li><strong>è§‚å¯Ÿè€…æ¨¡å¼</strong>æ˜¯ç”±å…·ä½“ç›®æ ‡è°ƒåº¦ï¼Œæ¯”å¦‚å½“äº‹ä»¶è§¦å‘ï¼Œ<code>Dep</code> å°±ä¼šå»è°ƒç”¨è§‚å¯Ÿè€…çš„æ–¹æ³•ï¼Œæ‰€ä»¥è§‚å¯Ÿè€…æ¨¡
å¼çš„è®¢é˜…è€…ä¸å‘å¸ƒè€…ä¹‹é—´æ˜¯å­˜åœ¨ä¾èµ–çš„</li> <li><strong>å‘å¸ƒ/è®¢é˜…æ¨¡å¼</strong>ç”±ç»Ÿä¸€è°ƒåº¦ä¸­å¿ƒè°ƒç”¨ï¼Œå› æ­¤å‘å¸ƒè€…å’Œè®¢é˜…è€…ä¸éœ€è¦çŸ¥é“å¯¹æ–¹çš„å­˜åœ¨</li></ul> <p><img src="./è¿›é˜¶_files/20210328214834.png" alt="" class="medium-zoom-image"></p> <h3 id="_3-ä¸ºä»€ä¹ˆä½¿ç”¨-virtual-dom"><a href="http://interview.poetries.top/docs/simply.html#_3-%E4%B8%BA%E4%BB%80%E4%B9%88%E4%BD%BF%E7%94%A8-virtual-dom" class="header-anchor">#</a> 3 ä¸ºä»€ä¹ˆä½¿ç”¨ Virtual DOM</h3> <ul><li>æ‰‹åŠ¨æ“ä½œ <code>DOM</code> æ¯”è¾ƒéº»çƒ¦ï¼Œè¿˜éœ€è¦è€ƒè™‘æµè§ˆå™¨å…¼å®¹æ€§é—®é¢˜ï¼Œè™½ç„¶æœ‰ <code>jQuery</code> ç­‰åº“ç®€åŒ– <code>DOM</code> æ“ä½œï¼Œä½†æ˜¯éšç€é¡¹ç›®çš„å¤æ‚ DOM æ“ä½œå¤æ‚æå‡</li> <li>ä¸ºäº†ç®€åŒ– <code>DOM</code> çš„å¤æ‚æ“ä½œäºæ˜¯å‡ºç°äº†å„ç§ <code>MVVM</code> æ¡†æ¶ï¼Œ<code>MVVM</code> æ¡†æ¶è§£å†³äº†è§†å›¾å’ŒçŠ¶æ€çš„åŒæ­¥é—®é¢˜</li> <li>ä¸ºäº†ç®€åŒ–è§†å›¾çš„æ“ä½œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ¨¡æ¿å¼•æ“ï¼Œä½†æ˜¯æ¨¡æ¿å¼•æ“æ²¡æœ‰è§£å†³è·Ÿè¸ªçŠ¶æ€å˜åŒ–çš„é—®é¢˜ï¼Œäºæ˜¯<code>Virtual DOM</code> å‡ºç°äº†</li> <li><code>Virtual DOM</code> çš„å¥½å¤„æ˜¯å½“çŠ¶æ€æ”¹å˜æ—¶ä¸éœ€è¦ç«‹å³æ›´æ–° DOMï¼Œåªéœ€è¦åˆ›å»ºä¸€ä¸ªè™šæ‹Ÿæ ‘æ¥æè¿°<code>DOM</code>ï¼Œ<code>Virtual DOM</code> å†…éƒ¨å°†å¼„æ¸…æ¥šå¦‚ä½•æœ‰æ•ˆ(<code>diff</code>)çš„æ›´æ–° <code>DOM</code></li> <li>è™šæ‹Ÿ <code>DOM</code> å¯ä»¥ç»´æŠ¤ç¨‹åºçš„çŠ¶æ€ï¼Œè·Ÿè¸ªä¸Šä¸€æ¬¡çš„çŠ¶æ€</li> <li>é€šè¿‡æ¯”è¾ƒå‰åä¸¤æ¬¡çŠ¶æ€çš„å·®å¼‚æ›´æ–°çœŸå® <code>DOM</code></li></ul> <p><strong>è™šæ‹Ÿ DOM çš„ä½œç”¨</strong></p> <ul><li>ç»´æŠ¤è§†å›¾å’ŒçŠ¶æ€çš„å…³ç³»</li> <li>å¤æ‚è§†å›¾æƒ…å†µä¸‹æå‡æ¸²æŸ“æ€§èƒ½</li> <li>é™¤äº†æ¸²æŸ“ <code>DOM</code> ä»¥å¤–ï¼Œè¿˜å¯ä»¥å®ç° <code>SSR(Nuxt.js/Next.js)</code>ã€åŸç”Ÿåº”ç”¨(<code>Weex/React Native</code>)ã€å°ç¨‹åº(<code>mpvue/uni-app</code>)ç­‰</li></ul> <p><img src="./è¿›é˜¶_files/20210328112610.png" alt="img" class="medium-zoom-image"></p> <h3 id="_4-vdom-ä¸‰ä¸ª-part"><a href="http://interview.poetries.top/docs/simply.html#_4-vdom-%E4%B8%89%E4%B8%AA-part" class="header-anchor">#</a> 4 VDOMï¼šä¸‰ä¸ª part</h3> <ul><li>è™šæ‹ŸèŠ‚ç‚¹ç±»ï¼Œå°†çœŸå® <code>DOM</code>èŠ‚ç‚¹ç”¨ <code>js</code> å¯¹è±¡çš„å½¢å¼è¿›è¡Œå±•ç¤ºï¼Œå¹¶æä¾› <code>render</code> æ–¹æ³•ï¼Œå°†è™šæ‹ŸèŠ‚ç‚¹æ¸²æŸ“æˆçœŸå® <code>DOM</code></li> <li>èŠ‚ç‚¹ <code>diff</code> æ¯”è¾ƒï¼šå¯¹è™šæ‹ŸèŠ‚ç‚¹è¿›è¡Œ <code>js</code> å±‚é¢çš„è®¡ç®—ï¼Œå¹¶å°†ä¸åŒçš„æ“ä½œéƒ½è®°å½•åˆ° <code>patch</code> å¯¹è±¡</li> <li><code>re-render</code>ï¼šè§£æ <code>patch</code> å¯¹è±¡ï¼Œè¿›è¡Œ <code>re-render</code></li></ul> <p><strong>è¡¥å……1ï¼šVDOM çš„å¿…è¦æ€§ï¼Ÿ</strong></p> <ul><li><strong>åˆ›å»ºçœŸå®DOMçš„ä»£ä»·é«˜</strong>ï¼šçœŸå®çš„ <code>DOM</code> èŠ‚ç‚¹ <code>node</code> å®ç°çš„å±æ€§å¾ˆå¤šï¼Œè€Œ <code>vnode</code> ä»…ä»…å®ç°ä¸€äº›å¿…è¦çš„å±æ€§ï¼Œç›¸æ¯”èµ·æ¥ï¼Œåˆ›å»ºä¸€ä¸ª <code>vnode</code> çš„æˆæœ¬æ¯”è¾ƒä½ã€‚</li> <li><strong>è§¦å‘å¤šæ¬¡æµè§ˆå™¨é‡ç»˜åŠå›æµ</strong>ï¼šä½¿ç”¨ <code>vnode</code> ï¼Œç›¸å½“äºåŠ äº†ä¸€ä¸ªç¼“å†²ï¼Œè®©ä¸€æ¬¡æ•°æ®å˜åŠ¨æ‰€å¸¦æ¥çš„æ‰€æœ‰ <code>node</code> å˜åŒ–ï¼Œå…ˆåœ¨ <code>vnode</code> ä¸­è¿›è¡Œä¿®æ”¹ï¼Œç„¶å <code>diff</code> ä¹‹åå¯¹æ‰€æœ‰äº§ç”Ÿå·®å¼‚çš„èŠ‚ç‚¹é›†ä¸­ä¸€æ¬¡å¯¹ <code>DOM tree</code> è¿›è¡Œä¿®æ”¹ï¼Œä»¥å‡å°‘æµè§ˆå™¨çš„é‡ç»˜åŠå›æµã€‚</li></ul> <p><strong>è¡¥å……2ï¼švue ä¸ºä»€ä¹ˆé‡‡ç”¨ vdomï¼Ÿ</strong></p> <blockquote><p>å¼•å…¥ <code>Virtual DOM</code> åœ¨æ€§èƒ½æ–¹é¢çš„è€ƒé‡ä»…ä»…æ˜¯ä¸€æ–¹é¢ã€‚</p></blockquote> <ul><li>æ€§èƒ½å—åœºæ™¯çš„å½±å“æ˜¯éå¸¸å¤§çš„ï¼Œä¸åŒçš„åœºæ™¯å¯èƒ½é€ æˆä¸åŒå®ç°æ–¹æ¡ˆä¹‹é—´æˆå€çš„æ€§èƒ½å·®è·ï¼Œæ‰€ä»¥ä¾èµ–ç»†ç²’åº¦ç»‘å®šåŠ <code>Virtual DOM</code> å“ªä¸ªçš„æ€§èƒ½æ›´å¥½è¿˜çœŸä¸æ˜¯ä¸€ä¸ªå®¹æ˜“ä¸‹å®šè®ºçš„é—®é¢˜ã€‚</li> <li><code>Vue</code> ä¹‹æ‰€ä»¥å¼•å…¥äº† <code>Virtual DOM</code>ï¼Œæ›´é‡è¦çš„åŸå› æ˜¯ä¸ºäº†è§£è€¦ <code>HTML</code>ä¾èµ–ï¼Œè¿™å¸¦æ¥ä¸¤ä¸ªéå¸¸é‡è¦çš„å¥½å¤„æ˜¯ï¼š</li></ul> <blockquote><ul><li>ä¸å†ä¾èµ– <code>HTML</code> è§£æå™¨è¿›è¡Œæ¨¡ç‰ˆè§£æï¼Œå¯ä»¥è¿›è¡Œæ›´å¤šçš„ <code>AOT</code> å·¥ä½œæé«˜è¿è¡Œæ—¶æ•ˆç‡ï¼šé€šè¿‡æ¨¡ç‰ˆ <code>AOT</code> ç¼–è¯‘ï¼Œ<code>Vue</code> çš„è¿è¡Œæ—¶ä½“ç§¯å¯ä»¥è¿›ä¸€æ­¥å‹ç¼©ï¼Œè¿è¡Œæ—¶æ•ˆç‡å¯ä»¥è¿›ä¸€æ­¥æå‡ï¼›</li> <li>å¯ä»¥æ¸²æŸ“åˆ° <code>DOM</code> ä»¥å¤–çš„å¹³å°ï¼Œå®ç° <code>SSR</code>ã€åŒæ„æ¸²æŸ“è¿™äº›é«˜çº§ç‰¹æ€§ï¼Œ<code>Weex</code>ç­‰æ¡†æ¶åº”ç”¨çš„å°±æ˜¯è¿™ä¸€ç‰¹æ€§ã€‚</li></ul></blockquote> <blockquote><p>ç»¼ä¸Šï¼Œ<code>Virtual DOM</code> åœ¨æ€§èƒ½ä¸Šçš„æ”¶ç›Šå¹¶ä¸æ˜¯æœ€ä¸»è¦çš„ï¼Œæ›´é‡è¦çš„æ˜¯å®ƒä½¿å¾— <code>Vue</code> å…·å¤‡äº†ç°ä»£æ¡†æ¶åº”æœ‰çš„é«˜çº§ç‰¹æ€§ã€‚</p></blockquote> <h3 id="_5-vue-å’Œ-reactæŠ€æœ¯é€‰å‹"><a href="http://interview.poetries.top/docs/simply.html#_5-vue-%E5%92%8C-react%E6%8A%80%E6%9C%AF%E9%80%89%E5%9E%8B" class="header-anchor">#</a> 5 vue å’Œ reactæŠ€æœ¯é€‰å‹</h3> <p><strong>ç›¸åŒç‚¹ï¼š</strong></p> <ol><li>æ•°æ®é©±åŠ¨é¡µé¢ï¼Œæä¾›å“åº”å¼çš„è¯•å›¾ç»„ä»¶</li> <li>éƒ½æœ‰virtual DOM,ç»„ä»¶åŒ–çš„å¼€å‘ï¼Œé€šè¿‡propså‚æ•°è¿›è¡Œçˆ¶å­ä¹‹é—´ç»„ä»¶ä¼ é€’æ•°æ®ï¼Œéƒ½å®ç°äº†webComponentsè§„èŒƒ</li> <li>æ•°æ®æµåŠ¨å•å‘ï¼Œéƒ½æ”¯æŒæœåŠ¡å™¨çš„æ¸²æŸ“SSR</li> <li>éƒ½æœ‰æ”¯æŒnativeçš„æ–¹æ³•ï¼Œreactæœ‰React nativeï¼Œ vueæœ‰wexx</li></ol> <p><strong>ä¸åŒç‚¹ï¼š</strong></p> <ol><li>æ•°æ®ç»‘å®šï¼šVueå®ç°äº†åŒå‘çš„æ•°æ®ç»‘å®šï¼Œreactæ•°æ®æµåŠ¨æ˜¯å•å‘çš„</li> <li>æ•°æ®æ¸²æŸ“ï¼šå¤§è§„æ¨¡çš„æ•°æ®æ¸²æŸ“ï¼Œreactæ›´å¿«</li> <li>ä½¿ç”¨åœºæ™¯ï¼šReacté…åˆReduxæ¶æ„é€‚åˆå¤§è§„æ¨¡å¤šäººåä½œå¤æ‚é¡¹ç›®ï¼ŒVueé€‚åˆå°å¿«çš„é¡¹ç›®</li> <li>å¼€å‘é£æ ¼ï¼šreactæ¨èåšæ³•jsx + inline styleæŠŠhtmlå’Œcsséƒ½å†™åœ¨jsäº†</li></ol> <blockquote><p>vueæ˜¯é‡‡ç”¨webpack +vue-loaderå•æ–‡ä»¶ç»„ä»¶æ ¼å¼ï¼Œhtml, js, cssåŒä¸€ä¸ªæ–‡ä»¶</p></blockquote> <h3 id="_6-nexttick"><a href="http://interview.poetries.top/docs/simply.html#_6-nexttick" class="header-anchor">#</a> 6 nextTick</h3> <blockquote><p><code>nextTick</code> å¯ä»¥è®©æˆ‘ä»¬åœ¨ä¸‹æ¬¡ <code>DOM</code> æ›´æ–°å¾ªç¯ç»“æŸä¹‹åæ‰§è¡Œå»¶è¿Ÿå›è°ƒï¼Œç”¨äºè·å¾—æ›´æ–°åçš„ <code>DOM</code></p></blockquote> <p><code>nextTick</code>ä¸»è¦ä½¿ç”¨äº†å®ä»»åŠ¡å’Œå¾®ä»»åŠ¡ã€‚æ ¹æ®æ‰§è¡Œç¯å¢ƒåˆ†åˆ«å°è¯•é‡‡ç”¨</p> <ul><li><code>Promise</code></li> <li><code>MutationObserver</code></li> <li><code>setImmediate</code></li> <li>å¦‚æœä»¥ä¸Šéƒ½ä¸è¡Œåˆ™é‡‡ç”¨<code>setTimeout</code></li></ul> <blockquote><p>å®šä¹‰äº†ä¸€ä¸ªå¼‚æ­¥æ–¹æ³•ï¼Œå¤šæ¬¡è°ƒç”¨<code>nextTick</code>ä¼šå°†æ–¹æ³•å­˜å…¥é˜Ÿåˆ—ä¸­ï¼Œé€šè¿‡è¿™ä¸ªå¼‚æ­¥æ–¹æ³•æ¸…ç©ºå½“å‰é˜Ÿåˆ—</p></blockquote> <h3 id="_7-ç”Ÿå‘½å‘¨æœŸ"><a href="http://interview.poetries.top/docs/simply.html#_7-%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F" class="header-anchor">#</a> 7 ç”Ÿå‘½å‘¨æœŸ</h3> <p><img src="./è¿›é˜¶_files/20210408093135.png" alt="" class="medium-zoom-image"></p> <p><strong><em>init</em></strong></p> <ul><li><code>initLifecycle/Event</code>ï¼Œå¾€vmä¸ŠæŒ‚è½½å„ç§å±æ€§</li> <li><code>callHook: beforeCreated</code>: å®ä¾‹åˆšåˆ›å»º</li> <li><code>initInjection/initState</code>: åˆå§‹åŒ–æ³¨å…¥å’Œ <code>data</code> å“åº”æ€§</li> <li><code>created: åˆ›å»ºå®Œæˆï¼Œå±æ€§å·²ç»ç»‘å®šï¼Œ ä½†è¿˜æœªç”ŸæˆçœŸå®</code>dom`</li> <li>è¿›è¡Œå…ƒç´ çš„æŒ‚è½½ï¼š <code>$el / vm.$mount()</code></li> <li>æ˜¯å¦æœ‰<code>template</code>: è§£ææˆ <code>render function</code> <ul><li><code>*.vue</code>æ–‡ä»¶: <code>vue-loader</code>ä¼šå°†<code>&lt;template&gt;</code>ç¼–è¯‘æˆ<code>render function</code></li></ul></li> <li><code>beforeMount</code>: æ¨¡æ¿ç¼–è¯‘/æŒ‚è½½ä¹‹å‰</li> <li>æ‰§è¡Œ<code>render function</code>ï¼Œç”ŸæˆçœŸå®çš„<code>dom</code>ï¼Œå¹¶æ›¿æ¢åˆ°<code>dom tree</code>ä¸­</li> <li><code>mounted</code>: ç»„ä»¶å·²æŒ‚è½½</li></ul> <p><strong>update</strong></p> <ul><li>æ‰§è¡Œ<code>diff</code>ç®—æ³•ï¼Œæ¯”å¯¹æ”¹å˜æ˜¯å¦éœ€è¦è§¦å‘<code>UI</code>æ›´æ–°</li> <li><code>flushScheduleQueue</code></li> <li><code>watcher.before</code>: è§¦å‘<code>beforeUpdate</code>é’©å­	- <code>watcher.run()</code>: æ‰§è¡Œ<code>watcher</code>ä¸­çš„ <code>notify</code>ï¼Œé€šçŸ¥æ‰€æœ‰ä¾èµ–é¡¹æ›´æ–°UI</li> <li>è§¦å‘<code>updated</code>é’©å­: ç»„ä»¶å·²æ›´æ–°</li> <li><code>actived / deactivated(keep-alive)</code>: ä¸é”€æ¯ï¼Œç¼“å­˜ï¼Œç»„ä»¶æ¿€æ´»ä¸å¤±æ´»</li> <li><code>destroy</code> <ul><li><code>beforeDestroy</code>: é”€æ¯å¼€å§‹</li> <li>é”€æ¯è‡ªèº«ä¸”é€’å½’é”€æ¯å­ç»„ä»¶ä»¥åŠäº‹ä»¶ç›‘å¬
<ul><li><code>remove()</code>: åˆ é™¤èŠ‚ç‚¹</li> <li><code>watcher.teardown()</code>: æ¸…ç©ºä¾èµ–</li> <li><code>vm.$off()</code>: è§£ç»‘ç›‘å¬</li></ul></li> <li><code>destroyed</code>: å®Œæˆåè§¦å‘é’©å­</li></ul></li></ul> <table><thead><tr><th style="text-align: left;">Vue2</th> <th style="text-align: left;">Vue3</th></tr></thead> <tbody><tr><td style="text-align: left;"><code>beforeCreate</code></td> <td style="text-align: left;">âŒ<code>setup</code>(æ›¿ä»£)</td></tr> <tr><td style="text-align: left;"><code>created</code></td> <td style="text-align: left;">âŒ<code>setup</code>(æ›¿ä»£)</td></tr> <tr><td style="text-align: left;"><code>beforeMount</code></td> <td style="text-align: left;"><code>onBeforeMount</code></td></tr> <tr><td style="text-align: left;"><code>mounted</code></td> <td style="text-align: left;"><code>onMounted</code></td></tr> <tr><td style="text-align: left;"><code>beforeUpdate</code></td> <td style="text-align: left;"><code>onBeforeUpdate</code></td></tr> <tr><td style="text-align: left;"><code>updated</code></td> <td style="text-align: left;"><code>nUpdated</code></td></tr> <tr><td style="text-align: left;"><code>beforeDestroy</code></td> <td style="text-align: left;"><code>onBeforeUnmount</code></td></tr> <tr><td style="text-align: left;"><code>destroyed</code></td> <td style="text-align: left;"><code>onUnmounted</code></td></tr> <tr><td style="text-align: left;"><code>errorCaptured</code></td> <td style="text-align: left;"><code>onErrorCaptured</code></td></tr> <tr><td style="text-align: left;">-</td> <td style="text-align: left;">ğŸ‰<code>onRenderTracked</code></td></tr> <tr><td style="text-align: left;">-</td> <td style="text-align: left;">ğŸ‰<code>onRenderTriggered</code></td></tr></tbody></table> <blockquote><p>ä¸Šé¢æ˜¯vueçš„å£°æ˜å‘¨æœŸçš„ç®€å•æ¢³ç†ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬ç›´æ¥ä»¥ä»£ç çš„å½¢å¼æ¥å®Œæˆvueçš„åˆå§‹åŒ–</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code>
<span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// åˆå§‹åŒ–Vueå®ä¾‹</span>
<span class="token keyword">function</span> <span class="token function">_init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	 <span class="token comment">// æŒ‚è½½å±æ€§</span>
    <span class="token function">initLifeCycle</span><span class="token punctuation">(</span>vm<span class="token punctuation">)</span> 
    <span class="token comment">// åˆå§‹åŒ–äº‹ä»¶ç³»ç»Ÿï¼Œé’©å­å‡½æ•°ç­‰</span>
    <span class="token function">initEvent</span><span class="token punctuation">(</span>vm<span class="token punctuation">)</span> 
    <span class="token comment">// ç¼–è¯‘slotã€vnode</span>
    <span class="token function">initRender</span><span class="token punctuation">(</span>vm<span class="token punctuation">)</span> 
    <span class="token comment">// è§¦å‘é’©å­</span>
    <span class="token function">callHook</span><span class="token punctuation">(</span>vm<span class="token punctuation">,</span> <span class="token string">'beforeCreate'</span><span class="token punctuation">)</span>
    <span class="token comment">// æ·»åŠ injectåŠŸèƒ½</span>
    <span class="token function">initInjection</span><span class="token punctuation">(</span>vm<span class="token punctuation">)</span>
    <span class="token comment">// å®Œæˆæ•°æ®å“åº”æ€§ props/data/watch/computed/methods</span>
    <span class="token function">initState</span><span class="token punctuation">(</span>vm<span class="token punctuation">)</span>
    <span class="token comment">// æ·»åŠ  provide åŠŸèƒ½</span>
    <span class="token function">initProvide</span><span class="token punctuation">(</span>vm<span class="token punctuation">)</span>
    <span class="token comment">// è§¦å‘é’©å­</span>
    <span class="token function">callHook</span><span class="token punctuation">(</span>vm<span class="token punctuation">,</span> <span class="token string">'created'</span><span class="token punctuation">)</span>
		
	 <span class="token comment">// æŒ‚è½½èŠ‚ç‚¹</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>vm<span class="token punctuation">.</span>$options<span class="token punctuation">.</span>el<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        vm<span class="token punctuation">.</span><span class="token function">$mount</span><span class="token punctuation">(</span>vm<span class="token punctuation">.</span>$options<span class="token punctuation">.</span>el<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// æŒ‚è½½èŠ‚ç‚¹å®ç°</span>
<span class="token keyword">function</span> <span class="token function">mountComponent</span><span class="token punctuation">(</span><span class="token parameter">vm</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	 <span class="token comment">// è·å– render function</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">.</span>render<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// template to render</span>
        <span class="token comment">// Vue.compile = compileToFunctions</span>
        <span class="token keyword">let</span> <span class="token punctuation">{</span> render <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">compileToFunctions</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
        <span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">.</span>render <span class="token operator">=</span> render
    <span class="token punctuation">}</span>
    <span class="token comment">// è§¦å‘é’©å­</span>
    <span class="token function">callHook</span><span class="token punctuation">(</span><span class="token string">'beforeMounte'</span><span class="token punctuation">)</span>
    <span class="token comment">// åˆå§‹åŒ–è§‚å¯Ÿè€…</span>
    <span class="token comment">// render æ¸²æŸ“ vdomï¼Œ </span>
    vdom <span class="token operator">=</span> vm<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">// update: æ ¹æ® diff å‡ºçš„ patchs æŒ‚è½½æˆçœŸå®çš„ dom </span>
    vm<span class="token punctuation">.</span><span class="token function">_update</span><span class="token punctuation">(</span>vdom<span class="token punctuation">)</span>
    <span class="token comment">// è§¦å‘é’©å­  </span>
    <span class="token function">callHook</span><span class="token punctuation">(</span>vm<span class="token punctuation">,</span> <span class="token string">'mounted'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// æ›´æ–°èŠ‚ç‚¹å®ç°</span>
funtion <span class="token function">queueWatcher</span><span class="token punctuation">(</span><span class="token parameter">watcher</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">nextTick</span><span class="token punctuation">(</span>flushScheduleQueue<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// æ¸…ç©ºé˜Ÿåˆ—</span>
<span class="token keyword">function</span> <span class="token function">flushScheduleQueue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	 <span class="token comment">// éå†é˜Ÿåˆ—ä¸­æ‰€æœ‰ä¿®æ”¹</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	    <span class="token comment">// beforeUpdate</span>
        watcher<span class="token punctuation">.</span><span class="token function">before</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
         
        <span class="token comment">// ä¾èµ–å±€éƒ¨æ›´æ–°èŠ‚ç‚¹</span>
        watcher<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
        <span class="token function">callHook</span><span class="token punctuation">(</span><span class="token string">'updated'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// é”€æ¯å®ä¾‹å®ç°</span>
<span class="token class-name">Vue</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">$destory</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	 <span class="token comment">// è§¦å‘é’©å­</span>
    <span class="token function">callHook</span><span class="token punctuation">(</span>vm<span class="token punctuation">,</span> <span class="token string">'beforeDestory'</span><span class="token punctuation">)</span>
    <span class="token comment">// è‡ªèº«åŠå­èŠ‚ç‚¹</span>
    <span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
    <span class="token comment">// åˆ é™¤ä¾èµ–</span>
    watcher<span class="token punctuation">.</span><span class="token function">teardown</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
    <span class="token comment">// åˆ é™¤ç›‘å¬</span>
    vm<span class="token punctuation">.</span><span class="token function">$off</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
    <span class="token comment">// è§¦å‘é’©å­</span>
    <span class="token function">callHook</span><span class="token punctuation">(</span>vm<span class="token punctuation">,</span> <span class="token string">'destoryed'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_8-vue-router"><a href="http://interview.poetries.top/docs/simply.html#_8-vue-router" class="header-anchor">#</a> 8 vue-router</h3> <p><strong>mode</strong></p> <ul><li><code>hash</code></li> <li><code>history</code></li></ul> <p><strong>è·³è½¬</strong></p> <ul><li><code>this.$router.push()</code></li> <li><code>&lt;router-link to=""&gt;&lt;/router-link&gt;</code></li></ul> <p><strong>å ä½</strong></p> <div class="language- extra-class"><pre class="language-text"><code>&lt;router-view&gt;&lt;/router-view&gt;
</code></pre></div><p><strong>vue-routeræºç å®ç°</strong></p> <ul><li>ä½œä¸ºä¸€ä¸ªæ’ä»¶å­˜åœ¨:å®ç°<code>VueRouter</code>ç±»å’Œ<code>install</code>æ–¹æ³•</li> <li>å®ç°ä¸¤ä¸ªå…¨å±€ç»„ä»¶:<code>router-view</code>ç”¨äºæ˜¾ç¤ºåŒ¹é…ç»„ä»¶å†…å®¹ï¼Œ<code>router-link</code>ç”¨äºè·³è½¬</li> <li>ç›‘æ§<code>url</code>å˜åŒ–:ç›‘å¬<code>hashchange</code>æˆ–<code>popstate</code>äº‹ä»¶</li> <li>å“åº”æœ€æ–°<code>url</code>:åˆ›å»ºä¸€ä¸ªå“åº”å¼çš„å±æ€§<code>current</code>ï¼Œå½“å®ƒæ”¹å˜æ—¶è·å–å¯¹åº”ç»„ä»¶å¹¶æ˜¾ç¤º</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// æˆ‘ä»¬çš„æ’ä»¶ï¼š</span>
<span class="token comment">// 1.å®ç°ä¸€ä¸ªRouterç±»å¹¶æŒ‚è½½æœŸå®ä¾‹</span>
<span class="token comment">// 2.å®ç°ä¸¤ä¸ªå…¨å±€ç»„ä»¶router-linkå’Œrouter-view</span>
<span class="token keyword">let</span> Vue<span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">VueRouter</span> <span class="token punctuation">{</span>
  <span class="token comment">// æ ¸å¿ƒä»»åŠ¡ï¼š</span>
  <span class="token comment">// 1.ç›‘å¬urlå˜åŒ–</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>$options <span class="token operator">=</span> options<span class="token punctuation">;</span>

    <span class="token comment">// ç¼“å­˜pathå’Œrouteæ˜ å°„å…³ç³»</span>
    <span class="token comment">// è¿™æ ·æ‰¾ç»„ä»¶æ›´å¿«</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>routeMap <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>$options<span class="token punctuation">.</span>routes<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">route</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>routeMap<span class="token punctuation">[</span>route<span class="token punctuation">.</span>path<span class="token punctuation">]</span> <span class="token operator">=</span> route
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token comment">// æ•°æ®å“åº”å¼</span>
    <span class="token comment">// å®šä¹‰ä¸€ä¸ªå“åº”å¼çš„currentï¼Œåˆ™å¦‚æœä»–å˜äº†ï¼Œé‚£ä¹ˆä½¿ç”¨å®ƒçš„ç»„ä»¶ä¼šrerender</span>
    Vue<span class="token punctuation">.</span>util<span class="token punctuation">.</span><span class="token function">defineReactive</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token string">'current'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>

    <span class="token comment">// è¯·ç¡®ä¿onHashChangeä¸­thisæŒ‡å‘å½“å‰å®ä¾‹</span>
    window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'hashchange'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">onHashChange</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'load'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">onHashChange</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token function">onHashChange</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// console.log(window.location.hash);</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>current <span class="token operator">=</span> window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>hash<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token string">'/'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// æ’ä»¶éœ€è¦å®ç°installæ–¹æ³•</span>
<span class="token comment">// æ¥æ”¶ä¸€ä¸ªå‚æ•°ï¼ŒVueæ„é€ å‡½æ•°ï¼Œä¸»è¦ç”¨äºæ•°æ®å“åº”å¼</span>
VueRouter<span class="token punctuation">.</span><span class="token function-variable function">install</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">_Vue</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ä¿å­˜Vueæ„é€ å‡½æ•°åœ¨VueRouterä¸­ä½¿ç”¨</span>
  Vue <span class="token operator">=</span> _Vue

  <span class="token comment">// ä»»åŠ¡1ï¼šä½¿ç”¨æ··å…¥æ¥åšrouteræŒ‚è½½è¿™ä»¶äº‹æƒ…</span>
  Vue<span class="token punctuation">.</span><span class="token function">mixin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token function">beforeCreate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// åªæœ‰æ ¹å®ä¾‹æ‰æœ‰routeré€‰é¡¹</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$options<span class="token punctuation">.</span>router<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Vue</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>$router <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$options<span class="token punctuation">.</span>router
      <span class="token punctuation">}</span>

    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token comment">// ä»»åŠ¡2ï¼šå®ç°ä¸¤ä¸ªå…¨å±€ç»„ä»¶</span>
  <span class="token comment">// router-link: ç”Ÿæˆä¸€ä¸ªaæ ‡ç­¾ï¼Œåœ¨urlåé¢æ·»åŠ #</span>
  <span class="token comment">// &lt;a href="#/about"&gt;aaaa&lt;/a&gt;</span>
  <span class="token comment">// &lt;router-link to="/about"&gt;aaa&lt;/router-link&gt;</span>
  Vue<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token string">'router-link'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    props<span class="token operator">:</span> <span class="token punctuation">{</span>
      to<span class="token operator">:</span> <span class="token punctuation">{</span>
        type<span class="token operator">:</span> String<span class="token punctuation">,</span>
        required<span class="token operator">:</span> <span class="token boolean">true</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token parameter">h</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// h(tag, props, children)</span>
      <span class="token keyword">return</span> <span class="token function">h</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> attrs<span class="token operator">:</span> <span class="token punctuation">{</span> href<span class="token operator">:</span> <span class="token string">'#'</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>to <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>$slots<span class="token punctuation">.</span>default
      <span class="token punctuation">)</span>
      <span class="token comment">// ä½¿ç”¨jsx</span>
      <span class="token comment">// return &lt;a href={'#'+this.to}&gt;{this.$slots.default}&lt;/a&gt;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  Vue<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token string">'router-view'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token parameter">h</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// æ ¹æ®currentè·å–ç»„ä»¶å¹¶render</span>
      <span class="token comment">// currentæ€ä¹ˆè·å–?</span>
      <span class="token comment">// console.log('render',this.$router.current);</span>
      <span class="token comment">// è·å–è¦æ¸²æŸ“çš„ç»„ä»¶</span>
      <span class="token keyword">let</span> component <span class="token operator">=</span> <span class="token keyword">null</span>
      <span class="token keyword">const</span> <span class="token punctuation">{</span> routeMap<span class="token punctuation">,</span> current <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$router
      <span class="token keyword">if</span> <span class="token punctuation">(</span>routeMap<span class="token punctuation">[</span>current<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        component <span class="token operator">=</span> routeMap<span class="token punctuation">[</span>current<span class="token punctuation">]</span><span class="token punctuation">.</span>component
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> <span class="token function">h</span><span class="token punctuation">(</span>component<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> VueRouter
</code></pre></div><h3 id="_9-vuex"><a href="http://interview.poetries.top/docs/simply.html#_9-vuex" class="header-anchor">#</a> 9 vuex</h3> <blockquote><p>Vuex é›†ä¸­å¼å­˜å‚¨ç®¡ç†åº”ç”¨çš„æ‰€æœ‰ç»„ä»¶çš„çŠ¶æ€ï¼Œå¹¶ä»¥ç›¸åº”çš„è§„åˆ™ä¿è¯çŠ¶æ€ä»¥å¯é¢„æµ‹çš„æ–¹å¼å‘ç”Ÿå˜åŒ–</p></blockquote> <p><strong>æ ¸å¿ƒæ¦‚å¿µ</strong></p> <ul><li><code>state</code>: çŠ¶æ€ä¸­å¿ƒ</li> <li><code>mutations</code>: æ›´æ”¹çŠ¶æ€</li> <li><code>actions</code>: å¼‚æ­¥æ›´æ”¹çŠ¶æ€</li> <li><code>getters</code>: è·å–çŠ¶æ€</li> <li><code>modules</code>: å°†<code>state</code>åˆ†æˆå¤šä¸ª<code>modules</code>ï¼Œä¾¿äºç®¡ç†</li></ul> <ol><li>çŠ¶æ€ <strong>- state</strong></li></ol> <p>stateä¿å­˜åº”ç”¨çŠ¶æ€</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">new</span> <span class="token class-name">Vuex<span class="token punctuation">.</span>Store</span><span class="token punctuation">(</span><span class="token punctuation">{</span> state<span class="token operator">:</span> <span class="token punctuation">{</span> counter<span class="token operator">:</span><span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><ol><li>çŠ¶æ€å˜æ›´ <strong>- mutations</strong></li></ol> <blockquote><p><code>mutations</code>ç”¨äºä¿®æ”¹çŠ¶æ€ï¼Œ<code>store.js</code></p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">new</span> <span class="token class-name">Vuex<span class="token punctuation">.</span>Store</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    mutations<span class="token operator">:</span>
    <span class="token punctuation">{</span>
      <span class="token function">add</span><span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        state<span class="token punctuation">.</span>counter<span class="token operator">++</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><ol><li>æ´¾ç”ŸçŠ¶æ€ <strong>- getters</strong></li></ol> <blockquote><p>ä»stateæ´¾ç”Ÿå‡ºæ–°çŠ¶æ€ï¼Œç±»ä¼¼è®¡ç®—å±æ€§</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">new</span> <span class="token class-name">Vuex<span class="token punctuation">.</span>Store</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    getters<span class="token operator">:</span>
    <span class="token punctuation">{</span>
      <span class="token function">doubleCounter</span><span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// è®¡ç®—å‰©ä½™æ•°é‡ return state.counter * 2;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><ol><li>åŠ¨ä½œ <strong>- actions</strong></li></ol> <p>åŠ ä¸šåŠ¡é€»è¾‘ï¼Œç±»ä¼¼äº<code>controller</code></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">new</span> <span class="token class-name">Vuex<span class="token punctuation">.</span>Store</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    actions<span class="token operator">:</span>
    <span class="token punctuation">{</span>
      <span class="token function">add</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>
        commit
      <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>æµ‹è¯•ä»£ç :</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>$store.commit(<span class="token punctuation">'</span>add<span class="token punctuation">'</span>)<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>counter: {{$store.state.counter}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>$store.dispatch(<span class="token punctuation">'</span>add<span class="token punctuation">'</span>)<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>async counter: {{$store.state.counter}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>double:{{$store.getters.doubleCounter}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p><strong>vuexåŸç†è§£æ</strong></p> <ul><li>å®ç°ä¸€ä¸ªæ’ä»¶:å£°æ˜<code>Store</code>ç±»ï¼ŒæŒ‚è½½<code>$store</code></li> <li><code>Store</code>å…·ä½“å®ç°:
<ul><li>åˆ›å»ºå“åº”å¼çš„<code>state</code>ï¼Œä¿å­˜<code>mutations</code>ã€<code>actions</code>å’Œ<code>getters</code></li> <li>å®ç°<code>commit</code>æ ¹æ®ç”¨æˆ·ä¼ å…¥<code>type</code>æ‰§è¡Œå¯¹åº”<code>mutation</code></li> <li>å®ç°<code>dispatch</code>æ ¹æ®ç”¨æˆ·ä¼ å…¥<code>type</code>æ‰§è¡Œå¯¹åº”<code>action</code>ï¼ŒåŒæ—¶ä¼ é€’ä¸Šä¸‹æ–‡</li> <li>å®ç°<code>getters</code>ï¼ŒæŒ‰ç…§<code>getters</code>å®šä¹‰å¯¹<code>state</code>åšæ´¾ç”Ÿ</li></ul></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// ç›®æ ‡1ï¼šå®ç°Storeç±»ï¼Œç®¡ç†stateï¼ˆå“åº”å¼çš„ï¼‰ï¼Œcommitæ–¹æ³•å’Œdispatchæ–¹æ³•</span>
<span class="token comment">// ç›®æ ‡2ï¼šå°è£…ä¸€ä¸ªæ’ä»¶ï¼Œä½¿ç”¨æ›´å®¹æ˜“ä½¿ç”¨</span>
<span class="token keyword">let</span> Vue<span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Store</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// å®šä¹‰å“åº”å¼çš„state</span>
    <span class="token comment">// this.$store.state.xx</span>
    <span class="token comment">// å€Ÿé¸¡ç”Ÿè›‹</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>_vm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      data<span class="token operator">:</span> <span class="token punctuation">{</span>
        $$state<span class="token operator">:</span> options<span class="token punctuation">.</span>state
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    
    <span class="token keyword">this</span><span class="token punctuation">.</span>_mutations <span class="token operator">=</span> options<span class="token punctuation">.</span>mutations
    <span class="token keyword">this</span><span class="token punctuation">.</span>_actions <span class="token operator">=</span> options<span class="token punctuation">.</span>actions

    <span class="token comment">// ç»‘å®šthisæŒ‡å‘</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>commit <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>dispatch <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// åªè¯»</span>
  <span class="token keyword">get</span> <span class="token function">state</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_vm<span class="token punctuation">.</span>_data<span class="token punctuation">.</span>$$state
  <span class="token punctuation">}</span>

  <span class="token keyword">set</span> <span class="token function">state</span><span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'ä¸èƒ½ç›´æ¥èµ‹å€¼å‘€ï¼Œè¯·æ¢åˆ«çš„æ–¹å¼ï¼ï¼å¤©ç‹ç›–åœ°è™ï¼ï¼'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
  <span class="token punctuation">}</span>
  
  <span class="token comment">// å®ç°commitæ–¹æ³•ï¼Œå¯ä»¥ä¿®æ”¹state</span>
  <span class="token function">commit</span><span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span> payload</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// æ‹¿å‡ºmutationsä¸­çš„å¤„ç†å‡½æ•°æ‰§è¡Œå®ƒ</span>
    <span class="token keyword">const</span> entry <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_mutations<span class="token punctuation">[</span>type<span class="token punctuation">]</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>entry<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'æœªçŸ¥mutaionç±»å‹'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span>
    <span class="token punctuation">}</span>

    <span class="token function">entry</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">,</span> payload<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span> payload</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> entry <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_actions<span class="token punctuation">[</span>type<span class="token punctuation">]</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>entry<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'æœªçŸ¥actionç±»å‹'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// ä¸Šä¸‹æ–‡å¯ä»¥ä¼ é€’å½“å‰storeå®ä¾‹è¿›å»å³å¯</span>
    <span class="token function">entry</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> payload<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">install</span><span class="token punctuation">(</span><span class="token parameter">_Vue</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  Vue <span class="token operator">=</span> _Vue

  <span class="token comment">// æ··å…¥storeå®ä¾‹</span>
  Vue<span class="token punctuation">.</span><span class="token function">mixin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token function">beforeCreate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$options<span class="token punctuation">.</span>store<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Vue</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>$store <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$options<span class="token punctuation">.</span>store
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// { Store, install }ç›¸å½“äºVuex</span>
<span class="token comment">// å®ƒå¿…é¡»å®ç°installæ–¹æ³•</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span> Store<span class="token punctuation">,</span> install <span class="token punctuation">}</span>
</code></pre></div><h3 id="_10-vue3å¸¦æ¥çš„æ–°ç‰¹æ€§-äº®ç‚¹"><a href="http://interview.poetries.top/docs/simply.html#_10-vue3%E5%B8%A6%E6%9D%A5%E7%9A%84%E6%96%B0%E7%89%B9%E6%80%A7-%E4%BA%AE%E7%82%B9" class="header-anchor">#</a> 10 vue3å¸¦æ¥çš„æ–°ç‰¹æ€§/äº®ç‚¹</h3> <p><strong>1. å‹ç¼©åŒ…ä½“ç§¯æ›´å°</strong></p> <blockquote><p>å½“å‰æœ€å°åŒ–å¹¶è¢«å‹ç¼©çš„ Vue è¿è¡Œæ—¶å¤§å°çº¦ä¸º 20kBï¼ˆ2.6.10 ç‰ˆä¸º 22.8kBï¼‰ã€‚Vue 3.0æ†ç»‘åŒ…çš„å¤§å°å¤§çº¦ä¼šå‡å°‘ä¸€åŠï¼Œå³åªæœ‰10kBï¼</p></blockquote> <p><strong>2. Object.defineProperty -&gt; Proxy</strong></p> <ul><li><code>Object.defineProperty</code>æ˜¯ä¸€ä¸ªç›¸å¯¹æ¯”è¾ƒæ˜‚è´µçš„æ“ä½œï¼Œå› ä¸ºå®ƒç›´æ¥æ“ä½œå¯¹è±¡çš„å±æ€§ï¼Œé¢—ç²’åº¦æ¯”è¾ƒå°ã€‚å°†å®ƒæ›¿æ¢ä¸ºes6çš„<code>Proxy</code>ï¼Œåœ¨ç›®æ ‡å¯¹è±¡ä¹‹ä¸Šæ¶äº†ä¸€å±‚æ‹¦æˆªï¼Œä»£ç†çš„æ˜¯å¯¹è±¡è€Œä¸æ˜¯å¯¹è±¡çš„å±æ€§ã€‚è¿™æ ·å¯ä»¥å°†åŸæœ¬å¯¹å¯¹è±¡å±æ€§çš„æ“ä½œå˜ä¸ºå¯¹æ•´ä¸ªå¯¹è±¡çš„æ“ä½œï¼Œé¢—ç²’åº¦å˜å¤§ã€‚</li> <li>javascriptå¼•æ“åœ¨è§£æçš„æ—¶å€™å¸Œæœ›å¯¹è±¡çš„ç»“æ„è¶Šç¨³å®šè¶Šå¥½ï¼Œå¦‚æœå¯¹è±¡ä¸€ç›´åœ¨å˜ï¼Œå¯ä¼˜åŒ–æ€§é™ä½ï¼Œproxyä¸éœ€è¦å¯¹åŸå§‹å¯¹è±¡åšå¤ªå¤šæ“ä½œã€‚</li></ul> <p><strong>3. Virtual DOM é‡æ„</strong></p> <blockquote><p>vdomçš„æœ¬è´¨æ˜¯ä¸€ä¸ªæŠ½è±¡å±‚ï¼Œç”¨javascriptæè¿°ç•Œé¢æ¸²æŸ“æˆä»€ä¹ˆæ ·å­ã€‚reactç”¨jsxï¼Œæ²¡åŠæ³•æ£€æµ‹å‡ºå¯ä»¥ä¼˜åŒ–çš„åŠ¨æ€ä»£ç ï¼Œæ‰€ä»¥åšæ—¶é—´åˆ†ç‰‡ï¼Œvueä¸­è¶³å¤Ÿå¿«çš„è¯å¯ä»¥ä¸ç”¨æ—¶é—´åˆ†ç‰‡</p></blockquote> <ul><li><p><strong>ä¼ ç»Ÿvdomçš„æ€§èƒ½ç“¶é¢ˆï¼š</strong></p> <ul><li>è™½ç„¶ Vue èƒ½å¤Ÿä¿è¯è§¦å‘æ›´æ–°çš„ç»„ä»¶æœ€å°åŒ–ï¼Œä½†åœ¨å•ä¸ªç»„ä»¶å†…éƒ¨ä¾ç„¶éœ€è¦éå†è¯¥ç»„ä»¶çš„æ•´ä¸ª vdom æ ‘ã€‚</li> <li>ä¼ ç»Ÿ vdom çš„æ€§èƒ½è·Ÿæ¨¡ç‰ˆå¤§å°æ­£ç›¸å…³ï¼Œè·ŸåŠ¨æ€èŠ‚ç‚¹çš„æ•°é‡æ— å…³ã€‚åœ¨ä¸€äº›ç»„ä»¶æ•´ä¸ªæ¨¡ç‰ˆå†…åªæœ‰å°‘é‡åŠ¨æ€èŠ‚ç‚¹çš„æƒ…å†µä¸‹ï¼Œè¿™äº›éå†éƒ½æ˜¯æ€§èƒ½çš„æµªè´¹ã€‚</li> <li>JSX å’Œæ‰‹å†™çš„ render function æ˜¯å®Œå…¨åŠ¨æ€çš„ï¼Œè¿‡åº¦çš„çµæ´»æ€§å¯¼è‡´è¿è¡Œæ—¶å¯ä»¥ç”¨äºä¼˜åŒ–çš„ä¿¡æ¯ä¸è¶³</li></ul></li> <li><p><strong>é‚£ä¸ºä»€ä¹ˆä¸ç›´æ¥æŠ›å¼ƒvdomå‘¢ï¼Ÿ</strong></p> <ul><li>é«˜çº§åœºæ™¯ä¸‹æ‰‹å†™ <code>render function</code> è·å¾—æ›´å¼ºçš„è¡¨è¾¾åŠ›</li> <li>ç”Ÿæˆçš„ä»£ç æ›´ç®€æ´</li> <li>å…¼å®¹2.x</li></ul></li></ul> <blockquote><p>vueçš„ç‰¹ç‚¹æ˜¯åº•å±‚ä¸ºVirtual DOMï¼Œä¸Šå±‚åŒ…å«æœ‰å¤§é‡é™æ€ä¿¡æ¯çš„æ¨¡ç‰ˆã€‚ä¸ºäº†å…¼å®¹æ‰‹å†™ render functionï¼Œæœ€å¤§åŒ–åˆ©ç”¨æ¨¡ç‰ˆé™æ€ä¿¡æ¯ï¼Œ<code>vue3.0é‡‡ç”¨äº†åŠ¨é™ç»“åˆçš„è§£å†³æ–¹æ¡ˆ</code>ï¼Œå°†vdomçš„æ“ä½œé¢—ç²’åº¦å˜å°ï¼Œæ¯æ¬¡è§¦å‘æ›´æ–°ä¸å†ä»¥ç»„ä»¶ä¸ºå•ä½è¿›è¡Œéå†ï¼Œä¸»è¦æ›´æ”¹å¦‚ä¸‹</p></blockquote> <ul><li>å°†æ¨¡ç‰ˆåŸºäºåŠ¨æ€èŠ‚ç‚¹æŒ‡ä»¤åˆ‡å‰²ä¸ºåµŒå¥—çš„åŒºå—</li> <li>æ¯ä¸ªåŒºå—å†…éƒ¨çš„èŠ‚ç‚¹ç»“æ„æ˜¯å›ºå®šçš„</li> <li>æ¯ä¸ªåŒºå—åªéœ€è¦ä»¥ä¸€ä¸ª <code>Array</code> è¿½è¸ªè‡ªèº«åŒ…å«çš„åŠ¨æ€èŠ‚ç‚¹</li></ul> <blockquote><p>vue3.0å°† vdom æ›´æ–°æ€§èƒ½ç”±ä¸æ¨¡ç‰ˆæ•´ä½“å¤§å°ç›¸å…³æå‡ä¸ºä¸åŠ¨æ€å†…å®¹çš„æ•°é‡ç›¸å…³</p></blockquote> <p><strong>Vue 3.0 åŠ¨é™ç»“åˆçš„ Dom diff</strong></p> <blockquote><ul><li>Vue3.0 æå‡ºåŠ¨é™ç»“åˆçš„ DOM diff æ€æƒ³ï¼ŒåŠ¨é™ç»“åˆçš„ DOM diffå…¶å®æ˜¯åœ¨é¢„ç¼–è¯‘é˜¶æ®µè¿›è¡Œäº†ä¼˜åŒ–ã€‚ä¹‹æ‰€ä»¥èƒ½å¤Ÿåšåˆ°é¢„ç¼–è¯‘ä¼˜åŒ–ï¼Œæ˜¯å› ä¸º Vue core å¯ä»¥é™æ€åˆ†æ templateï¼Œåœ¨è§£ææ¨¡ç‰ˆæ—¶ï¼Œæ•´ä¸ª parse çš„è¿‡ç¨‹æ˜¯åˆ©ç”¨æ­£åˆ™è¡¨è¾¾å¼é¡ºåºè§£ææ¨¡æ¿ï¼Œå½“è§£æåˆ°å¼€å§‹æ ‡ç­¾ã€é—­åˆæ ‡ç­¾å’Œæ–‡æœ¬çš„æ—¶å€™éƒ½ä¼šåˆ†åˆ«æ‰§è¡Œå¯¹åº”çš„å›è°ƒå‡½æ•°ï¼Œæ¥è¾¾åˆ°æ„é€  AST æ ‘çš„ç›®çš„ã€‚</li> <li>å€ŸåŠ©é¢„ç¼–è¯‘è¿‡ç¨‹ï¼ŒVue å¯ä»¥åšåˆ°çš„é¢„ç¼–è¯‘ä¼˜åŒ–å°±å¾ˆå¼ºå¤§äº†ã€‚æ¯”å¦‚åœ¨é¢„ç¼–è¯‘æ—¶æ ‡è®°å‡ºæ¨¡ç‰ˆä¸­å¯èƒ½å˜åŒ–çš„ç»„ä»¶èŠ‚ç‚¹ï¼Œå†æ¬¡è¿›è¡Œæ¸²æŸ“å‰ diff æ—¶å°±å¯ä»¥è·³è¿‡â€œæ°¸è¿œä¸ä¼šå˜åŒ–çš„èŠ‚ç‚¹â€ï¼Œè€Œåªéœ€è¦å¯¹æ¯”â€œå¯èƒ½ä¼šå˜åŒ–çš„åŠ¨æ€èŠ‚ç‚¹â€ã€‚è¿™ä¹Ÿå°±æ˜¯åŠ¨é™ç»“åˆçš„ DOM diff å°† diff æˆæœ¬ä¸æ¨¡ç‰ˆå¤§å°æ­£ç›¸å…³ä¼˜åŒ–åˆ°ä¸åŠ¨æ€èŠ‚ç‚¹æ­£ç›¸å…³çš„ç†è®ºä¾æ®ã€‚</li></ul></blockquote> <p><strong>4. Performance</strong></p> <blockquote><p>vue3åœ¨æ€§èƒ½æ–¹é¢æ¯”vue2å¿«äº†2å€ã€‚</p></blockquote> <ul><li>é‡å†™äº†è™šæ‹ŸDOMçš„å®ç°</li> <li>è¿è¡Œæ—¶ç¼–è¯‘</li> <li>updateæ€§èƒ½æé«˜</li> <li>SSRé€Ÿåº¦æé«˜</li></ul> <p><strong>5. Tree-shaking support</strong></p> <blockquote><p>vue3ä¸­çš„æ ¸å¿ƒapiéƒ½æ”¯æŒäº†tree-shakingï¼Œè¿™äº›apiéƒ½æ˜¯é€šè¿‡åŒ…å¼•å…¥çš„æ–¹å¼è€Œä¸æ˜¯ç›´æ¥åœ¨å®ä¾‹åŒ–æ—¶å°±æ³¨å…¥ï¼Œåªä¼šå¯¹ä½¿ç”¨åˆ°çš„åŠŸèƒ½æˆ–ç‰¹æ€§è¿›è¡Œæ‰“åŒ…ï¼ˆæŒ‰éœ€æ‰“åŒ…ï¼‰ï¼Œè¿™æ„å‘³ç€æ›´å¤šçš„åŠŸèƒ½å’Œæ›´å°çš„ä½“ç§¯ã€‚</p></blockquote> <p><strong>6. Composition API</strong></p> <blockquote><p>vue2ä¸­ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¼šé‡‡ç”¨mixinæ¥å¤ç”¨é€»è¾‘ä»£ç ï¼Œç”¨å€’æ˜¯æŒºå¥½ç”¨çš„ï¼Œä¸è¿‡ä¹Ÿå­˜åœ¨ä¸€äº›é—®é¢˜ï¼šä¾‹å¦‚ä»£ç æ¥æºä¸æ¸…æ™°ã€æ–¹æ³•å±æ€§ç­‰å†²çªã€‚åŸºäºæ­¤åœ¨vue3ä¸­å¼•å…¥äº†Composition APIï¼ˆç»„åˆAPIï¼‰ï¼Œä½¿ç”¨çº¯å‡½æ•°åˆ†éš”å¤ç”¨ä»£ç ã€‚å’ŒReactä¸­çš„<code>hooks</code>çš„æ¦‚å¿µå¾ˆç›¸ä¼¼</p></blockquote> <ul><li>æ›´å¥½çš„é€»è¾‘å¤ç”¨å’Œä»£ç ç»„ç»‡</li> <li>æ›´å¥½çš„ç±»å‹æ¨å¯¼</li></ul> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>X: {{ x }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>Y: {{ y }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> defineComponent<span class="token punctuation">,</span> onMounted<span class="token punctuation">,</span> onUnmounted<span class="token punctuation">,</span> ref <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"vue"</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">useMouseMove</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> x <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> y <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">function</span> <span class="token function">move</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        x<span class="token punctuation">.</span>value <span class="token operator">=</span> e<span class="token punctuation">.</span>clientX<span class="token punctuation">;</span>
        y<span class="token punctuation">.</span>value <span class="token operator">=</span> e<span class="token punctuation">.</span>clientY<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">onMounted</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"mousemove"</span><span class="token punctuation">,</span> move<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">onUnmounted</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        window<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">"mousemove"</span><span class="token punctuation">,</span> move<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token punctuation">{</span> x<span class="token punctuation">,</span> y <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineComponent</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> <span class="token punctuation">{</span> x<span class="token punctuation">,</span> y <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useMouseMove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> <span class="token punctuation">{</span> x<span class="token punctuation">,</span> y <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p><strong>7. æ–°å¢çš„ä¸‰ä¸ªç»„ä»¶Fragmentã€Teleportã€Suspense</strong></p> <p><strong>Fragment</strong></p> <blockquote><p>åœ¨ä¹¦å†™vue2æ—¶ï¼Œç”±äºç»„ä»¶å¿…é¡»åªæœ‰ä¸€ä¸ªæ ¹èŠ‚ç‚¹ï¼Œå¾ˆå¤šæ—¶å€™ä¼šæ·»åŠ ä¸€äº›æ²¡æœ‰æ„ä¹‰çš„èŠ‚ç‚¹ç”¨äºåŒ…è£¹ã€‚Fragmentç»„ä»¶å°±æ˜¯ç”¨äºè§£å†³è¿™ä¸ªé—®é¢˜çš„ï¼ˆè¿™å’ŒReactä¸­çš„Fragmentç»„ä»¶æ˜¯ä¸€æ ·çš„ï¼‰ã€‚</p></blockquote> <p>è¿™æ„å‘³ç€ç°åœ¨å¯ä»¥è¿™æ ·å†™ç»„ä»¶äº†ã€‚</p> <div class="language-html extra-class"><pre class="language-html"><code>/* App.vue */
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>header</span><span class="token punctuation">&gt;</span></span>...<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>header</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>main</span> <span class="token attr-name">v-bind</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>$attrs<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>...<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>main</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>footer</span><span class="token punctuation">&gt;</span></span>...<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>footer</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>æˆ–è€…è¿™æ ·</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// app.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> defineComponent<span class="token punctuation">,</span> h<span class="token punctuation">,</span> Fragment <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineComponent</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">h</span><span class="token punctuation">(</span>Fragment<span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
            <span class="token function">h</span><span class="token punctuation">(</span><span class="token string">'header'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'...'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">h</span><span class="token punctuation">(</span><span class="token string">'main'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'...'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">h</span><span class="token punctuation">(</span><span class="token string">'footer'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'...'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>Teleport</strong></p> <blockquote><p>Teleportå…¶å®å°±æ˜¯Reactä¸­çš„Portalã€‚Portal æä¾›äº†ä¸€ç§å°†å­èŠ‚ç‚¹æ¸²æŸ“åˆ°å­˜åœ¨äºçˆ¶ç»„ä»¶ä»¥å¤–çš„ DOM èŠ‚ç‚¹çš„ä¼˜ç§€çš„æ–¹æ¡ˆã€‚</p></blockquote> <p>ä¸€ä¸ª portal çš„å…¸å‹ç”¨ä¾‹æ˜¯å½“çˆ¶ç»„ä»¶æœ‰ overflow: hidden æˆ– z-index æ ·å¼æ—¶ï¼Œä½†ä½ éœ€è¦å­ç»„ä»¶èƒ½å¤Ÿåœ¨è§†è§‰ä¸Šâ€œè·³å‡ºâ€å…¶å®¹å™¨ã€‚ä¾‹å¦‚ï¼Œå¯¹è¯æ¡†ã€æ‚¬æµ®å¡ä»¥åŠæç¤ºæ¡†ã€‚</p> <div class="language-html extra-class"><pre class="language-html"><code>/* App.vue */
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>123<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Teleport</span> <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>#container<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        Teleport
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Teleport</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> defineComponent <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"vue"</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineComponent</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

/* index.html */
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>container<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p><img src="./è¿›é˜¶_files/20210407162653.png" alt="" class="medium-zoom-image"></p> <p><strong>Suspense</strong></p> <p>åŒæ ·çš„ï¼Œè¿™å’ŒReactä¸­çš„Supenseæ˜¯ä¸€æ ·çš„ã€‚</p> <blockquote><p><code>Suspense</code> è®©ä½ çš„ç»„ä»¶åœ¨æ¸²æŸ“ä¹‹å‰è¿›è¡Œâ€œç­‰å¾…â€ï¼Œå¹¶åœ¨ç­‰å¾…æ—¶æ˜¾ç¤º fallback çš„å†…å®¹</p></blockquote> <div class="language-html extra-class"><pre class="language-html"><code>// App.vue
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Suspense</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">#default</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>AsyncComponent</span> <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">#fallback</span><span class="token punctuation">&gt;</span></span>
            Loading...
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Suspense</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ts<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> defineComponent <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"vue"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> AsyncComponent <span class="token keyword">from</span> <span class="token string">'./AsyncComponent.vue'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineComponent</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">"App"</span><span class="token punctuation">,</span>
    
    components<span class="token operator">:</span> <span class="token punctuation">{</span>
        AsyncComponent
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

// AsyncComponent.vue
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>Async Component<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ts<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> defineComponent <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"vue"</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">sleep</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token parameter">resolve</span> <span class="token operator">=&gt;</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineComponent</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token keyword">async</span> <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">await</span> <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p><strong>8. Better TypeScript support</strong></p> <blockquote><p>åœ¨vue2ä¸­ä½¿ç”¨è¿‡TypesScriptçš„ç«¥é‹åº”è¯¥æœ‰è¿‡ä½“ä¼šï¼Œå†™èµ·æ¥å®åœ¨æ˜¯æœ‰ç‚¹éš¾å—ã€‚vue3åˆ™æ˜¯ä½¿ç”¨tsè¿›è¡Œäº†é‡å†™ï¼Œå¼€å‘è€…ä½¿ç”¨vue3æ—¶æ‹¥æœ‰æ›´å¥½çš„ç±»å‹æ”¯æŒå’Œæ›´å¥½çš„ç¼–å†™ä½“éªŒã€‚</p></blockquote> <h3 id="_11-compositon-api"><a href="http://interview.poetries.top/docs/simply.html#_11-compositon-api" class="header-anchor">#</a> 11 Compositon api</h3> <p><code>Composition API</code>ä¹Ÿå«ç»„åˆå¼APIï¼Œæ˜¯Vue3.xçš„æ–°ç‰¹æ€§ã€‚</p> <blockquote><p>é€šè¿‡åˆ›å»º Vue ç»„ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥å°†æ¥å£çš„å¯é‡å¤éƒ¨åˆ†åŠå…¶åŠŸèƒ½æå–åˆ°å¯é‡ç”¨çš„ä»£ç æ®µä¸­ã€‚ä»…æ­¤ä¸€é¡¹å°±å¯ä»¥ä½¿æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºåœ¨å¯ç»´æŠ¤æ€§å’Œçµæ´»æ€§æ–¹é¢èµ°å¾—æ›´è¿œã€‚ç„¶è€Œï¼Œæˆ‘ä»¬çš„ç»éªŒå·²ç»è¯æ˜ï¼Œå…‰é è¿™ä¸€ç‚¹å¯èƒ½æ˜¯ä¸å¤Ÿçš„ï¼Œå°¤å…¶æ˜¯å½“ä½ çš„åº”ç”¨ç¨‹åºå˜å¾—éå¸¸å¤§çš„æ—¶å€™â€”â€”æƒ³æƒ³å‡ ç™¾ä¸ªç»„ä»¶ã€‚åœ¨å¤„ç†å¦‚æ­¤å¤§çš„åº”ç”¨ç¨‹åºæ—¶ï¼Œå…±äº«å’Œé‡ç”¨ä»£ç å˜å¾—å°¤ä¸ºé‡è¦</p></blockquote> <p><strong>é€šä¿—çš„è®²ï¼š</strong></p> <p>æ²¡æœ‰<code>Composition API</code>ä¹‹å‰vueç›¸å…³ä¸šåŠ¡çš„ä»£ç éœ€è¦é…ç½®åˆ°optionçš„ç‰¹å®šçš„åŒºåŸŸï¼Œä¸­å°å‹é¡¹ç›®æ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œä½†æ˜¯åœ¨å¤§å‹é¡¹ç›®ä¸­ä¼šå¯¼è‡´åæœŸçš„ç»´æŠ¤æ€§æ¯”è¾ƒå¤æ‚ï¼ŒåŒæ—¶ä»£ç å¯å¤ç”¨æ€§ä¸é«˜ã€‚Vue3.xä¸­çš„composition-apiå°±æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜è€Œç”Ÿçš„</p> <p><strong>compositon apiæä¾›äº†ä»¥ä¸‹å‡ ä¸ªå‡½æ•°ï¼š</strong></p> <ul><li><code>setup</code></li> <li><code>ref</code></li> <li><code>reactive</code></li> <li><code>watchEffect</code></li> <li><code>watch</code></li> <li><code>computed</code></li> <li><code>toRefs</code></li> <li>ç”Ÿå‘½å‘¨æœŸçš„<code>hooks</code></li></ul> <h2 id="å…­ã€react"><a href="http://interview.poetries.top/docs/simply.html#%E5%85%AD%E3%80%81react" class="header-anchor">#</a> å…­ã€React</h2> <h3 id="_1-reactç”Ÿå‘½å‘¨æœŸ"><a href="http://interview.poetries.top/docs/simply.html#_1-react%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F" class="header-anchor">#</a> 1 Reactç”Ÿå‘½å‘¨æœŸ</h3> <p><strong>16.3ç‰ˆæœ¬</strong></p> <p><img src="./è¿›é˜¶_files/20210409153251.png" alt="" class="medium-zoom-image"></p> <p><strong>&gt;=16.4ç‰ˆæœ¬</strong></p> <p><img src="./è¿›é˜¶_files/20210409153312.png" alt="" class="medium-zoom-image"></p> <p><strong>åœ¨çº¿æŸ¥çœ‹</strong>ï¼š<a href="https://projects.wojtekmaj.pl/react-lifecycle-methods-diagram" target="_blank" rel="noopener noreferrer">https://projects.wojtekmaj.pl/react-lifecycle-methods-diagram<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="_2-react-fiberæ¶æ„"><a href="http://interview.poetries.top/docs/simply.html#_2-react-fiber%E6%9E%B6%E6%9E%84" class="header-anchor">#</a> 2 React Fiberæ¶æ„</h3> <p><strong>æœ€ä¸»è¦çš„æ€æƒ³å°±æ˜¯å°†ä»»åŠ¡æ‹†åˆ†</strong>ã€‚</p> <ul><li>DOMéœ€è¦æ¸²æŸ“æ—¶æš‚åœï¼Œç©ºé—²æ—¶æ¢å¤ã€‚</li> <li><code>window.requestIdleCallback</code></li> <li>Reactå†…éƒ¨å®ç°çš„æœºåˆ¶</li></ul> <blockquote><p>React è¿½æ±‚çš„æ˜¯ â€œå¿«é€Ÿå“åº”â€ï¼Œé‚£ä¹ˆï¼Œâ€œå¿«é€Ÿå“åº”â€œçš„åˆ¶çº¦å› ç´ éƒ½æœ‰ä»€ä¹ˆå‘¢</p></blockquote> <ul><li><code>CPU</code>çš„ç“¶é¢ˆï¼šå½“é¡¹ç›®å˜å¾—åºå¤§ã€ç»„ä»¶æ•°é‡ç¹å¤šã€é‡åˆ°å¤§è®¡ç®—é‡çš„æ“ä½œæˆ–è€…è®¾å¤‡æ€§èƒ½ä¸è¶³ä½¿å¾—é¡µé¢æ‰å¸§ï¼Œå¯¼è‡´å¡é¡¿ã€‚</li> <li><code>IO</code>çš„ç“¶é¢ˆï¼šå‘é€ç½‘ç»œè¯·æ±‚åï¼Œç”±äºéœ€è¦ç­‰å¾…æ•°æ®è¿”å›æ‰èƒ½è¿›ä¸€æ­¥æ“ä½œå¯¼è‡´ä¸èƒ½å¿«é€Ÿå“åº”ã€‚</li></ul> <blockquote><p><code>fiber</code> æ¶æ„ä¸»è¦å°±æ˜¯ç”¨æ¥è§£å†³ <code>CPU</code> å’Œç½‘ç»œçš„é—®é¢˜ï¼Œè¿™ä¸¤ä¸ªé—®é¢˜ä¸€ç›´ä¹Ÿæ˜¯æœ€å½±å“å‰ç«¯å¼€å‘ä½“éªŒçš„åœ°æ–¹ï¼Œä¸€ä¸ªä¼šé€ æˆå¡é¡¿ï¼Œä¸€ä¸ªä¼šé€ æˆç™½å±ã€‚ä¸ºæ­¤ react ä¸ºå‰ç«¯å¼•å…¥äº†ä¸¤ä¸ªæ–°æ¦‚å¿µï¼šTime Slicing <code>æ—¶é—´åˆ†ç‰‡</code>å’Œ<code>Suspense</code>ã€‚</p></blockquote> <h4 id="_1-react-éƒ½åšè¿‡å“ªäº›ä¼˜åŒ–"><a href="http://interview.poetries.top/docs/simply.html#_1-react-%E9%83%BD%E5%81%9A%E8%BF%87%E5%93%AA%E4%BA%9B%E4%BC%98%E5%8C%96" class="header-anchor">#</a> 1. React éƒ½åšè¿‡å“ªäº›ä¼˜åŒ–</h4> <ul><li><strong>Reactæ¸²æŸ“é¡µé¢çš„ä¸¤ä¸ªé˜¶æ®µ</strong> <ul><li>è°ƒåº¦é˜¶æ®µï¼ˆreconciliationï¼‰ï¼šåœ¨è¿™ä¸ªé˜¶æ®µ React ä¼šæ›´æ–°æ•°æ®ç”Ÿæˆæ–°çš„ <code>Virtual DOM</code>ï¼Œç„¶åé€šè¿‡<code>Diff</code>ç®—æ³•ï¼Œå¿«é€Ÿæ‰¾å‡ºéœ€è¦æ›´æ–°çš„å…ƒç´ ï¼Œæ”¾åˆ°æ›´æ–°é˜Ÿåˆ—ä¸­å»ï¼Œå¾—åˆ°æ–°çš„æ›´æ–°é˜Ÿåˆ—ã€‚</li> <li>æ¸²æŸ“é˜¶æ®µï¼ˆcommitï¼‰ï¼šè¿™ä¸ªé˜¶æ®µ React ä¼šéå†æ›´æ–°é˜Ÿåˆ—ï¼Œå°†å…¶æ‰€æœ‰çš„å˜æ›´ä¸€æ¬¡æ€§æ›´æ–°åˆ°DOMä¸Š</li></ul></li> <li><strong>React 15 æ¶æ„</strong> <ul><li>React15æ¶æ„å¯ä»¥åˆ†ä¸ºä¸¤å±‚
<ul><li>Reconcilerï¼ˆåè°ƒå™¨ï¼‰â€”â€” è´Ÿè´£æ‰¾å‡ºå˜åŒ–çš„ç»„ä»¶ï¼›</li> <li>Rendererï¼ˆæ¸²æŸ“å™¨ï¼‰â€”â€” è´Ÿè´£å°†å˜åŒ–çš„ç»„ä»¶æ¸²æŸ“åˆ°é¡µé¢ä¸Šï¼›</li></ul></li></ul></li></ul> <blockquote><ul><li>åœ¨React15åŠä»¥å‰ï¼ŒReconcileré‡‡ç”¨é€’å½’çš„æ–¹å¼åˆ›å»ºè™šæ‹ŸDOMï¼Œé€’å½’è¿‡ç¨‹æ˜¯ä¸èƒ½ä¸­æ–­çš„ã€‚å¦‚æœç»„ä»¶æ ‘çš„å±‚çº§å¾ˆæ·±ï¼Œé€’å½’ä¼šå ç”¨çº¿ç¨‹å¾ˆå¤šæ—¶é—´ï¼Œé€’å½’æ›´æ–°æ—¶é—´è¶…è¿‡äº†16msï¼Œç”¨æˆ·äº¤äº’å°±ä¼šå¡é¡¿ã€‚</li> <li>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒReact16å°†é€’å½’çš„æ— æ³•ä¸­æ–­çš„æ›´æ–°é‡æ„ä¸ºå¼‚æ­¥çš„å¯ä¸­æ–­æ›´æ–°ï¼Œç”±äºæ›¾ç»ç”¨äºé€’å½’çš„è™šæ‹ŸDOMæ•°æ®ç»“æ„å·²ç»æ— æ³•æ»¡è¶³éœ€è¦ã€‚äºæ˜¯ï¼Œå…¨æ–°çš„Fiberæ¶æ„åº”è¿è€Œç”Ÿã€‚</li></ul></blockquote> <ul><li><p><strong>React 16 æ¶æ„</strong></p> <ul><li>ä¸ºäº†è§£å†³åŒæ­¥æ›´æ–°é•¿æ—¶é—´å ç”¨çº¿ç¨‹å¯¼è‡´é¡µé¢å¡é¡¿çš„é—®é¢˜ï¼Œä¹Ÿä¸ºäº†æ¢ç´¢è¿è¡Œæ—¶ä¼˜åŒ–çš„æ›´å¤šå¯èƒ½ï¼ŒReactå¼€å§‹é‡æ„å¹¶ä¸€ç›´æŒç»­è‡³ä»Šã€‚é‡æ„çš„ç›®æ ‡æ˜¯å®ç°Concurrent Modeï¼ˆå¹¶å‘æ¨¡å¼ï¼‰ã€‚</li> <li>ä»v15åˆ°v16ï¼ŒReactå›¢é˜ŸèŠ±äº†ä¸¤å¹´æ—¶é—´å°†æºç æ¶æ„ä¸­çš„Stack Reconcileré‡æ„ä¸ºFiber Reconciler</li> <li><code>React16æ¶æ„å¯ä»¥åˆ†ä¸ºä¸‰å±‚</code>ï¼š
<ul><li>Schedulerï¼ˆè°ƒåº¦å™¨ï¼‰â€”â€” è°ƒåº¦ä»»åŠ¡çš„ä¼˜å…ˆçº§ï¼Œé«˜ä¼˜ä»»åŠ¡ä¼˜å…ˆè¿›å…¥Reconcilerï¼›</li> <li>Reconcilerï¼ˆåè°ƒå™¨ï¼‰â€”â€” è´Ÿè´£æ‰¾å‡ºå˜åŒ–çš„ç»„ä»¶ï¼šæ›´æ–°å·¥ä½œä»é€’å½’å˜æˆäº†å¯ä»¥ä¸­æ–­çš„å¾ªç¯è¿‡ç¨‹ã€‚Reconcilerå†…éƒ¨é‡‡ç”¨äº†Fiberçš„æ¶æ„ï¼›</li> <li>Rendererï¼ˆæ¸²æŸ“å™¨ï¼‰â€”â€” è´Ÿè´£å°†å˜åŒ–çš„ç»„ä»¶æ¸²æŸ“åˆ°é¡µé¢ä¸Šã€‚</li></ul></li></ul></li> <li><p><strong>React 17 ä¼˜åŒ–</strong></p> <ul><li>ä½¿ç”¨Laneæ¥ç®¡ç†ä»»åŠ¡çš„ä¼˜å…ˆçº§ã€‚Laneç”¨äºŒè¿›åˆ¶ä½è¡¨ç¤ºä»»åŠ¡çš„ä¼˜å…ˆçº§ï¼Œæ–¹ä¾¿ä¼˜å…ˆçº§çš„è®¡ç®—ï¼ˆä½è¿ç®—ï¼‰ï¼Œä¸åŒä¼˜å…ˆçº§å ç”¨ä¸åŒä½ç½®çš„â€œèµ›é“â€ï¼Œè€Œä¸”å­˜åœ¨æ‰¹çš„æ¦‚å¿µï¼Œä¼˜å…ˆçº§è¶Šä½ï¼Œâ€œèµ›é“â€è¶Šå¤šã€‚é«˜ä¼˜å…ˆçº§æ‰“æ–­ä½ä¼˜å…ˆçº§ï¼Œæ–°å»ºçš„ä»»åŠ¡éœ€è¦èµ‹äºˆä»€ä¹ˆä¼˜å…ˆçº§ç­‰é—®é¢˜éƒ½æ˜¯Laneæ‰€è¦è§£å†³çš„é—®é¢˜ã€‚</li> <li>Concurrent Modeçš„ç›®çš„æ˜¯å®ç°ä¸€å¥—å¯ä¸­æ–­/æ¢å¤çš„æ›´æ–°æœºåˆ¶ã€‚å…¶ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼š
<ul><li>ä¸€å¥—åç¨‹æ¶æ„ï¼šFiber Reconciler</li> <li>åŸºäºåç¨‹æ¶æ„çš„å¯å‘å¼æ›´æ–°ç®—æ³•ï¼šæ§åˆ¶åç¨‹æ¶æ„å·¥ä½œæ–¹å¼çš„ç®—æ³•</li></ul></li></ul></li></ul> <h4 id="_2-æµè§ˆå™¨ä¸€å¸§éƒ½ä¼šå¹²äº›ä»€ä¹ˆä»¥åŠrequestidlecallbackçš„å¯ç¤º"><a href="http://interview.poetries.top/docs/simply.html#_2-%E6%B5%8F%E8%A7%88%E5%99%A8%E4%B8%80%E5%B8%A7%E9%83%BD%E4%BC%9A%E5%B9%B2%E4%BA%9B%E4%BB%80%E4%B9%88%E4%BB%A5%E5%8F%8Arequestidlecallback%E7%9A%84%E5%90%AF%E7%A4%BA" class="header-anchor">#</a> 2. æµè§ˆå™¨ä¸€å¸§éƒ½ä¼šå¹²äº›ä»€ä¹ˆä»¥åŠrequestIdleCallbackçš„å¯ç¤º</h4> <blockquote><p>æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œé¡µé¢çš„å†…å®¹éƒ½æ˜¯ä¸€å¸§ä¸€å¸§ç»˜åˆ¶å‡ºæ¥çš„ï¼Œæµè§ˆå™¨åˆ·æ–°ç‡ä»£è¡¨æµè§ˆå™¨ä¸€ç§’ç»˜åˆ¶å¤šå°‘å¸§ã€‚åŸåˆ™ä¸Šè¯´ 1s å†…ç»˜åˆ¶çš„å¸§æ•°ä¹Ÿå¤šï¼Œç”»é¢è¡¨ç°å°±ä¹Ÿç»†è…»ã€‚ç›®å‰æµè§ˆå™¨å¤§å¤šæ˜¯ 60Hzï¼ˆ60å¸§/sï¼‰ï¼Œæ¯ä¸€å¸§è€—æ—¶ä¹Ÿå°±æ˜¯åœ¨ 16.6ms å·¦å³ã€‚é‚£ä¹ˆåœ¨è¿™ä¸€å¸§çš„ï¼ˆ16.6msï¼‰ è¿‡ç¨‹ä¸­æµè§ˆå™¨åˆå¹²äº†äº›ä»€ä¹ˆå‘¢</p></blockquote> <p><img src="./è¿›é˜¶_files/20210407173320.png" alt="" class="medium-zoom-image"></p> <p>é€šè¿‡ä¸Šé¢è¿™å¼ å›¾å¯ä»¥æ¸…æ¥šçš„çŸ¥é“ï¼Œæµè§ˆå™¨ä¸€å¸§ä¼šç»è¿‡ä¸‹é¢è¿™å‡ ä¸ªè¿‡ç¨‹ï¼š</p> <ol><li>æ¥å—è¾“å…¥äº‹ä»¶</li> <li>æ‰§è¡Œäº‹ä»¶å›è°ƒ</li> <li>å¼€å§‹ä¸€å¸§</li> <li>æ‰§è¡Œ RAF (RequestAnimationFrame)</li> <li>é¡µé¢å¸ƒå±€ï¼Œæ ·å¼è®¡ç®—</li> <li>ç»˜åˆ¶æ¸²æŸ“</li> <li>æ‰§è¡Œ RIC (RequestIdelCallback)</li></ol> <blockquote><p>ç¬¬ä¸ƒæ­¥çš„ RIC äº‹ä»¶ä¸æ˜¯æ¯ä¸€å¸§ç»“æŸéƒ½ä¼šæ‰§è¡Œï¼Œåªæœ‰åœ¨ä¸€å¸§çš„ 16.6ms ä¸­åšå®Œäº†å‰é¢ 6 ä»¶äº‹å„¿ä¸”è¿˜æœ‰å‰©ä½™æ—¶é—´ï¼Œæ‰ä¼šæ‰§è¡Œã€‚å¦‚æœä¸€å¸§æ‰§è¡Œç»“æŸåè¿˜æœ‰æ—¶é—´æ‰§è¡Œ RIC äº‹ä»¶ï¼Œé‚£ä¹ˆä¸‹ä¸€å¸§éœ€è¦åœ¨äº‹ä»¶æ‰§è¡Œç»“æŸæ‰èƒ½ç»§ç»­æ¸²æŸ“ï¼Œæ‰€ä»¥ RIC æ‰§è¡Œä¸è¦è¶…è¿‡ 30msï¼Œå¦‚æœé•¿æ—¶é—´ä¸å°†æ§åˆ¶æƒäº¤è¿˜ç»™æµè§ˆå™¨ï¼Œä¼šå½±å“ä¸‹ä¸€å¸§çš„æ¸²æŸ“ï¼Œå¯¼è‡´é¡µé¢å‡ºç°å¡é¡¿å’Œäº‹ä»¶å“åº”ä¸åŠæ—¶ã€‚</p></blockquote> <blockquote><p><code>requestIdleCallback çš„å¯ç¤º</code>ï¼šæˆ‘ä»¬ä»¥æµè§ˆå™¨æ˜¯å¦æœ‰å‰©ä½™æ—¶é—´ä½œä¸ºä»»åŠ¡ä¸­æ–­çš„æ ‡å‡†ï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦ä¸€ç§æœºåˆ¶ï¼Œå½“æµè§ˆå™¨æœ‰å‰©ä½™æ—¶é—´æ—¶é€šçŸ¥æˆ‘ä»¬ã€‚</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">requestIdleCallback</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">deadline</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
<span class="token comment">// deadline æœ‰ä¸¤ä¸ªå‚æ•°</span>
  <span class="token comment">// timeRemaining(): å½“å‰å¸§è¿˜å‰©ä¸‹å¤šå°‘æ—¶é—´</span>
  <span class="token comment">// didTimeout: æ˜¯å¦è¶…æ—¶</span>
<span class="token comment">// å¦å¤– requestIdleCallback åå¦‚æœè·Ÿä¸Šç¬¬äºŒä¸ªå‚æ•° {timeout: ...} åˆ™ä¼šå¼ºåˆ¶æµè§ˆå™¨åœ¨å½“å‰å¸§æ‰§è¡Œå®Œåæ‰§è¡Œã€‚</span>
 <span class="token keyword">if</span> <span class="token punctuation">(</span>deadline<span class="token punctuation">.</span><span class="token function">timeRemaining</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token comment">// TODO</span>
 <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
  <span class="token function">requestIdleCallback</span><span class="token punctuation">(</span>otherTasks<span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// ç”¨æ³•ç¤ºä¾‹</span>
<span class="token keyword">var</span> tasksNum <span class="token operator">=</span> <span class="token number">10000</span>

<span class="token function">requestIdleCallback</span><span class="token punctuation">(</span>unImportWork<span class="token punctuation">)</span>

<span class="token keyword">function</span> <span class="token function">unImportWork</span><span class="token punctuation">(</span><span class="token parameter">deadline</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span>deadline<span class="token punctuation">.</span><span class="token function">timeRemaining</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> tasksNum <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">æ‰§è¡Œäº†</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token number">10000</span> <span class="token operator">-</span> tasksNum <span class="token operator">+</span> <span class="token number">1</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">ä¸ªä»»åŠ¡</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
    tasksNum<span class="token operator">--</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>tasksNum <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// åœ¨æœªæ¥çš„å¸§ä¸­ç»§ç»­æ‰§è¡Œ</span>
    <span class="token function">requestIdleCallback</span><span class="token punctuation">(</span>unImportWork<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>å…¶å®éƒ¨åˆ†æµè§ˆå™¨å·²ç»å®ç°äº†è¿™ä¸ªAPIï¼Œè¿™å°±æ˜¯requestIdleCallbackã€‚ä½†æ˜¯ç”±äºä»¥ä¸‹å› ç´ ï¼ŒFacebook æŠ›å¼ƒäº† <code>requestIdleCallback</code>çš„åŸç”Ÿ APIï¼š</p></blockquote> <ul><li>æµè§ˆå™¨å…¼å®¹æ€§ï¼›</li> <li>è§¦å‘é¢‘ç‡ä¸ç¨³å®šï¼Œå—å¾ˆå¤šå› ç´ å½±å“ã€‚æ¯”å¦‚å½“æˆ‘ä»¬çš„æµè§ˆå™¨åˆ‡æ¢tabåï¼Œä¹‹å‰tabæ³¨å†Œçš„<code>requestIdleCallback</code>è§¦å‘çš„é¢‘ç‡ä¼šå˜å¾—å¾ˆä½ã€‚</li></ul> <blockquote><p>åŸºäºä»¥ä¸ŠåŸå› ï¼Œåœ¨Reactä¸­å®ç°äº†åŠŸèƒ½æ›´å®Œå¤‡çš„<code>requestIdleCallbackpolyfill</code>ï¼Œè¿™å°±æ˜¯<code>Scheduler</code>ã€‚é™¤äº†åœ¨ç©ºé—²æ—¶è§¦å‘å›è°ƒçš„åŠŸèƒ½å¤–ï¼ŒSchedulerè¿˜æä¾›äº†å¤šç§è°ƒåº¦ä¼˜å…ˆçº§ä¾›ä»»åŠ¡è®¾ç½®</p></blockquote> <h4 id="_3-react-fiberæ˜¯ä»€ä¹ˆ"><a href="http://interview.poetries.top/docs/simply.html#_3-react-fiber%E6%98%AF%E4%BB%80%E4%B9%88" class="header-anchor">#</a> 3. React Fiberæ˜¯ä»€ä¹ˆ</h4> <blockquote><p><code>React Fiber</code>æ˜¯å¯¹æ ¸å¿ƒç®—æ³•çš„ä¸€æ¬¡é‡æ–°å®ç°ã€‚<code>React Fiber</code>æŠŠæ›´æ–°è¿‡ç¨‹ç¢ç‰‡åŒ–ï¼ŒæŠŠä¸€ä¸ªè€—æ—¶é•¿çš„ä»»åŠ¡åˆ†æˆå¾ˆå¤šå°ç‰‡ï¼Œæ¯ä¸€ä¸ªå°ç‰‡çš„è¿è¡Œæ—¶é—´å¾ˆçŸ­ï¼Œè™½ç„¶æ€»æ—¶é—´ä¾ç„¶å¾ˆé•¿ï¼Œä½†æ˜¯åœ¨æ¯ä¸ªå°ç‰‡æ‰§è¡Œå®Œä¹‹åï¼Œéƒ½ç»™å…¶ä»–ä»»åŠ¡ä¸€ä¸ªæ‰§è¡Œçš„æœºä¼šï¼Œè¿™æ ·å”¯ä¸€çš„çº¿ç¨‹å°±ä¸ä¼šè¢«ç‹¬å ï¼Œå…¶ä»–ä»»åŠ¡ä¾ç„¶æœ‰è¿è¡Œçš„æœºä¼š</p></blockquote> <ol><li>åœ¨<code>React Fiber</code>ä¸­ï¼Œä¸€æ¬¡æ›´æ–°è¿‡ç¨‹ä¼šåˆ†æˆå¤šä¸ªåˆ†ç‰‡å®Œæˆï¼Œæ‰€ä»¥å®Œå…¨æœ‰å¯èƒ½ä¸€ä¸ªæ›´æ–°ä»»åŠ¡è¿˜æ²¡æœ‰å®Œæˆï¼Œå°±è¢«å¦ä¸€ä¸ªæ›´é«˜ä¼˜å…ˆçº§çš„æ›´æ–°è¿‡ç¨‹æ‰“æ–­ï¼Œè¿™æ—¶å€™ï¼Œä¼˜å…ˆçº§é«˜çš„æ›´æ–°ä»»åŠ¡ä¼šä¼˜å…ˆå¤„ç†å®Œï¼Œè€Œä½ä¼˜å…ˆçº§æ›´æ–°ä»»åŠ¡æ‰€åšçš„å·¥ä½œåˆ™ä¼šå®Œå…¨ä½œåºŸï¼Œç„¶åç­‰å¾…æœºä¼šé‡å¤´å†æ¥</li> <li>å› ä¸ºä¸€ä¸ªæ›´æ–°è¿‡ç¨‹å¯èƒ½è¢«æ‰“æ–­ï¼Œæ‰€ä»¥<code>React Fiber</code>ä¸€ä¸ªæ›´æ–°è¿‡ç¨‹è¢«åˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µ(<code>Phase</code>)ï¼šç¬¬ä¸€ä¸ªé˜¶æ®µ<code>Reconciliation Phase</code>å’Œç¬¬äºŒé˜¶æ®µ<code>Commit Phase</code></li> <li>åœ¨ç¬¬ä¸€é˜¶æ®µ<code>Reconciliation Phase</code>ï¼Œ<code>React Fiber</code>ä¼šæ‰¾å‡ºéœ€è¦æ›´æ–°å“ªäº›<code>DOM</code>ï¼Œè¿™ä¸ªé˜¶æ®µæ˜¯å¯ä»¥è¢«æ‰“æ–­çš„ï¼›ä½†æ˜¯åˆ°äº†ç¬¬äºŒé˜¶æ®µ<code>Commit Phase</code>ï¼Œé‚£å°±ä¸€é¼“ä½œæ°”æŠŠ<code>DOM</code>æ›´æ–°å®Œï¼Œç»ä¸ä¼šè¢«æ‰“æ–­</li> <li>è¿™ä¸¤ä¸ªé˜¶æ®µå¤§éƒ¨åˆ†å·¥ä½œéƒ½æ˜¯<code>React Fiber</code>åšï¼Œå’Œæˆ‘ä»¬ç›¸å…³çš„ä¹Ÿå°±æ˜¯ç”Ÿå‘½å‘¨æœŸå‡½æ•°</li></ol> <blockquote><p><code>React Fiber</code>æ”¹å˜äº†ä¹‹å‰<code>react</code>çš„ç»„ä»¶æ¸²æŸ“æœºåˆ¶ï¼Œæ–°çš„æ¶æ„ä½¿åŸæ¥åŒæ­¥æ¸²æŸ“çš„ç»„ä»¶ç°åœ¨å¯ä»¥å¼‚æ­¥åŒ–ï¼Œå¯ä¸­é€”ä¸­æ–­æ¸²æŸ“ï¼Œæ‰§è¡Œæ›´é«˜ä¼˜å…ˆçº§çš„ä»»åŠ¡ã€‚é‡Šæ”¾æµè§ˆå™¨ä¸»çº¿ç¨‹</p></blockquote> <p><strong>å…³é”®ç‰¹æ€§</strong></p> <ul><li>å¢é‡æ¸²æŸ“ï¼ˆæŠŠæ¸²æŸ“ä»»åŠ¡æ‹†åˆ†æˆå—ï¼ŒåŒ€åˆ°å¤šå¸§ï¼‰</li> <li>æ›´æ–°æ—¶èƒ½å¤Ÿæš‚åœï¼Œç»ˆæ­¢ï¼Œå¤ç”¨æ¸²æŸ“ä»»åŠ¡</li> <li>ç»™ä¸åŒç±»å‹çš„æ›´æ–°èµ‹äºˆä¼˜å…ˆçº§</li> <li>å¹¶å‘æ–¹é¢æ–°çš„åŸºç¡€èƒ½åŠ›</li></ul> <blockquote><p>å¢é‡æ¸²æŸ“ç”¨æ¥è§£å†³æ‰å¸§çš„é—®é¢˜ï¼Œæ¸²æŸ“ä»»åŠ¡æ‹†åˆ†ä¹‹åï¼Œæ¯æ¬¡åªåšä¸€å°æ®µï¼Œåšå®Œä¸€æ®µå°±æŠŠæ—¶é—´æ§åˆ¶æƒäº¤è¿˜ç»™ä¸»çº¿ç¨‹ï¼Œè€Œä¸åƒä¹‹å‰é•¿æ—¶é—´å ç”¨</p></blockquote> <h4 id="_4-ç»„ä»¶çš„æ¸²æŸ“é¡ºåº"><a href="http://interview.poetries.top/docs/simply.html#_4-%E7%BB%84%E4%BB%B6%E7%9A%84%E6%B8%B2%E6%9F%93%E9%A1%BA%E5%BA%8F" class="header-anchor">#</a> 4. ç»„ä»¶çš„æ¸²æŸ“é¡ºåº</h4> <blockquote><p>å‡å¦‚æœ‰A,B,C,Dç»„ä»¶ï¼Œå±‚çº§ç»“æ„ä¸ºï¼š</p></blockquote> <p><img src="./è¿›é˜¶_files/20210407174007.png" alt="" class="medium-zoom-image"></p> <p>æˆ‘ä»¬çŸ¥é“ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸä¸ºï¼š</p> <p><strong>æŒ‚è½½é˜¶æ®µ</strong>ï¼š</p> <ul><li><code>constructor()</code></li> <li><code>componentWillMount()</code></li> <li><code>render()</code></li> <li><code>componentDidMount()</code></li></ul> <p><strong>æ›´æ–°é˜¶æ®µä¸º</strong>ï¼š</p> <ul><li><code>componentWillReceiveProps()</code></li> <li><code>shouldComponentUpdate()</code></li> <li><code>componentWillUpdate()</code></li> <li><code>render()</code></li> <li><code>componentDidUpdate</code></li></ul> <blockquote><p>é‚£ä¹ˆåœ¨æŒ‚è½½é˜¶æ®µï¼Œ<code>A,B,C,D</code>çš„ç”Ÿå‘½å‘¨æœŸæ¸²æŸ“é¡ºåºæ˜¯å¦‚ä½•çš„å‘¢ï¼Ÿ</p></blockquote> <p>é‚£ä¹ˆåœ¨æŒ‚è½½é˜¶æ®µï¼ŒA,B,C,Dçš„ç”Ÿå‘½å‘¨æœŸæ¸²æŸ“é¡ºåºæ˜¯å¦‚ä½•çš„å‘¢ï¼Ÿ</p> <p><img src="./è¿›é˜¶_files/20210407173933.png" alt="" class="medium-zoom-image"></p> <blockquote><p>ä»¥<code>render()</code>å‡½æ•°ä¸ºåˆ†ç•Œçº¿ã€‚ä»é¡¶å±‚ç»„ä»¶å¼€å§‹ï¼Œä¸€ç›´å¾€ä¸‹ï¼Œç›´è‡³æœ€åº•å±‚å­ç»„ä»¶ã€‚ç„¶åå†å¾€ä¸Š</p></blockquote> <p>ç»„ä»¶<code>update</code>é˜¶æ®µåŒç†</p> <p>å‰é¢æ˜¯<code>react16</code>ä»¥å‰çš„ç»„å»ºæ¸²æŸ“æ–¹å¼ã€‚è¿™å°±å­˜åœ¨ä¸€ä¸ªé—®é¢˜</p> <blockquote><p>å¦‚æœè¿™æ˜¯ä¸€ä¸ªå¾ˆå¤§ï¼Œå±‚çº§å¾ˆæ·±çš„ç»„ä»¶ï¼Œ<code>react</code>æ¸²æŸ“å®ƒéœ€è¦å‡ åç”šè‡³å‡ ç™¾æ¯«ç§’ï¼Œåœ¨è¿™æœŸé—´ï¼Œ<code>react</code>ä¼šä¸€ç›´å ç”¨æµè§ˆå™¨ä¸»çº¿ç¨‹ï¼Œä»»ä½•å…¶ä»–çš„æ“ä½œï¼ˆåŒ…æ‹¬ç”¨æˆ·çš„ç‚¹å‡»ï¼Œé¼ æ ‡ç§»åŠ¨ç­‰æ“ä½œï¼‰éƒ½æ— æ³•æ‰§è¡Œ</p></blockquote> <p><strong>Fiberæ¶æ„å°±æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜</strong></p> <blockquote><p>çœ‹ä¸€ä¸‹fiberæ¶æ„ ç»„å»ºçš„æ¸²æŸ“é¡ºåº</p></blockquote> <p><img src="./è¿›é˜¶_files/20210407173949.png" alt="" class="medium-zoom-image"></p> <blockquote><p>åŠ å…¥<code>fiber</code>çš„<code>react</code>å°†ç»„ä»¶æ›´æ–°åˆ†ä¸ºä¸¤ä¸ªæ—¶æœŸ</p></blockquote> <p><strong>è¿™ä¸¤ä¸ªæ—¶æœŸä»¥renderä¸ºåˆ†ç•Œ</strong></p> <ul><li><code>render</code>å‰çš„ç”Ÿå‘½å‘¨æœŸä¸º<code>phase1</code>,</li> <li><code>render</code>åçš„ç”Ÿå‘½å‘¨æœŸä¸º<code>phase2</code></li></ul> <blockquote><ul><li><code>phase1</code>çš„ç”Ÿå‘½å‘¨æœŸæ˜¯å¯ä»¥è¢«æ‰“æ–­çš„ï¼Œæ¯éš”ä¸€æ®µæ—¶é—´å®ƒä¼šè·³å‡ºå½“å‰æ¸²æŸ“è¿›ç¨‹ï¼Œå»ç¡®å®šæ˜¯å¦æœ‰å…¶ä»–æ›´é‡è¦çš„ä»»åŠ¡ã€‚æ­¤è¿‡ç¨‹ï¼Œ<code>React</code>åœ¨ <code>workingProgressTree</code> ï¼ˆå¹¶ä¸æ˜¯çœŸå®çš„<code>virtualDomTree</code>ï¼‰ä¸Šå¤ç”¨ <code>current</code> ä¸Šçš„ <code>Fiber</code> æ•°æ®ç»“æ„æ¥ä¸€æ­¥åœ°ï¼ˆé€šè¿‡<code>requestIdleCallback</code>ï¼‰æ¥æ„å»ºæ–°çš„ treeï¼Œæ ‡è®°å¤„éœ€è¦æ›´æ–°çš„èŠ‚ç‚¹ï¼Œæ”¾å…¥é˜Ÿåˆ—ä¸­</li> <li><code>phase2</code>çš„ç”Ÿå‘½å‘¨æœŸæ˜¯ä¸å¯è¢«æ‰“æ–­çš„ï¼Œ<code>React</code> å°†å…¶æ‰€æœ‰çš„å˜æ›´ä¸€æ¬¡æ€§æ›´æ–°åˆ°<code>DOM</code>ä¸Š</li></ul></blockquote> <p><strong>è¿™é‡Œæœ€é‡è¦çš„æ˜¯phase1è¿™æ˜¯æ—¶æœŸæ‰€åšçš„äº‹ã€‚å› æ­¤æˆ‘ä»¬éœ€è¦å…·ä½“äº†è§£phase1çš„æœºåˆ¶</strong></p> <ul><li>å¦‚æœä¸è¢«æ‰“æ–­ï¼Œé‚£ä¹ˆ<code>phase1</code>æ‰§è¡Œå®Œä¼šç›´æ¥è¿›å…¥<code>render</code>å‡½æ•°ï¼Œæ„å»ºçœŸå®çš„<code>virtualDomTree</code></li> <li>å¦‚æœç»„ä»¶å†<code>phase1</code>è¿‡ç¨‹ä¸­è¢«æ‰“æ–­ï¼Œå³å½“å‰ç»„ä»¶åªæ¸²æŸ“åˆ°ä¸€åŠï¼ˆä¹Ÿè®¸æ˜¯åœ¨<code>willMount</code>,ä¹Ÿè®¸æ˜¯<code>willUpdate</code>~åæ­£æ˜¯åœ¨renderä¹‹å‰çš„ç”Ÿå‘½å‘¨æœŸï¼‰ï¼Œé‚£ä¹ˆ<code>react</code>ä¼šæ€ä¹ˆå¹²å‘¢ï¼Ÿ <code>react</code>ä¼šæ”¾å¼ƒå½“å‰ç»„ä»¶æ‰€æœ‰å¹²åˆ°ä¸€åŠçš„äº‹æƒ…ï¼Œå»åšæ›´é«˜ä¼˜å…ˆçº§æ›´é‡è¦çš„ä»»åŠ¡ï¼ˆå½“ç„¶ï¼Œä¹Ÿå¯èƒ½æ˜¯ç”¨æˆ·é¼ æ ‡ç§»åŠ¨ï¼Œæˆ–è€…å…¶ä»–reactç›‘å¬ä¹‹å¤–çš„ä»»åŠ¡ï¼‰ï¼Œå½“æ‰€æœ‰é«˜ä¼˜å…ˆçº§ä»»åŠ¡æ‰§è¡Œå®Œä¹‹åï¼Œ<code>react</code>é€šè¿‡<code>callback</code>å›åˆ°ä¹‹å‰æ¸²æŸ“åˆ°ä¸€åŠçš„ç»„ä»¶ï¼Œä»å¤´å¼€å§‹æ¸²æŸ“ã€‚ï¼ˆçœ‹èµ·æ¥æ”¾å¼ƒå·²ç»æ¸²æŸ“å®Œçš„ç”Ÿå‘½å‘¨æœŸï¼Œä¼šæœ‰ç‚¹ä¸åˆç†ï¼Œåè€Œä¼šå¢åŠ æ¸²æŸ“æ—¶é•¿ï¼Œä½†æ˜¯<code>react</code>ç¡®å®æ˜¯è¿™ä¹ˆå¹²çš„ï¼‰</li></ul> <p><strong>æ‰€æœ‰phase1çš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°éƒ½å¯èƒ½è¢«æ‰§è¡Œå¤šæ¬¡ï¼Œå› ä¸ºå¯èƒ½ä¼šè¢«æ‰“æ–­é‡æ¥</strong></p> <blockquote><p>è¿™æ ·çš„è¯ï¼Œå°±å’Œ<code>react16</code>ç‰ˆæœ¬ä¹‹å‰æœ‰å¾ˆå¤§åŒºåˆ«äº†ï¼Œå› ä¸ºå¯èƒ½ä¼šè¢«æ‰§è¡Œå¤šæ¬¡ï¼Œé‚£ä¹ˆæˆ‘ä»¬æœ€å¥½å°±å¾—ä¿è¯<code>phase1</code>çš„ç”Ÿå‘½å‘¨æœŸæ¯ä¸€æ¬¡æ‰§è¡Œçš„ç»“æœéƒ½æ˜¯ä¸€æ ·çš„ï¼Œå¦åˆ™å°±ä¼šæœ‰é—®é¢˜ï¼Œå› æ­¤ï¼Œæœ€å¥½éƒ½æ˜¯çº¯å‡½æ•°</p></blockquote> <ul><li>å¦‚æœé«˜ä¼˜å…ˆçº§çš„ä»»åŠ¡ä¸€ç›´å­˜åœ¨ï¼Œé‚£ä¹ˆä½ä¼˜å…ˆçº§çš„ä»»åŠ¡åˆ™æ°¸è¿œæ— æ³•è¿›è¡Œï¼Œç»„ä»¶æ°¸è¿œæ— æ³•ç»§ç»­æ¸²æŸ“ã€‚è¿™ä¸ªé—®é¢˜facebookç›®å‰å¥½åƒè¿˜æ²¡è§£å†³</li> <li>æ‰€ä»¥ï¼Œfacebookåœ¨<code>react16</code>å¢åŠ <code>fiber</code>ç»“æ„ï¼Œå…¶å®å¹¶ä¸æ˜¯ä¸ºäº†å‡å°‘ç»„ä»¶çš„æ¸²æŸ“æ—¶é—´ï¼Œäº‹å®ä¸Šä¹Ÿå¹¶ä¸ä¼šå‡å°‘ï¼Œæœ€é‡è¦çš„æ˜¯ç°åœ¨å¯ä»¥ä½¿å¾—ä¸€äº›æ›´é«˜ä¼˜å…ˆçº§çš„ä»»åŠ¡ï¼Œå¦‚ç”¨æˆ·çš„æ“ä½œèƒ½å¤Ÿä¼˜å…ˆæ‰§è¡Œï¼Œæé«˜ç”¨æˆ·çš„ä½“éªŒï¼Œè‡³å°‘ç”¨æˆ·ä¸ä¼šæ„Ÿè§‰åˆ°å¡é¡¿</li></ul> <h4 id="_5-react-fiberæ¶æ„æ€»ç»“"><a href="http://interview.poetries.top/docs/simply.html#_5-react-fiber%E6%9E%B6%E6%9E%84%E6%80%BB%E7%BB%93" class="header-anchor">#</a> 5 React Fiberæ¶æ„æ€»ç»“</h4> <p><strong>React Fiberå¦‚ä½•æ€§èƒ½ä¼˜åŒ–</strong></p> <ul><li><strong>æ›´æ–°çš„ä¸¤ä¸ªé˜¶æ®µ</strong> <ul><li>è°ƒåº¦ç®—æ³•é˜¶æ®µ-æ‰§è¡Œdiffç®—æ³•ï¼Œçº¯jsè®¡ç®—</li> <li>Commité˜¶æ®µ-å°†diffç»“æœæ¸²æŸ“dom</li></ul></li> <li>å¯èƒ½ä¼šæœ‰æ€§èƒ½é—®é¢˜
<ul><li>JSæ˜¯å•çº¿ç¨‹çš„ï¼Œä¸”å’ŒDOMæ¸²æŸ“å…¬ç”¨ä¸€ä¸ªçº¿ç¨‹</li> <li>å½“ç»„ä»¶è¶³å¤Ÿå¤æ‚ï¼Œç»„ä»¶æ›´æ–°æ—¶è®¡ç®—å’Œæ¸²æŸ“å‹åŠ›éƒ½å¤§</li> <li>åŒæ—¶å†æœ‰DOMæ“ä½œéœ€æ±‚ï¼ˆåŠ¨ç”»ã€é¼ æ ‡æ‹–æ‹½ç­‰ï¼‰ï¼Œå°†å¡é¡¿</li></ul></li> <li><strong>è§£å†³æ–¹æ¡ˆfiber</strong> <ul><li>å°†è°ƒåº¦ç®—æ³•é˜¶æ®µé˜¶æ®µä»»åŠ¡æ‹†åˆ†ï¼ˆCommitæ— æ³•æ‹†åˆ†ï¼‰</li> <li>DOMéœ€è¦æ¸²æŸ“æ—¶æš‚åœï¼Œç©ºé—²æ—¶æ¢å¤</li> <li><strong>åˆ†æ•£æ‰§è¡Œ:</strong> ä»»åŠ¡åˆ†å‰²åï¼Œå°±å¯ä»¥æŠŠå°ä»»åŠ¡å•å…ƒåˆ†æ•£åˆ°æµè§ˆå™¨çš„ç©ºé—²æœŸé—´å»æ’é˜Ÿæ‰§è¡Œï¼Œè€Œå®ç°çš„å…³é”®æ˜¯ä¸¤ä¸ªæ–°API: <code>requestIdleCallback</code> ä¸ <code>requestAnimationFrame</code> <ul><li>ä½ä¼˜å…ˆçº§çš„ä»»åŠ¡äº¤ç»™<code>requestIdleCallback</code>å¤„ç†ï¼Œè¿™æ˜¯ä¸ªæµè§ˆå™¨æä¾›çš„äº‹ä»¶å¾ªç¯ç©ºé—²æœŸçš„å›è°ƒå‡½æ•°ï¼Œéœ€è¦ <code>pollyfill</code>ï¼Œè€Œä¸”æ‹¥æœ‰ <code>deadline</code> å‚æ•°ï¼Œé™åˆ¶æ‰§è¡Œäº‹ä»¶ï¼Œä»¥ç»§ç»­åˆ‡åˆ†ä»»åŠ¡ï¼›</li> <li>é«˜ä¼˜å…ˆçº§çš„ä»»åŠ¡äº¤ç»™<code>requestAnimationFrame</code>å¤„ç†ï¼›</li></ul></li></ul></li></ul> <p><strong>React çš„æ ¸å¿ƒæµç¨‹å¯ä»¥åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†:</strong></p> <ul><li><code>reconciliation</code> (è°ƒåº¦ç®—æ³•ï¼Œä¹Ÿå¯ç§°ä¸º <code>render</code>)
<ul><li>æ›´æ–° <code>state</code> ä¸ <code>props</code>ï¼›</li> <li>è°ƒç”¨ç”Ÿå‘½å‘¨æœŸé’©å­ï¼›</li> <li>ç”Ÿæˆ <code>virtual dom</code> <ul><li>è¿™é‡Œåº”è¯¥ç§°ä¸º <code>Fiber Tree</code> æ›´ä¸ºç¬¦åˆï¼›</li></ul></li> <li>é€šè¿‡æ–°æ—§ vdom è¿›è¡Œ diff ç®—æ³•ï¼Œè·å– vdom change</li> <li>ç¡®å®šæ˜¯å¦éœ€è¦é‡æ–°æ¸²æŸ“</li></ul></li> <li><code>commit</code> <ul><li>å¦‚éœ€è¦ï¼Œåˆ™æ“ä½œ <code>dom</code> èŠ‚ç‚¹æ›´æ–°</li></ul></li></ul> <blockquote><p>è¦äº†è§£ Fiberï¼Œæˆ‘ä»¬é¦–å…ˆæ¥çœ‹ä¸ºä»€ä¹ˆéœ€è¦å®ƒ</p></blockquote> <ul><li><strong>é—®é¢˜</strong>: éšç€åº”ç”¨å˜å¾—è¶Šæ¥è¶Šåºå¤§ï¼Œæ•´ä¸ªæ›´æ–°æ¸²æŸ“çš„è¿‡ç¨‹å¼€å§‹å˜å¾—åƒåŠ›ï¼Œå¤§é‡çš„ç»„ä»¶æ¸²æŸ“ä¼šå¯¼è‡´ä¸»è¿›ç¨‹é•¿æ—¶é—´è¢«å ç”¨ï¼Œå¯¼è‡´ä¸€äº›åŠ¨ç”»æˆ–é«˜é¢‘æ“ä½œå‡ºç°å¡é¡¿å’Œæ‰å¸§çš„æƒ…å†µã€‚è€Œå…³é”®ç‚¹ï¼Œä¾¿æ˜¯ åŒæ­¥é˜»å¡ã€‚åœ¨ä¹‹å‰çš„è°ƒåº¦ç®—æ³•ä¸­ï¼ŒReact éœ€è¦å®ä¾‹åŒ–æ¯ä¸ªç±»ç»„ä»¶ï¼Œç”Ÿæˆä¸€é¢—ç»„ä»¶æ ‘ï¼Œä½¿ç”¨ åŒæ­¥é€’å½’ çš„æ–¹å¼è¿›è¡Œéå†æ¸²æŸ“ï¼Œè€Œè¿™ä¸ªè¿‡ç¨‹æœ€å¤§çš„é—®é¢˜å°±æ˜¯æ— æ³• æš‚åœå’Œæ¢å¤ã€‚</li> <li><strong>è§£å†³æ–¹</strong>æ¡ˆ: è§£å†³åŒæ­¥é˜»å¡çš„æ–¹æ³•ï¼Œé€šå¸¸æœ‰ä¸¤ç§: å¼‚æ­¥ ä¸ ä»»åŠ¡åˆ†å‰²ã€‚è€Œ React Fiber ä¾¿æ˜¯ä¸ºäº†å®ç°ä»»åŠ¡åˆ†å‰²è€Œè¯ç”Ÿçš„</li> <li><strong>ç®€è¿°</strong> <ul><li>åœ¨ <code>React V16</code> å°†è°ƒåº¦ç®—æ³•è¿›è¡Œäº†é‡æ„ï¼Œ å°†ä¹‹å‰çš„ <code>stack reconciler</code> é‡æ„æˆæ–°ç‰ˆçš„ fiber <code>reconciler</code>ï¼Œå˜æˆäº†å…·æœ‰é“¾è¡¨å’ŒæŒ‡é’ˆçš„ å•é“¾è¡¨æ ‘éå†ç®—æ³•ã€‚é€šè¿‡æŒ‡é’ˆæ˜ å°„ï¼Œæ¯ä¸ªå•å…ƒéƒ½è®°å½•ç€éå†å½“ä¸‹çš„ä¸Šä¸€æ­¥ä¸ä¸‹ä¸€æ­¥ï¼Œä»è€Œä½¿éå†å˜å¾—å¯ä»¥è¢«æš‚åœå’Œé‡å¯</li> <li>è¿™é‡Œæˆ‘ç†è§£ä¸ºæ˜¯ä¸€ç§ ä»»åŠ¡åˆ†å‰²è°ƒåº¦ç®—æ³•ï¼Œä¸»è¦æ˜¯ å°†åŸå…ˆåŒæ­¥æ›´æ–°æ¸²æŸ“çš„ä»»åŠ¡åˆ†å‰²æˆä¸€ä¸ªä¸ªç‹¬ç«‹çš„ å°ä»»åŠ¡å•ä½ï¼Œæ ¹æ®ä¸åŒçš„ä¼˜å…ˆçº§ï¼Œå°†å°ä»»åŠ¡åˆ†æ•£åˆ°æµè§ˆå™¨çš„ç©ºé—²æ—¶é—´æ‰§è¡Œï¼Œå……åˆ†åˆ©ç”¨ä¸»è¿›ç¨‹çš„äº‹ä»¶å¾ªç¯æœºåˆ¶</li></ul></li> <li><strong>æ ¸å¿ƒ</strong> <ul><li><code>Fiber</code> è¿™é‡Œå¯ä»¥å…·è±¡ä¸ºä¸€ä¸ª æ•°æ®ç»“æ„</li></ul></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Fiber</span> <span class="token punctuation">{</span>
	<span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">instance</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>instance <span class="token operator">=</span> instance
		<span class="token comment">// æŒ‡å‘ç¬¬ä¸€ä¸ª child èŠ‚ç‚¹</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>child <span class="token operator">=</span> child
		<span class="token comment">// æŒ‡å‘çˆ¶èŠ‚ç‚¹</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>return <span class="token operator">=</span> parent
		<span class="token comment">// æŒ‡å‘ç¬¬ä¸€ä¸ªå…„å¼ŸèŠ‚ç‚¹</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>sibling <span class="token operator">=</span> previous
	<span class="token punctuation">}</span>	
<span class="token punctuation">}</span>
</code></pre></div><ul><li><strong>é“¾è¡¨æ ‘éå†ç®—æ³•</strong>: é€šè¿‡ èŠ‚ç‚¹ä¿å­˜ä¸æ˜ å°„ï¼Œä¾¿èƒ½å¤Ÿéšæ—¶åœ°è¿›è¡Œ åœæ­¢å’Œé‡å¯ï¼Œè¿™æ ·ä¾¿èƒ½è¾¾åˆ°å®ç°ä»»åŠ¡åˆ†å‰²çš„åŸºæœ¬å‰æ
<ul><li>é¦–å…ˆé€šè¿‡ä¸æ–­éå†å­èŠ‚ç‚¹ï¼Œåˆ°æ ‘æœ«å°¾ï¼›</li> <li>å¼€å§‹é€šè¿‡ <code>sibling</code> éå†å…„å¼ŸèŠ‚ç‚¹ï¼›</li> <li>return è¿”å›çˆ¶èŠ‚ç‚¹ï¼Œç»§ç»­æ‰§è¡Œ2ï¼›</li> <li>ç›´åˆ° root èŠ‚ç‚¹åï¼Œè·³å‡ºéå†ï¼›</li></ul></li> <li><strong>ä»»åŠ¡åˆ†å‰²</strong>ï¼ŒReact ä¸­çš„æ¸²æŸ“æ›´æ–°å¯ä»¥åˆ†æˆä¸¤ä¸ªé˜¶æ®µ
<ul><li><strong>reconciliation é˜¶æ®µ</strong>: vdom çš„æ•°æ®å¯¹æ¯”ï¼Œæ˜¯ä¸ªé€‚åˆæ‹†åˆ†çš„é˜¶æ®µï¼Œæ¯”å¦‚å¯¹æ¯”ä¸€éƒ¨åˆ†æ ‘åï¼Œå…ˆæš‚åœæ‰§è¡Œä¸ªåŠ¨ç”»è°ƒç”¨ï¼Œå¾…å®Œæˆåå†å›æ¥ç»§ç»­æ¯”å¯¹</li> <li><strong>Commit é˜¶æ®µ</strong>: å°† change list æ›´æ–°åˆ° dom ä¸Šï¼Œå¹¶ä¸é€‚åˆæ‹†åˆ†ï¼Œæ‰èƒ½ä¿æŒæ•°æ®ä¸ UI çš„åŒæ­¥ã€‚å¦åˆ™å¯èƒ½ç”±äºé˜»å¡ UI æ›´æ–°ï¼Œè€Œå¯¼è‡´æ•°æ®æ›´æ–°å’Œ UI ä¸ä¸€è‡´çš„æƒ…å†µ</li></ul></li> <li><strong>åˆ†æ•£æ‰§è¡Œ:</strong> ä»»åŠ¡åˆ†å‰²åï¼Œå°±å¯ä»¥æŠŠå°ä»»åŠ¡å•å…ƒåˆ†æ•£åˆ°æµè§ˆå™¨çš„ç©ºé—²æœŸé—´å»æ’é˜Ÿæ‰§è¡Œï¼Œè€Œå®ç°çš„å…³é”®æ˜¯ä¸¤ä¸ªæ–°API: <code>requestIdleCallback</code> ä¸ <code>requestAnimationFrame</code> <ul><li>ä½ä¼˜å…ˆçº§çš„ä»»åŠ¡äº¤ç»™<code>requestIdleCallback</code>å¤„ç†ï¼Œè¿™æ˜¯ä¸ªæµè§ˆå™¨æä¾›çš„äº‹ä»¶å¾ªç¯ç©ºé—²æœŸçš„å›è°ƒå‡½æ•°ï¼Œéœ€è¦ <code>pollyfill</code>ï¼Œè€Œä¸”æ‹¥æœ‰ <code>deadline</code> å‚æ•°ï¼Œé™åˆ¶æ‰§è¡Œäº‹ä»¶ï¼Œä»¥ç»§ç»­åˆ‡åˆ†ä»»åŠ¡ï¼›</li> <li>é«˜ä¼˜å…ˆçº§çš„ä»»åŠ¡äº¤ç»™<code>requestAnimationFrame</code>å¤„ç†ï¼›</li></ul></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// ç±»ä¼¼äºè¿™æ ·çš„æ–¹å¼</span>
<span class="token function">requestIdleCallback</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">deadline</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// å½“æœ‰ç©ºé—²æ—¶é—´æ—¶ï¼Œæˆ‘ä»¬æ‰§è¡Œä¸€ä¸ªç»„ä»¶æ¸²æŸ“ï¼›</span>
    <span class="token comment">// æŠŠä»»åŠ¡å¡åˆ°ä¸€ä¸ªä¸ªç¢ç‰‡æ—¶é—´ä¸­å»ï¼›</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>deadline<span class="token punctuation">.</span><span class="token function">timeRemaining</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">||</span> deadline<span class="token punctuation">.</span>didTimeout<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> nextComponent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        nextComponent <span class="token operator">=</span> <span class="token function">performWork</span><span class="token punctuation">(</span>nextComponent<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li><strong>ä¼˜å…ˆçº§ç­–ç•¥:</strong> æ–‡æœ¬æ¡†è¾“å…¥ &gt; æœ¬æ¬¡è°ƒåº¦ç»“æŸéœ€å®Œæˆçš„ä»»åŠ¡ &gt; åŠ¨ç”»è¿‡æ¸¡ &gt; äº¤äº’åé¦ˆ &gt; æ•°æ®æ›´æ–° &gt; ä¸ä¼šæ˜¾ç¤ºä½†ä»¥é˜²å°†æ¥ä¼šæ˜¾ç¤ºçš„ä»»åŠ¡</li></ul> <blockquote><ul><li>Fiber å…¶å®å¯ä»¥ç®—æ˜¯ä¸€ç§ç¼–ç¨‹æ€æƒ³ï¼Œåœ¨å…¶å®ƒè¯­è¨€ä¸­ä¹Ÿæœ‰è®¸å¤šåº”ç”¨(Ruby Fiber)ã€‚</li> <li>æ ¸å¿ƒæ€æƒ³æ˜¯ ä»»åŠ¡æ‹†åˆ†å’ŒååŒï¼Œä¸»åŠ¨æŠŠæ‰§è¡Œæƒäº¤ç»™ä¸»çº¿ç¨‹ï¼Œä½¿ä¸»çº¿ç¨‹æœ‰æ—¶é—´ç©ºæŒ¡å¤„ç†å…¶ä»–é«˜ä¼˜å…ˆçº§ä»»åŠ¡ã€‚</li> <li>å½“é‡åˆ°è¿›ç¨‹é˜»å¡çš„é—®é¢˜æ—¶ï¼Œä»»åŠ¡åˆ†å‰²ã€å¼‚æ­¥è°ƒç”¨ å’Œ ç¼“å­˜ç­–ç•¥ æ˜¯ä¸‰ä¸ªæ˜¾è‘—çš„è§£å†³æ€è·¯ã€‚</li></ul></blockquote> <h3 id="_3-createelementè¿‡ç¨‹"><a href="http://interview.poetries.top/docs/simply.html#_3-createelement%E8%BF%87%E7%A8%8B" class="header-anchor">#</a> 3 createElementè¿‡ç¨‹</h3> <blockquote><p>React.createElement()ï¼š æ ¹æ®æŒ‡å®šçš„ç¬¬ä¸€ä¸ªå‚æ•°åˆ›å»ºä¸€ä¸ªReactå…ƒç´ </p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>React.createElement(
  type,
  [props],
  [...children]
)
</code></pre></div><ul><li>ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å¿…å¡«ï¼Œä¼ å…¥çš„æ˜¯ä¼¼HTMLæ ‡ç­¾åç§°ï¼Œeg: ul, li</li> <li>ç¬¬äºŒä¸ªå‚æ•°æ˜¯é€‰å¡«ï¼Œè¡¨ç¤ºçš„æ˜¯å±æ€§ï¼Œeg: className</li> <li>ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯é€‰å¡«, å­èŠ‚ç‚¹ï¼Œeg: è¦æ˜¾ç¤ºçš„æ–‡æœ¬å†…å®¹</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//å†™æ³•ä¸€ï¼š</span>

<span class="token keyword">var</span> child1 <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'li'</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">'one'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> child2 <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'li'</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">'two'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> content <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'ul'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> className<span class="token operator">:</span> <span class="token string">'teststyle'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> child1<span class="token punctuation">,</span> child2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ç¬¬ä¸‰ä¸ªå‚æ•°å¯ä»¥åˆ†å¼€ä¹Ÿå¯ä»¥å†™æˆä¸€ä¸ªæ•°ç»„</span>
      ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>
          content<span class="token punctuation">,</span>
        document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'example'</span><span class="token punctuation">)</span>
      <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//å†™æ³•äºŒï¼š</span>

<span class="token keyword">var</span> child1 <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'li'</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">'one'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> child2 <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'li'</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">'two'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> content <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'ul'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> className<span class="token operator">:</span> <span class="token string">'teststyle'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>child1<span class="token punctuation">,</span> child2<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>
          content<span class="token punctuation">,</span>
        document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'example'</span><span class="token punctuation">)</span>
      <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_4-è°ƒå’Œé˜¶æ®µ-setstateå†…éƒ¨å¹²äº†ä»€ä¹ˆ"><a href="http://interview.poetries.top/docs/simply.html#_4-%E8%B0%83%E5%92%8C%E9%98%B6%E6%AE%B5-setstate%E5%86%85%E9%83%A8%E5%B9%B2%E4%BA%86%E4%BB%80%E4%B9%88" class="header-anchor">#</a> 4 è°ƒå’Œé˜¶æ®µ setStateå†…éƒ¨å¹²äº†ä»€ä¹ˆ</h3> <ul><li>å½“è°ƒç”¨ setState æ—¶ï¼ŒReactä¼šåšçš„ç¬¬ä¸€ä»¶äº‹æƒ…æ˜¯å°†ä¼ é€’ç»™ setState çš„å¯¹è±¡åˆå¹¶åˆ°ç»„ä»¶çš„å½“å‰çŠ¶æ€</li> <li>è¿™å°†å¯åŠ¨ä¸€ä¸ªç§°ä¸ºå’Œè§£ï¼ˆ<code>reconciliation</code>ï¼‰çš„è¿‡ç¨‹ã€‚å’Œè§£ï¼ˆ<code>reconciliation</code>ï¼‰çš„æœ€ç»ˆç›®æ ‡æ˜¯ä»¥æœ€æœ‰æ•ˆçš„æ–¹å¼ï¼Œæ ¹æ®è¿™ä¸ªæ–°çš„çŠ¶æ€æ¥æ›´æ–°<code>UI</code>ã€‚ ä¸ºæ­¤ï¼Œ<code>React</code>å°†æ„å»ºä¸€ä¸ªæ–°çš„ <code>React</code> å…ƒç´ æ ‘ï¼ˆæ‚¨å¯ä»¥å°†å…¶è§†ä¸º <code>UI</code> çš„å¯¹è±¡è¡¨ç¤ºï¼‰</li> <li>ä¸€æ—¦æœ‰äº†è¿™ä¸ªæ ‘ï¼Œä¸ºäº†å¼„æ¸… UI å¦‚ä½•å“åº”æ–°çš„çŠ¶æ€è€Œæ”¹å˜ï¼ŒReact ä¼šå°†è¿™ä¸ªæ–°æ ‘ä¸ä¸Šä¸€ä¸ªå…ƒç´ æ ‘ç›¸æ¯”è¾ƒï¼ˆ diff ï¼‰</li></ul> <blockquote><p>é€šè¿‡è¿™æ ·åšï¼Œ React å°†ä¼šçŸ¥é“å‘ç”Ÿçš„ç¡®åˆ‡å˜åŒ–ï¼Œå¹¶ä¸”é€šè¿‡äº†è§£å‘ç”Ÿä»€ä¹ˆå˜åŒ–ï¼Œåªéœ€åœ¨ç»å¯¹å¿…è¦çš„æƒ…å†µä¸‹è¿›è¡Œæ›´æ–°å³å¯æœ€å°åŒ– UI çš„å ç”¨ç©ºé—´</p></blockquote> <h3 id="_5-setstate"><a href="http://interview.poetries.top/docs/simply.html#_5-setstate" class="header-anchor">#</a> 5 setState</h3> <blockquote><p>åœ¨äº†è§£setStateä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥ç®€å•äº†è§£ä¸‹ React ä¸€ä¸ªåŒ…è£…ç»“æ„: Transaction:</p></blockquote> <p><strong>äº‹åŠ¡ (Transaction)</strong></p> <blockquote><p>æ˜¯ React ä¸­çš„ä¸€ä¸ªè°ƒç”¨ç»“æ„ï¼Œç”¨äºåŒ…è£…ä¸€ä¸ªæ–¹æ³•ï¼Œç»“æ„ä¸º: initialize - perform(method) - closeã€‚é€šè¿‡äº‹åŠ¡ï¼Œå¯ä»¥ç»Ÿä¸€ç®¡ç†ä¸€ä¸ªæ–¹æ³•çš„å¼€å§‹ä¸ç»“æŸï¼›å¤„äºäº‹åŠ¡æµä¸­ï¼Œè¡¨ç¤ºè¿›ç¨‹æ­£åœ¨æ‰§è¡Œä¸€äº›æ“ä½œ</p></blockquote> <ul><li>setState: React ä¸­ç”¨äºä¿®æ”¹çŠ¶æ€ï¼Œæ›´æ–°è§†å›¾ã€‚å®ƒå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹:</li></ul> <p><strong>å¼‚æ­¥ä¸åŒæ­¥:</strong> setStateå¹¶ä¸æ˜¯å•çº¯çš„å¼‚æ­¥æˆ–åŒæ­¥ï¼Œè¿™å…¶å®ä¸è°ƒç”¨æ—¶çš„ç¯å¢ƒç›¸å…³:</p> <ul><li>åœ¨<strong>åˆæˆäº‹ä»¶</strong> å’Œ <strong>ç”Ÿå‘½å‘¨æœŸé’©å­</strong>(é™¤ componentDidUpdate) ä¸­ï¼ŒsetStateæ˜¯"å¼‚æ­¥"çš„ï¼›
<ul><li>åŸå› : å› ä¸ºåœ¨setStateçš„å®ç°ä¸­ï¼Œæœ‰ä¸€ä¸ªåˆ¤æ–­: å½“æ›´æ–°ç­–ç•¥æ­£åœ¨äº‹åŠ¡æµçš„æ‰§è¡Œä¸­æ—¶ï¼Œè¯¥ç»„ä»¶æ›´æ–°ä¼šè¢«æ¨å…¥dirtyComponentsé˜Ÿåˆ—ä¸­ç­‰å¾…æ‰§è¡Œï¼›å¦åˆ™ï¼Œå¼€å§‹æ‰§è¡ŒbatchedUpdatesé˜Ÿåˆ—æ›´æ–°ï¼›
<ul><li>åœ¨ç”Ÿå‘½å‘¨æœŸé’©å­è°ƒç”¨ä¸­ï¼Œæ›´æ–°ç­–ç•¥éƒ½å¤„äºæ›´æ–°ä¹‹å‰ï¼Œç»„ä»¶ä»å¤„äºäº‹åŠ¡æµä¸­ï¼Œè€ŒcomponentDidUpdateæ˜¯åœ¨æ›´æ–°ä¹‹åï¼Œæ­¤æ—¶ç»„ä»¶å·²ç»ä¸åœ¨äº‹åŠ¡æµä¸­äº†ï¼Œå› æ­¤åˆ™ä¼šåŒæ­¥æ‰§è¡Œï¼›</li> <li>åœ¨åˆæˆäº‹ä»¶ä¸­ï¼ŒReact æ˜¯åŸºäº äº‹åŠ¡æµå®Œæˆçš„äº‹ä»¶å§”æ‰˜æœºåˆ¶ å®ç°ï¼Œä¹Ÿæ˜¯å¤„äºäº‹åŠ¡æµä¸­ï¼›</li></ul></li> <li>é—®é¢˜: æ— æ³•åœ¨setStateåé©¬ä¸Šä»this.stateä¸Šè·å–æ›´æ–°åçš„å€¼ã€‚</li> <li>è§£å†³: å¦‚æœéœ€è¦é©¬ä¸ŠåŒæ­¥å»è·å–æ–°å€¼ï¼ŒsetStateå…¶å®æ˜¯å¯ä»¥ä¼ å…¥ç¬¬äºŒä¸ªå‚æ•°çš„ã€‚setState(updater, callback)ï¼Œåœ¨å›è°ƒä¸­å³å¯è·å–æœ€æ–°å€¼ï¼›</li></ul></li> <li>åœ¨ <strong>åŸç”Ÿäº‹ä»¶</strong> å’Œ setTimeout ä¸­ï¼ŒsetStateæ˜¯åŒæ­¥çš„ï¼Œå¯ä»¥é©¬ä¸Šè·å–æ›´æ–°åçš„å€¼ï¼›
<ul><li>åŸå› : åŸç”Ÿäº‹ä»¶æ˜¯æµè§ˆå™¨æœ¬èº«çš„å®ç°ï¼Œä¸äº‹åŠ¡æµæ— å…³ï¼Œè‡ªç„¶æ˜¯åŒæ­¥ï¼›è€ŒsetTimeoutæ˜¯æ”¾ç½®äºå®šæ—¶å™¨çº¿ç¨‹ä¸­å»¶åæ‰§è¡Œï¼Œæ­¤æ—¶äº‹åŠ¡æµå·²ç»“æŸï¼Œå› æ­¤ä¹Ÿæ˜¯åŒæ­¥ï¼›</li></ul></li> <li><strong>æ‰¹é‡æ›´æ–°</strong>: åœ¨ åˆæˆäº‹ä»¶ å’Œ ç”Ÿå‘½å‘¨æœŸé’©å­ ä¸­ï¼ŒsetStateæ›´æ–°é˜Ÿåˆ—æ—¶ï¼Œå­˜å‚¨çš„æ˜¯ åˆå¹¶çŠ¶æ€(Object.assign)ã€‚å› æ­¤å‰é¢è®¾ç½®çš„ key å€¼ä¼šè¢«åé¢æ‰€è¦†ç›–ï¼Œæœ€ç»ˆåªä¼šæ‰§è¡Œä¸€æ¬¡æ›´æ–°ï¼›</li> <li><strong>å‡½æ•°å¼</strong>: ç”±äº Fiber åŠ åˆå¹¶ çš„é—®é¢˜ï¼Œå®˜æ–¹æ¨èå¯ä»¥ä¼ å…¥ å‡½æ•° çš„å½¢å¼ã€‚setState(fn)ï¼Œåœ¨fnä¸­è¿”å›æ–°çš„stateå¯¹è±¡å³å¯ï¼Œä¾‹å¦‚this.setState((state, props) =&gt; newState)ï¼›
<ul><li>ä½¿ç”¨å‡½æ•°å¼ï¼Œå¯ä»¥ç”¨äºé¿å…setStateçš„æ‰¹é‡æ›´æ–°çš„é€»è¾‘ï¼Œä¼ å…¥çš„å‡½æ•°å°†ä¼šè¢« é¡ºåºè°ƒç”¨ï¼›</li></ul></li></ul> <p><strong>æ³¨æ„äº‹é¡¹:</strong></p> <ul><li>setState åˆå¹¶ï¼Œåœ¨ åˆæˆäº‹ä»¶ å’Œ ç”Ÿå‘½å‘¨æœŸé’©å­ ä¸­å¤šæ¬¡è¿ç»­è°ƒç”¨ä¼šè¢«ä¼˜åŒ–ä¸ºä¸€æ¬¡ï¼›</li> <li>å½“ç»„ä»¶å·²è¢«é”€æ¯ï¼Œå¦‚æœå†æ¬¡è°ƒç”¨setStateï¼ŒReact ä¼šæŠ¥é”™è­¦å‘Šï¼Œé€šå¸¸æœ‰ä¸¤ç§è§£å†³åŠæ³•
<ul><li>å°†æ•°æ®æŒ‚è½½åˆ°å¤–éƒ¨ï¼Œé€šè¿‡ props ä¼ å…¥ï¼Œå¦‚æ”¾åˆ° Redux æˆ– çˆ¶çº§ä¸­ï¼›</li> <li>åœ¨ç»„ä»¶å†…éƒ¨ç»´æŠ¤ä¸€ä¸ªçŠ¶æ€é‡ (isUnmounted)ï¼ŒcomponentWillUnmountä¸­æ ‡è®°ä¸º trueï¼Œåœ¨setStateå‰è¿›è¡Œåˆ¤æ–­ï¼›</li></ul></li></ul> <p><strong>æ€»ç»“</strong></p> <p>æœ‰æ—¶è¡¨ç°å‡ºåŒæ­¥ï¼Œæœ‰æ—¶è¡¨ç°å‡ºå¼‚æ­¥</p> <ol><li><code>setState</code> åªæœ‰åœ¨ React è‡ªèº«çš„åˆæˆäº‹ä»¶å’Œé’©å­å‡½æ•°ä¸­æ˜¯å¼‚æ­¥çš„ï¼Œåœ¨åŸç”Ÿäº‹ä»¶å’Œ setTimeout ä¸­éƒ½æ˜¯åŒæ­¥çš„</li> <li><code>setState</code> çš„å¼‚æ­¥å¹¶ä¸æ˜¯è¯´å†…éƒ¨ç”±å¼‚æ­¥ä»£ç å®ç°ï¼Œå…¶å®æœ¬èº«æ‰§è¡Œçš„è¿‡ç¨‹å’Œä»£ç éƒ½æ˜¯åŒæ­¥çš„ï¼Œåªæ˜¯åˆæˆäº‹ä»¶å’Œé’©å­å‡½æ•°ä¸­æ²¡æ³•ç«‹é©¬æ‹¿åˆ°æ›´æ–°åçš„å€¼ï¼Œå½¢æˆäº†æ‰€è°“çš„å¼‚æ­¥ã€‚å½“ç„¶å¯ä»¥é€šè¿‡ setState çš„ç¬¬äºŒä¸ªå‚æ•°ä¸­çš„ callback æ‹¿åˆ°æ›´æ–°åçš„ç»“æœ</li> <li><code>setState</code> çš„æ‰¹é‡æ›´æ–°ä¼˜åŒ–ä¹Ÿæ˜¯å»ºç«‹åœ¨å¼‚æ­¥ï¼ˆåˆæˆäº‹ä»¶ã€é’©å­å‡½æ•°ï¼‰ä¹‹ä¸Šçš„ï¼Œåœ¨åŸç”Ÿäº‹ä»¶å’Œ setTimeout ä¸­ä¸ä¼šæ‰¹é‡æ›´æ–°ï¼Œåœ¨å¼‚æ­¥ä¸­å¦‚æœå¯¹åŒä¸€ä¸ªå€¼è¿›è¡Œå¤šæ¬¡ setStateï¼ŒsetState çš„æ‰¹é‡æ›´æ–°ç­–ç•¥ä¼šå¯¹å…¶è¿›è¡Œè¦†ç›–ï¼Œå»æœ€åä¸€æ¬¡çš„æ‰§è¡Œï¼Œå¦‚æœæ˜¯åŒæ—¶ setState å¤šä¸ªä¸åŒçš„å€¼ï¼Œåœ¨æ›´æ–°æ—¶ä¼šå¯¹å…¶è¿›è¡Œåˆå¹¶æ‰¹é‡æ›´æ–°</li></ol> <ul><li>åˆæˆäº‹ä»¶ä¸­æ˜¯å¼‚æ­¥</li> <li>é’©å­å‡½æ•°ä¸­çš„æ˜¯å¼‚æ­¥</li> <li>åŸç”Ÿäº‹ä»¶ä¸­æ˜¯åŒæ­¥</li> <li>setTimeoutä¸­æ˜¯åŒæ­¥</li></ul> <p><img src="./è¿›é˜¶_files/20210409153900.png" alt="" class="medium-zoom-image"> <img src="./è¿›é˜¶_files/20210409153914.png" alt="" class="medium-zoom-image"> <img src="./è¿›é˜¶_files/20210409153926.png" alt="" class="medium-zoom-image"> <img src="./è¿›é˜¶_files/20210409153942.png" alt="" class="medium-zoom-image"> <img src="./è¿›é˜¶_files/20210409154004.png" alt="" class="medium-zoom-image"> <img src="./è¿›é˜¶_files/20210409154015.png" alt="" class="medium-zoom-image"></p> <h3 id="_6-setstateåŸç†åˆ†æ"><a href="http://interview.poetries.top/docs/simply.html#_6-setstate%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90" class="header-anchor">#</a> 6 setStateåŸç†åˆ†æ</h3> <p><strong>1. setStateå¼‚æ­¥æ›´æ–°</strong></p> <ul><li>æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œ<code>React</code>é€šè¿‡<code>this.state</code>æ¥è®¿é—®<code>state</code>ï¼Œé€šè¿‡<code>this.setState()</code>æ–¹æ³•æ¥æ›´æ–°<code>state</code>ã€‚å½“<code>this.setState()</code>æ–¹æ³•è¢«è°ƒç”¨çš„æ—¶å€™ï¼Œ<code>React</code>ä¼šé‡æ–°è°ƒç”¨<code>render</code>æ–¹æ³•æ¥é‡æ–°æ¸²æŸ“<code>UI</code></li> <li>é¦–å…ˆå¦‚æœç›´æ¥åœ¨<code>setState</code>åé¢è·å–<code>state</code>çš„å€¼æ˜¯è·å–ä¸åˆ°çš„ã€‚åœ¨<code>React</code>å†…éƒ¨æœºåˆ¶èƒ½æ£€æµ‹åˆ°çš„åœ°æ–¹ï¼Œ <code>setState</code>å°±æ˜¯å¼‚æ­¥çš„ï¼›<code>åœ¨React</code>æ£€æµ‹ä¸åˆ°çš„åœ°æ–¹ï¼Œä¾‹å¦‚<code>setInterval</code>,<code>setTimeout</code>ï¼Œ<code>setState</code>å°±æ˜¯åŒæ­¥æ›´æ–°çš„</li></ul> <p><img src="./è¿›é˜¶_files/431.png" alt="img" class="medium-zoom-image"></p> <blockquote><p>å› ä¸º<code>setState</code>æ˜¯å¯ä»¥æ¥å—ä¸¤ä¸ªå‚æ•°çš„ï¼Œä¸€ä¸ª<code>state</code>ï¼Œä¸€ä¸ªå›è°ƒå‡½æ•°ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥åœ¨å›è°ƒå‡½æ•°é‡Œé¢è·å–å€¼</p></blockquote> <p><img src="./è¿›é˜¶_files/432.png" alt="img" class="medium-zoom-image"></p> <ul><li><code>setState</code>æ–¹æ³•é€šè¿‡ä¸€ä¸ªé˜Ÿåˆ—æœºåˆ¶å®ç°<code>state</code>æ›´æ–°ï¼Œå½“æ‰§è¡Œ<code>setState</code>çš„æ—¶å€™ï¼Œä¼šå°†éœ€è¦æ›´æ–°çš„<code>state</code>åˆå¹¶ä¹‹åæ”¾å…¥çŠ¶æ€é˜Ÿåˆ—ï¼Œè€Œä¸ä¼šç«‹å³æ›´æ–°<code>this.state</code></li> <li>å¦‚æœæˆ‘ä»¬ä¸ä½¿ç”¨<code>setState</code>è€Œæ˜¯ä½¿ç”¨<code>this.state.key</code>æ¥ä¿®æ”¹ï¼Œå°†ä¸ä¼šè§¦å‘ç»„ä»¶çš„<code>re-render</code>ã€‚</li> <li>å¦‚æœå°†<code>this.state</code>èµ‹å€¼ç»™ä¸€ä¸ªæ–°çš„å¯¹è±¡å¼•ç”¨ï¼Œé‚£ä¹ˆå…¶ä»–ä¸åœ¨å¯¹è±¡ä¸Šçš„<code>state</code>å°†ä¸ä¼šè¢«æ”¾å…¥çŠ¶æ€é˜Ÿåˆ—ä¸­ï¼Œå½“ä¸‹æ¬¡è°ƒç”¨<code>setState</code>å¹¶å¯¹çŠ¶æ€é˜Ÿåˆ—è¿›è¡Œåˆå¹¶æ—¶ï¼Œç›´æ¥é€ æˆäº†<code>state</code>ä¸¢å¤±</li></ul> <p><strong>1.1 setStateæ‰¹é‡æ›´æ–°çš„è¿‡ç¨‹</strong></p> <blockquote><p>åœ¨<code>react</code>ç”Ÿå‘½å‘¨æœŸå’Œåˆæˆäº‹ä»¶æ‰§è¡Œå‰åéƒ½æœ‰ç›¸åº”çš„é’©å­ï¼Œåˆ†åˆ«æ˜¯<code>pre</code>é’©å­å’Œ<code>post</code>é’©å­ï¼Œ<code>pre</code>é’©å­ä¼šè°ƒç”¨<code>batchedUpdate</code>æ–¹æ³•å°†<code>isBatchingUpdates</code>å˜é‡ç½®ä¸º<code>true</code>ï¼Œå¼€å¯æ‰¹é‡æ›´æ–°ï¼Œè€Œ<code>post</code>é’©å­ä¼šå°†<code>isBatchingUpdates</code>ç½®ä¸º<code>false</code></p></blockquote> <ul><li><code>isBatchingUpdates</code>å˜é‡ç½®ä¸º<code>true</code>ï¼Œåˆ™ä¼šèµ°æ‰¹é‡æ›´æ–°åˆ†æ”¯ï¼Œ<code>setState</code>çš„æ›´æ–°ä¼šè¢«å­˜å…¥é˜Ÿåˆ—ä¸­ï¼Œå¾…åŒæ­¥ä»£ç æ‰§è¡Œå®Œåï¼Œå†æ‰§è¡Œé˜Ÿåˆ—ä¸­çš„<code>state</code>æ›´æ–°ã€‚ <code>isBatchingUpdates</code>ä¸º <code>true</code>ï¼Œåˆ™æŠŠå½“å‰ç»„ä»¶ï¼ˆå³è°ƒç”¨äº† <code>setState</code>çš„ç»„ä»¶ï¼‰æ”¾å…¥ <code>dirtyComponents</code> æ•°ç»„ä¸­ï¼›å¦åˆ™ <code>batchUpdate</code> æ‰€æœ‰é˜Ÿåˆ—ä¸­çš„æ›´æ–°</li> <li>è€Œåœ¨åŸç”Ÿäº‹ä»¶å’Œå¼‚æ­¥æ“ä½œä¸­ï¼Œä¸ä¼šæ‰§è¡Œ<code>pre</code>é’©å­ï¼Œæˆ–è€…ç”Ÿå‘½å‘¨æœŸçš„ä¸­çš„å¼‚æ­¥æ“ä½œä¹‹å‰æ‰§è¡Œäº†<code>pre</code>é’©å­ï¼Œä½†æ˜¯<code>pos</code>é’©å­ä¹Ÿåœ¨å¼‚æ­¥æ“ä½œä¹‹å‰æ‰§è¡Œå®Œäº†ï¼Œ<code>isBatchingUpdates</code>å¿…å®šä¸º<code>false</code>ï¼Œä¹Ÿå°±ä¸ä¼šè¿›è¡Œæ‰¹é‡æ›´æ–°</li></ul> <p><img src="./è¿›é˜¶_files/434.png" alt="img" class="medium-zoom-image"></p> <blockquote><p><code>enqueueUpdate</code>åŒ…å«äº†<code>React</code>é¿å…é‡å¤<code>render</code>çš„é€»è¾‘ã€‚<code>mountComponent</code>å’Œ<code>updateComponent</code>æ–¹æ³•åœ¨æ‰§è¡Œçš„æœ€å¼€å§‹ï¼Œä¼šè°ƒç”¨åˆ°<code>batchedUpdates</code>è¿›è¡Œæ‰¹å¤„ç†æ›´æ–°ï¼Œæ­¤æ—¶ä¼šå°†<code>isBatchingUpdates</code>è®¾ç½®ä¸º<code>true</code>ï¼Œä¹Ÿå°±æ˜¯å°†çŠ¶æ€æ ‡è®°ä¸ºç°åœ¨æ­£å¤„äºæ›´æ–°é˜¶æ®µäº†ã€‚ <code>isBatchingUpdates</code>ä¸º <code>true</code>ï¼Œåˆ™æŠŠå½“å‰ç»„ä»¶ï¼ˆå³è°ƒç”¨äº† <code>setState</code> çš„ç»„ä»¶ï¼‰æ”¾å…¥<code>dirtyComponents</code> æ•°ç»„ä¸­ï¼›å¦åˆ™ <code>batchUpdate</code> æ‰€æœ‰é˜Ÿåˆ—ä¸­çš„æ›´æ–°</p></blockquote> <p><strong>1.2 ä¸ºä»€ä¹ˆç›´æ¥ä¿®æ”¹this.stateæ— æ•ˆ</strong></p> <ul><li>è¦çŸ¥é“<code>setState</code>æœ¬è´¨æ˜¯é€šè¿‡ä¸€ä¸ªé˜Ÿåˆ—æœºåˆ¶å®ç°<code>state</code>æ›´æ–°çš„ã€‚ æ‰§è¡Œ<code>setState</code>æ—¶ï¼Œä¼šå°†éœ€è¦æ›´æ–°çš„stateåˆå¹¶åæ”¾å…¥çŠ¶æ€é˜Ÿåˆ—ï¼Œè€Œä¸ä¼šç«‹åˆ»æ›´æ–°<code>state</code>ï¼Œé˜Ÿåˆ—æœºåˆ¶å¯ä»¥æ‰¹é‡æ›´æ–°<code>state</code>ã€‚</li> <li>å¦‚æœä¸é€šè¿‡<code>setState</code>è€Œç›´æ¥ä¿®æ”¹<code>this.state</code>ï¼Œé‚£ä¹ˆè¿™ä¸ª<code>state</code>ä¸ä¼šæ”¾å…¥çŠ¶æ€é˜Ÿåˆ—ä¸­ï¼Œä¸‹æ¬¡è°ƒç”¨<code>setState</code>æ—¶å¯¹çŠ¶æ€é˜Ÿåˆ—è¿›è¡Œåˆå¹¶æ—¶ï¼Œä¼šå¿½ç•¥ä¹‹å‰ç›´æ¥è¢«ä¿®æ”¹çš„<code>state</code>ï¼Œè¿™æ ·æˆ‘ä»¬å°±æ— æ³•åˆå¹¶äº†ï¼Œè€Œä¸”å®é™…ä¹Ÿæ²¡æœ‰æŠŠä½ æƒ³è¦çš„<code>state</code>æ›´æ–°ä¸Šå»</li></ul> <p><strong>1.3 ä»€ä¹ˆæ˜¯æ‰¹é‡æ›´æ–° Batch Update</strong></p> <blockquote><p>åœ¨ä¸€äº›<code>mv*</code>æ¡†æ¶ä¸­ï¼Œï¼Œå°±æ˜¯å°†ä¸€æ®µæ—¶é—´å†…å¯¹<code>model</code>çš„ä¿®æ”¹æ‰¹é‡æ›´æ–°åˆ°<code>view</code>çš„æœºåˆ¶ã€‚æ¯”å¦‚é‚£å‰ç«¯æ¯”è¾ƒç«çš„<code>React</code>ã€<code>vue</code>ï¼ˆ<code>nextTick</code>æœºåˆ¶,è§†å›¾çš„æ›´æ–°ä»¥åŠå®ç°ï¼‰</p></blockquote> <p><strong>1.4 setStateä¹‹åå‘ç”Ÿçš„äº‹æƒ…</strong></p> <ul><li><code>setState</code>æ“ä½œå¹¶ä¸ä¿è¯æ˜¯åŒæ­¥çš„ï¼Œä¹Ÿå¯ä»¥è®¤ä¸ºæ˜¯å¼‚æ­¥çš„</li> <li><code>React</code>åœ¨<code>setState</code>ä¹‹åï¼Œä¼šç»å¯¹<code>state</code>è¿›è¡Œ<code>diff</code>ï¼Œåˆ¤æ–­æ˜¯å¦æœ‰æ”¹å˜ï¼Œç„¶åå»<code>diff dom</code>å†³å®šæ˜¯å¦è¦æ›´æ–°<code>UI</code>ã€‚å¦‚æœè¿™ä¸€ç³»åˆ—è¿‡ç¨‹ç«‹åˆ»å‘ç”Ÿåœ¨æ¯ä¸€ä¸ª<code>setState</code>ä¹‹åï¼Œå°±å¯èƒ½ä¼šæœ‰æ€§èƒ½é—®é¢˜</li> <li>åœ¨çŸ­æ—¶é—´å†…é¢‘ç¹<code>setState</code>ã€‚<code>React</code>ä¼šå°†<code>state</code>çš„æ”¹å˜å‹å…¥æ ˆä¸­ï¼Œåœ¨åˆé€‚çš„æ—¶æœºï¼Œæ‰¹é‡æ›´æ–°<code>state</code>å’Œè§†å›¾ï¼Œè¾¾åˆ°æé«˜æ€§èƒ½çš„æ•ˆæœ</li></ul> <p><strong>1.5 å¦‚ä½•çŸ¥é“stateå·²ç»è¢«æ›´æ–°</strong></p> <blockquote><p>ä¼ å…¥å›è°ƒå‡½æ•°</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>setState({
    index: 1
}}, function(){
    console.log(this.state.index);
})
</code></pre></div><blockquote><p>åœ¨é’©å­å‡½æ•°ä¸­ä½“ç°</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>componentDidUpdate(){
    console.log(this.state.index);
}
</code></pre></div><p><strong>2. setStateå¾ªç¯è°ƒç”¨é£é™©</strong></p> <ul><li>å½“è°ƒç”¨<code>setState</code>æ—¶ï¼Œå®é™…ä¸Šä¼šæ‰§è¡Œ<code>enqueueSetState</code>æ–¹æ³•ï¼Œå¹¶å¯¹<code>partialState</code>ä»¥åŠ<code>_pending-StateQueue</code>æ›´æ–°é˜Ÿåˆ—è¿›è¡Œåˆå¹¶æ“ä½œï¼Œæœ€ç»ˆé€šè¿‡<code>enqueueUpdate</code>æ‰§è¡Œ<code>state</code>æ›´æ–°</li> <li>è€Œ<code>performUpdateIfNecessary</code>æ–¹æ³•ä¼šè·<code>å–_pendingElement</code>,<code>_pendingStateQueue</code>ï¼Œ<code>_pending-ForceUpdate</code>ï¼Œå¹¶è°ƒç”¨<code>receiveComponent</code>å’Œ<code>updateComponent</code>æ–¹æ³•è¿›è¡Œç»„ä»¶æ›´æ–°</li> <li>å¦‚æœåœ¨<code>shouldComponentUpdate</code>æˆ–è€…<code>componentWillUpdate</code>æ–¹æ³•ä¸­è°ƒç”¨<code>setState</code>ï¼Œæ­¤æ—¶<code>this._pending-StateQueue != null</code>ï¼Œå°±ä¼šé€ æˆå¾ªç¯è°ƒç”¨ï¼Œä½¿å¾—æµè§ˆå™¨å†…å­˜å æ»¡åå´©æºƒ</li></ul> <p><strong>3 äº‹åŠ¡</strong></p> <ul><li>äº‹åŠ¡å°±æ˜¯å°†éœ€è¦æ‰§è¡Œçš„æ–¹æ³•ä½¿ç”¨<code>wrapper</code>å°è£…èµ·æ¥ï¼Œå†é€šè¿‡äº‹åŠ¡æä¾›çš„<code>perform</code>æ–¹æ³•æ‰§è¡Œï¼Œå…ˆæ‰§è¡Œ<code>wrapper</code>ä¸­çš„<code>initialize</code>æ–¹æ³•ï¼Œæ‰§è¡Œå®Œ<code>perform</code>ä¹‹åï¼Œåœ¨æ‰§è¡Œæ‰€æœ‰çš„<code>close</code>æ–¹æ³•ï¼Œä¸€ç»„<code>initialize</code>åŠ<code>close</code>æ–¹æ³•ç§°ä¸ºä¸€ä¸ª<code>wrapper</code>ã€‚</li> <li>é‚£ä¹ˆäº‹åŠ¡å’Œ<code>setState</code>æ–¹æ³•çš„ä¸åŒè¡¨ç°æœ‰ä»€ä¹ˆå…³ç³»ï¼Œé¦–å…ˆæˆ‘ä»¬æŠŠ<code>4</code>æ¬¡<code>setStat</code>eç®€å•å½’ç±»ï¼Œå‰ä¸¤æ¬¡å±äºä¸€ç±»ï¼Œå› ä¸ºå®ƒä»¬åœ¨åŒä¸€è°ƒç”¨æ ˆä¸­æ‰§è¡Œï¼Œ<code>setTimeout</code>ä¸­çš„ä¸¤æ¬¡<code>setState</code>å±äºå¦ä¸€ç±»</li> <li>åœ¨<code>setState</code>è°ƒç”¨ä¹‹å‰ï¼Œå·²ç»å¤„åœ¨<code>batchedUpdates</code>æ‰§è¡Œçš„äº‹åŠ¡ä¸­äº†ã€‚é‚£ä¹ˆè¿™æ¬¡<code>batchedUpdates</code>æ–¹æ³•æ˜¯è°è°ƒç”¨çš„å‘¢ï¼ŒåŸæ¥æ˜¯<code>ReactMount.js</code>ä¸­çš„<code>_renderNewRootComponent</code>æ–¹æ³•ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ•´ä¸ªå°†<code>React</code>ç»„ä»¶æ¸²æŸ“åˆ°<code>DOM</code>ä¸­çš„è¿‡ç¨‹å°±æ˜¯å¤„äºä¸€ä¸ªå¤§çš„äº‹åŠ¡ä¸­ã€‚è€Œåœ¨<code>componentDidMount</code>ä¸­è°ƒç”¨<code>setState</code>æ—¶ï¼Œ<code>batchingStrategy</code>çš„<code>isBatchingUpdates</code>å·²ç»è¢«è®¾ä¸ºäº†<code>true</code>ï¼Œæ‰€ä»¥ä¸¤æ¬¡<code>setState</code>çš„ç»“æœæ²¡æœ‰ç«‹å³ç”Ÿæ•ˆ</li> <li>å†åè§‚<code>setTimeout</code>ä¸­çš„ä¸¤æ¬¡<code>setState</code>ï¼Œå› ä¸ºæ²¡æœ‰å‰ç½®çš„<code>batchedUpdates</code>è°ƒç”¨ï¼Œæ‰€ä»¥å¯¼è‡´äº†æ–°çš„<code>state</code>é©¬ä¸Šç”Ÿæ•ˆ</li></ul> <p><strong>4. æ€»ç»“</strong></p> <ul><li>é€šè¿‡<code>setState</code>å»æ›´æ–°<code>this.state</code>ï¼Œä¸è¦ç›´æ¥æ“ä½œ<code>this.state</code>ï¼Œè¯·æŠŠå®ƒå½“æˆä¸å¯å˜çš„</li> <li>è°ƒç”¨<code>setState</code>æ›´æ–°<code>this.state</code>ä¸æ˜¯é©¬ä¸Šç”Ÿæ•ˆçš„ï¼Œå®ƒæ˜¯å¼‚æ­¥çš„ï¼Œæ‰€ä»¥ä¸è¦å¤©çœŸä»¥ä¸ºæ‰§è¡Œå®Œ<code>setState</code>å<code>this.state</code>å°±æ˜¯æœ€æ–°çš„å€¼äº†</li> <li>å¤šä¸ªé¡ºåºæ‰§è¡Œçš„<code>setState</code>ä¸æ˜¯åŒæ­¥åœ°ä¸€ä¸ªä¸€ä¸ªæ‰§è¡Œæ»´ï¼Œä¼šä¸€ä¸ªä¸€ä¸ªåŠ å…¥é˜Ÿåˆ—ï¼Œç„¶åæœ€åä¸€èµ·æ‰§è¡Œï¼Œå³æ‰¹å¤„ç†</li></ul> <h3 id="_7-reactäº‹åŠ¡æœºåˆ¶"><a href="http://interview.poetries.top/docs/simply.html#_7-react%E4%BA%8B%E5%8A%A1%E6%9C%BA%E5%88%B6" class="header-anchor">#</a> 7 Reactäº‹åŠ¡æœºåˆ¶</h3> <p><img src="./è¿›é˜¶_files/20210409154118.png" alt="" class="medium-zoom-image"> <img src="./è¿›é˜¶_files/20210409154127.png" alt="" class="medium-zoom-image"> <img src="./è¿›é˜¶_files/20210409154136.png" alt="" class="medium-zoom-image"></p> <h3 id="_8-reactç»„ä»¶å’Œæ¸²æŸ“æ›´æ–°è¿‡ç¨‹"><a href="http://interview.poetries.top/docs/simply.html#_8-react%E7%BB%84%E4%BB%B6%E5%92%8C%E6%B8%B2%E6%9F%93%E6%9B%B4%E6%96%B0%E8%BF%87%E7%A8%8B" class="header-anchor">#</a> 8 Reactç»„ä»¶å’Œæ¸²æŸ“æ›´æ–°è¿‡ç¨‹</h3> <p><strong>æ¸²æŸ“å’Œæ›´æ–°è¿‡ç¨‹</strong></p> <ul><li>jsxå¦‚ä½•æ¸²æŸ“ä¸ºé¡µé¢</li> <li>setStateä¹‹åå¦‚ä½•æ›´æ–°é¡µé¢</li> <li>é¢è¯•è€ƒå¯Ÿå…¨æµç¨‹</li></ul> <p><strong>JSXæœ¬è´¨å’Œvdom</strong></p> <ul><li>JSXå³<code>createElement</code>å‡½æ•°</li> <li>æ‰§è¡Œç”Ÿæˆvnode</li> <li><code>patch(elem,vnode)</code>å’Œ<code>patch(vnode,newNode)</code></li></ul> <p><strong>ç»„ä»¶æ¸²æŸ“è¿‡ç¨‹</strong></p> <ul><li><code>props state</code></li> <li><code>render()</code>ç”Ÿæˆ<code>vnode</code></li> <li><code>patch(elem, vnode)</code></li></ul> <p><strong>ç»„ä»¶æ›´æ–°è¿‡ç¨‹</strong></p> <ul><li><code>setState--&gt;dirtyComponents</code>(å¯èƒ½æœ‰å­ç»„ä»¶)</li> <li><code>render</code>ç”Ÿæˆ<code>newVnode</code></li> <li><code>patch(vnode, newVnode)</code></li></ul> <h3 id="_9-diffç®—æ³•æ˜¯æ€ä¹ˆè¿ä½œ"><a href="http://interview.poetries.top/docs/simply.html#_9-diff%E7%AE%97%E6%B3%95%E6%98%AF%E6%80%8E%E4%B9%88%E8%BF%90%E4%BD%9C" class="header-anchor">#</a> 9 diffç®—æ³•æ˜¯æ€ä¹ˆè¿ä½œ</h3> <blockquote><p>æ¯ä¸€ç§èŠ‚ç‚¹ç±»å‹æœ‰è‡ªå·±çš„å±æ€§ï¼Œä¹Ÿå°±æ˜¯propï¼Œæ¯æ¬¡è¿›è¡Œdiffçš„æ—¶å€™ï¼Œreactä¼šå…ˆæ¯”è¾ƒè¯¥èŠ‚ç‚¹ç±»å‹ï¼Œå‡å¦‚èŠ‚ç‚¹ç±»å‹ä¸ä¸€æ ·ï¼Œé‚£ä¹ˆreactä¼šç›´æ¥åˆ é™¤è¯¥èŠ‚ç‚¹ï¼Œç„¶åç›´æ¥åˆ›å»ºæ–°çš„èŠ‚ç‚¹æ’å…¥åˆ°å…¶ä¸­ï¼Œå‡å¦‚èŠ‚ç‚¹ç±»å‹ä¸€æ ·ï¼Œé‚£ä¹ˆä¼šæ¯”è¾ƒpropæ˜¯å¦æœ‰æ›´æ–°ï¼Œå‡å¦‚æœ‰propä¸ä¸€æ ·ï¼Œé‚£ä¹ˆreactä¼šåˆ¤å®šè¯¥èŠ‚ç‚¹æœ‰æ›´æ–°ï¼Œé‚£ä¹ˆé‡æ¸²æŸ“è¯¥èŠ‚ç‚¹ï¼Œç„¶ååœ¨å¯¹å…¶å­èŠ‚ç‚¹è¿›è¡Œæ¯”è¾ƒï¼Œä¸€å±‚ä¸€å±‚å¾€ä¸‹ï¼Œç›´åˆ°æ²¡æœ‰å­èŠ‚ç‚¹</p></blockquote> <ul><li>æŠŠæ ‘å½¢ç»“æ„æŒ‰ç…§å±‚çº§åˆ†è§£ï¼Œåªæ¯”è¾ƒåŒçº§å…ƒç´ ã€‚</li> <li>ç»™åˆ—è¡¨ç»“æ„çš„æ¯ä¸ªå•å…ƒæ·»åŠ å”¯ä¸€çš„<code>key</code>å±æ€§ï¼Œæ–¹ä¾¿æ¯”è¾ƒã€‚</li> <li><code>React</code> åªä¼šåŒ¹é…ç›¸åŒ <code>class</code> çš„ <code>component</code>ï¼ˆè¿™é‡Œé¢çš„<code>class</code>æŒ‡çš„æ˜¯ç»„ä»¶çš„åå­—ï¼‰</li> <li>åˆå¹¶æ“ä½œï¼Œè°ƒç”¨ <code>component</code> çš„ <code>setState</code> æ–¹æ³•çš„æ—¶å€™, <code>React</code> å°†å…¶æ ‡è®°ä¸º - <code>dirty</code>.åˆ°æ¯ä¸€ä¸ªäº‹ä»¶å¾ªç¯ç»“æŸ, <code>React</code> æ£€æŸ¥æ‰€æœ‰æ ‡è®° <code>dirty</code>çš„ <code>component</code>é‡æ–°ç»˜åˆ¶.</li> <li>é€‰æ‹©æ€§å­æ ‘æ¸²æŸ“ã€‚å¼€å‘äººå‘˜å¯ä»¥é‡å†™<code>shouldComponentUpdate</code>æé«˜<code>diff</code>çš„æ€§èƒ½</li></ul> <p><strong>ä¼˜åŒ–â¬‡ï¸</strong></p> <blockquote><p>ä¸ºäº†é™ä½ç®—æ³•å¤æ‚åº¦ï¼Œ<code>React</code>çš„<code>diff</code>ä¼šé¢„è®¾ä¸‰ä¸ªé™åˆ¶ï¼š</p></blockquote> <ol><li>åªå¯¹åŒçº§å…ƒç´ è¿›è¡Œ<code>Diff</code>ã€‚å¦‚æœä¸€ä¸ª<code>DOMèŠ‚ç‚¹</code>åœ¨å‰åä¸¤æ¬¡æ›´æ–°ä¸­è·¨è¶Šäº†å±‚çº§ï¼Œé‚£ä¹ˆ<code>React</code>ä¸ä¼šå°è¯•å¤ç”¨ä»–ã€‚</li> <li>ä¸¤ä¸ªä¸åŒç±»å‹çš„å…ƒç´ ä¼šäº§ç”Ÿå‡ºä¸åŒçš„æ ‘ã€‚å¦‚æœå…ƒç´ ç”±<code>div</code>å˜ä¸º<code>p</code>ï¼ŒReactä¼šé”€æ¯<code>div</code>åŠå…¶å­å­™èŠ‚ç‚¹ï¼Œå¹¶æ–°å»º<code>p</code>åŠå…¶å­å­™èŠ‚ç‚¹ã€‚</li> <li>å¼€å‘è€…å¯ä»¥é€šè¿‡ <code>key prop</code>æ¥æš—ç¤ºå“ªäº›å­å…ƒç´ åœ¨ä¸åŒçš„æ¸²æŸ“ä¸‹èƒ½ä¿æŒç¨³å®šã€‚è€ƒè™‘å¦‚ä¸‹ä¾‹å­ï¼š</li></ol> <p><strong>Diffçš„æ€è·¯</strong></p> <p>è¯¥å¦‚ä½•è®¾è®¡ç®—æ³•å‘¢ï¼Ÿå¦‚æœè®©æˆ‘è®¾è®¡ä¸€ä¸ª<code>Diffç®—æ³•</code>ï¼Œæˆ‘é¦–å…ˆæƒ³åˆ°çš„æ–¹æ¡ˆæ˜¯ï¼š</p> <ol><li>åˆ¤æ–­å½“å‰èŠ‚ç‚¹çš„æ›´æ–°å±äºå“ªç§æƒ…å†µ</li> <li>å¦‚æœæ˜¯<code>æ–°å¢</code>ï¼Œæ‰§è¡Œæ–°å¢é€»è¾‘</li> <li>å¦‚æœæ˜¯<code>åˆ é™¤</code>ï¼Œæ‰§è¡Œåˆ é™¤é€»è¾‘</li> <li>å¦‚æœæ˜¯<code>æ›´æ–°</code>ï¼Œæ‰§è¡Œæ›´æ–°é€»è¾‘</li></ol> <ul><li>æŒ‰è¿™ä¸ªæ–¹æ¡ˆï¼Œå…¶å®æœ‰ä¸ªéšå«çš„å‰æâ€”â€”<strong>ä¸åŒæ“ä½œçš„ä¼˜å…ˆçº§æ˜¯ç›¸åŒçš„</strong></li> <li>ä½†æ˜¯<code>Reactå›¢é˜Ÿ</code>å‘ç°ï¼Œåœ¨æ—¥å¸¸å¼€å‘ä¸­ï¼Œç›¸è¾ƒäº<code>æ–°å¢</code>å’Œ<code>åˆ é™¤</code>ï¼Œ<code>æ›´æ–°</code>ç»„ä»¶å‘ç”Ÿçš„é¢‘ç‡æ›´é«˜ã€‚æ‰€ä»¥<code>Diff</code>ä¼šä¼˜å…ˆåˆ¤æ–­å½“å‰èŠ‚ç‚¹æ˜¯å¦å±äº<code>æ›´æ–°</code>ã€‚</li></ul> <p>åŸºäºä»¥ä¸ŠåŸå› ï¼Œ<code>Diffç®—æ³•</code>çš„æ•´ä½“é€»è¾‘ä¼šç»å†ä¸¤è½®éå†ï¼š</p> <ul><li>ç¬¬ä¸€è½®éå†ï¼šå¤„ç†<code>æ›´æ–°</code>çš„èŠ‚ç‚¹ã€‚</li> <li>ç¬¬äºŒè½®éå†ï¼šå¤„ç†å‰©ä¸‹çš„ä¸å±äº<code>æ›´æ–°</code>çš„èŠ‚ç‚¹ã€‚</li></ul> <p><img src="./è¿›é˜¶_files/20210307225249.png" alt="" class="medium-zoom-image"></p> <p><strong>diffç®—æ³•çš„ä½œç”¨</strong></p> <p>è®¡ç®—å‡ºVirtual DOMä¸­çœŸæ­£å˜åŒ–çš„éƒ¨åˆ†ï¼Œå¹¶åªé’ˆå¯¹è¯¥éƒ¨åˆ†è¿›è¡ŒåŸç”ŸDOMæ“ä½œï¼Œè€Œéé‡æ–°æ¸²æŸ“æ•´ä¸ªé¡µé¢ã€‚</p> <p><strong>ä¼ ç»Ÿdiffç®—æ³•</strong></p> <blockquote><p>é€šè¿‡å¾ªç¯é€’å½’å¯¹èŠ‚ç‚¹è¿›è¡Œä¾æ¬¡å¯¹æ¯”ï¼Œç®—æ³•å¤æ‚åº¦è¾¾åˆ° <code>O(n^3)</code> ï¼Œnæ˜¯æ ‘çš„èŠ‚ç‚¹æ•°ï¼Œè¿™ä¸ªæœ‰å¤šå¯æ€•å‘¢ï¼Ÿâ€”â€”å¦‚æœè¦å±•ç¤º1000ä¸ªèŠ‚ç‚¹ï¼Œå¾—æ‰§è¡Œä¸Šäº¿æ¬¡æ¯”è¾ƒã€‚ã€‚å³ä¾¿æ˜¯CPUå¿«èƒ½æ‰§è¡Œ30äº¿æ¡å‘½ä»¤ï¼Œä¹Ÿå¾ˆéš¾åœ¨ä¸€ç§’å†…è®¡ç®—å‡ºå·®å¼‚ã€‚</p></blockquote> <p><strong>Reactçš„diffç®—æ³•</strong></p> <ol><li>ä»€ä¹ˆæ˜¯è°ƒå’Œï¼Ÿ</li></ol> <blockquote><p>å°†Virtual DOMæ ‘è½¬æ¢æˆactual DOMæ ‘çš„æœ€å°‘æ“ä½œçš„è¿‡ç¨‹ ç§°ä¸º è°ƒå’Œ ã€‚</p></blockquote> <ol start="2"><li>ä»€ä¹ˆæ˜¯React diffç®—æ³•ï¼Ÿ</li></ol> <blockquote><p><code>diff</code>ç®—æ³•æ˜¯è°ƒå’Œçš„å…·ä½“å®ç°ã€‚</p></blockquote> <p><strong>diffç­–ç•¥</strong></p> <blockquote><p>Reactç”¨ ä¸‰å¤§ç­–ç•¥ å°†O(n^3)å¤æ‚åº¦ è½¬åŒ–ä¸º O(n)å¤æ‚åº¦</p></blockquote> <p><strong>ç­–ç•¥ä¸€ï¼ˆtree diffï¼‰ï¼š</strong></p> <ul><li>Web UIä¸­DOMèŠ‚ç‚¹è·¨å±‚çº§çš„ç§»åŠ¨æ“ä½œç‰¹åˆ«å°‘ï¼Œå¯ä»¥å¿½ç•¥ä¸è®¡ã€‚</li></ul> <p><strong>ç­–ç•¥äºŒï¼ˆcomponent diffï¼‰ï¼š</strong></p> <ul><li>æ‹¥æœ‰ç›¸åŒç±»çš„ä¸¤ä¸ªç»„ä»¶ ç”Ÿæˆç›¸ä¼¼çš„æ ‘å½¢ç»“æ„ï¼Œ</li> <li>æ‹¥æœ‰ä¸åŒç±»çš„ä¸¤ä¸ªç»„ä»¶ ç”Ÿæˆä¸åŒçš„æ ‘å½¢ç»“æ„ã€‚</li></ul> <p><strong>ç­–ç•¥ä¸‰ï¼ˆelement diffï¼‰ï¼š</strong></p> <p>å¯¹äºåŒä¸€å±‚çº§çš„ä¸€ç»„å­èŠ‚ç‚¹ï¼Œé€šè¿‡å”¯ä¸€idåŒºåˆ†ã€‚</p> <p><strong>tree diff</strong></p> <ul><li>Reacté€šè¿‡updateDepthå¯¹Virtual DOMæ ‘è¿›è¡Œå±‚çº§æ§åˆ¶ã€‚</li> <li>å¯¹æ ‘åˆ†å±‚æ¯”è¾ƒï¼Œä¸¤æ£µæ ‘ åªå¯¹åŒä¸€å±‚æ¬¡èŠ‚ç‚¹ è¿›è¡Œæ¯”è¾ƒã€‚å¦‚æœè¯¥èŠ‚ç‚¹ä¸å­˜åœ¨æ—¶ï¼Œåˆ™è¯¥èŠ‚ç‚¹åŠå…¶å­èŠ‚ç‚¹ä¼šè¢«å®Œå…¨åˆ é™¤ï¼Œä¸ä¼šå†è¿›ä¸€æ­¥æ¯”è¾ƒã€‚</li> <li>åªéœ€éå†ä¸€æ¬¡ï¼Œå°±èƒ½å®Œæˆæ•´æ£µDOMæ ‘çš„æ¯”è¾ƒã€‚</li></ul> <p><img src="./è¿›é˜¶_files/image-20210307224725566.png" alt="image-20210307224725566" class="medium-zoom-image"></p> <p>é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œå¦‚æœDOMèŠ‚ç‚¹å‡ºç°äº†è·¨å±‚çº§æ“ä½œ,diffä¼šå’‹åŠå‘¢ï¼Ÿ</p> <blockquote><p>ç­”ï¼šdiffåªç®€å•è€ƒè™‘åŒå±‚çº§çš„èŠ‚ç‚¹ä½ç½®å˜æ¢ï¼Œå¦‚æœæ˜¯è·¨å±‚çº§çš„è¯ï¼Œåªæœ‰åˆ›å»ºèŠ‚ç‚¹å’Œåˆ é™¤èŠ‚ç‚¹çš„æ“ä½œã€‚</p></blockquote> <p><img src="./è¿›é˜¶_files/image-20210307224829092.png" alt="image-20210307224829092" class="medium-zoom-image"></p> <blockquote><p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œä»¥Aä¸ºæ ¹èŠ‚ç‚¹çš„æ•´æ£µæ ‘ä¼šè¢«é‡æ–°åˆ›å»ºï¼Œè€Œä¸æ˜¯ç§»åŠ¨ï¼Œå› æ­¤ å®˜æ–¹å»ºè®®ä¸è¦è¿›è¡ŒDOMèŠ‚ç‚¹è·¨å±‚çº§æ“ä½œï¼Œå¯ä»¥é€šè¿‡CSSéšè—ã€æ˜¾ç¤ºèŠ‚ç‚¹ï¼Œè€Œä¸æ˜¯çœŸæ­£åœ°ç§»é™¤ã€æ·»åŠ DOMèŠ‚ç‚¹</p></blockquote> <p><strong>component diff</strong></p> <blockquote><p>Reactå¯¹ä¸åŒçš„ç»„ä»¶é—´çš„æ¯”è¾ƒï¼Œæœ‰ä¸‰ç§ç­–ç•¥</p></blockquote> <ol><li>åŒä¸€ç±»å‹çš„ä¸¤ä¸ªç»„ä»¶ï¼ŒæŒ‰åŸç­–ç•¥ï¼ˆå±‚çº§æ¯”è¾ƒï¼‰ç»§ç»­æ¯”è¾ƒVirtual DOMæ ‘å³å¯ã€‚</li> <li>åŒä¸€ç±»å‹çš„ä¸¤ä¸ªç»„ä»¶ï¼Œç»„ä»¶Aå˜åŒ–ä¸ºç»„ä»¶Bæ—¶ï¼Œå¯èƒ½Virtual DOMæ²¡æœ‰ä»»ä½•å˜åŒ–ï¼Œå¦‚æœçŸ¥é“è¿™ç‚¹ï¼ˆå˜æ¢çš„è¿‡ç¨‹ä¸­ï¼ŒVirtual DOMæ²¡æœ‰æ”¹å˜ï¼‰ï¼Œå¯èŠ‚çœå¤§é‡è®¡ç®—æ—¶é—´ï¼Œæ‰€ä»¥ ç”¨æˆ· å¯ä»¥é€šè¿‡ <code>shouldComponentUpdate()</code> æ¥åˆ¤æ–­æ˜¯å¦éœ€è¦ åˆ¤æ–­è®¡ç®—ã€‚</li> <li>ä¸åŒç±»å‹çš„ç»„ä»¶ï¼Œå°†ä¸€ä¸ªï¼ˆå°†è¢«æ”¹å˜çš„ï¼‰ç»„ä»¶åˆ¤æ–­ä¸º<code>dirty component</code>ï¼ˆè„ç»„ä»¶ï¼‰ï¼Œä»è€Œæ›¿æ¢ æ•´ä¸ªç»„ä»¶çš„æ‰€æœ‰èŠ‚ç‚¹ã€‚</li></ol> <blockquote><p>æ³¨æ„ï¼šå¦‚æœç»„ä»¶Då’Œç»„ä»¶Gçš„ç»“æ„ç›¸ä¼¼ï¼Œä½†æ˜¯ Reactåˆ¤æ–­æ˜¯ ä¸åŒç±»å‹çš„ç»„ä»¶ï¼Œåˆ™ä¸ä¼šæ¯”è¾ƒå…¶ç»“æ„ï¼Œè€Œæ˜¯åˆ é™¤ ç»„ä»¶DåŠå…¶å­èŠ‚ç‚¹ï¼Œåˆ›å»ºç»„ä»¶GåŠå…¶å­èŠ‚ç‚¹ã€‚</p></blockquote> <p><strong>element diff</strong></p> <blockquote><p>å½“èŠ‚ç‚¹å¤„äºåŒä¸€å±‚çº§æ—¶ï¼Œdiffæä¾›ä¸‰ç§èŠ‚ç‚¹æ“ä½œï¼šåˆ é™¤ã€æ’å…¥ã€ç§»åŠ¨ã€‚</p></blockquote> <ul><li>æ’å…¥ï¼šç»„ä»¶ C ä¸åœ¨é›†åˆï¼ˆA,Bï¼‰ä¸­ï¼Œéœ€è¦æ’å…¥</li> <li>åˆ é™¤ï¼š
<ul><li>ç»„ä»¶ D åœ¨é›†åˆï¼ˆA,B,Dï¼‰ä¸­ï¼Œä½† Dçš„èŠ‚ç‚¹å·²ç»æ›´æ”¹ï¼Œä¸èƒ½å¤ç”¨å’Œæ›´æ–°ï¼Œæ‰€ä»¥éœ€è¦åˆ é™¤ æ—§çš„ D ï¼Œå†åˆ›å»ºæ–°çš„ã€‚</li> <li>ç»„ä»¶ D ä¹‹å‰åœ¨ é›†åˆï¼ˆA,B,Dï¼‰ä¸­ï¼Œä½†é›†åˆå˜æˆæ–°çš„é›†åˆï¼ˆA,Bï¼‰äº†ï¼ŒD å°±éœ€è¦è¢«åˆ é™¤ã€‚</li></ul></li> <li>ç§»åŠ¨ï¼šç»„ä»¶Då·²ç»åœ¨é›†åˆï¼ˆA,B,C,Dï¼‰é‡Œäº†ï¼Œä¸”é›†åˆæ›´æ–°æ—¶ï¼ŒDæ²¡æœ‰å‘ç”Ÿæ›´æ–°ï¼Œåªæ˜¯ä½ç½®æ”¹å˜ï¼Œå¦‚æ–°é›†åˆï¼ˆA,D,B,Cï¼‰ï¼ŒDåœ¨ç¬¬äºŒä¸ªï¼Œæ— é¡»åƒä¼ ç»Ÿdiffï¼Œè®©æ—§é›†åˆçš„ç¬¬äºŒä¸ªBå’Œæ–°é›†åˆçš„ç¬¬äºŒä¸ªD æ¯”è¾ƒï¼Œå¹¶ä¸”åˆ é™¤ç¬¬äºŒä¸ªä½ç½®çš„Bï¼Œå†åœ¨ç¬¬äºŒä¸ªä½ç½®æ’å…¥Dï¼Œè€Œæ˜¯ ï¼ˆå¯¹åŒä¸€å±‚çº§çš„åŒç»„å­èŠ‚ç‚¹ï¼‰ æ·»åŠ å”¯ä¸€keyè¿›è¡ŒåŒºåˆ†ï¼Œç§»åŠ¨å³å¯ã€‚</li></ul> <p><strong>æ€»ç»“</strong></p> <ol><li><code>tree diff</code>ï¼šåªå¯¹æ¯”åŒä¸€å±‚çš„ dom èŠ‚ç‚¹ï¼Œå¿½ç•¥ dom èŠ‚ç‚¹çš„è·¨å±‚çº§ç§»åŠ¨</li></ol> <p>å¦‚ä¸‹å›¾ï¼Œreact åªä¼šå¯¹ç›¸åŒé¢œè‰²æ–¹æ¡†å†…çš„ DOM èŠ‚ç‚¹è¿›è¡Œæ¯”è¾ƒï¼Œå³åŒä¸€ä¸ªçˆ¶èŠ‚ç‚¹ä¸‹çš„æ‰€æœ‰å­èŠ‚ç‚¹ã€‚å½“å‘ç°èŠ‚ç‚¹ä¸å­˜åœ¨æ—¶ï¼Œåˆ™è¯¥èŠ‚ç‚¹åŠå…¶å­èŠ‚ç‚¹ä¼šè¢«å®Œå…¨åˆ é™¤æ‰ï¼Œä¸ä¼šç”¨äºè¿›ä¸€æ­¥çš„æ¯”è¾ƒã€‚</p> <p>è¿™æ ·åªéœ€è¦å¯¹æ ‘è¿›è¡Œä¸€æ¬¡éå†ï¼Œä¾¿èƒ½å®Œæˆæ•´ä¸ª DOM æ ‘çš„æ¯”è¾ƒã€‚</p> <p><img src="./è¿›é˜¶_files/image-20210302195610674.png" alt="image-20210302195610674" class="medium-zoom-image"></p> <p>è¿™å°±æ„å‘³ç€ï¼Œå¦‚æœ dom èŠ‚ç‚¹å‘ç”Ÿäº†è·¨å±‚çº§ç§»åŠ¨ï¼Œreact ä¼šåˆ é™¤æ—§çš„èŠ‚ç‚¹ï¼Œç”Ÿæˆæ–°çš„èŠ‚ç‚¹ï¼Œè€Œä¸ä¼šå¤ç”¨ã€‚</p> <ol start="2"><li><code>component diff</code>ï¼šå¦‚æœä¸æ˜¯åŒä¸€ç±»å‹çš„ç»„ä»¶ï¼Œä¼šåˆ é™¤æ—§çš„ç»„ä»¶ï¼Œåˆ›å»ºæ–°çš„ç»„ä»¶</li></ol> <p><img src="./è¿›é˜¶_files/image-20210302195654736.png" alt="image-20210302195654736" class="medium-zoom-image"></p> <ol start="3"><li><code>element diff</code>ï¼šå¯¹äºåŒä¸€å±‚çº§çš„ä¸€ç»„å­èŠ‚ç‚¹ï¼Œéœ€è¦é€šè¿‡å”¯ä¸€ id è¿›è¡Œæ¥åŒºåˆ†</li></ol> <ul><li>å¦‚æœæ²¡æœ‰ id æ¥è¿›è¡ŒåŒºåˆ†ï¼Œä¸€æ—¦æœ‰æ’å…¥åŠ¨ä½œï¼Œä¼šå¯¼è‡´æ’å…¥ä½ç½®ä¹‹åçš„åˆ—è¡¨å…¨éƒ¨é‡æ–°æ¸²æŸ“</li> <li>è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆæ¸²æŸ“åˆ—è¡¨æ—¶ä¸ºä»€ä¹ˆè¦ä½¿ç”¨å”¯ä¸€çš„ keyã€‚</li></ul> <p><strong>diffçš„ä¸è¶³ä¸å¾…ä¼˜åŒ–çš„åœ°æ–¹</strong></p> <blockquote><p>å°½é‡å‡å°‘ç±»ä¼¼å°†æœ€åä¸€ä¸ªèŠ‚ç‚¹ç§»åŠ¨åˆ°åˆ—è¡¨é¦–éƒ¨çš„æ“ä½œï¼Œå½“èŠ‚ç‚¹æ•°é‡è¿‡å¤§æˆ–æ›´æ–°æ“ä½œè¿‡äºé¢‘ç¹æ—¶ï¼Œä¼šå½±å“Reactçš„æ¸²æŸ“æ€§èƒ½</p></blockquote> <h3 id="_10-åˆæˆäº‹ä»¶åŸç†"><a href="http://interview.poetries.top/docs/simply.html#_10-%E5%90%88%E6%88%90%E4%BA%8B%E4%BB%B6%E5%8E%9F%E7%90%86" class="header-anchor">#</a> 10 åˆæˆäº‹ä»¶åŸç†</h3> <blockquote><p>ä¸ºäº†è§£å†³è·¨æµè§ˆå™¨å…¼å®¹æ€§é—®é¢˜ï¼Œ<code>React</code> ä¼šå°†æµè§ˆå™¨åŸç”Ÿäº‹ä»¶ï¼ˆ<code>Browser Native Event</code>ï¼‰å°è£…ä¸ºåˆæˆäº‹ä»¶ï¼ˆ<code>SyntheticEvent</code>ï¼‰ä¼ å…¥è®¾ç½®çš„äº‹ä»¶å¤„ç†å™¨ä¸­ã€‚è¿™é‡Œçš„åˆæˆäº‹ä»¶æä¾›äº†ä¸åŸç”Ÿäº‹ä»¶ç›¸åŒçš„æ¥å£ï¼Œä¸è¿‡å®ƒä»¬å±è”½äº†åº•å±‚æµè§ˆå™¨çš„ç»†èŠ‚å·®å¼‚ï¼Œä¿è¯äº†è¡Œä¸ºçš„ä¸€è‡´æ€§ã€‚å¦å¤–æœ‰æ„æ€çš„æ˜¯ï¼Œ<code>React</code> å¹¶æ²¡æœ‰ç›´æ¥å°†äº‹ä»¶é™„ç€åˆ°å­å…ƒç´ ä¸Šï¼Œè€Œæ˜¯ä»¥å•ä¸€äº‹ä»¶ç›‘å¬å™¨çš„æ–¹å¼å°†æ‰€æœ‰çš„äº‹ä»¶å‘é€åˆ°é¡¶å±‚è¿›è¡Œå¤„ç†ã€‚è¿™æ · <code>React</code> åœ¨æ›´æ–° <code>DOM</code> çš„æ—¶å€™å°±ä¸éœ€è¦è€ƒè™‘å¦‚ä½•å»å¤„ç†é™„ç€åœ¨ <code>DOM</code> ä¸Šçš„äº‹ä»¶ç›‘å¬å™¨ï¼Œæœ€ç»ˆè¾¾åˆ°ä¼˜åŒ–æ€§èƒ½çš„ç›®çš„</p></blockquote> <ul><li>æ‰€æœ‰çš„äº‹ä»¶æŒ‚åœ¨documentä¸Š</li> <li>eventä¸æ˜¯åŸç”Ÿçš„ï¼Œæ˜¯SyntheticEventåˆæˆäº‹ä»¶å¯¹è±¡</li> <li>å’ŒVueäº‹ä»¶ä¸åŒ,å’ŒDOMäº‹ä»¶ä¹Ÿä¸åŒ</li></ul> <blockquote><p>å¦‚æœDOMä¸Šç»‘å®šäº†è¿‡å¤šçš„äº‹ä»¶å¤„ç†å‡½æ•°,æ•´ä¸ªé¡µé¢å“åº”ä»¥åŠå†…å­˜å ç”¨å¯èƒ½éƒ½ä¼šå—åˆ°å½±å“ã€‚Reactä¸ºäº†é¿å…è¿™ç±»DOMäº‹ä»¶æ»¥ç”¨,åŒæ—¶å±è”½åº•å±‚ä¸åŒæµè§ˆå™¨ä¹‹é—´çš„äº‹ä»¶ç³»ç»Ÿçš„å·®å¼‚,å®ç°äº†ä¸€ä¸ªä¸­é—´å±‚ - SyntheticEvent</p></blockquote> <ol><li>å½“ç”¨æˆ·åœ¨ä¸ºonClickæ·»åŠ å‡½æ•°æ—¶,Reactå¹¶æ²¡æœ‰å°†Clickç»‘å®šåˆ°DOMä¸Šé¢</li> <li>è€Œæ˜¯åœ¨documentå¤„ç›‘å¬æ‰€æœ‰æ”¯æŒçš„äº‹ä»¶,å½“äº‹ä»¶å‘ç”Ÿå¹¶å†’æ³¡è‡³documentå¤„æ—¶,Reactå°†äº‹ä»¶å†…å®¹å°è£…äº¤ç»™ä¸­é—´å±‚ SyntheticEvent (è´Ÿè´£æ‰€æœ‰äº‹ä»¶åˆæˆ)</li> <li>æ‰€ä»¥å½“äº‹ä»¶è§¦å‘çš„æ—¶å€™, å¯¹ä½¿ç”¨ç»Ÿä¸€çš„åˆ†å‘å‡½æ•° dispatchEvent å°†æŒ‡å®šå‡½æ•°æ‰§è¡Œ</li></ol> <p><img src="./è¿›é˜¶_files/20210409153648.png" alt="" class="medium-zoom-image"></p> <p><strong>ä¸ºä½•è¦åˆæˆäº‹ä»¶</strong></p> <ul><li>å…¼å®¹æ€§å’Œè·¨å¹³å°</li> <li>æŒ‚åœ¨ç»Ÿä¸€çš„documentä¸Šï¼Œå‡å°‘å†…å­˜æ¶ˆè€—ï¼Œé¿å…é¢‘ç¹è§£ç»‘</li> <li>æ–¹ä¾¿äº‹ä»¶çš„ç»Ÿä¸€ç®¡ç†ï¼ˆäº‹åŠ¡æœºåˆ¶ï¼‰</li> <li>dispatchEventäº‹ä»¶æœºåˆ¶</li></ul> <h3 id="_11-jsxè¯­æ³•ç³–æœ¬è´¨"><a href="http://interview.poetries.top/docs/simply.html#_11-jsx%E8%AF%AD%E6%B3%95%E7%B3%96%E6%9C%AC%E8%B4%A8" class="header-anchor">#</a> 11 JSXè¯­æ³•ç³–æœ¬è´¨</h3> <blockquote><p>JSXæ˜¯è¯­æ³•ç³–ï¼Œé€šè¿‡babelè½¬æˆ<code>React.createElement</code>å‡½æ•°ï¼Œåœ¨babelå®˜ç½‘ä¸Šå¯ä»¥åœ¨çº¿æŠŠJSXè½¬æˆReactçš„JSè¯­æ³•</p></blockquote> <ul><li>é¦–å…ˆè§£æå‡ºæ¥çš„è¯ï¼Œå°±æ˜¯ä¸€ä¸ª<code>createElement</code>å‡½æ•°</li> <li>ç„¶åè¿™ä¸ªå‡½æ•°æ‰§è¡Œå®Œåï¼Œä¼šè¿”å›ä¸€ä¸ª<code>vnode</code></li> <li>é€šè¿‡vdomçš„patchæˆ–è€…æ˜¯å…¶ä»–çš„ä¸€ä¸ªæ–¹æ³•ï¼Œæœ€åæ¸²æŸ“ä¸€ä¸ªé¡µé¢</li></ul> <p><img src="./è¿›é˜¶_files/20210407215708.png" alt="" class="medium-zoom-image"> <img src="./è¿›é˜¶_files/20210407215721.png" alt="" class="medium-zoom-image"></p> <blockquote><p>scriptæ ‡ç­¾ä¸­ä¸æ·»åŠ <code>text/babel</code>è§£æjsxè¯­æ³•çš„æƒ…å†µä¸‹</p></blockquote> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword">const</span> ele <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"h2"</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">"Hello React!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>ele<span class="token punctuation">,</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"app"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p><strong>JSXçš„æœ¬è´¨æ˜¯React.createElement()å‡½æ•°</strong></p> <p><img src="./è¿›é˜¶_files/20210407215754.png" alt="" class="medium-zoom-image"></p> <blockquote><p><code>createElement</code>å‡½æ•°è¿”å›çš„å¯¹è±¡æ˜¯<code>ReactEelement</code>å¯¹è±¡ã€‚</p></blockquote> <p><code>createElement</code>çš„å†™æ³•å¦‚ä¸‹</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> React<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"div"</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
        <span class="token comment">/*ç¬¬ä¸€ä¸ªå­å…ƒç´ ï¼Œheader*/</span>
        React<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"div"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> className<span class="token operator">:</span> <span class="token string">"header"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
                            React<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"h1"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> title<span class="token operator">:</span> <span class="token string">"\u6807\u9898"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">"\u6211\u662F\u6807\u9898"</span><span class="token punctuation">)</span>
                          <span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token comment">/*ç¬¬äºŒä¸ªå­å…ƒç´ ï¼Œcontent*/</span>
        React<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"div"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> className<span class="token operator">:</span> <span class="token string">"content"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
                            React<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"h2"</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">"\u6211\u662F\u9875\u9762\u7684\u5185\u5BB9"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                            React<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"button"</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">"\u6309\u94AE"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                            React<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"button"</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">"+1"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                            React<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"a"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> href<span class="token operator">:</span> <span class="token string">"http://www.baidu.com"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
                                                <span class="token string">"\u767E\u5EA6\u4E00\u4E0B"</span><span class="token punctuation">)</span>
                          <span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token comment">/*ç¬¬ä¸‰ä¸ªå­å…ƒç´ ï¼Œfooter*/</span>
        React<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"div"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> className<span class="token operator">:</span> <span class="token string">"footer"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
                            React<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"p"</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">"\u6211\u662F\u5C3E\u90E8\u7684\u5185\u5BB9"</span><span class="token punctuation">)</span>
                          <span class="token punctuation">)</span>
      <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>App <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"app"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>å®é™…å¼€å‘ä¸­ä¸ä¼šä½¿ç”¨<code>createElement</code>æ¥åˆ›å»º<code>ReactElement</code>çš„ï¼Œä¸€èˆ¬éƒ½æ˜¯ä½¿ç”¨JSXçš„å½¢å¼å¼€å‘ã€‚</p> <p><code>ReactElement</code>åœ¨ç¨‹åºä¸­æ‰“å°ä¸€ä¸‹</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> ele <span class="token operator">=</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">"header"</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>h1 title<span class="token operator">=</span><span class="token string">"æ ‡é¢˜"</span><span class="token operator">&gt;</span>æˆ‘æ˜¯æ ‡é¢˜<span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">"content"</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>h2<span class="token operator">&gt;</span>æˆ‘æ˜¯é¡µé¢çš„å†…å®¹<span class="token operator">&lt;</span><span class="token operator">/</span>h2<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>button<span class="token operator">&gt;</span>æŒ‰é’®<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>button<span class="token operator">&gt;</span><span class="token operator">+</span><span class="token number">1</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">"http://www.baidu.com"</span><span class="token operator">&gt;</span>ç™¾åº¦ä¸€ä¸‹<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">"footer"</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>æˆ‘æ˜¯å°¾éƒ¨çš„å†…å®¹<span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>ele<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> ele<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><img src="./è¿›é˜¶_files/20210407220013.png" alt="" class="medium-zoom-image"></p> <blockquote><p>reacté€šè¿‡babelæŠŠJSXè½¬æˆ<code>createElement</code>å‡½æ•°ï¼Œç”Ÿæˆ<code>ReactElement</code>å¯¹è±¡ï¼Œç„¶åé€šè¿‡<code>ReactDOM.renderå‡½</code>æ•°æŠŠ<code>ReactElement</code>æ¸²æŸ“æˆçœŸå®çš„<code>DOM</code>å…ƒç´ </p></blockquote> <h3 id="_12-ä¸ºä»€ä¹ˆ-react-å…ƒç´ æœ‰ä¸€ä¸ª-typeof-å±æ€§"><a href="http://interview.poetries.top/docs/simply.html#_12-%E4%B8%BA%E4%BB%80%E4%B9%88-react-%E5%85%83%E7%B4%A0%E6%9C%89%E4%B8%80%E4%B8%AA-typeof-%E5%B1%9E%E6%80%A7" class="header-anchor">#</a> 12 ä¸ºä»€ä¹ˆ React å…ƒç´ æœ‰ä¸€ä¸ª $$typeof å±æ€§</h3> <p><img src="./è¿›é˜¶_files/image-20210302200213923.png" alt="image-20210302200213923" class="medium-zoom-image"></p> <blockquote><p>ç›®çš„æ˜¯ä¸ºäº†é˜²æ­¢ XSS æ”»å‡»ã€‚å› ä¸º Synbol æ— æ³•è¢«åºåˆ—åŒ–ï¼Œæ‰€ä»¥ React å¯ä»¥é€šè¿‡æœ‰æ²¡æœ‰ $$typeof å±æ€§æ¥æ–­å‡ºå½“å‰çš„ element å¯¹è±¡æ˜¯ä»æ•°æ®åº“æ¥çš„è¿˜æ˜¯è‡ªå·±ç”Ÿæˆçš„ã€‚</p></blockquote> <ul><li>å¦‚æœæ²¡æœ‰ $$typeof è¿™ä¸ªå±æ€§ï¼Œreact ä¼šæ‹’ç»å¤„ç†è¯¥å…ƒç´ ã€‚</li> <li>åœ¨ React çš„å¤è€ç‰ˆæœ¬ä¸­ï¼Œä¸‹é¢çš„å†™æ³•ä¼šå‡ºç° XSS æ”»å‡»ï¼š</li></ul> <div class="language- extra-class"><pre class="language-text"><code>// æœåŠ¡ç«¯å…è®¸ç”¨æˆ·å­˜å‚¨ JSON
let expectedTextButGotJSON = {
  type: 'div',
  props: {
    dangerouslySetInnerHTML: {
      __html: '/* æŠŠä½ æƒ³çš„æç€ */'
    },
  },
  // ...
};
let message = { text: expectedTextButGotJSON };

// React 0.13 ä¸­æœ‰é£é™©
&lt;p&gt;
  {message.text}
&lt;/p&gt;
</code></pre></div><h3 id="_13-reactæœ‰å“ªäº›ä¼˜åŒ–æ€§èƒ½çš„æ‰‹æ®µ"><a href="http://interview.poetries.top/docs/simply.html#_13-react%E6%9C%89%E5%93%AA%E4%BA%9B%E4%BC%98%E5%8C%96%E6%80%A7%E8%83%BD%E7%9A%84%E6%89%8B%E6%AE%B5" class="header-anchor">#</a> 13 Reactæœ‰å“ªäº›ä¼˜åŒ–æ€§èƒ½çš„æ‰‹æ®µ</h3> <p><strong>ç±»ç»„ä»¶ä¸­çš„ä¼˜åŒ–æ‰‹æ®µ</strong></p> <ul><li>ä½¿ç”¨çº¯ç»„ä»¶ <code>PureComponent</code> ä½œä¸ºåŸºç±»ã€‚</li> <li>ä½¿ç”¨ <code>React.memo</code> é«˜é˜¶å‡½æ•°åŒ…è£…ç»„ä»¶ã€‚</li> <li>ä½¿ç”¨ <code>shouldComponentUpdate</code> ç”Ÿå‘½å‘¨æœŸå‡½æ•°æ¥è‡ªå®šä¹‰æ¸²æŸ“é€»è¾‘ã€‚</li></ul> <p><strong>æ–¹æ³•ç»„ä»¶ä¸­çš„ä¼˜åŒ–æ‰‹æ®µ</strong></p> <ul><li>ä½¿ç”¨ <code>useMemo</code>ã€‚</li> <li>ä½¿ç”¨ <code>useCallBack</code>ã€‚</li></ul> <p><strong>å…¶ä»–æ–¹å¼</strong></p> <ul><li>åœ¨åˆ—è¡¨éœ€è¦é¢‘ç¹å˜åŠ¨æ—¶ï¼Œä½¿ç”¨å”¯ä¸€ id ä½œä¸º keyï¼Œè€Œä¸æ˜¯æ•°ç»„ä¸‹æ ‡ã€‚</li> <li>å¿…è¦æ—¶é€šè¿‡æ”¹å˜ CSS æ ·å¼éšè—æ˜¾ç¤ºç»„ä»¶ï¼Œè€Œä¸æ˜¯é€šè¿‡æ¡ä»¶åˆ¤æ–­æ˜¾ç¤ºéšè—ç»„ä»¶ã€‚</li> <li>ä½¿ç”¨ <code>Suspense</code> å’Œ lazy è¿›è¡Œæ‡’åŠ è½½ï¼Œä¾‹å¦‚ï¼š</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> lazy<span class="token punctuation">,</span> Suspense <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">CallingLazyComponents</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> ComponentToLazyLoad <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>name <span class="token operator">==</span> <span class="token string">"Mayank"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      ComponentToLazyLoad <span class="token operator">=</span> <span class="token function">lazy</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">"./mayankComponent"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>name <span class="token operator">==</span> <span class="token string">"Anshul"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      ComponentToLazyLoad <span class="token operator">=</span> <span class="token function">lazy</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">"./anshulComponent"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>This is the Base User<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>Suspense fallback<span class="token operator">=</span><span class="token punctuation">{</span><span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>Loading<span class="token operator">...</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>ComponentToLazyLoad <span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>Suspense<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_14-reduxå®ç°åŸç†è§£æ"><a href="http://interview.poetries.top/docs/simply.html#_14-redux%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86%E8%A7%A3%E6%9E%90" class="header-anchor">#</a> 14 Reduxå®ç°åŸç†è§£æ</h3> <p><strong>ä¸ºä»€ä¹ˆè¦ç”¨redux</strong></p> <blockquote><p>åœ¨<code>React</code>ä¸­ï¼Œæ•°æ®åœ¨ç»„ä»¶ä¸­æ˜¯å•å‘æµåŠ¨çš„ï¼Œæ•°æ®ä»ä¸€ä¸ªæ–¹å‘çˆ¶ç»„ä»¶æµå‘å­ç»„ä»¶ï¼ˆé€šè¿‡<code>props</code>ï¼‰,æ‰€ä»¥ï¼Œä¸¤ä¸ªéçˆ¶å­ç»„ä»¶ä¹‹é—´é€šä¿¡å°±ç›¸å¯¹éº»çƒ¦ï¼Œ<code>redux</code>çš„å‡ºç°å°±æ˜¯ä¸ºäº†è§£å†³<code>state</code>é‡Œé¢çš„æ•°æ®é—®é¢˜</p></blockquote> <p><strong>Reduxè®¾è®¡ç†å¿µ</strong></p> <blockquote><p><code>Redux</code>æ˜¯å°†æ•´ä¸ªåº”ç”¨çŠ¶æ€å­˜å‚¨åˆ°ä¸€ä¸ªåœ°æ–¹ä¸Šç§°ä¸º<code>store</code>,é‡Œé¢ä¿å­˜ç€ä¸€ä¸ªçŠ¶æ€æ ‘<code>store tree</code>,ç»„ä»¶å¯ä»¥æ´¾å‘(<code>dispatch</code>)è¡Œä¸º(<code>action</code>)ç»™<code>store</code>,è€Œä¸æ˜¯ç›´æ¥é€šçŸ¥å…¶ä»–ç»„ä»¶ï¼Œç»„ä»¶å†…éƒ¨é€šè¿‡è®¢é˜…<code>store</code>ä¸­çš„çŠ¶æ€<code>state</code>æ¥åˆ·æ–°è‡ªå·±çš„è§†å›¾</p></blockquote> <p><img src="./è¿›é˜¶_files/68.png" alt="" class="medium-zoom-image"></p> <p><strong>Reduxä¸‰å¤§åŸåˆ™</strong></p> <ul><li>å”¯ä¸€æ•°æ®æº</li></ul> <blockquote><p>æ•´ä¸ªåº”ç”¨çš„stateéƒ½è¢«å­˜å‚¨åˆ°ä¸€ä¸ªçŠ¶æ€æ ‘é‡Œé¢ï¼Œå¹¶ä¸”è¿™ä¸ªçŠ¶æ€æ ‘ï¼Œåªå­˜åœ¨äºå”¯ä¸€çš„storeä¸­</p></blockquote> <ul><li>ä¿æŒåªè¯»çŠ¶æ€</li></ul> <blockquote><p><code>state</code>æ˜¯åªè¯»çš„ï¼Œå”¯ä¸€æ”¹å˜<code>state</code>çš„æ–¹æ³•å°±æ˜¯è§¦å‘<code>action</code>ï¼Œ<code>action</code>æ˜¯ä¸€ä¸ªç”¨äºæè¿°ä»¥å‘ç”Ÿæ—¶é—´çš„æ™®é€šå¯¹è±¡</p></blockquote> <ul><li>æ•°æ®æ”¹å˜åªèƒ½é€šè¿‡çº¯å‡½æ•°æ¥æ‰§è¡Œ</li></ul> <blockquote><p>ä½¿ç”¨çº¯å‡½æ•°æ¥æ‰§è¡Œä¿®æ”¹ï¼Œä¸ºäº†æè¿°<code>action</code>å¦‚ä½•æ”¹å˜<code>state</code>çš„ï¼Œä½ éœ€è¦ç¼–å†™<code>reducers</code></p></blockquote> <p><strong>Reduxæºç </strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> <span class="token function-variable function">createStore</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">reducer</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> state<span class="token punctuation">;</span>
    <span class="token comment">//è·å–çŠ¶æ€å¯¹è±¡</span>
    <span class="token comment">//å­˜æ”¾æ‰€æœ‰çš„ç›‘å¬å‡½æ•°</span>
    <span class="token keyword">let</span> listeners <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> <span class="token function-variable function">getState</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> state<span class="token punctuation">;</span>
    <span class="token comment">//æä¾›ä¸€ä¸ªæ–¹æ³•ä¾›å¤–éƒ¨è°ƒç”¨æ´¾å‘action</span>
    <span class="token keyword">let</span> <span class="token function-variable function">dispath</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">action</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">//è°ƒç”¨ç®¡ç†å‘˜reducerå¾—åˆ°æ–°çš„state</span>
        state <span class="token operator">=</span> <span class="token function">reducer</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span> action<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//æ‰§è¡Œæ‰€æœ‰çš„ç›‘å¬å‡½æ•°</span>
        listeners<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">l</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">l</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//è®¢é˜…çŠ¶æ€å˜åŒ–äº‹ä»¶ï¼Œå½“çŠ¶æ€æ”¹å˜å‘ç”Ÿä¹‹åæ‰§è¡Œç›‘å¬å‡½æ•°</span>
    <span class="token keyword">let</span> <span class="token function-variable function">subscribe</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">listener</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        listeners<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>listener<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">dispath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
        getState<span class="token punctuation">,</span>
        dispath<span class="token punctuation">,</span>
        subscribe
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> <span class="token function-variable function">combineReducers</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token parameter">renducers</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    <span class="token comment">//ä¼ å…¥ä¸€ä¸ªrenducersç®¡ç†ç»„ï¼Œè¿”å›çš„æ˜¯ä¸€ä¸ªrenducer</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">state<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>action<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">}</span></span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">let</span> newState<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> attr <span class="token keyword">in</span> renducers<span class="token punctuation">)</span><span class="token punctuation">{</span>
            newState<span class="token punctuation">[</span>attr<span class="token punctuation">]</span><span class="token operator">=</span>renducers<span class="token punctuation">[</span>attr<span class="token punctuation">]</span><span class="token punctuation">(</span>state<span class="token punctuation">[</span>attr<span class="token punctuation">]</span><span class="token punctuation">,</span>action<span class="token punctuation">)</span>

        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> newState<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span>createStore<span class="token punctuation">,</span>combineReducers<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_15-connectç»„ä»¶åŸç†åˆ†æ"><a href="http://interview.poetries.top/docs/simply.html#_15-connect%E7%BB%84%E4%BB%B6%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90" class="header-anchor">#</a> 15 connectç»„ä»¶åŸç†åˆ†æ</h3> <p><strong>1. connectç”¨æ³•</strong></p> <blockquote><p>ä½œç”¨ï¼šè¿æ¥<code>React</code>ç»„ä»¶ä¸ <code>Redux store</code></p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">[</span>mapStateToProps<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>mapDispatchToProps<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>mergeProps<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span>options<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment">// è¿™ä¸ªå‡½æ•°å…è®¸æˆ‘ä»¬å°† store ä¸­çš„æ•°æ®ä½œä¸º props ç»‘å®šåˆ°ç»„ä»¶ä¸Š</span>
<span class="token keyword">const</span> <span class="token function-variable function">mapStateToProps</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    count<span class="token operator">:</span> state<span class="token punctuation">.</span>count
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>è¿™ä¸ªå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°å°±æ˜¯ <code>Redux</code> çš„ <code>store</code>ï¼Œæˆ‘ä»¬ä»ä¸­æ‘˜å–äº† <code>count</code> å±æ€§ã€‚ä½ ä¸å¿…å°† <code>state</code> ä¸­çš„æ•°æ®åŸå°ä¸åŠ¨åœ°ä¼ å…¥ç»„ä»¶ï¼Œå¯ä»¥æ ¹æ® <code>state</code> ä¸­çš„æ•°æ®ï¼ŒåŠ¨æ€åœ°è¾“å‡ºç»„ä»¶éœ€è¦çš„ï¼ˆæœ€å°ï¼‰å±æ€§</li> <li>å‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•° <code>ownProps</code>ï¼Œæ˜¯ç»„ä»¶è‡ªå·±çš„ <code>props</code></li></ul> <blockquote><p>å½“ <code>state</code> å˜åŒ–ï¼Œæˆ–è€… <code>ownProps</code> å˜åŒ–çš„æ—¶å€™ï¼Œ<code>mapStateToProps</code> éƒ½ä¼šè¢«è°ƒç”¨ï¼Œè®¡ç®—å‡ºä¸€ä¸ªæ–°çš„ <code>stateProps</code>ï¼Œï¼ˆåœ¨ä¸ <code>ownProps merge</code> åï¼‰æ›´æ–°ç»™ç»„ä»¶</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">mapDispatchToProps</span><span class="token punctuation">(</span>dispatch<span class="token punctuation">,</span> ownProps<span class="token punctuation">)</span><span class="token operator">:</span> dispatchProps
</code></pre></div><blockquote><p><code>connect</code> çš„ç¬¬äºŒä¸ªå‚æ•°æ˜¯ <code>mapDispatchToProps</code>ï¼Œå®ƒçš„åŠŸèƒ½æ˜¯ï¼Œå°† <code>action</code> ä½œä¸º <code>props</code>ç»‘å®šåˆ°ç»„ä»¶ä¸Šï¼Œä¹Ÿä¼šæˆä¸º <code>MyComp</code> çš„ `props</p></blockquote> <p><strong>2. åŸç†è§£æ</strong></p> <blockquote><p>é¦–å…ˆ<code>connect</code>ä¹‹æ‰€ä»¥ä¼šæˆåŠŸï¼Œæ˜¯å› ä¸º<code>Provider</code>ç»„ä»¶</p></blockquote> <ul><li>åœ¨åŸåº”ç”¨ç»„ä»¶ä¸ŠåŒ…è£¹ä¸€å±‚ï¼Œä½¿åŸæ¥æ•´ä¸ªåº”ç”¨æˆä¸º<code>Provider</code>çš„å­ç»„ä»¶</li> <li>æ¥æ”¶<code>Redux</code>çš„<code>store</code>ä½œä¸º<code>props</code>ï¼Œé€šè¿‡<code>context</code>å¯¹è±¡ä¼ é€’ç»™å­å­™ç»„ä»¶ä¸Šçš„<code>connect</code></li></ul> <p><strong>connectåšäº†äº›ä»€ä¹ˆ</strong></p> <blockquote><p>å®ƒçœŸæ­£è¿æ¥ <code>Redux</code> å’Œ <code>React</code>ï¼Œå®ƒåŒ…åœ¨æˆ‘ä»¬çš„å®¹å™¨ç»„ä»¶çš„å¤–ä¸€å±‚ï¼Œå®ƒæ¥æ”¶ä¸Šé¢ <code>Provider</code>æä¾›çš„ <code>store</code> é‡Œé¢çš„ <code>state</code>å’Œ <code>dispatch</code>ï¼Œä¼ ç»™ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œè¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œä»¥å±æ€§å½¢å¼ä¼ ç»™æˆ‘ä»¬çš„å®¹å™¨ç»„ä»¶</p></blockquote> <p><strong>3. æºç </strong></p> <blockquote><p><code>connect</code>æ˜¯ä¸€ä¸ªé«˜é˜¶å‡½æ•°ï¼Œé¦–å…ˆä¼ å…¥<code>mapStateToProps</code>ã€<code>mapDispatchToProps</code>ï¼Œç„¶åè¿”å›ä¸€ä¸ªç”Ÿäº§<code>Component</code>çš„å‡½æ•°(<code>wrapWithConnect</code>)ï¼Œç„¶åå†å°†çœŸæ­£çš„<code>Component</code>ä½œä¸ºå‚æ•°ä¼ å…¥<code>wrapWithConnect</code>ï¼Œè¿™æ ·å°±ç”Ÿäº§å‡ºä¸€ä¸ªç»è¿‡åŒ…è£¹çš„<code>Connect</code>ç»„ä»¶ï¼Œè¯¥ç»„ä»¶å…·æœ‰å¦‚ä¸‹ç‰¹ç‚¹</p></blockquote> <ul><li>é€šè¿‡<code>props.store</code>è·å–ç¥–å…ˆ<code>Component</code>çš„<code>store props</code>åŒ…æ‹¬<code>stateProps</code>ã€<code>dispatchProps</code>ã€<code>parentProps</code>,åˆå¹¶åœ¨ä¸€èµ·å¾—åˆ°<code>nextState</code>ï¼Œä½œä¸º<code>props</code>ä¼ ç»™çœŸæ­£çš„<code>Component</code></li> <li><code>componentDidMount</code>æ—¶ï¼Œæ·»åŠ äº‹ä»¶<code>this.store.subscribe(this.handleChange)</code>ï¼Œå®ç°é¡µé¢äº¤äº’</li> <li><code>shouldComponentUpdate</code>æ—¶åˆ¤æ–­æ˜¯å¦æœ‰é¿å…è¿›è¡Œæ¸²æŸ“ï¼Œæå‡é¡µé¢æ€§èƒ½ï¼Œå¹¶å¾—åˆ°<code>nextState</code></li> <li><code>componentWillUnmount</code>æ—¶ç§»é™¤æ³¨å†Œçš„äº‹ä»¶<code>this.handleChange</code></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// ä¸»è¦é€»è¾‘</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">connect</span><span class="token punctuation">(</span><span class="token parameter">mapStateToProps<span class="token punctuation">,</span> mapDispatchToProps<span class="token punctuation">,</span> mergeProps<span class="token punctuation">,</span> options <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token function">wrapWithConnect</span><span class="token punctuation">(</span><span class="token parameter">WrappedComponent</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">class</span> <span class="token class-name">Connect</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
      <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">props<span class="token punctuation">,</span> context</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// ä»ç¥–å…ˆComponentå¤„è·å¾—store</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>store <span class="token operator">=</span> props<span class="token punctuation">.</span>store <span class="token operator">||</span> context<span class="token punctuation">.</span>store
        <span class="token keyword">this</span><span class="token punctuation">.</span>stateProps <span class="token operator">=</span> <span class="token function">computeStateProps</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>store<span class="token punctuation">,</span> props<span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>dispatchProps <span class="token operator">=</span> <span class="token function">computeDispatchProps</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>store<span class="token punctuation">,</span> props<span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">{</span> storeState<span class="token operator">:</span> <span class="token keyword">null</span> <span class="token punctuation">}</span>
        <span class="token comment">// å¯¹statePropsã€dispatchPropsã€parentPropsè¿›è¡Œåˆå¹¶</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">updateState</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
      <span class="token function">shouldComponentUpdate</span><span class="token punctuation">(</span><span class="token parameter">nextProps<span class="token punctuation">,</span> nextState</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// è¿›è¡Œåˆ¤æ–­ï¼Œå½“æ•°æ®å‘ç”Ÿæ”¹å˜æ—¶ï¼ŒComponenté‡æ–°æ¸²æŸ“</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>propsChanged <span class="token operator">||</span> mapStateProducedChange <span class="token operator">||</span> dispatchPropsChanged<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">updateState</span><span class="token punctuation">(</span>nextProps<span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment">// æ”¹å˜Componentçš„state</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span>store<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
              storeState<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>store<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment">// ç”ŸæˆåŒ…è£¹ç»„ä»¶Connect</span>
          <span class="token keyword">return</span> <span class="token punctuation">(</span>
            <span class="token operator">&lt;</span>WrappedComponent <span class="token punctuation">{</span><span class="token operator">...</span><span class="token keyword">this</span><span class="token punctuation">.</span>nextState<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
          <span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      Connect<span class="token punctuation">.</span>contextTypes <span class="token operator">=</span> <span class="token punctuation">{</span>
        store<span class="token operator">:</span> storeShape
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> Connect<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_16-react-hooks-å®ƒå¸¦æ¥äº†é‚£äº›ä¾¿åˆ©"><a href="http://interview.poetries.top/docs/simply.html#_16-react-hooks-%E5%AE%83%E5%B8%A6%E6%9D%A5%E4%BA%86%E9%82%A3%E4%BA%9B%E4%BE%BF%E5%88%A9" class="header-anchor">#</a> 16 react hooksï¼Œå®ƒå¸¦æ¥äº†é‚£äº›ä¾¿åˆ©</h3> <ul><li>ä»£ç é€»è¾‘èšåˆï¼Œé€»è¾‘å¤ç”¨</li> <li>HOCåµŒå¥—åœ°ç‹±</li> <li>ä»£æ›¿class</li></ul> <blockquote><p>React ä¸­é€šå¸¸ä½¿ç”¨ ç±»å®šä¹‰ æˆ–è€… å‡½æ•°å®šä¹‰ åˆ›å»ºç»„ä»¶:</p></blockquote> <p>åœ¨ç±»å®šä¹‰ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨åˆ°è®¸å¤š React ç‰¹æ€§ï¼Œä¾‹å¦‚ stateã€ å„ç§ç»„ä»¶ç”Ÿå‘½å‘¨æœŸé’©å­ç­‰ï¼Œä½†æ˜¯åœ¨å‡½æ•°å®šä¹‰ä¸­ï¼Œæˆ‘ä»¬å´æ— èƒ½ä¸ºåŠ›ï¼Œå› æ­¤ React 16.8 ç‰ˆæœ¬æ¨å‡ºäº†ä¸€ä¸ªæ–°åŠŸèƒ½ (React Hooks)ï¼Œé€šè¿‡å®ƒï¼Œå¯ä»¥æ›´å¥½çš„åœ¨å‡½æ•°å®šä¹‰ç»„ä»¶ä¸­ä½¿ç”¨ React ç‰¹æ€§ã€‚</p> <p><strong>å¥½å¤„:</strong></p> <ol><li>è·¨ç»„ä»¶å¤ç”¨: å…¶å® render props / HOC ä¹Ÿæ˜¯ä¸ºäº†å¤ç”¨ï¼Œç›¸æ¯”äºå®ƒä»¬ï¼ŒHooks ä½œä¸ºå®˜æ–¹çš„åº•å±‚ APIï¼Œæœ€ä¸ºè½»é‡ï¼Œè€Œä¸”æ”¹é€ æˆæœ¬å°ï¼Œä¸ä¼šå½±å“åŸæ¥çš„ç»„ä»¶å±‚æ¬¡ç»“æ„å’Œä¼ è¯´ä¸­çš„åµŒå¥—åœ°ç‹±ï¼›</li> <li>ç±»å®šä¹‰æ›´ä¸ºå¤æ‚</li></ol> <ul><li>ä¸åŒçš„ç”Ÿå‘½å‘¨æœŸä¼šä½¿é€»è¾‘å˜å¾—åˆ†æ•£ä¸”æ··ä¹±ï¼Œä¸æ˜“ç»´æŠ¤å’Œç®¡ç†ï¼›</li> <li>æ—¶åˆ»éœ€è¦å…³æ³¨thisçš„æŒ‡å‘é—®é¢˜ï¼›</li> <li>ä»£ç å¤ç”¨ä»£ä»·é«˜ï¼Œé«˜é˜¶ç»„ä»¶çš„ä½¿ç”¨ç»å¸¸ä¼šä½¿æ•´ä¸ªç»„ä»¶æ ‘å˜å¾—è‡ƒè‚¿ï¼›</li></ul> <ol start="3"><li>çŠ¶æ€ä¸UIéš”ç¦»: æ­£æ˜¯ç”±äº Hooks çš„ç‰¹æ€§ï¼ŒçŠ¶æ€é€»è¾‘ä¼šå˜æˆæ›´å°çš„ç²’åº¦ï¼Œå¹¶ä¸”æå®¹æ˜“è¢«æŠ½è±¡æˆä¸€ä¸ªè‡ªå®šä¹‰ Hooksï¼Œç»„ä»¶ä¸­çš„çŠ¶æ€å’Œ UI å˜å¾—æ›´ä¸ºæ¸…æ™°å’Œéš”ç¦»ã€‚</li></ol> <p><strong>æ³¨æ„:</strong></p> <ul><li>é¿å…åœ¨ å¾ªç¯/æ¡ä»¶åˆ¤æ–­/åµŒå¥—å‡½æ•° ä¸­è°ƒç”¨ hooksï¼Œä¿è¯è°ƒç”¨é¡ºåºçš„ç¨³å®šï¼›</li> <li>åªæœ‰ å‡½æ•°å®šä¹‰ç»„ä»¶ å’Œ hooks å¯ä»¥è°ƒç”¨ hooksï¼Œé¿å…åœ¨ ç±»ç»„ä»¶ æˆ–è€… æ™®é€šå‡½æ•° ä¸­è°ƒç”¨ï¼›</li> <li>ä¸èƒ½åœ¨useEffectä¸­ä½¿ç”¨useStateï¼ŒReact ä¼šæŠ¥é”™æç¤ºï¼›</li> <li>ç±»ç»„ä»¶ä¸ä¼šè¢«æ›¿æ¢æˆ–åºŸå¼ƒï¼Œä¸éœ€è¦å¼ºåˆ¶æ”¹é€ ç±»ç»„ä»¶ï¼Œä¸¤ç§æ–¹å¼èƒ½å¹¶å­˜ï¼›</li></ul> <p><strong>é‡è¦é’©å­</strong></p> <ol><li>çŠ¶æ€é’©å­ (useState): ç”¨äºå®šä¹‰ç»„ä»¶çš„ Stateï¼Œå…¶åˆ°ç±»å®šä¹‰ä¸­this.stateçš„åŠŸèƒ½ï¼›</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// useState åªæ¥å—ä¸€ä¸ªå‚æ•°: åˆå§‹çŠ¶æ€</span>
<span class="token comment">// è¿”å›çš„æ˜¯ç»„ä»¶åå’Œæ›´æ”¹è¯¥ç»„ä»¶å¯¹åº”çš„å‡½æ•°</span>
<span class="token keyword">const</span> <span class="token punctuation">[</span>flag<span class="token punctuation">,</span> setFlag<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// ä¿®æ”¹çŠ¶æ€</span>
<span class="token function">setFlag</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
	
<span class="token comment">// ä¸Šé¢çš„ä»£ç æ˜ å°„åˆ°ç±»å®šä¹‰ä¸­:</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">{</span>
	flag<span class="token operator">:</span> <span class="token boolean">true</span>	
<span class="token punctuation">}</span>
<span class="token keyword">const</span> flag <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>flag
<span class="token keyword">const</span> <span class="token function-variable function">setFlag</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">bool</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        flag<span class="token operator">:</span> bool<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><ol start="2"><li>ç”Ÿå‘½å‘¨æœŸé’©å­ (useEffect):</li></ol> <blockquote><p>ç±»å®šä¹‰ä¸­æœ‰è®¸å¤šç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼Œè€Œåœ¨ React Hooks ä¸­ä¹Ÿæä¾›äº†ä¸€ä¸ªç›¸åº”çš„å‡½æ•° (useEffect)ï¼Œè¿™é‡Œå¯ä»¥çœ‹åšcomponentDidMountã€componentDidUpdateå’ŒcomponentWillUnmountçš„ç»“åˆã€‚</p></blockquote> <p><strong>useEffect(callback, [source])æ¥å—ä¸¤ä¸ªå‚æ•°</strong></p> <ul><li>callback: é’©å­å›è°ƒå‡½æ•°ï¼›</li> <li>source: è®¾ç½®è§¦å‘æ¡ä»¶ï¼Œä»…å½“ source å‘ç”Ÿæ”¹å˜æ—¶æ‰ä¼šè§¦å‘ï¼›</li> <li>useEffecté’©å­åœ¨æ²¡æœ‰ä¼ å…¥[source]å‚æ•°æ—¶ï¼Œé»˜è®¤åœ¨æ¯æ¬¡ render æ—¶éƒ½ä¼šä¼˜å…ˆè°ƒç”¨ä¸Šæ¬¡ä¿å­˜çš„å›è°ƒä¸­è¿”å›çš„å‡½æ•°ï¼Œåå†é‡æ–°è°ƒç”¨å›è°ƒï¼›</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
	<span class="token comment">// ç»„ä»¶æŒ‚è½½åæ‰§è¡Œäº‹ä»¶ç»‘å®š</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'on'</span><span class="token punctuation">)</span>
	<span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	
	<span class="token comment">// ç»„ä»¶ update æ—¶ä¼šæ‰§è¡Œäº‹ä»¶è§£ç»‘</span>
	<span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'off'</span><span class="token punctuation">)</span>
		<span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>source<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token comment">// æ¯æ¬¡ source å‘ç”Ÿæ”¹å˜æ—¶ï¼Œæ‰§è¡Œç»“æœ(ä»¥ç±»å®šä¹‰çš„ç”Ÿå‘½å‘¨æœŸï¼Œä¾¿äºå¤§å®¶ç†è§£):</span>
<span class="token comment">// --- DidMount ---</span>
<span class="token comment">// 'on'</span>
<span class="token comment">// --- DidUpdate ---</span>
<span class="token comment">// 'off'</span>
<span class="token comment">// 'on'</span>
<span class="token comment">// --- DidUpdate ---</span>
<span class="token comment">// 'off'</span>
<span class="token comment">// 'on'</span>
<span class="token comment">// --- WillUnmount --- </span>
<span class="token comment">// 'off'</span>
</code></pre></div><p><strong>é€šè¿‡ç¬¬äºŒä¸ªå‚æ•°ï¼Œæˆ‘ä»¬ä¾¿å¯æ¨¡æ‹Ÿå‡ºå‡ ä¸ªå¸¸ç”¨çš„ç”Ÿå‘½å‘¨æœŸ:</strong></p> <ul><li>componentDidMount: ä¼ å…¥[]æ—¶ï¼Œå°±åªä¼šåœ¨åˆå§‹åŒ–æ—¶è°ƒç”¨ä¸€æ¬¡</li></ul> <div class="language- extra-class"><pre class="language-text"><code>const useMount = (fn) =&gt; useEffect(fn, [])
</code></pre></div><ul><li>componentWillUnmount: ä¼ å…¥[]ï¼Œå›è°ƒä¸­çš„è¿”å›çš„å‡½æ•°ä¹Ÿåªä¼šè¢«æœ€ç»ˆæ‰§è¡Œä¸€æ¬¡</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">useUnmount</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">fn</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> fn<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>mounted: å¯ä»¥ä½¿ç”¨ useState å°è£…æˆä¸€ä¸ªé«˜åº¦å¯å¤ç”¨çš„ mounted çŠ¶æ€ï¼›</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">useMounted</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">[</span>mounted<span class="token punctuation">,</span> setMounted<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token operator">!</span>mounted <span class="token operator">&amp;&amp;</span> <span class="token function">setMounted</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setMounted</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> mounted<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>componentDidUpdate: useEffectæ¯æ¬¡å‡ä¼šæ‰§è¡Œï¼Œå…¶å®å°±æ˜¯æ’é™¤äº† DidMount åå³å¯ï¼›</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> mounted <span class="token operator">=</span> <span class="token function">useMounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
<span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    mounted <span class="token operator">&amp;&amp;</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><ol start="3"><li>å…¶å®ƒå†…ç½®é’©å­:</li></ol> <ul><li><code>useContext</code>: è·å– context å¯¹è±¡</li> <li><code>useReducer</code>: ç±»ä¼¼äº Redux æ€æƒ³çš„å®ç°ï¼Œä½†å…¶å¹¶ä¸è¶³ä»¥æ›¿ä»£ Reduxï¼Œå¯ä»¥ç†è§£æˆä¸€ä¸ªç»„ä»¶å†…éƒ¨çš„ redux:
<ul><li>å¹¶ä¸æ˜¯æŒä¹…åŒ–å­˜å‚¨ï¼Œä¼šéšç€ç»„ä»¶è¢«é”€æ¯è€Œé”€æ¯ï¼›</li> <li>å±äºç»„ä»¶å†…éƒ¨ï¼Œå„ä¸ªç»„ä»¶æ˜¯ç›¸äº’éš”ç¦»çš„ï¼Œå•çº¯ç”¨å®ƒå¹¶æ— æ³•å…±äº«æ•°æ®ï¼›</li> <li>é…åˆuseContext`çš„å…¨å±€æ€§ï¼Œå¯ä»¥å®Œæˆä¸€ä¸ªè½»é‡çº§çš„ Reduxï¼›(easy-peasy)</li></ul></li> <li><code>useCallback</code>: ç¼“å­˜å›è°ƒå‡½æ•°ï¼Œé¿å…ä¼ å…¥çš„å›è°ƒæ¯æ¬¡éƒ½æ˜¯æ–°çš„å‡½æ•°å®ä¾‹è€Œå¯¼è‡´ä¾èµ–ç»„ä»¶é‡æ–°æ¸²æŸ“ï¼Œå…·æœ‰æ€§èƒ½ä¼˜åŒ–çš„æ•ˆæœï¼›</li> <li><code>useMemo</code>: ç”¨äºç¼“å­˜ä¼ å…¥çš„ propsï¼Œé¿å…ä¾èµ–çš„ç»„ä»¶æ¯æ¬¡éƒ½é‡æ–°æ¸²æŸ“ï¼›</li> <li><code>useRef</code>: è·å–ç»„ä»¶çš„çœŸå®èŠ‚ç‚¹ï¼›</li> <li><code>useLayoutEffect</code> <ul><li>DOMæ›´æ–°åŒæ­¥é’©å­ã€‚ç”¨æ³•ä¸useEffectç±»ä¼¼ï¼Œåªæ˜¯åŒºåˆ«äºæ‰§è¡Œæ—¶é—´ç‚¹çš„ä¸åŒ</li> <li>useEffectå±äºå¼‚æ­¥æ‰§è¡Œï¼Œå¹¶ä¸ä¼šç­‰å¾… DOM çœŸæ­£æ¸²æŸ“åæ‰§è¡Œï¼Œè€ŒuseLayoutEffectåˆ™ä¼šçœŸæ­£æ¸²æŸ“åæ‰è§¦å‘ï¼›</li> <li>å¯ä»¥è·å–æ›´æ–°åçš„ stateï¼›</li></ul></li></ul> <ol start="4"><li>è‡ªå®šä¹‰é’©å­(useXxxxx): åŸºäº Hooks å¯ä»¥å¼•ç”¨å…¶å®ƒ Hooks è¿™ä¸ªç‰¹æ€§ï¼Œæˆ‘ä»¬å¯ä»¥ç¼–å†™è‡ªå®šä¹‰é’©å­ï¼Œå¦‚ä¸Šé¢çš„useMountedã€‚åˆä¾‹å¦‚ï¼Œæˆ‘ä»¬éœ€è¦æ¯ä¸ªé¡µé¢è‡ªå®šä¹‰æ ‡é¢˜:</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">useTitle</span><span class="token punctuation">(</span><span class="token parameter">title</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">useEffect</span><span class="token punctuation">(</span>
    <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      document<span class="token punctuation">.</span>title <span class="token operator">=</span> title<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// ä½¿ç”¨:</span>
<span class="token keyword">function</span> <span class="token function">Home</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">const</span> title <span class="token operator">=</span> <span class="token string">'æˆ‘æ˜¯é¦–é¡µ'</span>
	<span class="token function">useTitle</span><span class="token punctuation">(</span>title<span class="token punctuation">)</span>
	
	<span class="token keyword">return</span> <span class="token punctuation">(</span>
		<span class="token operator">&lt;</span>div<span class="token operator">&gt;</span><span class="token punctuation">{</span>title<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
	<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_17-èŠèŠ-redux-å’Œ-vuex-çš„è®¾è®¡æ€æƒ³"><a href="http://interview.poetries.top/docs/simply.html#_17-%E8%81%8A%E8%81%8A-redux-%E5%92%8C-vuex-%E7%9A%84%E8%AE%BE%E8%AE%A1%E6%80%9D%E6%83%B3" class="header-anchor">#</a> 17 èŠèŠ Redux å’Œ Vuex çš„è®¾è®¡æ€æƒ³</h3> <p><strong>å…±åŒç‚¹</strong></p> <blockquote><p>é¦–å…ˆä¸¤è€…éƒ½æ˜¯å¤„ç†å…¨å±€çŠ¶æ€çš„å·¥å…·åº“ï¼Œå¤§è‡´å®ç°æ€æƒ³éƒ½æ˜¯ï¼šå…¨å±€<code>state</code>ä¿å­˜çŠ¶æ€----&gt;<code>dispatch(action)</code>------&gt;<code>reducer</code>(<code>vuex</code>é‡Œçš„<code>mutation</code>)----&gt; ç”Ÿæˆ<code>newState</code>; æ•´ä¸ªçŠ¶æ€ä¸ºåŒæ­¥æ“ä½œï¼›</p></blockquote> <p><strong>åŒºåˆ«</strong></p> <blockquote><p>æœ€å¤§çš„åŒºåˆ«åœ¨äºå¤„ç†å¼‚æ­¥çš„ä¸åŒï¼Œvuexé‡Œé¢å¤šäº†ä¸€æ­¥<code>commit</code>æ“ä½œï¼Œåœ¨<code>action</code>ä¹‹å<code>commit(mutation)</code>ä¹‹å‰å¤„ç†å¼‚æ­¥ï¼Œè€Œ<code>redux</code>é‡Œé¢åˆ™æ˜¯é€šè¿‡ä¸­é—´ä»¶å¤„ç†</p></blockquote> <h3 id="_18-redux-ä¸­é—´ä»¶"><a href="http://interview.poetries.top/docs/simply.html#_18-redux-%E4%B8%AD%E9%97%B4%E4%BB%B6" class="header-anchor">#</a> 18 redux ä¸­é—´ä»¶</h3> <blockquote><p>ä¸­é—´ä»¶æä¾›ç¬¬ä¸‰æ–¹æ’ä»¶çš„æ¨¡å¼ï¼Œè‡ªå®šä¹‰æ‹¦æˆª action -&gt; reducer çš„è¿‡ç¨‹ã€‚å˜ä¸º action -&gt; middlewares -&gt; reducer ã€‚è¿™ç§æœºåˆ¶å¯ä»¥è®©æˆ‘ä»¬æ”¹å˜æ•°æ®æµï¼Œå®ç°å¦‚å¼‚æ­¥ action ï¼Œaction è¿‡ æ»¤ï¼Œæ—¥å¿—è¾“å‡ºï¼Œå¼‚å¸¸æŠ¥å‘Šç­‰åŠŸèƒ½</p></blockquote> <p>å¸¸è§çš„ä¸­é—´ä»¶:</p> <ul><li><code>redux-logger</code>:æä¾›æ—¥å¿—è¾“å‡º;</li> <li><code>redux-thunk</code>:å¤„ç†å¼‚æ­¥æ“ä½œ;</li> <li><code>redux-promise</code>: å¤„ç†å¼‚æ­¥æ“ä½œ;</li> <li><code>actionCreator</code> çš„è¿”å›å€¼æ˜¯ <code>promise</code></li></ul> <p><strong>reduxä¸­é—´ä»¶çš„åŸç†æ˜¯ä»€ä¹ˆ</strong></p> <p><code>applyMiddleware</code></p> <p><strong>ä¸ºä»€ä¹ˆä¼šå‡ºç°ä¸­é—´ä»¶ï¼Ÿ</strong></p> <ul><li>å®ƒåªæ˜¯ä¸€ä¸ªç”¨æ¥åŠ å·¥dispatchçš„å·¥å‚ï¼Œè€Œè¦åŠ å·¥ä»€ä¹ˆæ ·çš„dispatchå‡ºæ¥ï¼Œåˆ™éœ€è¦æˆ‘ä»¬ä¼ å…¥å¯¹åº”çš„ä¸­é—´ä»¶å‡½æ•°</li> <li>è®©æ¯ä¸€ä¸ªä¸­é—´ä»¶å‡½æ•°ï¼Œæ¥æ”¶ä¸€ä¸ªdispatchï¼Œç„¶åè¿”å›ä¸€ä¸ªæ”¹é€ åçš„dispatchï¼Œæ¥ä½œä¸ºä¸‹ä¸€ä¸ªä¸­é—´ä»¶å‡½æ•°çš„nextï¼Œä»¥æ­¤ç±»æ¨ã€‚</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">applyMiddleware</span><span class="token punctuation">(</span><span class="token parameter">middlewares</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  middlewares <span class="token operator">=</span> middlewares<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  middlewares<span class="token punctuation">.</span><span class="token function">reverse</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

  <span class="token keyword">let</span> dispatch <span class="token operator">=</span> store<span class="token punctuation">.</span>dispatch
  middlewares<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">middleware</span> <span class="token operator">=&gt;</span>
    dispatch <span class="token operator">=</span> <span class="token function">middleware</span><span class="token punctuation">(</span>store<span class="token punctuation">)</span><span class="token punctuation">(</span>dispatch<span class="token punctuation">)</span>
  <span class="token punctuation">)</span>
  <span class="token keyword">return</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> store<span class="token punctuation">,</span> <span class="token punctuation">{</span> dispatch <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>ä¸Šé¢çš„<code>m</code>iddleware(store)(dispatch)<code>å°±ç›¸å½“äºæ˜¯</code>const logger = store =&gt; next =&gt; {}<code>ï¼Œè¿™å°±æ˜¯æ„é€ åçš„dispatchï¼Œç»§ç»­å‘ä¸‹ä¼ é€’ã€‚è¿™é‡Œ</code>middlewares.reverse()<code>ï¼Œè¿›è¡Œæ•°ç»„åè½¬çš„åŸå› ï¼Œæ˜¯æœ€åæ„é€ çš„</code>dispatch<code>ï¼Œå®é™…ä¸Šæ˜¯æœ€å…ˆæ‰§è¡Œçš„ã€‚å› ä¸ºåœ¨</code>applyMiddleware<code>ä¸²è”çš„æ—¶å€™ï¼Œæ¯ä¸ªä¸­é—´ä»¶åªæ˜¯è¿”å›ä¸€ä¸ªæ–°çš„</code>dispatch<code>å‡½æ•°ç»™ä¸‹ä¸€ä¸ªä¸­é—´ä»¶ï¼Œå®é™…ä¸Šè¿™ä¸ª</code>dispatch<code>å¹¶ä¸ä¼šæ‰§è¡Œã€‚åªæœ‰å½“æˆ‘ä»¬åœ¨ç¨‹åºä¸­é€šè¿‡</code>store.dispatch(action)<code>ï¼ŒçœŸæ­£æ´¾å‘çš„æ—¶å€™ï¼Œæ‰ä¼šæ‰§è¡Œã€‚è€Œæ­¤æ—¶çš„</code>dispatch`æ˜¯æœ€åä¸€ä¸ªä¸­é—´ä»¶è¿”å›çš„åŒ…è£…å‡½æ•°ã€‚ç„¶åä¾æ¬¡å‘å‰é€’æ¨æ‰§è¡Œã€‚</p></blockquote> <h3 id="_19-reduxæ•°æ®ç®¡ç†"><a href="http://interview.poetries.top/docs/simply.html#_19-redux%E6%95%B0%E6%8D%AE%E7%AE%A1%E7%90%86" class="header-anchor">#</a> 19 reduxæ•°æ®ç®¡ç†</h3> <p>ä½ ä¼šæŠŠæ•°æ®ç»Ÿä¸€æ”¾åœ¨reduxä¸­ç®¡ç†ï¼Œè¿˜æ˜¯å…±äº«æ•°æ®æ”¾åœ¨reduxä¸­ç®¡ç†ï¼Ÿ</p> <p><strong>ç­”ï¼š</strong></p> <blockquote><p>ç»Ÿä¸€æ”¾åœ¨reduxä¸­ç®¡ç†ï¼Œæˆ‘ä»¬éƒ½çŸ¥é“æ•°æ®å­˜åœ¨propsä¸­å’Œstateä¸­ï¼Œå½“ä½ ä¼šè®¤ä¸ºå½“å‰è¿™ä¸ªç»„ä»¶çš„æ•°æ®åªæ˜¯è¿™ä¸ªç»„ä»¶éœ€è¦ä½¿ç”¨ï¼Œå½“æŸä¸€å¤©ï¼Œé¡¹ç›®æ‰©å±•ï¼Œè¿™ä¸ªç»„ä»¶æ•°æ®éœ€è¦ç»™å…¶ä»–ç»„ä»¶ä½¿ç”¨ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œä½ æ˜¯å¦‚ä½•ä¼ é€’æ•°æ®å‘¢ï¼Œæ˜¯é€šè¿‡propsä¼ é€’å‘¢ï¼Œè¿˜æ˜¯æ”¾åœ¨reduxä¸­å­˜å‘¢ï¼Ÿ</p> <p>æœ¬æ¥ä¸€å¼€å§‹è‡ªèº«ä½¿ç”¨ï¼Œåæ¥éœ€è¦å…±äº«æ•°æ®ï¼Œéœ€è¦æ”¾åœ¨reduxï¼Œä½ è¿˜æ˜¯éœ€è¦å°†stateæ•°æ®è¿ç§»åˆ°reduxä¸­ã€‚</p> <p>ä»£ç å¯ç»´æŠ¤æ€§ï¼Œå¯æ‰©å±•æ€§å¾ˆé«˜ï¼ŒåŠ ä¸Šimmutable + reactåï¼Œæ›´åŠ å‹å¥½ï¼Œæ€§èƒ½æ›´å¥½ï¼Œæ•°æ®ä¹Ÿä¸ä¼šè‡ƒè‚¿ã€‚</p></blockquote> <h3 id="_20-å—æ§ç»„ä»¶å’Œéå—æ§ç»„ä»¶"><a href="http://interview.poetries.top/docs/simply.html#_20-%E5%8F%97%E6%8E%A7%E7%BB%84%E4%BB%B6%E5%92%8C%E9%9D%9E%E5%8F%97%E6%8E%A7%E7%BB%84%E4%BB%B6" class="header-anchor">#</a> 20 å—æ§ç»„ä»¶å’Œéå—æ§ç»„ä»¶</h3> <div class="language- extra-class"><pre class="language-text"><code>&lt;FInput value = {x} onChange = {fn} /&gt; 
// ä¸Šé¢çš„æ˜¯å—æ§ç»„ä»¶ ä¸‹é¢çš„æ˜¯éå—æ§ç»„ä»¶
&lt;FInput defaultValue = {x} /&gt;
</code></pre></div><ul><li>å½“ä½ ä¸€ä¸ªç»„ä»¶åŒæ—¶ä¼ é€’ä¸€ä¸ªvalueä»¥åŠonChangeäº‹ä»¶æ—¶ï¼Œå®ƒå°±æ˜¯ä¸€ä¸ªå—æ§ç»„ä»¶ï¼Œæ”¶å…¥è¾“å‡ºéƒ½æ˜¯æˆ‘æ¥æ§åˆ¶çš„ã€‚</li> <li>ç¬¬äºŒä¸ªåªæ˜¯ä¼ é€’äº†é»˜è®¤çš„åˆæ—¶å€¼ï¼Œå¹¶æ²¡æœ‰ä¼ onchangeäº‹ä»¶ï¼Œ</li> <li>éå—æ§ç»„ä»¶æ˜¯ä¸€ç§åæ¨¡å¼ï¼Œå®ƒçš„å€¼ä¸å—ç»„ä»¶è‡ªèº«çš„stateæˆ–propsæ§åˆ¶</li></ul> <h3 id="_21-ssråŸç†"><a href="http://interview.poetries.top/docs/simply.html#_21-ssr%E5%8E%9F%E7%90%86" class="header-anchor">#</a> 21 SSRåŸç†</h3> <blockquote><p>å€ŸåŠ©è™šæ‹Ÿdom,æœåŠ¡å™¨ä¸­æ²¡æœ‰domæ¦‚å¿µçš„ï¼Œreactå·§å¦™çš„å€ŸåŠ©è™šæ‹Ÿdomï¼Œç„¶åå¯ä»¥åœ¨æœåŠ¡å™¨ä¸­nodejså¯ä»¥è¿è¡Œèµ·æ¥reactä»£ç ã€‚</p></blockquote> <h3 id="_22-å¦‚ä½•é¿å…ajaxæ•°æ®è¯·æ±‚é‡æ–°è·å–"><a href="http://interview.poetries.top/docs/simply.html#_22-%E5%A6%82%E4%BD%95%E9%81%BF%E5%85%8Dajax%E6%95%B0%E6%8D%AE%E8%AF%B7%E6%B1%82%E9%87%8D%E6%96%B0%E8%8E%B7%E5%8F%96" class="header-anchor">#</a> 22 å¦‚ä½•é¿å…ajaxæ•°æ®è¯·æ±‚é‡æ–°è·å–</h3> <blockquote><p>ä¸€èˆ¬è€Œè¨€ï¼Œajaxè¯·æ±‚çš„æ•°æ®éƒ½æ”¾åœ¨reduxä¸­å­˜å–ã€‚</p></blockquote> <h3 id="_23-ç»„ä»¶ä¹‹é—´é€šä¿¡"><a href="http://interview.poetries.top/docs/simply.html#_23-%E7%BB%84%E4%BB%B6%E4%B9%8B%E9%97%B4%E9%80%9A%E4%BF%A1" class="header-anchor">#</a> 23 ç»„ä»¶ä¹‹é—´é€šä¿¡</h3> <ul><li>çˆ¶å­ç»„ä»¶é€šä¿¡</li> <li>è‡ªå®šä¹‰äº‹ä»¶</li> <li>reduxå’Œcontext</li></ul> <p><strong>contextå¦‚ä½•è¿ç”¨</strong></p> <ul><li>çˆ¶ç»„ä»¶å‘å…¶ä¸‹æ‰€æœ‰å­å­™ç»„ä»¶ä¼ é€’ä¿¡æ¯</li> <li>å¦‚ä¸€äº›ç®€å•çš„ä¿¡æ¯ï¼šä¸»é¢˜ã€è¯­è¨€</li> <li>å¤æ‚çš„å…¬å…±ä¿¡æ¯ç”¨redux</li></ul> <h3 id="_24-react-router"><a href="http://interview.poetries.top/docs/simply.html#_24-react-router" class="header-anchor">#</a> 24 React router</h3> <p><img src="./è¿›é˜¶_files/20210409164620.png" alt="" class="medium-zoom-image"></p> <p><a href="http://interview.poetries.top/principle-docs/react/01-React-router%E5%8E%9F%E7%90%86.html" target="_blank" rel="noopener noreferrer">React routeråŸç†åˆ†æ<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="ä¸ƒã€æ€§èƒ½"><a href="http://interview.poetries.top/docs/simply.html#%E4%B8%83%E3%80%81%E6%80%A7%E8%83%BD" class="header-anchor">#</a> ä¸ƒã€æ€§èƒ½</h2> <h3 id="_1-dns-é¢„è§£æ"><a href="http://interview.poetries.top/docs/simply.html#_1-dns-%E9%A2%84%E8%A7%A3%E6%9E%90" class="header-anchor">#</a> 1 DNS é¢„è§£æ</h3> <ul><li><code>DNS</code> è§£æä¹Ÿæ˜¯éœ€è¦æ—¶é—´çš„ï¼Œå¯ä»¥é€šè¿‡é¢„è§£æçš„æ–¹å¼æ¥é¢„å…ˆè·å¾—åŸŸåæ‰€å¯¹åº”çš„ <code>IP</code></li></ul> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dns-prefetch<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>//blog.poetries.top<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="_2-ç¼“å­˜"><a href="http://interview.poetries.top/docs/simply.html#_2-%E7%BC%93%E5%AD%98" class="header-anchor">#</a> 2 ç¼“å­˜</h3> <ul><li>ç¼“å­˜å¯¹äºå‰ç«¯æ€§èƒ½ä¼˜åŒ–æ¥è¯´æ˜¯ä¸ªå¾ˆé‡è¦çš„ç‚¹ï¼Œè‰¯å¥½çš„ç¼“å­˜ç­–ç•¥å¯ä»¥é™ä½èµ„æºçš„é‡å¤åŠ è½½æé«˜ç½‘é¡µçš„æ•´ä½“åŠ è½½é€Ÿåº¦</li> <li>é€šå¸¸æµè§ˆå™¨ç¼“å­˜ç­–ç•¥åˆ†ä¸ºä¸¤ç§ï¼šå¼ºç¼“å­˜å’Œåå•†ç¼“å­˜</li></ul> <p><strong>å¼ºç¼“å­˜</strong></p> <blockquote><p>å®ç°å¼ºç¼“å­˜å¯ä»¥é€šè¿‡ä¸¤ç§å“åº”å¤´å®ç°ï¼š<code>Expires</code>å’Œ <code>Cache-Control</code> ã€‚å¼ºç¼“å­˜è¡¨ç¤ºåœ¨ç¼“å­˜æœŸé—´ä¸éœ€è¦è¯·æ±‚ï¼Œ<code>state code</code>ä¸º <code>200</code></p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>Expires: Wed, 22 Oct 2018 08:41:00 GMT
</code></pre></div><blockquote><p><code>Expires</code> æ˜¯ <code>HTTP / 1.0</code> çš„äº§ç‰©ï¼Œè¡¨ç¤ºèµ„æºä¼šåœ¨ <code>Wed, 22 Oct 2018 08:41:00 GMT</code> åè¿‡æœŸï¼Œéœ€è¦å†æ¬¡è¯·æ±‚ã€‚å¹¶ä¸” <code>Expires</code> å—é™äºæœ¬åœ°æ—¶é—´ï¼Œå¦‚æœä¿®æ”¹äº†æœ¬åœ°æ—¶é—´ï¼Œå¯èƒ½ä¼šé€ æˆç¼“å­˜å¤±æ•ˆ</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>Cache-control: max-age=30
</code></pre></div><blockquote><p><code>Cache-Control</code> å‡ºç°äº <code>HTTP / 1.1</code>ï¼Œä¼˜å…ˆçº§é«˜äº <code>Expires</code> ã€‚è¯¥å±æ€§è¡¨ç¤ºèµ„æºä¼šåœ¨ <code>30</code> ç§’åè¿‡æœŸï¼Œéœ€è¦å†æ¬¡è¯·æ±‚</p></blockquote> <p><strong>åå•†ç¼“å­˜</strong></p> <ul><li>å¦‚æœç¼“å­˜è¿‡æœŸäº†ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨åå•†ç¼“å­˜æ¥è§£å†³é—®é¢˜ã€‚åå•†ç¼“å­˜éœ€è¦è¯·æ±‚ï¼Œå¦‚æœç¼“å­˜æœ‰æ•ˆä¼šè¿”å› 304</li> <li>åå•†ç¼“å­˜éœ€è¦å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯å…±åŒå®ç°ï¼Œå’Œå¼ºç¼“å­˜ä¸€æ ·ï¼Œä¹Ÿæœ‰ä¸¤ç§å®ç°æ–¹å¼</li></ul> <p><code>Last-Modified</code> å’Œ <code>If-Modified-Since</code></p> <ul><li><code>Last-Modified</code> è¡¨ç¤ºæœ¬åœ°æ–‡ä»¶æœ€åä¿®æ”¹æ—¥æœŸï¼Œ<code>If-Modified-Since</code> ä¼šå°† <code>Last-Modified</code>çš„å€¼å‘é€ç»™æœåŠ¡å™¨ï¼Œè¯¢é—®æœåŠ¡å™¨åœ¨è¯¥æ—¥æœŸåèµ„æºæ˜¯å¦æœ‰æ›´æ–°ï¼Œæœ‰æ›´æ–°çš„è¯å°±ä¼šå°†æ–°çš„èµ„æºå‘é€å›æ¥</li> <li>ä½†æ˜¯å¦‚æœåœ¨æœ¬åœ°æ‰“å¼€ç¼“å­˜æ–‡ä»¶ï¼Œå°±ä¼šé€ æˆ <code>Last-Modified</code> è¢«ä¿®æ”¹ï¼Œæ‰€ä»¥åœ¨ <code>HTTP / 1.1</code> å‡ºç°äº† <code>ETag</code></li></ul> <p><code>ETag</code> å’Œ <code>If-None-Match</code></p> <ul><li><code>ETag</code> ç±»ä¼¼äºæ–‡ä»¶æŒ‡çº¹ï¼Œ<code>If-None-Match</code> ä¼šå°†å½“å‰ <code>ETag</code> å‘é€ç»™æœåŠ¡å™¨ï¼Œè¯¢é—®è¯¥èµ„æº ETag æ˜¯å¦å˜åŠ¨ï¼Œæœ‰å˜åŠ¨çš„è¯å°±å°†æ–°çš„èµ„æºå‘é€å›æ¥ã€‚å¹¶ä¸” <code>ETag</code> ä¼˜å…ˆçº§æ¯” <code>Last-Modified</code> é«˜</li></ul> <p><strong>é€‰æ‹©åˆé€‚çš„ç¼“å­˜ç­–ç•¥</strong></p> <blockquote><p>å¯¹äºå¤§éƒ¨åˆ†çš„åœºæ™¯éƒ½å¯ä»¥ä½¿ç”¨å¼ºç¼“å­˜é…åˆåå•†ç¼“å­˜è§£å†³ï¼Œä½†æ˜¯åœ¨ä¸€äº›ç‰¹æ®Šçš„åœ°æ–¹å¯èƒ½éœ€è¦é€‰æ‹©ç‰¹æ®Šçš„ç¼“å­˜ç­–ç•¥</p></blockquote> <ul><li>å¯¹äºæŸäº›ä¸éœ€è¦ç¼“å­˜çš„èµ„æºï¼Œå¯ä»¥ä½¿ç”¨ <code>Cache-control: no-store</code> ï¼Œè¡¨ç¤ºè¯¥èµ„æºä¸éœ€è¦ç¼“å­˜</li> <li>å¯¹äºé¢‘ç¹å˜åŠ¨çš„èµ„æºï¼Œå¯ä»¥ä½¿ç”¨ <code>Cache-Control: no-cache</code> å¹¶é…åˆ <code>ETag</code> ä½¿ç”¨ï¼Œè¡¨ç¤ºè¯¥èµ„æºå·²è¢«ç¼“å­˜ï¼Œä½†æ˜¯æ¯æ¬¡éƒ½ä¼šå‘é€è¯·æ±‚è¯¢é—®èµ„æºæ˜¯å¦æ›´æ–°ã€‚</li> <li>å¯¹äºä»£ç æ–‡ä»¶æ¥è¯´ï¼Œé€šå¸¸ä½¿ç”¨ <code>Cache-Control: max-age=31536000</code> å¹¶é…åˆç­–ç•¥ç¼“å­˜ä½¿ç”¨ï¼Œç„¶åå¯¹æ–‡ä»¶è¿›è¡ŒæŒ‡çº¹å¤„ç†ï¼Œä¸€æ—¦æ–‡ä»¶åå˜åŠ¨å°±ä¼šç«‹åˆ»ä¸‹è½½æ–°çš„æ–‡ä»¶</li></ul> <h3 id="_3-ä½¿ç”¨-http-2-0"><a href="http://interview.poetries.top/docs/simply.html#_3-%E4%BD%BF%E7%94%A8-http-2-0" class="header-anchor">#</a> 3 ä½¿ç”¨ HTTP / 2.0</h3> <ul><li>å› ä¸ºæµè§ˆå™¨ä¼šæœ‰å¹¶å‘è¯·æ±‚é™åˆ¶ï¼Œåœ¨ <code>HTTP / 1.1</code> æ—¶ä»£ï¼Œæ¯ä¸ªè¯·æ±‚éƒ½éœ€è¦å»ºç«‹å’Œæ–­å¼€ï¼Œæ¶ˆè€—äº†å¥½å‡ ä¸ª <code>RTT</code> æ—¶é—´ï¼Œå¹¶ä¸”ç”±äº <code>TCP</code> æ…¢å¯åŠ¨çš„åŸå› ï¼ŒåŠ è½½ä½“ç§¯å¤§çš„æ–‡ä»¶ä¼šéœ€è¦æ›´å¤šçš„æ—¶é—´</li> <li>åœ¨ <code>HTTP / 2.0</code> ä¸­å¼•å…¥äº†å¤šè·¯å¤ç”¨ï¼Œèƒ½å¤Ÿè®©å¤šä¸ªè¯·æ±‚ä½¿ç”¨åŒä¸€ä¸ª <code>TCP</code> é“¾æ¥ï¼Œæå¤§çš„åŠ å¿«äº†ç½‘é¡µçš„åŠ è½½é€Ÿåº¦ã€‚å¹¶ä¸”è¿˜æ”¯æŒ <code>Header</code> å‹ç¼©ï¼Œè¿›ä¸€æ­¥çš„å‡å°‘äº†è¯·æ±‚çš„æ•°æ®å¤§å°</li></ul> <h3 id="_4-é¢„åŠ è½½"><a href="http://interview.poetries.top/docs/simply.html#_4-%E9%A2%84%E5%8A%A0%E8%BD%BD" class="header-anchor">#</a> 4 é¢„åŠ è½½</h3> <ul><li>åœ¨å¼€å‘ä¸­ï¼Œå¯èƒ½ä¼šé‡åˆ°è¿™æ ·çš„æƒ…å†µã€‚æœ‰äº›èµ„æºä¸éœ€è¦é©¬ä¸Šç”¨åˆ°ï¼Œä½†æ˜¯å¸Œæœ›å°½æ—©è·å–ï¼Œè¿™æ—¶å€™å°±å¯ä»¥ä½¿ç”¨é¢„åŠ è½½</li> <li>é¢„åŠ è½½å…¶å®æ˜¯å£°æ˜å¼çš„ <code>fetch</code> ï¼Œå¼ºåˆ¶æµè§ˆå™¨è¯·æ±‚èµ„æºï¼Œå¹¶ä¸”ä¸ä¼šé˜»å¡ <code>onload</code> äº‹ä»¶ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä»£ç å¼€å¯é¢„åŠ è½½</li></ul> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>preload<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://example.com<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
</code></pre></div><blockquote><p>é¢„åŠ è½½å¯ä»¥ä¸€å®šç¨‹åº¦ä¸Šé™ä½é¦–å±çš„åŠ è½½æ—¶é—´ï¼Œå› ä¸ºå¯ä»¥å°†ä¸€äº›ä¸å½±å“é¦–å±ä½†é‡è¦çš„æ–‡ä»¶å»¶ååŠ è½½ï¼Œå”¯ä¸€ç¼ºç‚¹å°±æ˜¯å…¼å®¹æ€§ä¸å¥½</p></blockquote> <h3 id="_5-é¢„æ¸²æŸ“"><a href="http://interview.poetries.top/docs/simply.html#_5-%E9%A2%84%E6%B8%B2%E6%9F%93" class="header-anchor">#</a> 5 é¢„æ¸²æŸ“</h3> <blockquote><p>å¯ä»¥é€šè¿‡é¢„æ¸²æŸ“å°†ä¸‹è½½çš„æ–‡ä»¶é¢„å…ˆåœ¨åå°æ¸²æŸ“ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä»£ç å¼€å¯é¢„æ¸²æŸ“</p></blockquote> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>prerender<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://poetries.com<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ul><li>é¢„æ¸²æŸ“è™½ç„¶å¯ä»¥æé«˜é¡µé¢çš„åŠ è½½é€Ÿåº¦ï¼Œä½†æ˜¯è¦ç¡®ä¿è¯¥é¡µé¢ç™¾åˆ†ç™¾ä¼šè¢«ç”¨æˆ·åœ¨ä¹‹åæ‰“å¼€ï¼Œå¦åˆ™å°±ç™½ç™½æµªè´¹èµ„æºå»æ¸²æŸ“</li></ul> <h3 id="_6-æ‡’æ‰§è¡Œä¸æ‡’åŠ è½½"><a href="http://interview.poetries.top/docs/simply.html#_6-%E6%87%92%E6%89%A7%E8%A1%8C%E4%B8%8E%E6%87%92%E5%8A%A0%E8%BD%BD" class="header-anchor">#</a> 6 æ‡’æ‰§è¡Œä¸æ‡’åŠ è½½</h3> <p><strong>æ‡’æ‰§è¡Œ</strong></p> <ul><li>æ‡’æ‰§è¡Œå°±æ˜¯å°†æŸäº›é€»è¾‘å»¶è¿Ÿåˆ°ä½¿ç”¨æ—¶å†è®¡ç®—ã€‚è¯¥æŠ€æœ¯å¯ä»¥ç”¨äºé¦–å±ä¼˜åŒ–ï¼Œå¯¹äºæŸäº›è€—æ—¶é€»è¾‘å¹¶ä¸éœ€è¦åœ¨é¦–å±å°±ä½¿ç”¨çš„ï¼Œå°±å¯ä»¥ä½¿ç”¨æ‡’æ‰§è¡Œã€‚æ‡’æ‰§è¡Œéœ€è¦å”¤é†’ï¼Œä¸€èˆ¬å¯ä»¥é€šè¿‡å®šæ—¶å™¨æˆ–è€…äº‹ä»¶çš„è°ƒç”¨æ¥å”¤é†’</li></ul> <p><strong>æ‡’åŠ è½½</strong></p> <ul><li>æ‡’åŠ è½½å°±æ˜¯å°†ä¸å…³é”®çš„èµ„æºå»¶ååŠ è½½</li></ul> <blockquote><p>æ‡’åŠ è½½çš„åŸç†å°±æ˜¯åªåŠ è½½è‡ªå®šä¹‰åŒºåŸŸï¼ˆé€šå¸¸æ˜¯å¯è§†åŒºåŸŸï¼Œä½†ä¹Ÿå¯ä»¥æ˜¯å³å°†è¿›å…¥å¯è§†åŒºåŸŸï¼‰å†…éœ€è¦åŠ è½½çš„ä¸œè¥¿ã€‚å¯¹äºå›¾ç‰‡æ¥è¯´ï¼Œå…ˆè®¾ç½®å›¾ç‰‡æ ‡ç­¾çš„ <code>src</code> å±æ€§ä¸ºä¸€å¼ å ä½å›¾ï¼Œå°†çœŸå®çš„å›¾ç‰‡èµ„æºæ”¾å…¥ä¸€ä¸ªè‡ªå®šä¹‰å±æ€§ä¸­ï¼Œå½“è¿›å…¥è‡ªå®šä¹‰åŒºåŸŸæ—¶ï¼Œå°±å°†è‡ªå®šä¹‰å±æ€§æ›¿æ¢ä¸º <code>src</code> å±æ€§ï¼Œè¿™æ ·å›¾ç‰‡å°±ä¼šå»ä¸‹è½½èµ„æºï¼Œå®ç°äº†å›¾ç‰‡æ‡’åŠ è½½</p></blockquote> <ul><li>æ‡’åŠ è½½ä¸ä»…å¯ä»¥ç”¨äºå›¾ç‰‡ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨åœ¨åˆ«çš„èµ„æºä¸Šã€‚æ¯”å¦‚è¿›å…¥å¯è§†åŒºåŸŸæ‰å¼€å§‹æ’­æ”¾è§†é¢‘ç­‰</li></ul> <h3 id="_7-æ–‡ä»¶ä¼˜åŒ–"><a href="http://interview.poetries.top/docs/simply.html#_7-%E6%96%87%E4%BB%B6%E4%BC%98%E5%8C%96" class="header-anchor">#</a> 7 æ–‡ä»¶ä¼˜åŒ–</h3> <p><strong>å›¾ç‰‡ä¼˜åŒ–</strong></p> <blockquote><p>å¯¹äºå¦‚ä½•ä¼˜åŒ–å›¾ç‰‡ï¼Œæœ‰ 2 ä¸ªæ€è·¯</p></blockquote> <ul><li>å‡å°‘åƒç´ ç‚¹</li> <li>å‡å°‘æ¯ä¸ªåƒç´ ç‚¹èƒ½å¤Ÿæ˜¾ç¤ºçš„é¢œè‰²</li></ul> <p><strong>å›¾ç‰‡åŠ è½½ä¼˜åŒ–</strong></p> <ul><li>ä¸ç”¨å›¾ç‰‡ã€‚å¾ˆå¤šæ—¶å€™ä¼šä½¿ç”¨åˆ°å¾ˆå¤šä¿®é¥°ç±»å›¾ç‰‡ï¼Œå…¶å®è¿™ç±»ä¿®é¥°å›¾ç‰‡å®Œå…¨å¯ä»¥ç”¨ <code>CSS</code> å»ä»£æ›¿ã€‚</li> <li>å¯¹äºç§»åŠ¨ç«¯æ¥è¯´ï¼Œå±å¹•å®½åº¦å°±é‚£ä¹ˆç‚¹ï¼Œå®Œå…¨æ²¡æœ‰å¿…è¦å»åŠ è½½åŸå›¾æµªè´¹å¸¦å®½ã€‚ä¸€èˆ¬å›¾ç‰‡éƒ½ç”¨ CDN åŠ è½½ï¼Œå¯ä»¥è®¡ç®—å‡ºé€‚é…å±å¹•çš„å®½åº¦ï¼Œç„¶åå»è¯·æ±‚ç›¸åº”è£å‰ªå¥½çš„å›¾ç‰‡</li> <li>å°å›¾ä½¿ç”¨ <code>base64</code>æ ¼å¼</li> <li>å°†å¤šä¸ªå›¾æ ‡æ–‡ä»¶æ•´åˆåˆ°ä¸€å¼ å›¾ç‰‡ä¸­ï¼ˆé›ªç¢§å›¾ï¼‰</li> <li>é€‰æ‹©æ­£ç¡®çš„å›¾ç‰‡æ ¼å¼ï¼š
<ul><li>å¯¹äºèƒ½å¤Ÿæ˜¾ç¤º <code>WebP</code> æ ¼å¼çš„æµè§ˆå™¨å°½é‡ä½¿ç”¨ <code>WebP</code> æ ¼å¼ã€‚å› ä¸º <code>WebP</code> æ ¼å¼å…·æœ‰æ›´å¥½çš„å›¾åƒæ•°æ®å‹ç¼©ç®—æ³•ï¼Œèƒ½å¸¦æ¥æ›´å°çš„å›¾ç‰‡ä½“ç§¯ï¼Œè€Œä¸”æ‹¥æœ‰è‚‰çœ¼è¯†åˆ«æ— å·®å¼‚çš„å›¾åƒè´¨é‡ï¼Œç¼ºç‚¹å°±æ˜¯å…¼å®¹æ€§å¹¶ä¸å¥½</li> <li>å°å›¾ä½¿ç”¨ <code>PNG</code>ï¼Œå…¶å®å¯¹äºå¤§éƒ¨åˆ†å›¾æ ‡è¿™ç±»å›¾ç‰‡ï¼Œå®Œå…¨å¯ä»¥ä½¿ç”¨ <code>SVG</code> ä»£æ›¿</li> <li>ç…§ç‰‡ä½¿ç”¨ <code>JPEG</code></li></ul></li></ul> <p><strong>å…¶ä»–æ–‡ä»¶ä¼˜åŒ–</strong></p> <ul><li><code>CSS</code>æ–‡ä»¶æ”¾åœ¨ <code>head</code> ä¸­</li> <li>æœåŠ¡ç«¯å¼€å¯æ–‡ä»¶å‹ç¼©åŠŸèƒ½</li> <li>å°† <code>script</code> æ ‡ç­¾æ”¾åœ¨ <code>body</code> åº•éƒ¨ï¼Œå› ä¸º <code>JS</code> æ–‡ä»¶æ‰§è¡Œä¼šé˜»å¡æ¸²æŸ“ã€‚å½“ç„¶ä¹Ÿå¯ä»¥æŠŠ <code>script</code> æ ‡ç­¾æ”¾åœ¨ä»»æ„ä½ç½®ç„¶ååŠ ä¸Š <code>defer</code> ï¼Œè¡¨ç¤ºè¯¥æ–‡ä»¶ä¼šå¹¶è¡Œä¸‹è½½ï¼Œä½†æ˜¯ä¼šæ”¾åˆ° <code>HTML</code> è§£æå®Œæˆåé¡ºåºæ‰§è¡Œã€‚å¯¹äºæ²¡æœ‰ä»»ä½•ä¾èµ–çš„ <code>JS</code>æ–‡ä»¶å¯ä»¥åŠ ä¸Š <code>async</code> ï¼Œè¡¨ç¤ºåŠ è½½å’Œæ¸²æŸ“åç»­æ–‡æ¡£å…ƒç´ çš„è¿‡ç¨‹å°†å’Œ <code>JS</code> æ–‡ä»¶çš„åŠ è½½ä¸æ‰§è¡Œå¹¶è¡Œæ— åºè¿›è¡Œã€‚
æ‰§è¡Œ <code>JS</code>ä»£ç è¿‡é•¿ä¼šå¡ä½æ¸²æŸ“ï¼Œå¯¹äºéœ€è¦å¾ˆå¤šæ—¶é—´è®¡ç®—çš„ä»£ç </li> <li>å¯ä»¥è€ƒè™‘ä½¿ç”¨ <code>Webworker</code>ã€‚<code>Webworker</code>å¯ä»¥è®©æˆ‘ä»¬å¦å¼€ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œè„šæœ¬è€Œä¸å½±å“æ¸²æŸ“ã€‚</li></ul> <p><strong>CDN</strong></p> <blockquote><p>é™æ€èµ„æºå°½é‡ä½¿ç”¨ <code>CDN</code> åŠ è½½ï¼Œç”±äºæµè§ˆå™¨å¯¹äºå•ä¸ªåŸŸåæœ‰å¹¶å‘è¯·æ±‚ä¸Šé™ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨å¤šä¸ª <code>CDN</code> åŸŸåã€‚å¯¹äº <code>CDN</code> åŠ è½½é™æ€èµ„æºéœ€è¦æ³¨æ„ <code>CDN</code> åŸŸåè¦ä¸ä¸»ç«™ä¸åŒï¼Œå¦åˆ™æ¯æ¬¡è¯·æ±‚éƒ½ä¼šå¸¦ä¸Šä¸»ç«™çš„ <code>Cookie</code></p></blockquote> <h3 id="_8-å…¶ä»–"><a href="http://interview.poetries.top/docs/simply.html#_8-%E5%85%B6%E4%BB%96" class="header-anchor">#</a> 8 å…¶ä»–</h3> <p><strong>ä½¿ç”¨ Webpack ä¼˜åŒ–é¡¹ç›®</strong></p> <ul><li>å¯¹äº <code>Webpack4</code>ï¼Œæ‰“åŒ…é¡¹ç›®ä½¿ç”¨ <code>production</code> æ¨¡å¼ï¼Œè¿™æ ·ä¼šè‡ªåŠ¨å¼€å¯ä»£ç å‹ç¼©</li> <li>ä½¿ç”¨ <code>ES6</code> æ¨¡å—æ¥å¼€å¯ <code>tree shaking</code>ï¼Œè¿™ä¸ªæŠ€æœ¯å¯ä»¥ç§»é™¤æ²¡æœ‰ä½¿ç”¨çš„ä»£ç </li> <li>ä¼˜åŒ–å›¾ç‰‡ï¼Œå¯¹äºå°å›¾å¯ä»¥ä½¿ç”¨ <code>base64</code> çš„æ–¹å¼å†™å…¥æ–‡ä»¶ä¸­</li> <li>æŒ‰ç…§è·¯ç”±æ‹†åˆ†ä»£ç ï¼Œå®ç°æŒ‰éœ€åŠ è½½</li> <li>ç»™æ‰“åŒ…å‡ºæ¥çš„æ–‡ä»¶åæ·»åŠ å“ˆå¸Œï¼Œå®ç°æµè§ˆå™¨ç¼“å­˜æ–‡ä»¶</li></ul> <p><strong>ç›‘æ§</strong></p> <blockquote><p>å¯¹äºä»£ç è¿è¡Œé”™è¯¯ï¼Œé€šå¸¸çš„åŠæ³•æ˜¯ä½¿ç”¨ <code>window.onerror</code> æ‹¦æˆªæŠ¥é”™ã€‚è¯¥æ–¹æ³•èƒ½æ‹¦æˆªåˆ°å¤§éƒ¨åˆ†çš„è¯¦ç»†æŠ¥é”™ä¿¡æ¯ï¼Œä½†æ˜¯ä¹Ÿæœ‰ä¾‹å¤–</p></blockquote> <ul><li>å¯¹äºè·¨åŸŸçš„ä»£ç è¿è¡Œé”™è¯¯ä¼šæ˜¾ç¤º <code>Script error</code>. å¯¹äºè¿™ç§æƒ…å†µæˆ‘ä»¬éœ€è¦ç»™ <code>script</code> æ ‡ç­¾æ·»åŠ  <code>crossorigin</code> å±æ€§</li> <li>å¯¹äºæŸäº›æµè§ˆå™¨å¯èƒ½ä¸ä¼šæ˜¾ç¤ºè°ƒç”¨æ ˆä¿¡æ¯ï¼Œè¿™ç§æƒ…å†µå¯ä»¥é€šè¿‡ <code>arguments.callee.caller</code> æ¥åšæ ˆé€’å½’</li> <li>å¯¹äºå¼‚æ­¥ä»£ç æ¥è¯´ï¼Œå¯ä»¥ä½¿ç”¨ <code>catch</code> çš„æ–¹å¼æ•è·é”™è¯¯ã€‚æ¯”å¦‚ <code>Promise</code> å¯ä»¥ç›´æ¥ä½¿ç”¨ catch å‡½æ•°ï¼Œ<code>async await</code> å¯ä»¥ä½¿ç”¨ <code>try catch</code></li> <li>ä½†æ˜¯è¦æ³¨æ„çº¿ä¸Šè¿è¡Œçš„ä»£ç éƒ½æ˜¯å‹ç¼©è¿‡çš„ï¼Œéœ€è¦åœ¨æ‰“åŒ…æ—¶ç”Ÿæˆ <code>sourceMap</code> æ–‡ä»¶ä¾¿äº <code>debug</code>ã€‚</li> <li>å¯¹äºæ•è·çš„é”™è¯¯éœ€è¦ä¸Šä¼ ç»™æœåŠ¡å™¨ï¼Œé€šå¸¸å¯ä»¥é€šè¿‡ <code>img</code> æ ‡ç­¾çš„ <code>src</code>å‘èµ·ä¸€ä¸ªè¯·æ±‚</li></ul> <h3 id="_9-webpackç¼–è¯‘ä¼˜åŒ–"><a href="http://interview.poetries.top/docs/simply.html#_9-webpack%E7%BC%96%E8%AF%91%E4%BC%98%E5%8C%96" class="header-anchor">#</a> 9 webpackç¼–è¯‘ä¼˜åŒ–</h3> <p><strong>ä»£ç ä¼˜åŒ–:</strong></p> <blockquote><p>æ— ç”¨ä»£ç æ¶ˆé™¤ï¼Œæ˜¯è®¸å¤šç¼–ç¨‹è¯­è¨€éƒ½å…·æœ‰çš„ä¼˜åŒ–æ‰‹æ®µï¼Œè¿™ä¸ªè¿‡ç¨‹ç§°ä¸º DCE (dead code elimination)ï¼Œå³ åˆ é™¤ä¸å¯èƒ½æ‰§è¡Œçš„ä»£ç ï¼›</p></blockquote> <p>ä¾‹å¦‚æˆ‘ä»¬çš„ <code>UglifyJs</code>ï¼Œå®ƒå°±ä¼šå¸®æˆ‘ä»¬åœ¨ç”Ÿäº§ç¯å¢ƒä¸­åˆ é™¤ä¸å¯èƒ½è¢«æ‰§è¡Œçš„ä»£ç ï¼Œä¾‹å¦‚:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> <span class="token function-variable function">fn</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token comment">// ä¸‹é¢ä»£ç ä¾¿å±äº ä¸å¯èƒ½æ‰§è¡Œçš„ä»£ç ï¼›</span>
	<span class="token comment">// é€šè¿‡ UglifyJs (Webpack4+ å·²å†…ç½®) ä¾¿ä¼šè¿›è¡Œ DCEï¼›</span>
	<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> a<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>æ‘‡æ ‘ä¼˜åŒ– (Tree-shaking)ï¼Œè¿™æ˜¯ä¸€ç§å½¢è±¡æ¯”å–»ã€‚æˆ‘ä»¬æŠŠæ‰“åŒ…åçš„ä»£ç æ¯”å–»æˆä¸€æ£µæ ‘ï¼Œè¿™é‡Œå…¶å®è¡¨ç¤ºçš„å°±æ˜¯ï¼Œé€šè¿‡å·¥å…· "æ‘‡" æˆ‘ä»¬æ‰“åŒ…åçš„ js ä»£ç ï¼Œå°†æ²¡æœ‰ä½¿ç”¨åˆ°çš„æ— ç”¨ä»£ç  "æ‘‡" ä¸‹æ¥ (åˆ é™¤)ã€‚å³ æ¶ˆé™¤é‚£äº›è¢« å¼•ç”¨äº†ä½†æœªè¢«ä½¿ç”¨ çš„æ¨¡å—ä»£ç ã€‚</p></blockquote> <ul><li>åŸç†: ç”±äºæ˜¯åœ¨ç¼–è¯‘æ—¶ä¼˜åŒ–ï¼Œå› æ­¤æœ€åŸºæœ¬çš„å‰æå°±æ˜¯è¯­æ³•çš„é™æ€åˆ†æï¼ŒES6çš„æ¨¡å—æœºåˆ¶ æä¾›äº†è¿™ç§å¯èƒ½æ€§ã€‚ä¸éœ€è¦è¿è¡Œæ—¶ï¼Œä¾¿å¯è¿›è¡Œä»£ç å­—é¢ä¸Šçš„é™æ€åˆ†æï¼Œç¡®å®šç›¸åº”çš„ä¾èµ–å…³ç³»ã€‚</li> <li>é—®é¢˜: å…·æœ‰ å‰¯ä½œç”¨ çš„å‡½æ•°æ— æ³•è¢« <code>tree-shaking</code> <ul><li>åœ¨å¼•ç”¨ä¸€äº›ç¬¬ä¸‰æ–¹åº“ï¼Œéœ€è¦å»è§‚å¯Ÿå…¶å¼•å…¥çš„ä»£ç é‡æ˜¯ä¸æ˜¯ç¬¦åˆé¢„æœŸï¼›</li> <li>å°½é‡å†™çº¯å‡½æ•°ï¼Œå‡å°‘å‡½æ•°çš„å‰¯ä½œç”¨ï¼›</li> <li>å¯ä½¿ç”¨ <code>webpack-deep-scope-plugin</code>ï¼Œå¯ä»¥è¿›è¡Œä½œç”¨åŸŸåˆ†æï¼Œå‡å°‘æ­¤ç±»æƒ…å†µçš„å‘ç”Ÿï¼Œä½†ä»éœ€è¦æ³¨æ„ï¼›</li></ul></li></ul> <p><strong>code-spliting: ä»£ç åˆ†å‰²æŠ€æœ¯</strong>ï¼Œå°†ä»£ç åˆ†å‰²æˆå¤šä»½è¿›è¡Œ æ‡’åŠ è½½ æˆ– å¼‚æ­¥åŠ è½½ï¼Œé¿å…æ‰“åŒ…æˆä¸€ä»½åå¯¼è‡´ä½“ç§¯è¿‡å¤§ï¼Œå½±å“é¡µé¢çš„é¦–å±åŠ è½½ï¼›</p> <ul><li><code>Webpack</code> ä¸­ä½¿ç”¨ <code>SplitChunksPlugin</code> è¿›è¡Œæ‹†åˆ†ï¼›</li> <li>æŒ‰ é¡µé¢ æ‹†åˆ†: ä¸åŒé¡µé¢æ‰“åŒ…æˆä¸åŒçš„æ–‡ä»¶ï¼›</li> <li>æŒ‰ åŠŸèƒ½ æ‹†åˆ†:
<ul><li>å°†ç±»ä¼¼äºæ’­æ”¾å™¨ï¼Œè®¡ç®—åº“ç­‰å¤§æ¨¡å—è¿›è¡Œæ‹†åˆ†åå†æ‡’åŠ è½½å¼•å…¥ï¼›</li> <li>æå–å¤ç”¨çš„ä¸šåŠ¡ä»£ç ï¼Œå‡å°‘å†—ä½™ä»£ç ï¼›</li></ul></li> <li>æŒ‰ æ–‡ä»¶ä¿®æ”¹é¢‘ç‡ æ‹†åˆ†: å°†ç¬¬ä¸‰æ–¹åº“ç­‰ä¸å¸¸ä¿®æ”¹çš„ä»£ç å•ç‹¬æ‰“åŒ…ï¼Œè€Œä¸”ä¸æ”¹å˜å…¶æ–‡ä»¶ hash å€¼ï¼Œèƒ½æœ€å¤§åŒ–è¿ç”¨æµè§ˆå™¨çš„ç¼“å­˜ï¼›</li></ul> <p><strong>scope hoisting</strong>: ä½œç”¨åŸŸæå‡ï¼Œå°†åˆ†æ•£çš„æ¨¡å—åˆ’åˆ†åˆ°åŒä¸€ä¸ªä½œç”¨åŸŸä¸­ï¼Œé¿å…äº†ä»£ç çš„é‡å¤å¼•å…¥ï¼Œæœ‰æ•ˆå‡å°‘æ‰“åŒ…åçš„ä»£ç ä½“ç§¯å’Œè¿è¡Œæ—¶çš„å†…å­˜æŸè€—ï¼›</p> <p><strong>ç¼–è¯‘æ€§èƒ½ä¼˜åŒ–:</strong></p> <ul><li>å‡çº§è‡³ æœ€æ–° ç‰ˆæœ¬çš„ <code>webpack</code>ï¼Œèƒ½æœ‰æ•ˆæå‡ç¼–è¯‘æ€§èƒ½ï¼›</li> <li>ä½¿ç”¨ <code>dev-server</code> / æ¨¡å—çƒ­æ›¿æ¢ (<code>HMR</code>) æå‡å¼€å‘ä½“éªŒï¼›
<ul><li>ç›‘å¬æ–‡ä»¶å˜åŠ¨ å¿½ç•¥ node_modules ç›®å½•èƒ½æœ‰æ•ˆæé«˜ç›‘å¬æ—¶çš„ç¼–è¯‘æ•ˆç‡ï¼›</li></ul></li> <li>ç¼©å°ç¼–è¯‘èŒƒå›´
<ul><li><code>modules</code>: æŒ‡å®šæ¨¡å—è·¯å¾„ï¼Œå‡å°‘é€’å½’æœç´¢ï¼›</li> <li><code>mainFields</code>: æŒ‡å®šå…¥å£æ–‡ä»¶æè¿°å­—æ®µï¼Œå‡å°‘æœç´¢ï¼›</li> <li><code>noParse</code>: é¿å…å¯¹éæ¨¡å—åŒ–æ–‡ä»¶çš„åŠ è½½ï¼›</li> <li><code>includes/exclude</code>: æŒ‡å®šæœç´¢èŒƒå›´/æ’é™¤ä¸å¿…è¦çš„æœç´¢èŒƒå›´ï¼›</li> <li><code>alias</code>: ç¼“å­˜ç›®å½•ï¼Œé¿å…é‡å¤å¯»å€ï¼›</li></ul></li> <li><code>babel-loader</code> <ul><li>å¿½ç•¥<code>node_moudles</code>ï¼Œé¿å…ç¼–è¯‘ç¬¬ä¸‰æ–¹åº“ä¸­å·²ç»è¢«ç¼–è¯‘è¿‡çš„ä»£ç </li> <li>ä½¿ç”¨<code>cacheDirectory</code>ï¼Œå¯ä»¥ç¼“å­˜ç¼–è¯‘ç»“æœï¼Œé¿å…å¤šæ¬¡é‡å¤ç¼–è¯‘</li></ul></li> <li>å¤šè¿›ç¨‹å¹¶å‘
<ul><li><code>webpack-parallel-uglify-plugin</code>: å¯å¤šè¿›ç¨‹å¹¶å‘å‹ç¼© js æ–‡ä»¶ï¼Œæé«˜å‹ç¼©é€Ÿåº¦ï¼›</li> <li><code>HappyPack</code>: å¤šè¿›ç¨‹å¹¶å‘æ–‡ä»¶çš„ <code>Loader</code> è§£æï¼›</li></ul></li> <li>ç¬¬ä¸‰æ–¹åº“æ¨¡å—ç¼“å­˜:
<ul><li><code>DLLPlugin</code> å’Œ <code>DLLReferencePlugin</code> å¯ä»¥æå‰è¿›è¡Œæ‰“åŒ…å¹¶ç¼“å­˜ï¼Œé¿å…æ¯æ¬¡éƒ½é‡æ–°ç¼–è¯‘ï¼›</li></ul></li> <li>ä½¿ç”¨åˆ†æ
<ul><li><code>Webpack Analyse / webpack-bundle-analyzer</code> å¯¹æ‰“åŒ…åçš„æ–‡ä»¶è¿›è¡Œåˆ†æï¼Œå¯»æ‰¾å¯ä¼˜åŒ–çš„åœ°æ–¹</li> <li>é…ç½®profileï¼štrueï¼Œå¯¹å„ä¸ªç¼–è¯‘é˜¶æ®µè€—æ—¶è¿›è¡Œç›‘æ§ï¼Œå¯»æ‰¾è€—æ—¶æœ€å¤šçš„åœ°æ–¹</li></ul></li> <li><code>source-map</code>:
<ul><li>å¼€å‘: <code>cheap-module-eval-source-map</code></li> <li>ç”Ÿäº§: <code>hidden-source-map</code>ï¼›</li></ul></li></ul> <p><strong>ä¼˜åŒ–webpackæ‰“åŒ…é€Ÿåº¦</strong></p> <ul><li>å‡å°‘æ–‡ä»¶æœç´¢èŒƒå›´
<ul><li>æ¯”å¦‚é€šè¿‡åˆ«å</li> <li><code>loader</code> çš„ <code>test</code>ï¼Œ<code>include &amp; exclude</code></li></ul></li> <li><code>Webpack4</code> é»˜è®¤å‹ç¼©å¹¶è¡Œ</li> <li><code>Happypack</code> å¹¶å‘è°ƒç”¨</li> <li><code>babel</code> ä¹Ÿå¯ä»¥ç¼“å­˜ç¼–è¯‘</li> <li>ä½¿ç”¨<code>DllPlugin</code>ï¼Œä¸ç”¨æ¯æ¬¡éƒ½é‡æ–°æ„å»º</li></ul> <p><strong>ä¼˜åŒ–æ‰“åŒ…ä½“ç§¯</strong></p> <ul><li>æå–ç¬¬ä¸‰æ–¹åº“æˆ–é€šè¿‡å¼•ç”¨å¤–éƒ¨æ–‡ä»¶çš„æ–¹å¼å¼•å…¥ç¬¬ä¸‰æ–¹åº“</li> <li>ä»£ç å‹ç¼©æ’ä»¶<code>UglifyJsPlugin</code></li> <li>æœåŠ¡å™¨å¯ç”¨gzipå‹ç¼©</li> <li>æŒ‰éœ€åŠ è½½èµ„æºæ–‡ä»¶ <code>require.ensure</code></li> <li>ä¼˜åŒ–<code>devtool</code>ä¸­çš„<code>source-map</code></li> <li>å‰¥ç¦»<code>css</code>æ–‡ä»¶ï¼Œå•ç‹¬æ‰“åŒ…</li> <li>å»é™¤ä¸å¿…è¦æ’ä»¶ï¼Œé€šå¸¸å°±æ˜¯å¼€å‘ç¯å¢ƒä¸ç”Ÿäº§ç¯å¢ƒç”¨åŒä¸€å¥—é…ç½®æ–‡ä»¶å¯¼è‡´</li> <li>å¼€å¯ <code>scope hosting</code> <ul><li>ä½“ç§¯æ›´å°</li> <li>åˆ›å»ºå‡½æ•°ä½œç”¨åŸŸæ›´å°</li> <li>ä»£ç å¯è¯»æ€§æ›´å¥½</li></ul></li></ul> <p><img src="./è¿›é˜¶_files/20210409165629.png" alt="" class="medium-zoom-image"> <img src="./è¿›é˜¶_files/20210409165723.png" alt="" class="medium-zoom-image"></p> <h3 id="_10-å¦‚ä½•æ ¹æ®chromeçš„timingä¼˜åŒ–"><a href="http://interview.poetries.top/docs/simply.html#_10-%E5%A6%82%E4%BD%95%E6%A0%B9%E6%8D%AEchrome%E7%9A%84timing%E4%BC%98%E5%8C%96" class="header-anchor">#</a> 10 å¦‚ä½•æ ¹æ®chromeçš„timingä¼˜åŒ–</h3> <p><strong>æ€§èƒ½ä¼˜åŒ–API</strong></p> <ul><li><code>Performance</code>ã€‚<code>performance.now()</code>ä¸<code>new Date()</code>åŒºåˆ«ï¼Œå®ƒæ˜¯é«˜ç²¾åº¦çš„ï¼Œä¸”æ˜¯ç›¸å¯¹æ—¶é—´ï¼Œç›¸å¯¹äºé¡µé¢åŠ è½½çš„é‚£ä¸€åˆ»ã€‚ä½†æ˜¯ä¸ä¸€å®šé€‚åˆå•é¡µé¢åœºæ™¯</li> <li><code>window.addEventListener("load", "");</code> <code>window.addEventListener("domContentLoaded", "");</code></li> <li><code>Img</code>çš„<code>onload</code>äº‹ä»¶ï¼Œç›‘å¬é¦–å±å†…çš„å›¾ç‰‡æ˜¯å¦åŠ è½½å®Œæˆï¼Œåˆ¤æ–­é¦–å±äº‹ä»¶</li> <li><code>RequestFrameAnmation</code> å’Œ <code>RequestIdleCallback</code></li> <li><code>IntersectionObserver</code>ã€<code>MutationObserver</code>ï¼Œ<code>PostMessage</code></li> <li><code>Web Worker</code>ï¼Œè€—æ—¶ä»»åŠ¡æ”¾åœ¨é‡Œé¢æ‰§è¡Œ</li></ul> <p><strong>æ£€æµ‹å·¥å…·</strong></p> <ul><li><code>Chrome Dev Tools</code></li> <li><code>Page Speed</code></li> <li><code>Jspref</code></li></ul> <p><strong>å‰ç«¯æŒ‡æ ‡</strong></p> <p><img src="./è¿›é˜¶_files/image-20210307184052955.png" alt="image-20210307184052955" class="medium-zoom-image"></p> <div class="language-js extra-class"><pre class="language-js"><code>window<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">let</span> t <span class="token operator">=</span> performance<span class="token punctuation">.</span>timing
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'DNSæŸ¥è¯¢è€—æ—¶ ï¼š'</span> <span class="token operator">+</span> <span class="token punctuation">(</span>t<span class="token punctuation">.</span>domainLookupEnd <span class="token operator">-</span> t<span class="token punctuation">.</span>domainLookupStart<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'TCPé“¾æ¥è€—æ—¶ ï¼š'</span> <span class="token operator">+</span> <span class="token punctuation">(</span>t<span class="token punctuation">.</span>connectEnd <span class="token operator">-</span> t<span class="token punctuation">.</span>connectStart<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'requestè¯·æ±‚è€—æ—¶ ï¼š'</span> <span class="token operator">+</span> <span class="token punctuation">(</span>t<span class="token punctuation">.</span>responseEnd <span class="token operator">-</span> t<span class="token punctuation">.</span>responseStart<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'è§£ædomæ ‘è€—æ—¶ ï¼š'</span> <span class="token operator">+</span> <span class="token punctuation">(</span>t<span class="token punctuation">.</span>domComplete <span class="token operator">-</span> t<span class="token punctuation">.</span>domInteractive<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'ç™½å±æ—¶é—´ ï¼š'</span> <span class="token operator">+</span> <span class="token punctuation">(</span>t<span class="token punctuation">.</span>responseStart <span class="token operator">-</span> t<span class="token punctuation">.</span>navigationStart<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'domreadyæ—¶é—´ ï¼š'</span> <span class="token operator">+</span> <span class="token punctuation">(</span>t<span class="token punctuation">.</span>domContentLoadedEventEnd <span class="token operator">-</span> t<span class="token punctuation">.</span>navigationStart<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'onloadæ—¶é—´ ï¼š'</span> <span class="token operator">+</span> <span class="token punctuation">(</span>t<span class="token punctuation">.</span>loadEventEnd <span class="token operator">-</span> t<span class="token punctuation">.</span>navigationStart<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

        <span class="token keyword">if</span><span class="token punctuation">(</span>t <span class="token operator">=</span> performance<span class="token punctuation">.</span>memory<span class="token punctuation">)</span><span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'jså†…å­˜ä½¿ç”¨å æ¯” ï¼š'</span> <span class="token operator">+</span> <span class="token punctuation">(</span>t<span class="token punctuation">.</span>usedJSHeapSize <span class="token operator">/</span> t<span class="token punctuation">.</span>totalJSHeapSize <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'%'</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>DNSé¢„è§£æä¼˜åŒ–</strong></p> <blockquote><p>dnsè§£ææ˜¯å¾ˆè€—æ—¶çš„ï¼Œå› æ­¤å¦‚æœè§£æåŸŸåè¿‡å¤šï¼Œä¼šè®©é¦–å±åŠ è½½å˜å¾—è¿‡æ…¢ï¼Œå¯ä»¥è€ƒè™‘dns-prefetchä¼˜åŒ–</p></blockquote> <p><code>DNS Prefetch</code> åº”è¯¥å°½é‡çš„æ”¾åœ¨ç½‘é¡µçš„å‰é¢ï¼Œæ¨èæ”¾åœ¨ åé¢ã€‚å…·ä½“ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>x-dns-prefetch-control<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>on<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dns-prefetch<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>//www.zhix.net<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dns-prefetch<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>//api.share.zhix.net<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dns-prefetch<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>//bdimg.share.zhix.net<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p><strong>requestè¯·æ±‚è€—æ—¶</strong></p> <ul><li>ä¸è¯·æ±‚ï¼Œç”¨cacheï¼ˆæœ€å¥½çš„æ–¹å¼å°±æ˜¯å°½é‡å¼•ç”¨å…¬å…±èµ„æºï¼ŒåŒæ—¶è®¾ç½®ç¼“å­˜ï¼Œä¸å»é‡æ–°è¯·æ±‚èµ„æºï¼Œä¹Ÿå¯ä»¥è¿ç”¨PWAçš„ç¦»çº¿ç¼“å­˜æŠ€æœ¯ï¼Œå¯ä»¥å¸®åŠ©wepå®ç°ç¦»çº¿ä½¿ç”¨ï¼‰</li> <li>å‰ç«¯æ‰“åŒ…æ—¶å‹ç¼©</li> <li>æœåŠ¡å™¨ä¸Šçš„zipå‹ç¼©</li> <li>å›¾ç‰‡å‹ç¼©ï¼ˆæ¯”å¦‚tinyï¼‰ï¼Œä½¿ç”¨webpç­‰é«˜å‹ç¼©æ¯”æ ¼å¼</li> <li>æŠŠè¿‡å¤§çš„åŒ…ï¼Œæ‹†åˆ†æˆå¤šä¸ªè¾ƒå°‘çš„åŒ…ï¼Œé˜²æ­¢å•ä¸ªèµ„æºè€—æ—¶è¿‡å¤§</li> <li>åŒä¸€æ—¶é—´é’ˆå¯¹åŒä¸€åŸŸåä¸‹çš„è¯·æ±‚æœ‰ä¸€å®šæ•°é‡é™åˆ¶ï¼Œè¶…è¿‡é™åˆ¶æ•°ç›®çš„è¯·æ±‚ä¼šè¢«é˜»å¡ã€‚å¦‚æœèµ„æºæ¥è‡ªäºå¤šä¸ªåŸŸä¸‹ï¼Œå¯ä»¥å¢å¤§å¹¶è¡Œè¯·æ±‚å’Œä¸‹è½½é€Ÿåº¦</li> <li>å»¶è¿Ÿã€å¼‚æ­¥ã€é¢„åŠ è½½ã€æ‡’åŠ è½½</li> <li>å¯¹äºéé¦–å±çš„èµ„æºï¼Œå¯ä»¥ä½¿ç”¨ defer æˆ– async çš„æ–¹å¼å¼•å…¥</li> <li>ä¹Ÿå¯ä»¥æŒ‰éœ€åŠ è½½ï¼Œåœ¨é€»è¾‘ä¸­ï¼Œåªæœ‰æ‰§è¡Œåˆ°æ—¶æ‰åšè¯·æ±‚</li> <li>å¯¹äºå¤šå±é¡µé¢ï¼Œæ»šåŠ¨æ—¶æ‰åŠ¨æ€è½½å…¥å›¾ç‰‡</li></ul> <h3 id="_11-ç§»åŠ¨ç«¯ä¼˜åŒ–"><a href="http://interview.poetries.top/docs/simply.html#_11-%E7%A7%BB%E5%8A%A8%E7%AB%AF%E4%BC%98%E5%8C%96" class="header-anchor">#</a> 11 ç§»åŠ¨ç«¯ä¼˜åŒ–</h3> <p><img src="./è¿›é˜¶_files/462322984-553e3da07b565_articlex" alt="img" class="medium-zoom-image"></p> <p><strong>1. æ¦‚è¿°</strong></p> <ul><li><code>PC</code>ä¼˜åŒ–æ‰‹æ®µåœ¨<code>Mobile</code>ä¾§åŒæ ·é€‚ç”¨</li> <li>åœ¨<code>Mobile</code>ä¾§æˆ‘ä»¬æå‡ºä¸‰ç§’ç§æ¸²æŸ“å®Œæˆé¦–å±æŒ‡æ ‡</li> <li>åŸºäºç¬¬äºŒç‚¹ï¼Œé¦–å±åŠ è½½<code>3</code>ç§’å®Œæˆæˆ–ä½¿ç”¨<code>Loading</code></li> <li>åŸºäºè”é€š3Gç½‘ç»œå¹³å‡<code>338KB/s(2.71Mb/s</code>ï¼‰ï¼Œæ‰€ä»¥é¦–å±èµ„æºä¸åº”è¶…è¿‡<code>1014KB</code></li> <li><code>Mobile</code>ä¾§å› æ‰‹æœºé…ç½®åŸå› ï¼Œé™¤åŠ è½½å¤–æ¸²æŸ“é€Ÿåº¦ä¹Ÿæ˜¯ä¼˜åŒ–é‡ç‚¹</li> <li>åŸºäºç¬¬äº”ç‚¹ï¼Œè¦åˆç†å¤„ç†ä»£ç å‡å°‘æ¸²æŸ“æŸè€—</li> <li>åŸºäºç¬¬äºŒã€ç¬¬äº”ç‚¹ï¼Œæ‰€æœ‰å½±å“é¦–å±åŠ è½½å’Œæ¸²æŸ“çš„ä»£ç åº”åœ¨å¤„ç†é€»è¾‘ä¸­åç½®</li> <li>åŠ è½½å®Œæˆåç”¨æˆ·äº¤äº’ä½¿ç”¨æ—¶ä¹Ÿéœ€æ³¨æ„æ€§èƒ½</li></ul> <p><strong>2. åŠ è½½ä¼˜åŒ–</strong></p> <blockquote><p>åŠ è½½è¿‡ç¨‹æ˜¯æœ€ä¸ºè€—æ—¶çš„è¿‡ç¨‹ï¼Œå¯èƒ½ä¼šå åˆ°æ€»è€—æ—¶çš„<code>80%</code>æ—¶é—´ï¼Œå› æ­¤æ˜¯ä¼˜åŒ–çš„é‡ç‚¹</p></blockquote> <p><strong>2.1 ç¼“å­˜</strong></p> <blockquote><p>ä½¿ç”¨ç¼“å­˜å¯ä»¥å‡å°‘å‘æœåŠ¡å™¨çš„è¯·æ±‚æ•°ï¼ŒèŠ‚çœåŠ è½½æ—¶é—´ï¼Œæ‰€ä»¥æ‰€æœ‰é™æ€èµ„æºéƒ½è¦åœ¨æœåŠ¡å™¨ç«¯è®¾ç½®ç¼“å­˜ï¼Œå¹¶ä¸”å°½é‡ä½¿ç”¨é•¿<code>Cache</code>ï¼ˆé•¿<code>Cache</code>èµ„æºçš„æ›´æ–°å¯ä½¿ç”¨æ—¶é—´æˆ³ï¼‰</p></blockquote> <p><strong>2.2 å‹ç¼©HTMLã€CSSã€JavaScript</strong></p> <blockquote><p>å‡å°‘èµ„æºå¤§å°å¯ä»¥åŠ å¿«ç½‘é¡µæ˜¾ç¤ºé€Ÿåº¦ï¼Œæ‰€ä»¥è¦å¯¹<code>HTML</code>ã€<code>CSS</code>ã€<code>JavaScript</code>ç­‰è¿›è¡Œä»£ç å‹ç¼©ï¼Œå¹¶åœ¨æœåŠ¡å™¨ç«¯è®¾ç½®<code>GZip</code></p></blockquote> <ul><li>aï¼‰ å‹ç¼©ï¼ˆä¾‹å¦‚ï¼Œå¤šä½™çš„ç©ºæ ¼ã€æ¢è¡Œç¬¦å’Œç¼©è¿›ï¼‰</li> <li>bï¼‰ å¯ç”¨<code>GZip</code></li></ul> <p><strong>2.3 æ— é˜»å¡</strong></p> <blockquote><p>å†™åœ¨<code>HTML</code>å¤´éƒ¨çš„<code>JavaScript</code>ï¼ˆæ— å¼‚æ­¥ï¼‰ï¼Œå’Œå†™åœ¨<code>HTML</code>æ ‡ç­¾ä¸­çš„<code>Style</code>ä¼šé˜»å¡é¡µé¢çš„æ¸²æŸ“ï¼Œå› æ­¤<code>CSS</code>æ”¾åœ¨é¡µé¢å¤´éƒ¨å¹¶ä½¿ç”¨<code>Link</code>æ–¹å¼å¼•å…¥ï¼Œé¿å…åœ¨<code>HTML</code>æ ‡ç­¾ä¸­å†™<code>Style</code>ï¼Œ<code>JavaScript</code>æ”¾åœ¨é¡µé¢å°¾éƒ¨æˆ–ä½¿ç”¨å¼‚æ­¥æ–¹å¼åŠ è½½</p></blockquote> <p><strong>2.4 ä½¿ç”¨é¦–å±åŠ è½½</strong></p> <blockquote><p>é¦–å±çš„å¿«é€Ÿæ˜¾ç¤ºï¼Œå¯ä»¥å¤§å¤§æå‡ç”¨æˆ·å¯¹é¡µé¢é€Ÿåº¦çš„æ„ŸçŸ¥ï¼Œå› æ­¤åº”å°½é‡é’ˆå¯¹é¦–å±çš„å¿«é€Ÿæ˜¾ç¤ºåšä¼˜åŒ–ã€‚</p></blockquote> <p><strong>2.5 æŒ‰éœ€åŠ è½½</strong></p> <blockquote><p>å°†ä¸å½±å“é¦–å±çš„èµ„æºå’Œå½“å‰å±å¹•èµ„æºä¸ç”¨çš„èµ„æºæ”¾åˆ°ç”¨æˆ·éœ€è¦æ—¶æ‰åŠ è½½ï¼Œå¯ä»¥å¤§å¤§æå‡é‡è¦èµ„æºçš„æ˜¾ç¤ºé€Ÿåº¦å’Œé™ä½æ€»ä½“æµé‡ã€‚</p></blockquote> <p><strong>PSï¼šæŒ‰éœ€åŠ è½½ä¼šå¯¼è‡´å¤§é‡é‡ç»˜ï¼Œå½±å“æ¸²æŸ“æ€§èƒ½</strong></p> <ul><li>aï¼‰ <code>LazyLoad</code></li> <li>bï¼‰ æ»šå±åŠ è½½</li> <li>cï¼‰ é€šè¿‡<code>Media Query</code>åŠ è½½</li></ul> <p><strong>2.6 é¢„åŠ è½½</strong></p> <blockquote><p>å¤§å‹é‡èµ„æºé¡µé¢ï¼ˆå¦‚æ¸¸æˆï¼‰å¯ä½¿ç”¨å¢åŠ <code>Loading</code>çš„æ–¹æ³•ï¼Œèµ„æºåŠ è½½å®Œæˆåå†æ˜¾ç¤ºé¡µé¢ã€‚ä½†<code>Loading</code>æ—¶é—´è¿‡é•¿ï¼Œä¼šé€ æˆç”¨æˆ·æµå¤±ã€‚</p></blockquote> <p>å¯¹ç”¨æˆ·è¡Œä¸ºåˆ†æï¼Œå¯ä»¥åœ¨å½“å‰é¡µåŠ è½½ä¸‹ä¸€é¡µèµ„æºï¼Œæå‡é€Ÿåº¦ã€‚</p> <ul><li>aï¼‰å¯æ„ŸçŸ¥<code>Loading</code></li> <li>bï¼‰ä¸å¯æ„ŸçŸ¥çš„<code>Loading</code>ï¼ˆå¦‚æå‰åŠ è½½ä¸‹ä¸€é¡µï¼‰</li></ul> <p><strong>2.7 å‹ç¼©å›¾ç‰‡</strong></p> <blockquote><p>å›¾ç‰‡æ˜¯æœ€å æµé‡çš„èµ„æºï¼Œå› æ­¤å°½é‡é¿å…ä½¿ç”¨ä»–ï¼Œä½¿ç”¨æ—¶é€‰æ‹©æœ€åˆé€‚çš„æ ¼å¼ï¼ˆå®ç°éœ€æ±‚çš„å‰æä¸‹ï¼Œä»¥å¤§å°åˆ¤æ–­ï¼‰ï¼Œåˆé€‚çš„å¤§å°ï¼Œç„¶åä½¿ç”¨æ™ºå›¾å‹ç¼©ï¼ŒåŒæ—¶åœ¨ä»£ç ä¸­ç”¨<code>Srcset</code>æ¥æŒ‰éœ€æ˜¾ç¤º</p></blockquote> <p><strong>PSï¼šè¿‡åº¦å‹ç¼©å›¾ç‰‡å¤§å°å½±å“å›¾ç‰‡æ˜¾ç¤ºæ•ˆæœ</strong></p> <ul><li>aï¼‰ä½¿ç”¨æ™ºå›¾ï¼ˆ http://zhitu.tencent.com/ ï¼‰</li> <li>bï¼‰ä½¿ç”¨å…¶å®ƒæ–¹å¼ä»£æ›¿å›¾ç‰‡(1. ä½¿ç”¨<code>CSS3</code> 2. ä½¿ç”¨<code>SVG</code> 3. ä½¿ç”¨<code>IconFont</code>ï¼‰</li> <li>cï¼‰ä½¿ç”¨<code>Srcset</code></li> <li>dï¼‰é€‰æ‹©åˆé€‚çš„å›¾ç‰‡(1. <code>webP</code>ä¼˜äº<code>JPG</code>2. <code>PNG8</code>ä¼˜äº<code>GIF</code>ï¼‰</li> <li>eï¼‰é€‰æ‹©åˆé€‚çš„å¤§å°ï¼ˆ1. é¦–æ¬¡åŠ è½½ä¸å¤§äº<code>1014KB</code> 2. ä¸å®½äº<code>640</code>ï¼ˆåŸºäºæ‰‹æœºå±å¹•ä¸€èˆ¬å®½åº¦ï¼‰ï¼‰</li></ul> <p><strong>2.8 å‡å°‘Cookie</strong></p> <blockquote><p><code>Cookie</code>ä¼šå½±å“åŠ è½½é€Ÿåº¦ï¼Œæ‰€ä»¥é™æ€èµ„æºåŸŸåä¸ä½¿ç”¨<code>Cookie</code>ã€‚</p></blockquote> <p><strong>2.9 é¿å…é‡å®šå‘</strong></p> <p>é‡å®šå‘ä¼šå½±å“åŠ è½½é€Ÿåº¦ï¼Œæ‰€ä»¥åœ¨æœåŠ¡å™¨æ­£ç¡®è®¾ç½®é¿å…é‡å®šå‘ã€‚</p> <p><strong>2.10 å¼‚æ­¥åŠ è½½ç¬¬ä¸‰æ–¹èµ„æº</strong></p> <p>ç¬¬ä¸‰æ–¹èµ„æºä¸å¯æ§ä¼šå½±å“é¡µé¢çš„åŠ è½½å’Œæ˜¾ç¤ºï¼Œå› æ­¤è¦å¼‚æ­¥åŠ è½½ç¬¬ä¸‰æ–¹èµ„æº</p> <p><strong>2.11 å‡å°‘HTTPè¯·æ±‚</strong></p> <blockquote><p>å› ä¸ºæ‰‹æœºæµè§ˆå™¨åŒæ—¶å“åº”è¯·æ±‚ä¸º4ä¸ªè¯·æ±‚ï¼ˆ<code>Android</code>æ”¯æŒ4ä¸ªï¼Œ<code>iOS</code> 5åå¯æ”¯æŒ6ä¸ªï¼‰ï¼Œæ‰€ä»¥è¦å°½é‡å‡å°‘é¡µé¢çš„è¯·æ±‚æ•°ï¼Œé¦–æ¬¡åŠ è½½åŒæ—¶è¯·æ±‚æ•°ä¸èƒ½è¶…è¿‡4ä¸ª</p></blockquote> <ul><li>aï¼‰åˆå¹¶<code>CSS</code>ã€<code>JavaScript</code></li> <li>bï¼‰åˆå¹¶å°å›¾ç‰‡ï¼Œä½¿ç”¨é›ªç¢§å›¾</li></ul> <p><strong>3. ä¸‰ã€è„šæœ¬æ‰§è¡Œä¼˜åŒ–</strong></p> <blockquote><p>è„šæœ¬å¤„ç†ä¸å½“ä¼šé˜»å¡é¡µé¢åŠ è½½ã€æ¸²æŸ“ï¼Œå› æ­¤åœ¨ä½¿ç”¨æ—¶éœ€å½“æ³¨æ„</p></blockquote> <ul><li><code>CSS</code>å†™åœ¨å¤´éƒ¨ï¼Œ<code>JavaScript</code>å†™åœ¨å°¾éƒ¨æˆ–å¼‚æ­¥</li> <li>é¿å…å›¾ç‰‡å’Œ<code>iFrame</code>ç­‰çš„ç©º<code>Src</code>ï¼Œç©º<code>Src</code>ä¼šé‡æ–°åŠ è½½å½“å‰é¡µé¢ï¼Œå½±å“é€Ÿåº¦å’Œæ•ˆç‡ã€‚</li> <li>å°½é‡é¿å…é‡è®¾å›¾ç‰‡å¤§å°</li> <li>é‡è®¾å›¾ç‰‡å¤§å°æ˜¯æŒ‡åœ¨é¡µé¢ã€<code>CSS</code>ã€J<code>avaScript</code>ç­‰ä¸­å¤šæ¬¡é‡ç½®å›¾ç‰‡å¤§å°ï¼Œå¤šæ¬¡é‡è®¾å›¾ç‰‡å¤§å°ä¼šå¼•å‘å›¾ç‰‡çš„å¤šæ¬¡é‡ç»˜ï¼Œå½±å“æ€§èƒ½</li> <li>å›¾ç‰‡å°½é‡é¿å…ä½¿ç”¨<code>DataURL</code>ï¼Œ<code>DataURL</code>å›¾ç‰‡æ²¡æœ‰ä½¿ç”¨å›¾ç‰‡çš„å‹ç¼©ç®—æ³•æ–‡ä»¶ä¼šå˜å¤§ï¼Œå¹¶ä¸”è¦è§£ç åå†æ¸²æŸ“ï¼ŒåŠ è½½æ…¢è€—æ—¶é•¿</li></ul> <p><strong>4. CSSä¼˜åŒ–</strong></p> <blockquote><p>å°½é‡é¿å…å†™åœ¨HTMLæ ‡ç­¾ä¸­å†™<code>Style</code>å±æ€§</p></blockquote> <p><strong>4.1 css3è¿‡æ¸¡åŠ¨ç”»å¼€å¯ç¡¬ä»¶åŠ é€Ÿ</strong></p> <div class="language- extra-class"><pre class="language-text"><code>.translate3d{
   -webkit-transform: translate3d(0, 0, 0);
   -moz-transform: translate3d(0, 0, 0);
   -ms-transform: translate3d(0, 0, 0);
   transform: translate3d(0, 0, 0);
 }
</code></pre></div><p><strong>4.2 é¿å…CSSè¡¨è¾¾å¼</strong></p> <p>CSSè¡¨è¾¾å¼çš„æ‰§è¡Œéœ€è·³å‡ºCSSæ ‘çš„æ¸²æŸ“ï¼Œå› æ­¤è¯·é¿å…CSSè¡¨è¾¾å¼ã€‚</p> <p><strong>4.3 ä¸æ»¥ç”¨Float</strong></p> <p>Floatåœ¨æ¸²æŸ“æ—¶è®¡ç®—é‡æ¯”è¾ƒå¤§ï¼Œå°½é‡å‡å°‘ä½¿ç”¨</p> <p><strong>4.4 å€¼ä¸º0æ—¶ä¸éœ€è¦ä»»ä½•å•ä½</strong></p> <p>ä¸ºäº†æµè§ˆå™¨çš„å…¼å®¹æ€§å’Œæ€§èƒ½ï¼Œå€¼ä¸º<code>0</code>æ—¶ä¸è¦å¸¦å•ä½</p> <p><strong>5. JavaScriptæ‰§è¡Œä¼˜åŒ–</strong></p> <p><strong>5.1 å‡å°‘é‡ç»˜å’Œå›æµ</strong></p> <ul><li>é¿å…ä¸å¿…è¦çš„Domæ“ä½œ</li> <li>å°½é‡æ”¹å˜<code>Class</code>è€Œä¸æ˜¯<code>Style</code>ï¼Œä½¿ç”¨<code>classList</code>ä»£æ›¿<code>className</code></li> <li>é¿å…ä½¿ç”¨<code>document.write</code></li> <li>å‡å°‘<code>drawImage</code></li></ul> <p><strong>5.2 TOUCHäº‹ä»¶ä¼˜åŒ–</strong></p> <blockquote><p>ä½¿ç”¨<code>touchstart</code>ã€<code>touchend</code>ä»£æ›¿<code>click</code>ï¼Œå› å¿«å½±å“é€Ÿåº¦å¿«ã€‚ä½†åº”æ³¨æ„<code>Touch</code>å“åº”è¿‡å¿«ï¼Œæ˜“å¼•å‘è¯¯æ“ä½œ</p></blockquote> <p><strong>6. æ¸²æŸ“ä¼˜åŒ–</strong></p> <p><strong>6.1 HTMLä½¿ç”¨Viewport</strong></p> <p><strong>Viewportå¯ä»¥åŠ é€Ÿé¡µé¢çš„æ¸²æŸ“ï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹ä»£ç </strong></p> <div class="language- extra-class"><pre class="language-text"><code>&lt;meta name=â€viewportâ€ content=â€width=device-width, initial-scale=1â€³&gt;
</code></pre></div><p><strong>6.2 åŠ¨ç”»ä¼˜åŒ–</strong></p> <ul><li>å°½é‡ä½¿ç”¨<code>CSS3</code>åŠ¨ç”»</li> <li>åˆç†ä½¿ç”¨<code>requestAnimationFrame</code>åŠ¨ç”»ä»£æ›¿<code>setTimeout</code></li> <li>é€‚å½“ä½¿ç”¨<code>Canvas</code>åŠ¨ç”» <code>5</code>ä¸ªå…ƒç´ ä»¥å†…ä½¿ç”¨<code>css</code>åŠ¨ç”»ï¼Œ<code>5</code>ä¸ªä»¥ä¸Šä½¿ç”¨<code>Canvas</code>åŠ¨ç”»ï¼ˆ<code>iOS8</code>å¯ä½¿ç”¨<code>webGL</code>ï¼‰</li></ul> <p><strong>6.3 é«˜é¢‘äº‹ä»¶ä¼˜åŒ–</strong></p> <blockquote><p><code>Touchmove</code>ã€<code>Scroll</code> äº‹ä»¶å¯å¯¼è‡´å¤šæ¬¡æ¸²æŸ“</p></blockquote> <ul><li>ä½¿ç”¨<code>requestAnimationFrame</code>ç›‘å¬å¸§å˜åŒ–ï¼Œä½¿å¾—åœ¨æ­£ç¡®çš„æ—¶é—´è¿›è¡Œæ¸²æŸ“</li> <li>å¢åŠ å“åº”å˜åŒ–çš„æ—¶é—´é—´éš”ï¼Œå‡å°‘é‡ç»˜æ¬¡æ•°</li></ul> <p><strong>6.4 GPUåŠ é€Ÿ</strong></p> <blockquote><p><code>CSS</code>ä¸­ä»¥ä¸‹å±æ€§ï¼ˆ<code>CSS3 transitions</code>ã€<code>CSS3 3D transforms</code>ã€<code>Opacity</code>ã€<code>Canvas</code>ã€<code>WebGL</code>ã€<code>Video</code>ï¼‰æ¥è§¦å‘<code>GPU</code>æ¸²æŸ“ï¼Œè¯·åˆç†ä½¿ç”¨</p></blockquote> <h2 id="å…«ã€http"><a href="http://interview.poetries.top/docs/simply.html#%E5%85%AB%E3%80%81http" class="header-anchor">#</a> å…«ã€HTTP</h2> <h3 id="_1-è°ˆä¸€è°ˆhttpåè®®ä¼˜ç¼ºç‚¹"><a href="http://interview.poetries.top/docs/simply.html#_1-%E8%B0%88%E4%B8%80%E8%B0%88http%E5%8D%8F%E8%AE%AE%E4%BC%98%E7%BC%BA%E7%82%B9" class="header-anchor">#</a> 1 è°ˆä¸€è°ˆHTTPåè®®ä¼˜ç¼ºç‚¹</h3> <blockquote><p>è¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼Œ<strong>HTTP æ˜¯ä¸€ä¸ªåœ¨è®¡ç®—æœºä¸–ç•Œé‡Œä¸“é—¨åœ¨ä¸¤ç‚¹ä¹‹é—´ä¼ è¾“æ–‡å­—ã€å›¾ç‰‡ã€éŸ³é¢‘ã€è§†é¢‘ç­‰è¶…æ–‡æœ¬æ•°æ®çš„çº¦å®šå’Œè§„èŒƒ</strong>ã€‚</p></blockquote> <ul><li><strong>HTTP ç‰¹ç‚¹</strong> <ul><li><strong>çµæ´»å¯æ‰©å±•</strong>ã€‚ä¸€ä¸ªæ˜¯è¯­æ³•ä¸Šåªè§„å®šäº†åŸºæœ¬æ ¼å¼ï¼Œç©ºæ ¼åˆ†éš”å•è¯ï¼Œæ¢è¡Œåˆ†éš”å­—æ®µç­‰ã€‚å¦å¤–ä¸€ä¸ªå°±æ˜¯ä¼ è¾“å½¢å¼ä¸Šä¸ä»…å¯ä»¥ä¼ è¾“æ–‡æœ¬ï¼Œè¿˜å¯ä»¥ä¼ è¾“å›¾ç‰‡ï¼Œè§†é¢‘ç­‰ä»»æ„æ•°æ®ã€‚</li> <li><strong>è¯·æ±‚-åº”ç­”æ¨¡å¼</strong>ï¼Œé€šå¸¸è€Œè¨€ï¼Œå°±æ˜¯ä¸€æ–¹å‘é€æ¶ˆæ¯ï¼Œå¦å¤–ä¸€æ–¹è¦æ¥å—æ¶ˆæ¯ï¼Œæˆ–è€…æ˜¯åšå‡ºç›¸åº”ç­‰ã€‚</li> <li><strong>å¯é ä¼ è¾“</strong>ï¼ŒHTTPæ˜¯åŸºäºTCP/IPï¼Œå› æ­¤æŠŠè¿™ä¸€ç‰¹æ€§ç»§æ‰¿äº†ä¸‹æ¥ã€‚</li> <li><strong>æ— çŠ¶æ€</strong>ï¼Œè¿™ä¸ªåˆ†åœºæ™¯å›ç­”å³å¯ã€‚</li></ul></li> <li><strong>HTTP ç¼ºç‚¹</strong> <ul><li><strong>æ— çŠ¶æ€</strong>ï¼Œæœ‰æ—¶å€™ï¼Œéœ€è¦ä¿å­˜ä¿¡æ¯ï¼Œæ¯”å¦‚åƒè´­ç‰©ç³»ç»Ÿï¼Œéœ€è¦ä¿ç•™ä¸‹é¡¾å®¢ä¿¡æ¯ç­‰ç­‰ï¼Œå¦å¤–ä¸€æ–¹é¢ï¼Œæœ‰æ—¶å€™ï¼Œæ— çŠ¶æ€ä¹Ÿä¼šå‡å°‘ç½‘ç»œå¼€é”€ï¼Œæ¯”å¦‚ç±»ä¼¼ç›´æ’­è¡Œä¸šè¿™æ ·å­ç­‰ï¼Œè¿™ä¸ªè¿˜æ˜¯åˆ†åœºæ™¯æ¥è¯´ã€‚</li> <li><strong>æ˜æ–‡ä¼ è¾“</strong>ï¼Œå³åè®®é‡Œçš„æŠ¥æ–‡(ä¸»è¦æŒ‡çš„æ˜¯å¤´éƒ¨)ä¸ä½¿ç”¨äºŒè¿›åˆ¶æ•°æ®ï¼Œè€Œæ˜¯æ–‡æœ¬å½¢å¼ã€‚è¿™è®©HTTPçš„æŠ¥æ–‡ä¿¡æ¯æš´éœ²ç»™äº†å¤–ç•Œï¼Œç»™æ”»å‡»è€…å¸¦æ¥äº†ä¾¿åˆ©ã€‚</li> <li><strong>é˜Ÿå¤´é˜»å¡</strong>ï¼Œå½“httpå¼€å¯é•¿è¿æ¥æ—¶ï¼Œå…±ç”¨ä¸€ä¸ª<code>TCP</code>è¿æ¥ï¼Œå½“æŸä¸ªè¯·æ±‚æ—¶é—´è¿‡é•¿æ—¶ï¼Œå…¶ä»–çš„è¯·æ±‚åªèƒ½å¤„äºé˜»å¡çŠ¶æ€ï¼Œè¿™å°±æ˜¯é˜Ÿå¤´é˜»å¡é—®é¢˜ã€‚</li></ul></li></ul> <p><strong>http æ— çŠ¶æ€æ— è¿æ¥</strong></p> <ul><li><code>http</code> åè®®å¯¹äºäº‹åŠ¡å¤„ç†æ²¡æœ‰è®°å¿†èƒ½åŠ›</li> <li>å¯¹åŒä¸€ä¸ª<code>url</code>è¯·æ±‚æ²¡æœ‰ä¸Šä¸‹æ–‡å…³ç³»</li> <li>æ¯æ¬¡çš„è¯·æ±‚éƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œå®ƒçš„æ‰§è¡Œæƒ…å†µå’Œç»“æœä¸å‰é¢çš„è¯·æ±‚å’Œä¹‹åçš„è¯·æ±‚æ˜¯æ— ç›´æ¥å…³ç³»çš„ï¼Œå®ƒä¸ä¼šå—å‰é¢çš„è¯·æ±‚åº”ç­”æƒ…å†µç›´æ¥å½±å“ï¼Œä¹Ÿä¸ä¼šç›´æ¥å½±å“åé¢çš„è¯·æ±‚åº”ç­”æƒ…å†µ</li> <li>æœåŠ¡å™¨ä¸­æ²¡æœ‰ä¿å­˜å®¢æˆ·ç«¯çš„çŠ¶æ€ï¼Œå®¢æˆ·ç«¯å¿…é¡»æ¯æ¬¡å¸¦ä¸Šè‡ªå·±çš„çŠ¶æ€å»è¯·æ±‚æœåŠ¡å™¨</li> <li>äººç”Ÿè‹¥åªå¦‚åˆè§ï¼Œè¯·æ±‚è¿‡çš„èµ„æºä¸‹ä¸€æ¬¡ä¼šç»§ç»­è¿›è¡Œè¯·æ±‚</li></ul> <p><strong>httpåè®®æ— çŠ¶æ€ä¸­çš„ çŠ¶æ€ åˆ°åº•æŒ‡çš„æ˜¯ä»€ä¹ˆï¼Ÿï¼</strong></p> <ul><li>ã€çŠ¶æ€ã€‘çš„å«ä¹‰å°±æ˜¯ï¼šå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨åœ¨æŸæ¬¡ä¼šè¯ä¸­äº§ç”Ÿçš„æ•°æ®</li> <li>é‚£ä¹ˆå¯¹åº”çš„ã€æ— çŠ¶æ€ã€‘å°±æ„å‘³ç€ï¼šè¿™äº›æ•°æ®ä¸ä¼šè¢«ä¿ç•™</li> <li>é€šè¿‡å¢åŠ <code>cookie</code>å’Œ<code>session</code>æœºåˆ¶ï¼Œç°åœ¨çš„ç½‘ç»œè¯·æ±‚å…¶å®æ˜¯æœ‰çŠ¶æ€çš„</li> <li>åœ¨æ²¡æœ‰çŠ¶æ€çš„<code>http</code>åè®®ä¸‹ï¼ŒæœåŠ¡å™¨ä¹Ÿä¸€å®šä¼šä¿ç•™ä½ æ¯æ¬¡ç½‘ç»œè¯·æ±‚å¯¹æ•°æ®çš„ä¿®æ”¹ï¼Œä½†è¿™è·Ÿä¿ç•™æ¯æ¬¡è®¿é—®çš„æ•°æ®æ˜¯ä¸ä¸€æ ·çš„ï¼Œä¿ç•™çš„åªæ˜¯ä¼šè¯äº§ç”Ÿçš„ç»“æœï¼Œè€Œæ²¡æœ‰ä¿ç•™ä¼šè¯</li></ul> <h3 id="_2-è¯´ä¸€è¯´http-çš„è¯·æ±‚æ–¹æ³•"><a href="http://interview.poetries.top/docs/simply.html#_2-%E8%AF%B4%E4%B8%80%E8%AF%B4http-%E7%9A%84%E8%AF%B7%E6%B1%82%E6%96%B9%E6%B3%95" class="header-anchor">#</a> 2 è¯´ä¸€è¯´HTTP çš„è¯·æ±‚æ–¹æ³•</h3> <ul><li>HTTP1.0å®šä¹‰äº†ä¸‰ç§è¯·æ±‚æ–¹æ³•ï¼š GET, POST å’Œ HEADæ–¹æ³•</li> <li>HTTP1.1æ–°å¢äº†äº”ç§è¯·æ±‚æ–¹æ³•ï¼šOPTIONS, PUT, DELETE, TRACE å’Œ CONNECT</li></ul> <p><code>http/1.1</code>è§„å®šäº†ä»¥ä¸‹è¯·æ±‚æ–¹æ³•(æ³¨æ„ï¼Œéƒ½æ˜¯å¤§å†™):</p> <ul><li>GETï¼š                è¯·æ±‚è·å–Request-URIæ‰€æ ‡è¯†çš„èµ„æº</li> <li>POSTï¼š              åœ¨Request-URIæ‰€æ ‡è¯†çš„èµ„æºåé™„åŠ æ–°çš„æ•°æ®</li> <li>HEADï¼š             è¯·æ±‚è·å–ç”±Request-URIæ‰€æ ‡è¯†çš„èµ„æºçš„å“åº”æ¶ˆæ¯æŠ¥å¤´</li> <li>PUTï¼š                è¯·æ±‚æœåŠ¡å™¨å­˜å‚¨ä¸€ä¸ªèµ„æºï¼Œå¹¶ç”¨Request-URIä½œä¸ºå…¶æ ‡è¯†ï¼ˆä¿®æ”¹æ•°æ®ï¼‰</li> <li>DELETEï¼š          è¯·æ±‚æœåŠ¡å™¨åˆ é™¤å¯¹åº”æ‰€æ ‡è¯†çš„èµ„æº</li> <li>TRACEï¼š            è¯·æ±‚æœåŠ¡å™¨å›é€æ”¶åˆ°çš„è¯·æ±‚ä¿¡æ¯ï¼Œä¸»è¦ç”¨äºæµ‹è¯•æˆ–è¯Šæ–­</li> <li>CONNECTï¼š      å»ºç«‹è¿æ¥éš§é“ï¼Œç”¨äºä»£ç†æœåŠ¡å™¨</li> <li>OPTIONSï¼š       åˆ—å‡ºå¯å¯¹èµ„æºå®è¡Œçš„è¯·æ±‚æ–¹æ³•ï¼Œç”¨æ¥è·¨åŸŸè¯·æ±‚</li></ul> <blockquote><p>ä»åº”ç”¨åœºæ™¯è§’åº¦æ¥çœ‹ï¼ŒGet å¤šç”¨äºæ— å‰¯ä½œç”¨ï¼Œå¹‚ç­‰çš„åœºæ™¯ï¼Œä¾‹å¦‚æœç´¢å…³é”®å­—ã€‚Post å¤šç”¨äºå‰¯ä½œç”¨ï¼Œä¸å¹‚ç­‰çš„åœºæ™¯ï¼Œä¾‹å¦‚æ³¨å†Œã€‚</p></blockquote> <p><strong>options æ–¹æ³•æœ‰ä»€ä¹ˆç”¨</strong></p> <ul><li>OPTIONS è¯·æ±‚ä¸ HEAD ç±»ä¼¼ï¼Œä¸€èˆ¬ä¹Ÿæ˜¯ç”¨äºå®¢æˆ·ç«¯æŸ¥çœ‹æœåŠ¡å™¨çš„æ€§èƒ½ã€‚</li> <li>è¿™ä¸ªæ–¹æ³•ä¼šè¯·æ±‚æœåŠ¡å™¨è¿”å›è¯¥èµ„æºæ‰€æ”¯æŒçš„æ‰€æœ‰ HTTP è¯·æ±‚æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¼šç”¨'*'æ¥ä»£æ›¿èµ„æºåç§°ï¼Œå‘æœåŠ¡å™¨å‘é€ OPTIONS è¯·æ±‚ï¼Œå¯ä»¥æµ‹è¯•æœåŠ¡å™¨åŠŸèƒ½æ˜¯å¦æ­£å¸¸ã€‚</li> <li>JS çš„ XMLHttpRequestå¯¹è±¡è¿›è¡Œ CORS è·¨åŸŸèµ„æºå…±äº«æ—¶ï¼Œå¯¹äºå¤æ‚è¯·æ±‚ï¼Œå°±æ˜¯ä½¿ç”¨ OPTIONS æ–¹æ³•å‘é€å—…æ¢è¯·æ±‚ï¼Œä»¥åˆ¤æ–­æ˜¯å¦æœ‰å¯¹æŒ‡å®šèµ„æºçš„è®¿é—®æƒé™ã€‚</li></ul> <h3 id="_3-è°ˆä¸€è°ˆget-å’Œ-post-çš„åŒºåˆ«"><a href="http://interview.poetries.top/docs/simply.html#_3-%E8%B0%88%E4%B8%80%E8%B0%88get-%E5%92%8C-post-%E7%9A%84%E5%8C%BA%E5%88%AB" class="header-anchor">#</a> 3 è°ˆä¸€è°ˆGET å’Œ POST çš„åŒºåˆ«</h3> <p>æœ¬è´¨ä¸Šï¼Œåªæ˜¯è¯­ä¹‰ä¸Šçš„åŒºåˆ«ï¼ŒGET ç”¨äºè·å–èµ„æºï¼ŒPOST ç”¨äºæäº¤èµ„æºã€‚</p> <p>å…·ä½“å·®åˆ«ğŸ‘‡</p> <ul><li>ä»ç¼“å­˜è§’åº¦çœ‹ï¼ŒGET è¯·æ±‚åæµè§ˆå™¨ä¼šä¸»åŠ¨ç¼“å­˜ï¼ŒPOST é»˜è®¤æƒ…å†µä¸‹ä¸èƒ½ã€‚</li> <li>ä»å‚æ•°è§’åº¦æ¥çœ‹ï¼ŒGETè¯·æ±‚ä¸€èˆ¬æ”¾åœ¨URLä¸­ï¼Œå› æ­¤ä¸å®‰å…¨ï¼ŒPOSTè¯·æ±‚æ”¾åœ¨è¯·æ±‚ä½“ä¸­ï¼Œç›¸å¯¹è€Œè¨€è¾ƒä¸ºå®‰å…¨ï¼Œä½†æ˜¯åœ¨æŠ“åŒ…çš„æƒ…å†µä¸‹éƒ½æ˜¯ä¸€æ ·çš„ã€‚</li> <li>ä»ç¼–ç è§’åº¦çœ‹ï¼ŒGETè¯·æ±‚åªèƒ½ç»è¡ŒURLç¼–ç ï¼Œåªèƒ½æ¥å—ASCIIç ï¼Œè€ŒPOSTæ”¯æŒæ›´å¤šçš„ç¼–ç ç±»å‹ä¸”ä¸å¯¹æ•°æ®ç±»å‹é™å€¼ã€‚</li> <li>GETè¯·æ±‚å¹‚ç­‰ï¼ŒPOSTè¯·æ±‚ä¸å¹‚ç­‰ï¼Œå¹‚ç­‰æŒ‡å‘é€ M å’Œ N æ¬¡è¯·æ±‚ï¼ˆä¸¤è€…ä¸ç›¸åŒä¸”éƒ½å¤§äº1ï¼‰ï¼ŒæœåŠ¡å™¨ä¸Šèµ„æºçš„çŠ¶æ€ä¸€è‡´ã€‚</li> <li>GETè¯·æ±‚ä¼šä¸€æ¬¡æ€§å‘é€è¯·æ±‚æŠ¥æ–‡ï¼ŒPOSTè¯·æ±‚é€šå¸¸åˆ†ä¸ºä¸¤ä¸ªTCPæ•°æ®åŒ…ï¼Œé¦–å…ˆå‘ header éƒ¨åˆ†ï¼Œå¦‚æœæœåŠ¡å™¨å“åº” 100(continue)ï¼Œ ç„¶åå‘ body éƒ¨åˆ†ã€‚</li></ul> <h3 id="_4-è°ˆä¸€è°ˆé˜Ÿå¤´é˜»å¡é—®é¢˜"><a href="http://interview.poetries.top/docs/simply.html#_4-%E8%B0%88%E4%B8%80%E8%B0%88%E9%98%9F%E5%A4%B4%E9%98%BB%E5%A1%9E%E9%97%AE%E9%A2%98" class="header-anchor">#</a> 4 è°ˆä¸€è°ˆé˜Ÿå¤´é˜»å¡é—®é¢˜</h3> <p><strong>ä»€ä¹ˆæ˜¯é˜Ÿå¤´é˜»å¡ï¼Ÿ</strong></p> <p>å¯¹äºæ¯ä¸€ä¸ªHTTPè¯·æ±‚è€Œè¨€ï¼Œè¿™äº›ä»»åŠ¡æ˜¯ä¼šè¢«æ”¾å…¥ä¸€ä¸ªä»»åŠ¡é˜Ÿåˆ—ä¸­ä¸²è¡Œæ‰§è¡Œçš„ï¼Œä¸€æ—¦é˜Ÿé¦–ä»»åŠ¡è¯·æ±‚å¤ªæ…¢æ—¶ï¼Œå°±ä¼šé˜»å¡åé¢çš„è¯·æ±‚å¤„ç†ï¼Œè¿™å°±æ˜¯<code>HTTPé˜Ÿå¤´é˜»å¡</code>é—®é¢˜ã€‚</p> <p>æœ‰ä»€ä¹ˆè§£å†³åŠæ³•å—ğŸ‘‡</p> <p><strong>å¹¶å‘è¿æ¥</strong></p> <blockquote><p>æˆ‘ä»¬çŸ¥é“å¯¹äºä¸€ä¸ªåŸŸåè€Œè¨€ï¼Œæ˜¯å…è®¸åˆ†é…å¤šä¸ªé•¿è¿æ¥çš„ï¼Œé‚£ä¹ˆå¯ä»¥ç†è§£æˆå¢åŠ äº†ä»»åŠ¡é˜Ÿåˆ—ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸ä¼šå¯¼è‡´ä¸€ä¸ªä»»åŠ¡é˜»å¡äº†è¯¥ä»»åŠ¡é˜Ÿåˆ—çš„å…¶ä»–ä»»åŠ¡ï¼Œåœ¨<code>RFCè§„èŒƒ</code>ä¸­è§„å®šå®¢æˆ·ç«¯æœ€å¤šå¹¶å‘2ä¸ªè¿æ¥ï¼Œä¸è¿‡å®é™…æƒ…å†µå°±æ˜¯è¦æ¯”è¿™ä¸ªè¿˜è¦å¤šï¼Œä¸¾ä¸ªä¾‹å­ï¼ŒChromeä¸­æ˜¯6ä¸ªã€‚</p></blockquote> <p><strong>åŸŸååˆ†ç‰‡</strong></p> <ul><li>é¡¾åæ€ä¹‰ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸€ä¸ªåŸŸåä¸‹åˆ†å‡ºå¤šä¸ªäºŒçº§åŸŸåå‡ºæ¥ï¼Œè€Œå®ƒä»¬æœ€ç»ˆæŒ‡å‘çš„è¿˜æ˜¯åŒä¸€ä¸ªæœåŠ¡å™¨ï¼Œè¿™æ ·å­çš„è¯å°±å¯ä»¥å¹¶å‘å¤„ç†çš„ä»»åŠ¡é˜Ÿåˆ—æ›´å¤šï¼Œä¹Ÿæ›´å¥½çš„è§£å†³äº†é˜Ÿå¤´é˜»å¡çš„é—®é¢˜ã€‚</li> <li>ä¸¾ä¸ªä¾‹å­ï¼Œæ¯”å¦‚<code>TianTian.com</code>ï¼Œå¯ä»¥åˆ†å‡ºå¾ˆå¤šäºŒçº§åŸŸåï¼Œæ¯”å¦‚<code>Day1.TianTian.com</code>ï¼Œ<code>Day2.TianTian.com</code>,<code>Day3.TianTian.com</code>,è¿™æ ·å­å°±å¯ä»¥æœ‰æ•ˆè§£å†³é˜Ÿå¤´é˜»å¡é—®é¢˜ã€‚</li></ul> <h3 id="_5-è°ˆä¸€è°ˆhttpæ•°æ®ä¼ è¾“"><a href="http://interview.poetries.top/docs/simply.html#_5-%E8%B0%88%E4%B8%80%E8%B0%88http%E6%95%B0%E6%8D%AE%E4%BC%A0%E8%BE%93" class="header-anchor">#</a> 5 è°ˆä¸€è°ˆHTTPæ•°æ®ä¼ è¾“</h3> <p>å¤§æ¦‚é‡åˆ°çš„æƒ…å†µå°±åˆ†ä¸º<strong>å®šé•¿æ•°æ®</strong> ä¸ <strong>ä¸å®šé•¿æ•°æ®</strong>çš„å¤„ç†å§ã€‚</p> <p><strong>å®šé•¿æ•°æ®</strong></p> <p>å¯¹äºå®šé•¿çš„æ•°æ®åŒ…è€Œè¨€ï¼Œå‘é€ç«¯åœ¨å‘é€æ•°æ®çš„è¿‡ç¨‹ä¸­ï¼Œéœ€è¦è®¾ç½®<code>Content-Length</code>,æ¥æŒ‡æ˜å‘é€æ•°æ®çš„é•¿åº¦ã€‚</p> <blockquote><p>å½“ç„¶äº†å¦‚æœé‡‡ç”¨äº†Gzipå‹ç¼©çš„è¯ï¼ŒContent-Lengthè®¾ç½®çš„å°±æ˜¯å‹ç¼©åçš„ä¼ è¾“é•¿åº¦ã€‚</p></blockquote> <p>æˆ‘ä»¬è¿˜éœ€è¦çŸ¥é“çš„æ˜¯ğŸ‘‡</p> <ul><li><code>Content-Length</code>å¦‚æœå­˜åœ¨å¹¶ä¸”æœ‰æ•ˆçš„è¯ï¼Œåˆ™å¿…é¡»å’Œæ¶ˆæ¯å†…å®¹çš„ä¼ è¾“é•¿åº¦å®Œå…¨ä¸€è‡´ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœè¿‡çŸ­å°±ä¼šæˆªæ–­ï¼Œè¿‡é•¿çš„è¯ï¼Œå°±ä¼šå¯¼è‡´è¶…æ—¶ã€‚</li> <li>å¦‚æœé‡‡ç”¨çŸ­é“¾æ¥çš„è¯ï¼Œç›´æ¥å¯ä»¥é€šè¿‡æœåŠ¡å™¨å…³é—­è¿æ¥æ¥ç¡®å®šæ¶ˆæ¯çš„ä¼ è¾“é•¿åº¦ã€‚</li> <li>é‚£ä¹ˆåœ¨HTTP/1.0ä¹‹å‰çš„ç‰ˆæœ¬ä¸­ï¼ŒContent-Lengthå­—æ®µå¯æœ‰å¯æ— ,å› ä¸ºä¸€æ—¦æœåŠ¡å™¨å…³é—­è¿æ¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥è·å–åˆ°ä¼ è¾“æ•°æ®çš„é•¿åº¦äº†ã€‚</li> <li>åœ¨HTTP/1.1ç‰ˆæœ¬ä¸­ï¼Œå¦‚æœæ˜¯Keep-aliveçš„è¯ï¼Œchunkedä¼˜å…ˆçº§é«˜äº<code>Content-Length</code>,è‹¥æ˜¯éKeep-aliveï¼Œè·Ÿå‰é¢æƒ…å†µä¸€æ ·ï¼ŒContent-Lengthå¯æœ‰å¯æ— ã€‚</li></ul> <p>é‚£æ€ä¹ˆæ¥è®¾ç½®<code>Content-Length</code></p> <p>ä¸¾ä¸ªä¾‹å­æ¥çœ‹çœ‹ğŸ‘‡</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> server <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
server<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'request'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>url <span class="token operator">===</span> <span class="token string">'/index'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  	<span class="token comment">// è®¾ç½®æ•°æ®ç±»å‹</span>
    res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">'Content-Type'</span><span class="token punctuation">,</span> <span class="token string">'text/plain'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">'Content-Length'</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    res<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">"ä½ å¥½ï¼Œä½¿ç”¨çš„æ˜¯Content-Lengthè®¾ç½®ä¼ è¾“æ•°æ®å½¢å¼"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"æˆåŠŸå¯åŠ¨--TinaTian"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre></div><p><strong>ä¸å®šé•¿æ•°æ®</strong></p> <blockquote><p>ç°åœ¨é‡‡ç”¨æœ€å¤šçš„å°±æ˜¯HTTP/1.1ç‰ˆæœ¬ï¼Œæ¥å®Œæˆä¼ è¾“æ•°æ®ï¼Œåœ¨ä¿å­˜Keep-aliveçŠ¶æ€ä¸‹ï¼Œå½“æ•°æ®æ˜¯ä¸å®šé•¿çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦è®¾ç½®æ–°çš„å¤´éƒ¨å­—æ®µğŸ‘‡</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>Transfer-Encoding: chunked
</code></pre></div><p>é€šè¿‡chunkedæœºåˆ¶ï¼Œå¯ä»¥å®Œæˆå¯¹ä¸å®šé•¿æ•°æ®çš„å¤„ç†ï¼Œå½“ç„¶äº†ï¼Œä½ éœ€è¦çŸ¥é“çš„æ˜¯</p> <ul><li>å¦‚æœå¤´éƒ¨ä¿¡æ¯ä¸­æœ‰<code>Transfer-Encoding</code>,ä¼˜å…ˆé‡‡ç”¨Transfer-Encodingé‡Œé¢çš„æ–¹æ³•æ¥æ‰¾åˆ°å¯¹åº”çš„é•¿åº¦ã€‚</li> <li>å¦‚æœè®¾ç½®äº†Transfer-Encodingï¼Œé‚£ä¹ˆContent-Lengthå°†è¢«å¿½è§†ã€‚</li> <li>ä½¿ç”¨é•¿è¿æ¥çš„è¯ï¼Œä¼šæŒç»­çš„æ¨é€åŠ¨æ€å†…å®¹ã€‚</li></ul> <p>é‚£æˆ‘ä»¬æ¥æ¨¡æ‹Ÿä¸€ä¸‹å§ğŸ‘‡</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> server <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
server<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'request'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>url <span class="token operator">===</span> <span class="token string">'/index'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  	<span class="token comment">// è®¾ç½®æ•°æ®ç±»å‹</span>
    res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">'Content-Type'</span><span class="token punctuation">,</span> <span class="token string">'text/html; charset=utf8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">'Content-Length'</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">'Transfer-Encoding'</span><span class="token punctuation">,</span> <span class="token string">'chunked'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    res<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">"ä½ å¥½ï¼Œä½¿ç”¨çš„æ˜¯Transfer-Encodingè®¾ç½®ä¼ è¾“æ•°æ®å½¢å¼"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      res<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">"ç¬¬ä¸€æ¬¡ä¼ è¾“æ•°æ®ç»™æ‚¨&lt;br/&gt;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    res<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">"éªšç­‰ä¸€ä¸‹"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      res<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">"ç¬¬ä¸€æ¬¡ä¼ è¾“æ•°æ®ç»™æ‚¨"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"æˆåŠŸå¯åŠ¨--TinaTian"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre></div><blockquote><p>ä¸Šé¢ä½¿ç”¨çš„æ˜¯nodejsä¸­<code>http</code>æ¨¡å—ï¼Œæœ‰å…´è¶£çš„å°ä¼™ä¼´å¯ä»¥å»è¯•ä¸€è¯•ï¼Œä»¥ä¸Šå°±æ˜¯HTTPå¯¹<strong>å®šé•¿æ•°æ®</strong>å’Œ<strong>ä¸å®šé•¿æ•°æ®</strong>ä¼ è¾“è¿‡ç¨‹ä¸­çš„å¤„ç†æ‰‹æ®µã€‚</p></blockquote> <h3 id="_6-cookie-å’Œ-session"><a href="http://interview.poetries.top/docs/simply.html#_6-cookie-%E5%92%8C-session" class="header-anchor">#</a> 6 cookie å’Œ session</h3> <ul><li><code>session</code>ï¼š æ˜¯ä¸€ä¸ªæŠ½è±¡æ¦‚å¿µï¼Œå¼€å‘è€…ä¸ºäº†å®ç°ä¸­æ–­å’Œç»§ç»­ç­‰æ“ä½œï¼Œå°† <code>user agent</code>å’Œ <code>server</code> ä¹‹é—´ä¸€å¯¹ä¸€çš„äº¤äº’ï¼ŒæŠ½è±¡ä¸ºâ€œä¼šè¯â€ï¼Œè¿›è€Œè¡ç”Ÿå‡ºâ€œä¼šè¯çŠ¶æ€â€ï¼Œä¹Ÿå°±æ˜¯ <code>session</code> çš„æ¦‚å¿µ</li> <li><code>cookie</code>ï¼šå®ƒæ˜¯ä¸€ä¸ªä¸–çºªå­˜åœ¨çš„ä¸œè¥¿ï¼Œ<code>http</code> åè®®ä¸­å®šä¹‰åœ¨ <code>header</code> ä¸­çš„å­—æ®µï¼Œå¯ä»¥è®¤ä¸ºæ˜¯ <code>session</code> çš„ä¸€ç§åç«¯æ— çŠ¶æ€å®ç°</li></ul> <blockquote><p>ç°åœ¨æˆ‘ä»¬å¸¸è¯´çš„ <code>session</code>ï¼Œæ˜¯ä¸ºäº†ç»•å¼€ <code>cookie</code> çš„å„ç§é™åˆ¶ï¼Œé€šå¸¸å€ŸåŠ© <code>cookie</code>æœ¬èº«å’Œåç«¯å­˜å‚¨å®ç°çš„ï¼Œä¸€ç§æ›´é«˜çº§çš„ä¼šè¯çŠ¶æ€å®ç°</p></blockquote> <p><code>session</code> çš„å¸¸è§å®ç°è¦å€ŸåŠ©<code>cookie</code>æ¥å‘é€ <code>sessionID</code></p> <h3 id="_7-ä»‹ç»ä¸€ä¸‹httpså’ŒhttpåŒºåˆ«"><a href="http://interview.poetries.top/docs/simply.html#_7-%E4%BB%8B%E7%BB%8D%E4%B8%80%E4%B8%8Bhttps%E5%92%8Chttp%E5%8C%BA%E5%88%AB" class="header-anchor">#</a> 7 ä»‹ç»ä¸€ä¸‹HTTPSå’ŒHTTPåŒºåˆ«</h3> <blockquote><p>HTTPS è¦æ¯” HTTPS å¤šäº† secure å®‰å…¨æ€§è¿™ä¸ªæ¦‚å¿µï¼Œå®é™…ä¸Šï¼Œ HTTPS å¹¶ä¸æ˜¯ä¸€ä¸ªæ–°çš„åº”ç”¨å±‚åè®®ï¼Œå®ƒå…¶å®å°±æ˜¯ HTTP + TLS/SSL åè®®ç»„åˆè€Œæˆï¼Œè€Œå®‰å…¨æ€§çš„ä¿è¯æ­£æ˜¯ SSL/TLS æ‰€åšçš„å·¥ä½œã€‚</p></blockquote> <p><strong>SSL</strong></p> <p>å®‰å…¨å¥—æ¥å±‚ï¼ˆSecure Sockets Layerï¼‰</p> <p><strong>TLS</strong></p> <p>ï¼ˆä¼ è¾“å±‚å®‰å…¨ï¼ŒTransport Layer Securityï¼‰</p> <p>ç°åœ¨ä¸»æµçš„ç‰ˆæœ¬æ˜¯ TLS/1.2, ä¹‹å‰çš„ TLS1.0ã€TLS1.1 éƒ½è¢«è®¤ä¸ºæ˜¯ä¸å®‰å…¨çš„ï¼Œåœ¨ä¸ä¹…çš„å°†æ¥ä¼šè¢«å®Œå…¨æ·˜æ±°ã€‚</p> <p><strong>HTTPS å°±æ˜¯èº«æŠ«äº†ä¸€å±‚ SSL çš„ HTTP</strong>ã€‚</p> <p><img src="./è¿›é˜¶_files/20210409105003.png" alt="" class="medium-zoom-image"></p> <p>é‚£ä¹ˆåŒºåˆ«æœ‰å“ªäº›å‘¢ğŸ‘‡</p> <ul><li>HTTP æ˜¯æ˜æ–‡ä¼ è¾“åè®®ï¼ŒHTTPS åè®®æ˜¯ç”± SSL+HTTP åè®®æ„å»ºçš„å¯è¿›è¡ŒåŠ å¯†ä¼ è¾“ã€èº«ä»½è®¤è¯çš„ç½‘ç»œåè®®ï¼Œæ¯” HTTP åè®®å®‰å…¨ã€‚</li> <li>HTTPSæ¯”HTTPæ›´åŠ å®‰å…¨ï¼Œå¯¹æœç´¢å¼•æ“æ›´å‹å¥½ï¼Œåˆ©äºSEO,è°·æ­Œã€ç™¾åº¦ä¼˜å…ˆç´¢å¼•HTTPSç½‘é¡µã€‚</li> <li>HTTPSæ ‡å‡†ç«¯å£443ï¼ŒHTTPæ ‡å‡†ç«¯å£80ã€‚</li> <li>HTTPSéœ€è¦ç”¨åˆ°SSLè¯ä¹¦ï¼Œè€ŒHTTPä¸ç”¨ã€‚</li></ul> <p>æˆ‘è§‰å¾—è®°ä½ä»¥ä¸‹ä¸¤ç‚¹HTTPSä¸»è¦ä½œç”¨å°±è¡ŒğŸ‘‡</p> <ol><li>å¯¹æ•°æ®è¿›è¡ŒåŠ å¯†ï¼Œå¹¶å»ºç«‹ä¸€ä¸ªä¿¡æ¯å®‰å…¨é€šé“ï¼Œæ¥ä¿è¯ä¼ è¾“è¿‡ç¨‹ä¸­çš„æ•°æ®å®‰å…¨;</li> <li>å¯¹ç½‘ç«™æœåŠ¡å™¨è¿›è¡ŒçœŸå®èº«ä»½è®¤è¯ã€‚</li></ol> <h3 id="_8-httpsæ¡æ‰‹è¿‡ç¨‹"><a href="http://interview.poetries.top/docs/simply.html#_8-https%E6%8F%A1%E6%89%8B%E8%BF%87%E7%A8%8B" class="header-anchor">#</a> 8 HTTPSæ¡æ‰‹è¿‡ç¨‹</h3> <ul><li>ç¬¬ä¸€æ­¥ï¼Œå®¢æˆ·ç«¯ç»™å‡ºåè®®ç‰ˆæœ¬å·ã€ä¸€ä¸ªå®¢æˆ·ç«¯ç”Ÿæˆçš„éšæœºæ•°ï¼ˆClient randomï¼‰ï¼Œä»¥åŠå®¢æˆ·ç«¯æ”¯æŒçš„åŠ å¯†æ–¹æ³•</li> <li>ç¬¬äºŒæ­¥ï¼ŒæœåŠ¡ç«¯ç¡®è®¤åŒæ–¹ä½¿ç”¨çš„åŠ å¯†æ–¹æ³•ï¼Œå¹¶ç»™å‡ºæ•°å­—è¯ä¹¦ã€ä»¥åŠä¸€ä¸ªæœåŠ¡å™¨ç”Ÿæˆçš„éšæœºæ•°</li> <li>ç¬¬ä¸‰æ­¥ï¼Œå®¢æˆ·ç«¯ç¡®è®¤æ•°å­—è¯ä¹¦æœ‰æ•ˆï¼Œç„¶åç”Ÿæˆä¸€ä¸ªæ–°çš„éšæœºæ•°ï¼ˆPremaster secretï¼‰ï¼Œå¹¶ä½¿ç”¨æ•°å­—è¯ä¹¦ä¸­çš„å…¬é’¥ï¼ŒåŠ å¯†è¿™ä¸ªéšæœºæ•°ï¼Œå‘ç»™æœåŠ¡ç«¯</li> <li>ç¬¬å››æ­¥ï¼ŒæœåŠ¡ç«¯ä½¿ç”¨è‡ªå·±çš„ç§é’¥ï¼Œè·å–å®¢æˆ·ç«¯å‘æ¥çš„éšæœºæ•°ï¼ˆå³Premaster secretï¼‰ã€‚</li> <li>ç¬¬äº”æ­¥ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯æ ¹æ®çº¦å®šçš„åŠ å¯†æ–¹æ³•ï¼Œä½¿ç”¨å‰é¢çš„ä¸‰ä¸ªéšæœºæ•°ï¼Œç”Ÿæˆ"å¯¹è¯å¯†é’¥"ï¼ˆsession keyï¼‰ï¼Œç”¨æ¥åŠ å¯†æ¥ä¸‹æ¥çš„æ•´ä¸ªå¯¹è¯è¿‡ç¨‹</li></ul> <p><strong>æ€»ç»“</strong></p> <ul><li>å®¢æˆ·ç«¯å‘èµ· HTTPS è¯·æ±‚ï¼ŒæœåŠ¡ç«¯è¿”å›è¯ä¹¦ï¼Œå®¢æˆ·ç«¯å¯¹è¯ä¹¦è¿›è¡ŒéªŒè¯ï¼ŒéªŒè¯é€šè¿‡åæœ¬åœ°ç”Ÿæˆç”¨äºæ„é€ å¯¹ç§°åŠ å¯†ç®—æ³•çš„éšæœºæ•°</li> <li>é€šè¿‡è¯ä¹¦ä¸­çš„å…¬é’¥å¯¹éšæœºæ•°è¿›è¡ŒåŠ å¯†ä¼ è¾“åˆ°æœåŠ¡ç«¯ï¼ˆéšæœºå¯¹ç§°å¯†é’¥ï¼‰ï¼ŒæœåŠ¡ç«¯æ¥æ”¶åé€šè¿‡ç§é’¥è§£å¯†å¾—åˆ°éšæœºå¯¹ç§°å¯†é’¥ï¼Œä¹‹åçš„æ•°æ®äº¤äº’é€šè¿‡å¯¹ç§°åŠ å¯†ç®—æ³•è¿›è¡ŒåŠ è§£å¯†ã€‚ï¼ˆæ—¢æœ‰å¯¹ç§°åŠ å¯†ï¼Œä¹Ÿæœ‰éå¯¹ç§°åŠ å¯†ï¼‰</li></ul> <h3 id="_9-ä»‹ç»ä¸€ä¸ªhttpså·¥ä½œåŸç†"><a href="http://interview.poetries.top/docs/simply.html#_9-%E4%BB%8B%E7%BB%8D%E4%B8%80%E4%B8%AAhttps%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86" class="header-anchor">#</a> 9 ä»‹ç»ä¸€ä¸ªHTTPSå·¥ä½œåŸç†</h3> <p>æˆ‘ä»¬å¯ä»¥æŠŠHTTPSç†è§£æˆ<strong>HTTPS = HTTP + SSL/TLS</strong></p> <blockquote><p>TLS/SSL çš„åŠŸèƒ½å®ç°ä¸»è¦ä¾èµ–äºä¸‰ç±»åŸºæœ¬ç®—æ³•ï¼š<code>æ•£åˆ—å‡½æ•°</code> ã€<code>å¯¹ç§°åŠ å¯†</code>å’Œ<code>éå¯¹ç§°åŠ å¯†</code>ï¼Œå…¶åˆ©ç”¨éå¯¹ç§°åŠ å¯†å®ç°èº«ä»½è®¤è¯å’Œå¯†é’¥åå•†ï¼Œå¯¹ç§°åŠ å¯†ç®—æ³•é‡‡ç”¨åå•†çš„å¯†é’¥å¯¹æ•°æ®åŠ å¯†ï¼ŒåŸºäºæ•£åˆ—å‡½æ•°éªŒè¯ä¿¡æ¯çš„å®Œæ•´æ€§ã€‚</p></blockquote> <p><strong>1. å¯¹ç§°åŠ å¯†</strong></p> <blockquote><p>åŠ å¯†å’Œè§£å¯†ç”¨åŒä¸€ä¸ªç§˜é’¥çš„åŠ å¯†æ–¹å¼å«åšå¯¹ç§°åŠ å¯†ã€‚Clientå®¢æˆ·ç«¯å’ŒServerç«¯å…±ç”¨ä¸€å¥—å¯†é’¥ï¼Œè¿™æ ·å­çš„åŠ å¯†è¿‡ç¨‹ä¼¼ä¹å¾ˆè®©äººç†è§£ï¼Œä½†æ˜¯éšä¹‹ä¼šäº§ç”Ÿä¸€äº›é—®é¢˜ã€‚</p></blockquote> <p><strong>é—®é¢˜ä¸€:</strong> WWWä¸‡ç»´ç½‘æœ‰è®¸è®¸å¤šå¤šçš„å®¢æˆ·ç«¯ï¼Œä¸å¯èƒ½éƒ½ç”¨ç§˜é’¥Aè¿›è¡Œä¿¡æ¯åŠ å¯†ï¼Œè¿™æ ·å­å¾ˆä¸åˆç†ï¼Œæ‰€ä»¥è§£å†³åŠæ³•å°±æ˜¯ä½¿ç”¨ä¸€ä¸ªå®¢æˆ·ç«¯ä½¿ç”¨ä¸€ä¸ªå¯†é’¥è¿›è¡ŒåŠ å¯†ã€‚</p> <p><strong>é—®é¢˜äºŒ:<strong>æ—¢ç„¶ä¸åŒçš„å®¢æˆ·ç«¯ä½¿ç”¨ä¸åŒçš„å¯†é’¥ï¼Œé‚£ä¹ˆ</strong>å¯¹ç§°åŠ å¯†çš„å¯†é’¥å¦‚ä½•ä¼ è¾“ï¼Ÿ</strong> é‚£ä¹ˆè§£å†³çš„åŠæ³•åªèƒ½æ˜¯<strong>ä¸€ç«¯ç”Ÿæˆä¸€ä¸ªç§˜é’¥ï¼Œç„¶åé€šè¿‡HTTPä¼ è¾“ç»™å¦ä¸€ç«¯</strong>ï¼Œé‚£ä¹ˆè¿™æ ·å­åˆä¼šäº§ç”Ÿæ–°çš„é—®é¢˜ã€‚</p> <p><strong>é—®é¢˜ä¸‰:</strong> è¿™ä¸ªä¼ è¾“å¯†é’¥çš„è¿‡ç¨‹ï¼Œåˆå¦‚ä½•ä¿è¯åŠ å¯†ï¼Ÿ<strong>å¦‚æœè¢«ä¸­é—´äººæ‹¦æˆªï¼Œå¯†é’¥ä¹Ÿä¼šè¢«è·å–,</strong> é‚£ä¹ˆä½ ä¼šè¯´å¯¹å¯†é’¥å†è¿›è¡ŒåŠ å¯†ï¼Œé‚£åˆæ€ä¹ˆä¿å­˜å¯¹å¯†é’¥åŠ å¯†çš„è¿‡ç¨‹ï¼Œæ˜¯åŠ å¯†çš„è¿‡ç¨‹ï¼Ÿ</p> <p>åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬ä¼¼ä¹æƒ³æ˜ç™½äº†ï¼Œä½¿ç”¨å¯¹ç§°åŠ å¯†çš„æ–¹å¼ï¼Œè¡Œä¸é€šï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦é‡‡ç”¨éå¯¹ç§°åŠ å¯†ğŸ‘‡</p> <p><strong>2. éå¯¹ç§°åŠ å¯†</strong></p> <blockquote><p>é€šè¿‡ä¸Šé¢çš„åˆ†æï¼Œå¯¹ç§°åŠ å¯†çš„æ–¹å¼è¡Œä¸é€šï¼Œé‚£ä¹ˆæˆ‘ä»¬æ¥æ¢³ç†ä¸€ä¸‹éå¯¹ç§°åŠ å¯†ã€‚é‡‡ç”¨çš„ç®—æ³•æ˜¯RSAï¼Œæ‰€ä»¥åœ¨ä¸€äº›æ–‡ç« ä¸­ä¹Ÿä¼šçœ‹è§<strong>ä¼ ç»ŸRSAæ¡æ‰‹</strong>ï¼ŒåŸºäºç°åœ¨TLSä¸»æµç‰ˆæœ¬æ˜¯1.2ï¼Œæ‰€ä»¥æ¥ä¸‹æ¥æ¢³ç†çš„æ˜¯<strong>TLS/1.2æ¡æ‰‹è¿‡ç¨‹</strong>ã€‚</p></blockquote> <p>éå¯¹ç§°åŠ å¯†ä¸­ï¼Œæˆ‘ä»¬éœ€è¦æ˜ç¡®çš„ç‚¹æ˜¯ğŸ‘‡</p> <ul><li>æœ‰ä¸€å¯¹ç§˜é’¥ï¼Œ<strong>å…¬é’¥</strong>å’Œ<strong>ç§é’¥</strong>ã€‚</li> <li>å…¬é’¥åŠ å¯†çš„å†…å®¹ï¼Œåªæœ‰ç§é’¥å¯ä»¥è§£å¼€ï¼Œç§é’¥åŠ å¯†çš„å†…å®¹ï¼Œæ‰€æœ‰çš„å…¬é’¥éƒ½å¯ä»¥è§£å¼€ï¼Œè¿™é‡Œè¯´çš„<strong>å…¬é’¥éƒ½å¯ä»¥è§£å¼€ï¼ŒæŒ‡çš„æ˜¯ä¸€å¯¹ç§˜é’¥</strong>ã€‚</li> <li>å…¬é’¥å¯ä»¥å‘é€ç»™æ‰€æœ‰çš„å®¢æˆ·ç«¯ï¼Œç§é’¥åªä¿å­˜åœ¨æœåŠ¡å™¨ç«¯ã€‚</li></ul> <p><strong>3. ä¸»è¦å·¥ä½œæµç¨‹</strong></p> <p>æ¢³ç†èµ·æ¥ï¼Œå¯ä»¥æŠŠ<strong>TLS 1.2 æ¡æ‰‹è¿‡ç¨‹</strong>åˆ†ä¸ºä¸»è¦çš„äº”æ­¥ğŸ‘‡</p> <p><img src="./è¿›é˜¶_files/20210409105413.png" alt="" class="medium-zoom-image"></p> <ul><li>æ­¥éª¤ä¸€ï¼šClientå‘èµ·ä¸€ä¸ªHTTPSè¯·æ±‚ï¼Œè¿æ¥443ç«¯å£ã€‚è¿™ä¸ªè¿‡ç¨‹å¯ä»¥ç†è§£æˆæ˜¯<strong>è¯·æ±‚å…¬é’¥çš„è¿‡ç¨‹</strong>ã€‚</li> <li>æ­¥éª¤äºŒï¼šServerç«¯æ”¶åˆ°è¯·æ±‚åï¼Œé€šè¿‡ç¬¬ä¸‰æ–¹æœºæ„ç§é’¥åŠ å¯†ï¼Œä¼šæŠŠæ•°å­—è¯ä¹¦ï¼ˆä¹Ÿå¯ä»¥è®¤ä¸ºæ˜¯å…¬é’¥è¯ä¹¦ï¼‰å‘é€ç»™Clientã€‚</li> <li>æ­¥éª¤ä¸‰ï¼š
<ul><li>æµè§ˆå™¨å®‰è£…åä¼šè‡ªåŠ¨å¸¦ä¸€äº›æƒå¨ç¬¬ä¸‰æ–¹æœºæ„å…¬é’¥ï¼Œä½¿ç”¨åŒ¹é…çš„å…¬é’¥å¯¹æ•°å­—ç­¾åè¿›è¡Œè§£å¯†ã€‚</li> <li>æ ¹æ®ç­¾åç”Ÿæˆçš„è§„åˆ™å¯¹ç½‘ç«™ä¿¡æ¯è¿›è¡Œæœ¬åœ°ç­¾åç”Ÿæˆï¼Œç„¶åä¸¤è€…æ¯”å¯¹ã€‚</li> <li>é€šè¿‡æ¯”å¯¹ä¸¤è€…ç­¾åï¼ŒåŒ¹é…åˆ™è¯´æ˜è®¤è¯é€šè¿‡ï¼Œä¸åŒ¹é…åˆ™è·å–è¯ä¹¦å¤±è´¥ã€‚</li></ul></li> <li>æ­¥éª¤å››ï¼šåœ¨å®‰å…¨æ‹¿åˆ°<strong>æœåŠ¡å™¨å…¬é’¥</strong>åï¼Œå®¢æˆ·ç«¯Clientéšæœºç”Ÿæˆä¸€ä¸ª<strong>å¯¹ç§°å¯†é’¥</strong>ï¼Œä½¿ç”¨<strong>æœåŠ¡å™¨å…¬é’¥</strong>ï¼ˆè¯ä¹¦çš„å…¬é’¥ï¼‰åŠ å¯†è¿™ä¸ª<strong>å¯¹ç§°å¯†é’¥</strong>ï¼Œå‘é€ç»™Server(æœåŠ¡å™¨)ã€‚</li> <li>æ­¥éª¤äº”ï¼šServer(æœåŠ¡å™¨)é€šè¿‡è‡ªå·±çš„ç§é’¥ï¼Œå¯¹ä¿¡æ¯è§£å¯†ï¼Œè‡³æ­¤å¾—åˆ°äº†<strong>å¯¹ç§°å¯†é’¥</strong>ï¼Œæ­¤æ—¶ä¸¤è€…éƒ½æ‹¥æœ‰äº†ç›¸åŒçš„<strong>å¯¹ç§°å¯†é’¥</strong>ã€‚</li></ul> <p>æ¥ä¸‹æ¥ï¼Œå°±å¯ä»¥é€šè¿‡è¯¥å¯¹ç§°å¯†é’¥å¯¹ä¼ è¾“çš„ä¿¡æ¯åŠ å¯†/è§£å¯†å•¦ï¼Œä»ä¸Šé¢å›¾ä¸¾ä¸ªä¾‹å­ğŸ‘‡</p> <ul><li>Clientç”¨æˆ·ä½¿ç”¨è¯¥<strong>å¯¹ç§°å¯†é’¥</strong>åŠ å¯†'æ˜æ–‡å†…å®¹B',å‘é€ç»™Server(æœåŠ¡å™¨)</li> <li>Serverä½¿ç”¨è¯¥<strong>å¯¹ç§°å¯†é’¥</strong>è¿›è¡Œè§£å¯†æ¶ˆæ¯ï¼Œå¾—åˆ°æ˜æ–‡å†…å®¹Bã€‚</li></ul> <p>æ¥ä¸‹æ¥è€ƒè™‘ä¸€ä¸ªé—®é¢˜ï¼Œ<strong>å¦‚æœå…¬é’¥è¢«ä¸­é—´äººæ‹¿åˆ°çº‚æ”¹æ€ä¹ˆåŠå‘¢ï¼Ÿ</strong></p> <p><img src="./è¿›é˜¶_files/20210409105827.png" alt="" class="medium-zoom-image"></p> <p><strong>å®¢æˆ·ç«¯å¯èƒ½æ‹¿åˆ°çš„å…¬é’¥æ˜¯å‡çš„ï¼Œè§£å†³åŠæ³•æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</strong></p> <p><strong>3. ç¬¬ä¸‰æ–¹è®¤è¯</strong></p> <p>å®¢æˆ·ç«¯æ— æ³•è¯†åˆ«ä¼ å›å…¬é’¥æ˜¯ä¸­é—´äººçš„ï¼Œè¿˜æ˜¯æœåŠ¡å™¨çš„ï¼Œè¿™æ˜¯é—®é¢˜çš„æ ¹æœ¬ï¼Œæˆ‘ä»¬æ˜¯ä¸æ˜¯å¯ä»¥é€šè¿‡æŸç§è§„èŒƒå¯ä»¥è®©å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨éƒ½éµå¾ªæŸç§çº¦å®šå‘¢ï¼Ÿé‚£å°±æ˜¯é€šè¿‡<strong>ç¬¬ä¸‰æ–¹è®¤è¯çš„æ–¹å¼</strong></p> <p>åœ¨HTTPSä¸­ï¼Œé€šè¿‡ <strong>è¯ä¹¦</strong> + <strong>æ•°å­—ç­¾å</strong>æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p> <p><img src="./è¿›é˜¶_files/20210409105910.png" alt="" class="medium-zoom-image"></p> <p>è¿™é‡Œå”¯ä¸€ä¸åŒçš„æ˜¯ï¼Œå‡è®¾å¯¹ç½‘ç«™ä¿¡æ¯åŠ å¯†çš„ç®—æ³•æ˜¯MD5ï¼Œé€šè¿‡MD5åŠ å¯†åï¼Œ<strong>ç„¶åé€šè¿‡ç¬¬ä¸‰æ–¹æœºæ„çš„ç§é’¥å†æ¬¡å¯¹å…¶åŠ å¯†ï¼Œç”Ÿæˆæ•°å­—ç­¾å</strong>ã€‚</p> <p>è¿™æ ·å­çš„è¯ï¼Œæ•°å­—è¯ä¹¦åŒ…å«æœ‰ä¸¤ä¸ªç‰¹åˆ«é‡è¦çš„ä¿¡æ¯ğŸ‘‰<strong>æŸç½‘ç«™å…¬é’¥+æ•°å­—ç­¾å</strong></p> <blockquote><p>æˆ‘ä»¬å†æ¬¡å‡è®¾ä¸­é—´äººæˆªå–åˆ°æœåŠ¡å™¨çš„å…¬é’¥åï¼Œå»æ›¿æ¢æˆè‡ªå·±çš„å…¬é’¥ï¼Œå› ä¸ºæœ‰æ•°å­—ç­¾åçš„å­˜åœ¨ï¼Œè¿™æ ·å­å®¢æˆ·ç«¯éªŒè¯å‘ç°æ•°å­—ç­¾åä¸åŒ¹é…ï¼Œè¿™æ ·å­å°±é˜²æ­¢ä¸­é—´äººæ›¿æ¢å…¬é’¥çš„é—®é¢˜ã€‚</p></blockquote> <p><strong>é‚£ä¹ˆå®¢æˆ·ç«¯æ˜¯å¦‚ä½•å»å¯¹æ¯”ä¸¤è€…æ•°å­—ç­¾åçš„å‘¢ï¼Ÿ</strong></p> <ul><li>æµè§ˆå™¨ä¼šå»å®‰è£…ä¸€äº›æ¯”è¾ƒæƒå¨çš„ç¬¬ä¸‰æ–¹è®¤è¯æœºæ„çš„å…¬é’¥ï¼Œæ¯”å¦‚VeriSignã€Symantecä»¥åŠGlobalSignç­‰ç­‰ã€‚</li> <li>éªŒè¯æ•°å­—ç­¾åçš„æ—¶å€™ï¼Œä¼šç›´æ¥ä»æœ¬åœ°æ‹¿åˆ°ç›¸åº”çš„ç¬¬ä¸‰æ–¹çš„å…¬é’¥ï¼Œå¯¹ç§é’¥åŠ å¯†åçš„æ•°å­—ç­¾åè¿›è¡Œè§£å¯†å¾—åˆ°çœŸæ­£çš„ç­¾åã€‚</li> <li>ç„¶åå®¢æˆ·ç«¯åˆ©ç”¨ç­¾åç”Ÿæˆè§„åˆ™è¿›è¡Œç­¾åç”Ÿæˆï¼Œçœ‹ä¸¤ä¸ªç­¾åæ˜¯å¦åŒ¹é…ï¼Œå¦‚æœåŒ¹é…è®¤è¯é€šè¿‡ï¼Œä¸åŒ¹é…åˆ™è·å–è¯ä¹¦å¤±è´¥ã€‚</li></ul> <p><strong>4. æ•°å­—ç­¾åä½œç”¨</strong></p> <blockquote><p>æ•°å­—ç­¾åï¼šå°†ç½‘ç«™çš„ä¿¡æ¯ï¼Œé€šè¿‡ç‰¹å®šçš„ç®—æ³•åŠ å¯†ï¼Œæ¯”å¦‚MD5,åŠ å¯†ä¹‹åï¼Œå†é€šè¿‡æœåŠ¡å™¨çš„ç§é’¥è¿›è¡ŒåŠ å¯†ï¼Œå½¢æˆ<strong>åŠ å¯†åçš„æ•°å­—ç­¾å</strong>ã€‚</p></blockquote> <p>ç¬¬ä¸‰æ–¹è®¤è¯æœºæ„æ˜¯ä¸€ä¸ªå…¬å¼€çš„å¹³å°ï¼Œä¸­é—´äººå¯ä»¥å»è·å–ã€‚</p> <p>å¦‚æœæ²¡æœ‰æ•°å­—ç­¾åçš„è¯ï¼Œè¿™æ ·å­å¯ä»¥å°±ä¼šæœ‰ä¸‹é¢æƒ…å†µğŸ‘‡</p> <p><img src="./è¿›é˜¶_files/20210409110016.png" alt="" class="medium-zoom-image"></p> <p>ä»ä¸Šé¢æˆ‘ä»¬çŸ¥é“ï¼Œå¦‚æœ<strong>åªæ˜¯å¯¹ç½‘ç«™ä¿¡æ¯è¿›è¡Œç¬¬ä¸‰æ–¹æœºæ„ç§é’¥åŠ å¯†</strong>çš„è¯ï¼Œè¿˜æ˜¯ä¼šå—åˆ°æ¬ºéª—ã€‚</p> <p>å› ä¸ºæ²¡æœ‰è®¤è¯ï¼Œæ‰€ä»¥ä¸­é—´äººä¹Ÿå‘ç¬¬ä¸‰æ–¹è®¤è¯æœºæ„è¿›è¡Œç”³è¯·ï¼Œç„¶åæ‹¦æˆªåæŠŠæ‰€æœ‰çš„ä¿¡æ¯éƒ½æ›¿æ¢æˆè‡ªå·±çš„ï¼Œå®¢æˆ·ç«¯ä»ç„¶å¯ä»¥è§£å¯†ï¼Œå¹¶ä¸”æ— æ³•åˆ¤æ–­è¿™æ˜¯æœåŠ¡å™¨çš„è¿˜æ˜¯ä¸­é—´äººçš„ï¼Œæœ€åé€ æˆæ•°æ®æ³„éœ²ã€‚</p> <p><strong>5. æ€»ç»“</strong></p> <ul><li>HTTPSå°±æ˜¯ä½¿ç”¨SSL/TLSåè®®è¿›è¡ŒåŠ å¯†ä¼ è¾“</li> <li>å¤§è‡´æµç¨‹ï¼šå®¢æˆ·ç«¯æ‹¿åˆ°æœåŠ¡å™¨çš„å…¬é’¥ï¼ˆæ˜¯æ­£ç¡®çš„ï¼‰ï¼Œç„¶åå®¢æˆ·ç«¯éšæœºç”Ÿæˆä¸€ä¸ª<strong>å¯¹ç§°åŠ å¯†çš„ç§˜é’¥</strong>ï¼Œä½¿ç”¨<strong>è¯¥å…¬é’¥</strong>åŠ å¯†ï¼Œä¼ è¾“ç»™æœåŠ¡ç«¯ï¼ŒæœåŠ¡ç«¯å†é€šè¿‡è§£å¯†æ‹¿åˆ°è¯¥<strong>å¯¹ç§°ç§˜é’¥</strong>ï¼Œåç»­çš„æ‰€æœ‰ä¿¡æ¯éƒ½é€šè¿‡è¯¥<strong>å¯¹ç§°ç§˜é’¥</strong>è¿›è¡ŒåŠ å¯†è§£å¯†ï¼Œå®Œæˆæ•´ä¸ªHTTPSçš„æµç¨‹ã€‚</li> <li><strong>ç¬¬ä¸‰æ–¹è®¤è¯</strong>ï¼Œæœ€é‡è¦çš„æ˜¯<strong>æ•°å­—ç­¾å</strong>ï¼Œé¿å…äº†è·å–çš„å…¬é’¥æ˜¯ä¸­é—´äººçš„ã€‚</li></ul> <h3 id="_10-ssl-è¿æ¥æ–­å¼€åå¦‚ä½•æ¢å¤"><a href="http://interview.poetries.top/docs/simply.html#_10-ssl-%E8%BF%9E%E6%8E%A5%E6%96%AD%E5%BC%80%E5%90%8E%E5%A6%82%E4%BD%95%E6%81%A2%E5%A4%8D" class="header-anchor">#</a> 10 SSL è¿æ¥æ–­å¼€åå¦‚ä½•æ¢å¤</h3> <p>ä¸€å…±æœ‰ä¸¤ç§æ–¹æ³•æ¥æ¢å¤æ–­å¼€çš„ SSL è¿æ¥ï¼Œä¸€ç§æ˜¯ä½¿ç”¨ session IDï¼Œä¸€ç§æ˜¯ session ticketã€‚</p> <p><strong>é€šè¿‡session ID</strong></p> <p>ä½¿ç”¨ session ID çš„æ–¹å¼ï¼Œæ¯ä¸€æ¬¡çš„ä¼šè¯éƒ½æœ‰ä¸€ä¸ªç¼–å·ï¼Œå½“å¯¹è¯ä¸­æ–­åï¼Œä¸‹ä¸€æ¬¡é‡æ–°è¿æ¥æ—¶ï¼Œåªè¦å®¢æˆ·ç«¯ç»™å‡ºè¿™ä¸ªç¼–å·ï¼ŒæœåŠ¡å™¨å¦‚æœæœ‰è¿™ä¸ªç¼–å·çš„è®°å½•ï¼Œé‚£ä¹ˆåŒæ–¹å°±å¯ä»¥ç»§ç»­ä½¿ç”¨ä»¥å‰çš„ç§˜é’¥ï¼Œè€Œä¸ç”¨é‡æ–°ç”Ÿæˆä¸€æŠŠã€‚ç›®å‰æ‰€æœ‰çš„æµè§ˆå™¨éƒ½æ”¯æŒè¿™ä¸€ç§æ–¹æ³•ã€‚ä½†æ˜¯è¿™ç§æ–¹æ³•æœ‰ä¸€ä¸ªç¼ºç‚¹æ˜¯ï¼Œsession ID åªèƒ½å¤Ÿå­˜åœ¨ä¸€å°æœåŠ¡å™¨ä¸Šï¼Œå¦‚æœæˆ‘ä»¬çš„è¯·æ±‚é€šè¿‡è´Ÿè½½å¹³è¡¡è¢«è½¬ç§»åˆ°äº†å…¶ä»–çš„æœåŠ¡å™¨ä¸Šï¼Œé‚£ä¹ˆå°±æ— æ³•æ¢å¤å¯¹è¯ã€‚</p> <p><strong>é€šè¿‡session ticket</strong></p> <p>å¦ä¸€ç§æ–¹å¼æ˜¯ session ticket çš„æ–¹å¼ï¼Œsession ticket æ˜¯æœåŠ¡å™¨åœ¨ä¸Šä¸€æ¬¡å¯¹è¯ä¸­å‘é€ç»™å®¢æˆ·çš„ï¼Œè¿™ä¸ª ticket æ˜¯åŠ å¯†çš„ï¼Œåªæœ‰æœåŠ¡å™¨èƒ½å¤Ÿè§£å¯†ï¼Œé‡Œé¢åŒ…å«äº†æœ¬æ¬¡ä¼šè¯çš„ä¿¡æ¯ï¼Œæ¯”å¦‚å¯¹è¯ç§˜é’¥å’ŒåŠ å¯†æ–¹æ³•ç­‰ã€‚è¿™æ ·ä¸ç®¡æˆ‘ä»¬çš„è¯·æ±‚æ˜¯å¦è½¬ç§»åˆ°å…¶ä»–çš„æœåŠ¡å™¨ä¸Šï¼Œå½“æœåŠ¡å™¨å°† ticket è§£å¯†ä»¥åï¼Œå°±èƒ½å¤Ÿè·å–ä¸Šæ¬¡å¯¹è¯çš„ä¿¡æ¯ï¼Œå°±ä¸ç”¨é‡æ–°ç”Ÿæˆå¯¹è¯ç§˜é’¥äº†ã€‚</p> <h3 id="_11-è°ˆä¸€è°ˆä½ å¯¹http-2ç†è§£"><a href="http://interview.poetries.top/docs/simply.html#_11-%E8%B0%88%E4%B8%80%E8%B0%88%E4%BD%A0%E5%AF%B9http-2%E7%90%86%E8%A7%A3" class="header-anchor">#</a> 11 è°ˆä¸€è°ˆä½ å¯¹HTTP/2ç†è§£</h3> <blockquote><p>é¦–å…ˆè¡¥å……ä¸€ä¸‹ï¼Œhttp å’Œ https çš„åŒºåˆ«ï¼Œç›¸æ¯”äº http,https æ˜¯åŸºäº ssl åŠ å¯†çš„ http åè®®</p></blockquote> <p>ç®€è¦æ¦‚æ‹¬:<code>http2.0</code> æ˜¯åŸºäº 1999 å¹´å‘å¸ƒçš„ <code>http1.0</code> ä¹‹åçš„é¦–æ¬¡æ›´æ–°</p> <ul><li><strong>æå‡è®¿é—®é€Ÿåº¦</strong>(å¯ä»¥å¯¹äºï¼Œè¯·æ±‚èµ„æºæ‰€éœ€æ—¶é—´æ›´å°‘ï¼Œè®¿é—®é€Ÿåº¦æ›´å¿«ï¼Œç›¸æ¯” http1.0)</li> <li><strong>å…è®¸å¤šè·¯å¤ç”¨</strong>:å¤šè·¯å¤ç”¨å…è®¸åŒæ—¶é€šè¿‡å•ä¸€çš„ HTTP/2 è¿æ¥å‘é€å¤šé‡è¯·æ±‚-å“åº”ä¿¡æ¯ã€‚æ”¹ å–„äº†:åœ¨ <code>http1.1</code> ä¸­ï¼Œæµè§ˆå™¨å®¢æˆ·ç«¯åœ¨åŒä¸€æ—¶é—´ï¼Œé’ˆå¯¹åŒä¸€åŸŸåä¸‹çš„è¯·æ±‚æœ‰ä¸€å®šæ•°é‡é™ åˆ¶(è¿æ¥æ•°é‡)ï¼Œè¶…è¿‡é™åˆ¶ä¼šè¢«é˜»å¡</li> <li><strong>äºŒè¿›åˆ¶åˆ†å¸§</strong>:HTTP2.0 ä¼šå°†æ‰€æœ‰çš„ä¼ è¾“ä¿¡æ¯åˆ†å‰²ä¸ºæ›´å°çš„ä¿¡æ¯æˆ–è€…å¸§ï¼Œå¹¶å¯¹ä»–ä»¬è¿›è¡ŒäºŒ è¿›åˆ¶ç¼–ç </li> <li><strong>é¦–éƒ¨å‹ç¼©</strong></li> <li><strong>æœåŠ¡å™¨ç«¯æ¨é€</strong></li></ul> <p><strong>å¤´éƒ¨å‹ç¼©</strong></p> <blockquote><p>HTTP 1.1ç‰ˆæœ¬ä¼šå‡ºç° <strong>User-Agentã€Cookieã€Acceptã€Serverã€Range</strong> ç­‰å­—æ®µå¯èƒ½ä¼šå ç”¨å‡ ç™¾ç”šè‡³å‡ åƒå­—èŠ‚ï¼Œè€Œ Body å´ç»å¸¸åªæœ‰å‡ åå­—èŠ‚ï¼Œæ‰€ä»¥å¯¼è‡´å¤´éƒ¨åé‡ã€‚</p></blockquote> <p>HTTP 2.0 ä½¿ç”¨ <code>HPACK</code> ç®—æ³•è¿›è¡Œå‹ç¼©ã€‚</p> <p><strong>å¤šè·¯å¤ç”¨</strong></p> <ul><li>HTTP 1.x ä¸­ï¼Œå¦‚æœæƒ³å¹¶å‘å¤šä¸ªè¯·æ±‚ï¼Œå¿…é¡»ä½¿ç”¨å¤šä¸ª TCP é“¾æ¥ï¼Œä¸”æµè§ˆå™¨ä¸ºäº†æ§åˆ¶èµ„æºï¼Œè¿˜ä¼šå¯¹å•ä¸ªåŸŸåæœ‰ 6-8ä¸ªçš„TCPé“¾æ¥è¯·æ±‚é™åˆ¶ã€‚</li></ul> <p>HTTP2ä¸­ï¼š</p> <ul><li>åŒåŸŸåä¸‹æ‰€æœ‰é€šä¿¡éƒ½åœ¨å•ä¸ªè¿æ¥ä¸Šå®Œæˆã€‚</li> <li>å•ä¸ªè¿æ¥å¯ä»¥æ‰¿è½½ä»»æ„æ•°é‡çš„åŒå‘æ•°æ®æµã€‚</li> <li>æ•°æ®æµä»¥æ¶ˆæ¯çš„å½¢å¼å‘é€ï¼Œè€Œæ¶ˆæ¯åˆç”±ä¸€ä¸ªæˆ–å¤šä¸ªå¸§ç»„æˆï¼Œå¤šä¸ªå¸§ä¹‹é—´å¯ä»¥ä¹±åºå‘é€ï¼Œå› ä¸ºæ ¹æ®å¸§é¦–éƒ¨çš„æµæ ‡è¯†å¯ä»¥é‡æ–°ç»„è£…ï¼Œä¹Ÿå°±æ˜¯<code>Stream ID</code>ï¼Œæµæ ‡è¯†ç¬¦ï¼Œæœ‰äº†å®ƒï¼Œæ¥æ”¶æ–¹å°±èƒ½ä»ä¹±åºçš„äºŒè¿›åˆ¶å¸§ä¸­é€‰æ‹©IDç›¸åŒçš„å¸§ï¼ŒæŒ‰ç…§é¡ºåºç»„è£…æˆè¯·æ±‚/å“åº”æŠ¥æ–‡ã€‚</li></ul> <p><strong>æœåŠ¡å™¨æ¨é€</strong></p> <p>æµè§ˆå™¨å‘é€ä¸€ä¸ªè¯·æ±‚ï¼ŒæœåŠ¡å™¨ä¸»åŠ¨å‘æµè§ˆå™¨æ¨é€ä¸è¿™ä¸ªè¯·æ±‚ç›¸å…³çš„èµ„æºï¼Œè¿™æ ·æµè§ˆå™¨å°±ä¸ç”¨å‘èµ·åç»­è¯·æ±‚ã€‚</p> <p><strong>ç›¸æ¯”è¾ƒhttp/1.1çš„ä¼˜åŠ¿ğŸ‘‡</strong></p> <ul><li>æ¨é€èµ„æºå¯ä»¥ç”±ä¸åŒé¡µé¢å…±äº«</li> <li>æœåŠ¡å™¨å¯ä»¥æŒ‰ç…§ä¼˜å…ˆçº§æ¨é€èµ„æº</li> <li>å®¢æˆ·ç«¯å¯ä»¥ç¼“å­˜æ¨é€çš„èµ„æº</li> <li>å®¢æˆ·ç«¯å¯ä»¥æ‹’æ”¶æ¨é€è¿‡æ¥çš„èµ„æº</li></ul> <p><strong>äºŒè¿›åˆ¶åˆ†å¸§</strong></p> <p>ä¹‹å‰æ˜¯æ˜æ–‡ä¼ è¾“ï¼Œä¸æ–¹ä¾¿è®¡ç®—æœºè§£æï¼Œå¯¹äºå›è½¦æ¢è¡Œç¬¦æ¥è¯´åˆ°åº•æ˜¯å†…å®¹è¿˜æ˜¯åˆ†éš”ç¬¦ï¼Œéƒ½éœ€è¦å†…éƒ¨çŠ¶æ€æœºå»è¯†åˆ«ï¼Œè¿™æ ·å­æ•ˆç‡ä½ï¼ŒHTTP/2é‡‡ç”¨äºŒè¿›åˆ¶æ ¼å¼ï¼Œå…¨éƒ¨ä¼ è¾“01ä¸²ï¼Œä¾¿äºæœºå™¨è§£ç ã€‚</p> <p>è¿™æ ·å­ä¸€ä¸ªæŠ¥æ–‡æ ¼å¼å°±è¢«æ‹†åˆ†ä¸ºä¸€ä¸ªä¸ªäºŒè¿›åˆ¶å¸§ï¼Œç”¨<strong>Headerså¸§</strong>å­˜æ”¾å¤´éƒ¨å­—æ®µï¼Œ<strong>Dataå¸§</strong>å­˜æ”¾è¯·æ±‚ä½“æ•°æ®ã€‚è¿™æ ·å­çš„è¯ï¼Œå°±æ˜¯ä¸€å †ä¹±åºçš„äºŒè¿›åˆ¶å¸§ï¼Œå®ƒä»¬ä¸å­˜åœ¨å…ˆåå…³ç³»ï¼Œå› æ­¤ä¸éœ€è¦æ’é˜Ÿç­‰å¾…ï¼Œè§£å†³äº†HTTPé˜Ÿå¤´é˜»å¡é—®é¢˜ã€‚</p> <p>åœ¨å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¹‹é—´ï¼ŒåŒæ–¹éƒ½å¯ä»¥äº’ç›¸å‘é€äºŒè¿›åˆ¶å¸§ï¼Œè¿™æ ·å­<strong>åŒå‘ä¼ è¾“çš„åºåˆ—</strong>ï¼Œç§°ä¸º<code>æµ</code>ï¼Œæ‰€ä»¥HTTP/2ä¸­ä»¥æµæ¥è¡¨ç¤ºä¸€ä¸ªTCPè¿æ¥ä¸Šè¿›è¡Œå¤šä¸ªæ•°æ®å¸§çš„é€šä¿¡ï¼Œè¿™å°±æ˜¯å¤šè·¯å¤ç”¨æ¦‚å¿µã€‚</p> <blockquote><p>é‚£ä¹±åºçš„äºŒè¿›åˆ¶å¸§ï¼Œæ˜¯å¦‚ä½•ç»„è£…æˆå¯¹äºçš„æŠ¥æ–‡å‘¢ï¼Ÿ</p></blockquote> <ul><li>æ‰€è°“çš„ä¹±åºï¼Œå€¼çš„æ˜¯ä¸åŒIDçš„Streamæ˜¯ä¹±åºçš„ï¼Œå¯¹äºåŒä¸€ä¸ªStream IDçš„å¸§æ˜¯æŒ‰é¡ºåºä¼ è¾“çš„ã€‚</li> <li>æ¥æ”¶æ–¹æ”¶åˆ°äºŒè¿›åˆ¶å¸§åï¼Œå°†ç›¸åŒçš„Stream IDç»„è£…æˆå®Œæ•´çš„è¯·æ±‚æŠ¥æ–‡å’Œå“åº”æŠ¥æ–‡ã€‚</li> <li>äºŒè¿›åˆ¶å¸§ä¸­æœ‰ä¸€äº›å­—æ®µï¼Œæ§åˆ¶ç€<code>ä¼˜å…ˆçº§</code>å’Œ<code>æµé‡æ§åˆ¶</code>ç­‰åŠŸèƒ½ï¼Œè¿™æ ·å­çš„è¯ï¼Œå°±å¯ä»¥è®¾ç½®æ•°æ®å¸§çš„ä¼˜å…ˆçº§ï¼Œè®©æœåŠ¡å™¨å¤„ç†é‡è¦èµ„æºï¼Œä¼˜åŒ–ç”¨æˆ·ä½“éªŒã€‚</li></ul> <h3 id="_12-http-1-0-http1-1-http2-0ç‰ˆæœ¬ä¹‹é—´çš„å·®å¼‚"><a href="http://interview.poetries.top/docs/simply.html#_12-http-1-0-http1-1-http2-0%E7%89%88%E6%9C%AC%E4%B9%8B%E9%97%B4%E7%9A%84%E5%B7%AE%E5%BC%82" class="header-anchor">#</a> 12 HTTP/1.0 HTTP1.1 HTTP2.0ç‰ˆæœ¬ä¹‹é—´çš„å·®å¼‚</h3> <ul><li><strong>HTTP 0.9</strong>ï¼š1991å¹´,åŸå‹ç‰ˆæœ¬ï¼ŒåŠŸèƒ½ç®€é™‹ï¼Œåªæœ‰ä¸€ä¸ªå‘½ä»¤GET,åªæ”¯æŒçº¯æ–‡æœ¬å†…å®¹ï¼Œè¯¥ç‰ˆæœ¬å·²è¿‡æ—¶ã€‚</li> <li><strong>HTTP 1.0</strong> <ul><li>ä»»ä½•æ ¼å¼çš„å†…å®¹éƒ½å¯ä»¥å‘é€ï¼Œè¿™ä½¿å¾—äº’è”ç½‘ä¸ä»…å¯ä»¥ä¼ è¾“æ–‡å­—ï¼Œè¿˜èƒ½ä¼ è¾“å›¾åƒã€è§†é¢‘ã€äºŒè¿›åˆ¶ç­‰æ–‡ä»¶ã€‚</li> <li>é™¤äº†GETå‘½ä»¤ï¼Œè¿˜å¼•å…¥äº†POSTå‘½ä»¤å’ŒHEADå‘½ä»¤ã€‚</li> <li>httpè¯·æ±‚å’Œå›åº”çš„æ ¼å¼æ”¹å˜ï¼Œé™¤äº†æ•°æ®éƒ¨åˆ†ï¼Œæ¯æ¬¡é€šä¿¡éƒ½å¿…é¡»åŒ…æ‹¬å¤´ä¿¡æ¯ï¼ˆHTTP headerï¼‰ï¼Œç”¨æ¥æè¿°ä¸€äº›å…ƒæ•°æ®ã€‚</li> <li>åªä½¿ç”¨ header ä¸­çš„ If-Modified-Since å’Œ Expires ä½œä¸ºç¼“å­˜å¤±æ•ˆçš„æ ‡å‡†ã€‚</li> <li>ä¸æ”¯æŒæ–­ç‚¹ç»­ä¼ ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ¯æ¬¡éƒ½ä¼šä¼ é€å…¨éƒ¨çš„é¡µé¢å’Œæ•°æ®ã€‚</li> <li>é€šå¸¸æ¯å°è®¡ç®—æœºåªèƒ½ç»‘å®šä¸€ä¸ª IPï¼Œæ‰€ä»¥è¯·æ±‚æ¶ˆæ¯ä¸­çš„ URL å¹¶æ²¡æœ‰ä¼ é€’ä¸»æœºåï¼ˆhostnameï¼‰</li></ul></li> <li><strong>HTTP 1.1</strong>  http1.1æ˜¯ç›®å‰æœ€ä¸ºä¸»æµçš„httpåè®®ç‰ˆæœ¬ï¼Œä»1999å¹´å‘å¸ƒè‡³ä»Šï¼Œä»æ˜¯ä¸»æµçš„httpåè®®ç‰ˆæœ¬ã€‚
<ul><li>å¼•å…¥äº†æŒä¹…è¿æ¥ï¼ˆ persistent connectionï¼‰ï¼Œå³TCPè¿æ¥é»˜è®¤ä¸å…³é—­ï¼Œå¯ä»¥è¢«å¤šä¸ªè¯·æ±‚å¤ç”¨ï¼Œä¸ç”¨å£°æ˜Connection: keep-aliveã€‚é•¿è¿æ¥çš„è¿æ¥æ—¶é•¿å¯ä»¥é€šè¿‡è¯·æ±‚å¤´ä¸­çš„ <code>keep-alive</code> æ¥è®¾ç½®</li> <li>å¼•å…¥äº†ç®¡é“æœºåˆ¶ï¼ˆ pipeliningï¼‰ï¼Œå³åœ¨åŒä¸€ä¸ªTCPè¿æ¥é‡Œï¼Œå®¢æˆ·ç«¯å¯ä»¥åŒæ—¶å‘é€å¤šä¸ª
è¯·æ±‚ï¼Œè¿›ä¸€æ­¥æ”¹è¿›äº†HTTPåè®®çš„æ•ˆç‡ã€‚</li> <li>HTTP 1.1 ä¸­æ–°å¢åŠ äº† E-tagï¼ŒIf-Unmodified-Since, If-Match, If-None-Match ç­‰ç¼“å­˜æ§åˆ¶æ ‡å¤´æ¥æ§åˆ¶ç¼“å­˜å¤±æ•ˆã€‚</li> <li>æ”¯æŒæ–­ç‚¹ç»­ä¼ ï¼Œé€šè¿‡ä½¿ç”¨è¯·æ±‚å¤´ä¸­çš„ <code>Range</code> æ¥å®ç°ã€‚</li> <li>ä½¿ç”¨äº†è™šæ‹Ÿç½‘ç»œï¼Œåœ¨ä¸€å°ç‰©ç†æœåŠ¡å™¨ä¸Šå¯ä»¥å­˜åœ¨å¤šä¸ªè™šæ‹Ÿä¸»æœºï¼ˆMulti-homed Web Serversï¼‰ï¼Œå¹¶ä¸”å®ƒä»¬å…±äº«ä¸€ä¸ªIPåœ°å€ã€‚</li> <li>æ–°å¢æ–¹æ³•ï¼šPUTã€ PATCHã€ OPTIONSã€ DELETEã€‚</li></ul></li> <li><strong>http1.xç‰ˆæœ¬é—®é¢˜</strong> <ul><li>åœ¨ä¼ è¾“æ•°æ®è¿‡ç¨‹ä¸­ï¼Œæ‰€æœ‰å†…å®¹éƒ½æ˜¯æ˜æ–‡ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯éƒ½æ— æ³•éªŒè¯å¯¹æ–¹çš„èº«ä»½ï¼Œæ— æ³•ä¿è¯æ•°æ®çš„å®‰å…¨æ€§ã€‚</li> <li>HTTP/1.1 ç‰ˆæœ¬é»˜è®¤å…è®¸å¤ç”¨TCPè¿æ¥ï¼Œä½†æ˜¯åœ¨åŒä¸€ä¸ªTCPè¿æ¥é‡Œï¼Œæ‰€æœ‰æ•°æ®é€šä¿¡æ˜¯æŒ‰æ¬¡åºè¿›è¡Œçš„ï¼ŒæœåŠ¡å™¨é€šå¸¸åœ¨å¤„ç†å®Œä¸€ä¸ªå›åº”åï¼Œæ‰ä¼šç»§ç»­å»å¤„ç†ä¸‹ä¸€ä¸ªï¼Œè¿™æ ·å­å°±ä¼šé€ æˆé˜Ÿå¤´é˜»å¡ã€‚</li> <li>http/1.x ç‰ˆæœ¬æ”¯æŒKeep-aliveï¼Œç”¨æ­¤æ–¹æ¡ˆæ¥å¼¥è¡¥åˆ›å»ºå¤šæ¬¡è¿æ¥äº§ç”Ÿçš„å»¶è¿Ÿï¼Œä½†æ˜¯åŒæ ·ä¼šç»™æœåŠ¡å™¨å¸¦æ¥å‹åŠ›ï¼Œå¹¶ä¸”çš„è¯ï¼Œå¯¹äºå•æ–‡ä»¶è¢«ä¸æ–­è¯·æ±‚çš„æœåŠ¡ï¼ŒKeep-aliveä¼šæå¤§å½±å“æ€§èƒ½ï¼Œå› ä¸ºå®ƒåœ¨æ–‡ä»¶è¢«è¯·æ±‚ä¹‹åè¿˜ä¿æŒäº†ä¸å¿…è¦çš„è¿æ¥å¾ˆé•¿æ—¶é—´ã€‚</li></ul></li> <li><strong>HTTP 2.0</strong> <ul><li><code>äºŒè¿›åˆ¶åˆ†å¸§</code>  è¿™æ˜¯ä¸€æ¬¡å½»åº•çš„äºŒè¿›åˆ¶åè®®ï¼Œå¤´ä¿¡æ¯å’Œæ•°æ®ä½“éƒ½æ˜¯äºŒè¿›åˆ¶ï¼Œå¹¶ä¸”ç»Ÿç§°ä¸º"å¸§"ï¼šå¤´ä¿¡æ¯å¸§å’Œæ•°æ®å¸§ã€‚</li> <li><code>å¤´éƒ¨å‹ç¼©</code>  HTTP 1.1ç‰ˆæœ¬ä¼šå‡ºç° <strong>User-Agentã€Cookieã€Acceptã€Serverã€Range</strong> ç­‰å­—æ®µå¯èƒ½ä¼šå ç”¨å‡ ç™¾ç”šè‡³å‡ åƒå­—èŠ‚ï¼Œè€Œ Body å´ç»å¸¸åªæœ‰å‡ åå­—èŠ‚ï¼Œæ‰€ä»¥å¯¼è‡´å¤´éƒ¨åé‡ã€‚HTTP 2.0 ä½¿ç”¨ <code>HPACK</code> ç®—æ³•è¿›è¡Œå‹ç¼©ã€‚</li> <li><code>å¤šè·¯å¤ç”¨</code> å¤ç”¨TCPè¿æ¥ï¼Œåœ¨ä¸€ä¸ªè¿æ¥é‡Œï¼Œå®¢æˆ·ç«¯å’Œæµè§ˆå™¨éƒ½å¯ä»¥åŒæ—¶å‘é€å¤šä¸ªè¯·æ±‚æˆ–å›åº”ï¼Œä¸”ä¸ç”¨æŒ‰é¡ºåºä¸€ä¸€å¯¹åº”ï¼Œè¿™æ ·å­è§£å†³äº†é˜Ÿå¤´é˜»å¡çš„é—®é¢˜ã€‚</li> <li><code>æœåŠ¡å™¨æ¨é€</code> å…è®¸æœåŠ¡å™¨æœªç»è¯·æ±‚ï¼Œä¸»åŠ¨å‘å®¢æˆ·ç«¯å‘é€èµ„æºï¼Œå³æœåŠ¡å™¨æ¨é€ã€‚</li> <li><code>è¯·æ±‚ä¼˜å…ˆçº§</code> å¯ä»¥è®¾ç½®æ•°æ®å¸§çš„ä¼˜å…ˆçº§ï¼Œè®©æœåŠ¡ç«¯å…ˆå¤„ç†é‡è¦èµ„æºï¼Œä¼˜åŒ–ç”¨æˆ·ä½“éªŒã€‚</li></ul></li></ul> <h3 id="_13-dnså¦‚ä½•å·¥ä½œçš„"><a href="http://interview.poetries.top/docs/simply.html#_13-dns%E5%A6%82%E4%BD%95%E5%B7%A5%E4%BD%9C%E7%9A%84" class="header-anchor">#</a> 13 DNSå¦‚ä½•å·¥ä½œçš„</h3> <p>DNS åè®®æä¾›çš„æ˜¯ä¸€ç§ä¸»æœºååˆ° IP åœ°å€çš„è½¬æ¢æœåŠ¡ï¼Œå°±æ˜¯æˆ‘ä»¬å¸¸è¯´çš„åŸŸåç³»ç»Ÿã€‚æ˜¯åº”ç”¨å±‚åè®®ï¼Œé€šå¸¸è¯¥åè®®è¿è¡Œåœ¨UDPåè®®ä¹‹ä¸Šï¼Œä½¿ç”¨çš„æ˜¯53ç«¯å£å·ã€‚</p> <p><strong>æˆ‘ä»¬é€šè¿‡ä¸€å¼ å›¾æ¥çœ‹çœ‹å®ƒçš„æŸ¥è¯¢è¿‡ç¨‹å§</strong>ğŸ‘‡</p> <p><img src="./è¿›é˜¶_files/20210409102754.png" alt="" class="medium-zoom-image"></p> <p>è¿™å¼ å›¾å¾ˆç”ŸåŠ¨çš„å±•ç¤ºäº†DNSåœ¨æœ¬åœ°DNSæœåŠ¡å™¨æ˜¯å¦‚ä½•æŸ¥è¯¢çš„ï¼Œ<strong>ä¸€èˆ¬å‘æœ¬åœ°DNSæœåŠ¡å™¨å‘é€è¯·æ±‚æ˜¯é€’å½’æŸ¥è¯¢çš„</strong></p> <p>æœ¬åœ° DNS æœåŠ¡å™¨å‘å…¶ä»–åŸŸåæœåŠ¡å™¨è¯·æ±‚çš„è¿‡ç¨‹æ˜¯è¿­ä»£æŸ¥è¯¢çš„è¿‡ç¨‹ğŸ‘‡</p> <p><img src="./è¿›é˜¶_files/20210409102812.png" alt="" class="medium-zoom-image"></p> <p><strong>é€’å½’æŸ¥è¯¢å’Œè¿­ä»£æŸ¥è¯¢</strong></p> <ul><li>é€’å½’æŸ¥è¯¢æŒ‡çš„æ˜¯æŸ¥è¯¢è¯·æ±‚å‘å‡ºåï¼ŒåŸŸåæœåŠ¡å™¨ä»£ä¸ºå‘ä¸‹ä¸€çº§åŸŸåæœåŠ¡å™¨å‘å‡ºè¯·æ±‚ï¼Œæœ€åå‘ç”¨æˆ·è¿”å›æŸ¥è¯¢çš„æœ€ç»ˆç»“æœã€‚ä½¿ç”¨é€’å½’ æŸ¥è¯¢ï¼Œç”¨æˆ·åªéœ€è¦å‘å‡ºä¸€æ¬¡æŸ¥è¯¢è¯·æ±‚ã€‚</li> <li>è¿­ä»£æŸ¥è¯¢æŒ‡çš„æ˜¯æŸ¥è¯¢è¯·æ±‚åï¼ŒåŸŸåæœåŠ¡å™¨è¿”å›å•æ¬¡æŸ¥è¯¢çš„ç»“æœã€‚ä¸‹ä¸€çº§çš„æŸ¥è¯¢ç”±ç”¨æˆ·è‡ªå·±è¯·æ±‚ã€‚ä½¿ç”¨è¿­ä»£æŸ¥è¯¢ï¼Œç”¨æˆ·éœ€è¦å‘å‡º å¤šæ¬¡çš„æŸ¥è¯¢è¯·æ±‚ã€‚</li></ul> <p>æ‰€ä»¥ä¸€èˆ¬è€Œè¨€ï¼Œ<strong>æœ¬åœ°æœåŠ¡å™¨æŸ¥è¯¢æ˜¯é€’å½’æŸ¥è¯¢</strong>ï¼Œè€Œ<strong>æœ¬åœ° DNS æœåŠ¡å™¨å‘å…¶ä»–åŸŸåæœåŠ¡å™¨è¯·æ±‚çš„è¿‡ç¨‹æ˜¯è¿­ä»£æŸ¥è¯¢çš„è¿‡ç¨‹</strong></p> <p><strong>DNSç¼“å­˜</strong></p> <p>ç¼“å­˜ä¹Ÿå¾ˆå¥½ç†è§£ï¼Œåœ¨ä¸€ä¸ªè¯·æ±‚ä¸­ï¼Œå½“æŸä¸ªDNSæœåŠ¡å™¨æ”¶åˆ°ä¸€ä¸ªDNSå›ç­”åï¼Œå®ƒèƒ½å¤Ÿå›ç­”ä¸­çš„ä¿¡æ¯ç¼“å­˜åœ¨æœ¬åœ°å­˜å‚¨å™¨ä¸­ã€‚<strong>è¿”å›çš„èµ„æºè®°å½•ä¸­çš„ TTL ä»£è¡¨äº†è¯¥æ¡è®°å½•çš„ç¼“å­˜çš„æ—¶é—´ã€‚</strong></p> <p><strong>DNSå®ç°è´Ÿè½½å¹³è¡¡</strong></p> <p>å®ƒæ˜¯å¦‚ä½•å®ç°è´Ÿè½½å‡è¡¡çš„å‘¢ï¼Ÿé¦–å…ˆæˆ‘ä»¬å¾—æ¸…æ¥šDNS æ˜¯å¯ä»¥ç”¨äºåœ¨å†—ä½™çš„æœåŠ¡å™¨ä¸Šå®ç°è´Ÿè½½å¹³è¡¡ã€‚</p> <p>**åŸå› ï¼š**è¿™æ˜¯å› ä¸ºä¸€èˆ¬çš„å¤§å‹ç½‘ç«™ä½¿ç”¨å¤šå°æœåŠ¡å™¨æä¾›æœåŠ¡ï¼Œå› æ­¤ä¸€ä¸ªåŸŸåå¯èƒ½ä¼šå¯¹åº” å¤šä¸ªæœåŠ¡å™¨åœ°å€ã€‚</p> <p>ä¸¾ä¸ªä¾‹å­æ¥è¯´ğŸ‘‡</p> <ul><li>å½“ç”¨æˆ·å‘èµ·ç½‘ç«™åŸŸåçš„ DNS è¯·æ±‚çš„æ—¶å€™ï¼ŒDNS æœåŠ¡å™¨è¿”å›è¿™ä¸ªåŸŸåæ‰€å¯¹åº”çš„æœåŠ¡å™¨ IP åœ°å€çš„é›†åˆ</li> <li>åœ¨æ¯ä¸ªå›ç­”ä¸­ï¼Œä¼šå¾ªç¯è¿™äº› IP åœ°å€çš„é¡ºåºï¼Œç”¨æˆ·ä¸€èˆ¬ä¼šé€‰æ‹©æ’åœ¨å‰é¢çš„åœ°å€å‘é€è¯·æ±‚ã€‚</li> <li>ä»¥æ­¤å°†ç”¨æˆ·çš„è¯·æ±‚å‡è¡¡çš„åˆ†é…åˆ°å„ä¸ªä¸åŒçš„æœåŠ¡å™¨ä¸Šï¼Œè¿™æ ·æ¥å®ç°è´Ÿè½½å‡è¡¡ã€‚</li></ul> <p><strong>DNS ä¸ºä»€ä¹ˆä½¿ç”¨ UDP åè®®ä½œä¸ºä¼ è¾“å±‚åè®®ï¼Ÿ</strong></p> <blockquote><p>DNS ä½¿ç”¨ UDP åè®®ä½œä¸ºä¼ è¾“å±‚åè®®çš„ä¸»è¦åŸå› æ˜¯ä¸ºäº†é¿å…ä½¿ç”¨ TCP åè®®æ—¶é€ æˆçš„è¿æ¥æ—¶å»¶</p></blockquote> <ul><li>ä¸ºäº†å¾—åˆ°ä¸€ä¸ªåŸŸåçš„ IP åœ°å€ï¼Œå¾€å¾€ä¼šå‘å¤šä¸ªåŸŸåæœåŠ¡å™¨æŸ¥è¯¢ï¼Œå¦‚æœä½¿ç”¨ TCP åè®®ï¼Œé‚£ä¹ˆæ¯æ¬¡è¯·æ±‚éƒ½ä¼šå­˜åœ¨è¿æ¥æ—¶å»¶ï¼Œè¿™æ ·ä½¿ DNS æœåŠ¡å˜å¾—å¾ˆæ…¢ã€‚</li> <li>å¤§å¤šæ•°çš„åœ°å€æŸ¥è¯¢è¯·æ±‚ï¼Œéƒ½æ˜¯æµè§ˆå™¨è¯·æ±‚é¡µé¢æ—¶å‘å‡ºçš„ï¼Œè¿™æ ·ä¼šé€ æˆç½‘é¡µçš„ç­‰å¾…æ—¶é—´è¿‡é•¿ã€‚</li></ul> <p><strong>æ€»ç»“</strong></p> <ul><li>DNSåŸŸåç³»ç»Ÿï¼Œæ˜¯åº”ç”¨å±‚åè®®ï¼Œè¿è¡ŒUDPåè®®ä¹‹ä¸Šï¼Œä½¿ç”¨ç«¯å£43ã€‚</li> <li>æŸ¥è¯¢è¿‡ç¨‹ï¼Œæœ¬åœ°æŸ¥è¯¢æ˜¯é€’å½’æŸ¥è¯¢ï¼Œä¾æ¬¡é€šè¿‡æµè§ˆå™¨ç¼“å­˜ <code>â€”&gt;&gt;</code> æœ¬åœ°hostsæ–‡ä»¶ <code>â€”&gt;&gt;</code> æœ¬åœ°DNSè§£æå™¨ <code>â€”&gt;&gt;</code>æœ¬åœ°DNSæœåŠ¡å™¨ <code>â€”&gt;&gt;</code> å…¶ä»–åŸŸåæœåŠ¡å™¨è¯·æ±‚ã€‚ æ¥ä¸‹æ¥çš„è¿‡ç¨‹å°±æ˜¯è¿­ä»£è¿‡ç¨‹ã€‚</li> <li>é€’å½’æŸ¥è¯¢ä¸€èˆ¬è€Œè¨€ï¼Œå‘é€ä¸€æ¬¡è¯·æ±‚å°±å¤Ÿï¼Œè¿­ä»£è¿‡ç¨‹éœ€è¦ç”¨æˆ·å‘é€å¤šæ¬¡è¯·æ±‚ã€‚</li></ul> <h3 id="_14-çŸ­è½®è¯¢ã€é•¿è½®è¯¢å’Œ-websocket-é—´çš„åŒºåˆ«"><a href="http://interview.poetries.top/docs/simply.html#_14-%E7%9F%AD%E8%BD%AE%E8%AF%A2%E3%80%81%E9%95%BF%E8%BD%AE%E8%AF%A2%E5%92%8C-websocket-%E9%97%B4%E7%9A%84%E5%8C%BA%E5%88%AB" class="header-anchor">#</a> 14 çŸ­è½®è¯¢ã€é•¿è½®è¯¢å’Œ WebSocket é—´çš„åŒºåˆ«</h3> <p><strong>1. çŸ­è½®è¯¢</strong></p> <p>çŸ­è½®è¯¢çš„åŸºæœ¬æ€è·¯:</p> <ul><li>æµè§ˆå™¨æ¯éš”ä¸€æ®µæ—¶é—´å‘æµè§ˆå™¨å‘é€ http è¯·æ±‚ï¼ŒæœåŠ¡å™¨ç«¯åœ¨æ”¶åˆ°è¯·æ±‚åï¼Œä¸è®ºæ˜¯å¦æœ‰æ•°æ®æ›´æ–°ï¼Œéƒ½ç›´æ¥è¿›è¡Œ
å“åº”ã€‚</li> <li>è¿™ç§æ–¹å¼å®ç°çš„å³æ—¶é€šä¿¡ï¼Œæœ¬è´¨ä¸Šè¿˜æ˜¯æµè§ˆå™¨å‘é€è¯·æ±‚ï¼ŒæœåŠ¡å™¨æ¥å—è¯·æ±‚çš„ä¸€ä¸ªè¿‡ç¨‹ï¼Œé€šè¿‡è®©å®¢æˆ·ç«¯ä¸æ–­çš„è¿›è¡Œè¯·æ±‚ï¼Œä½¿å¾—å®¢æˆ·ç«¯èƒ½å¤Ÿæ¨¡æ‹Ÿå®æ—¶åœ°æ”¶åˆ°æœåŠ¡å™¨ç«¯çš„æ•°æ®çš„å˜åŒ–ã€‚</li></ul> <p>ä¼˜ç¼ºç‚¹ğŸ‘‡</p> <ul><li>ä¼˜ç‚¹æ˜¯æ¯”è¾ƒç®€å•ï¼Œæ˜“äºç†è§£ã€‚</li> <li>ç¼ºç‚¹æ˜¯è¿™ç§æ–¹å¼ç”±äºéœ€è¦ä¸æ–­çš„å»ºç«‹ http è¿æ¥ï¼Œä¸¥é‡æµªè´¹äº†æœåŠ¡å™¨ç«¯å’Œå®¢æˆ·ç«¯çš„èµ„æºã€‚å½“ç”¨æˆ·å¢åŠ æ—¶ï¼ŒæœåŠ¡å™¨ç«¯çš„å‹åŠ›å°±ä¼šå˜å¤§ï¼Œè¿™æ˜¯å¾ˆä¸åˆç†çš„ã€‚</li></ul> <p><strong>2. é•¿è½®è¯¢</strong></p> <p>é•¿è½®è¯¢çš„åŸºæœ¬æ€è·¯:</p> <ul><li>é¦–å…ˆç”±å®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘èµ·è¯·æ±‚ï¼Œå½“æœåŠ¡å™¨æ”¶åˆ°å®¢æˆ·ç«¯å‘æ¥çš„è¯·æ±‚åï¼ŒæœåŠ¡å™¨ç«¯ä¸ä¼šç›´æ¥è¿›è¡Œå“åº”ï¼Œè€Œæ˜¯å…ˆå°†
è¿™ä¸ªè¯·æ±‚æŒ‚èµ·ï¼Œç„¶ååˆ¤æ–­æœåŠ¡å™¨ç«¯æ•°æ®æ˜¯å¦æœ‰æ›´æ–°ã€‚</li> <li>å¦‚æœæœ‰æ›´æ–°ï¼Œåˆ™è¿›è¡Œå“åº”ï¼Œå¦‚æœä¸€ç›´æ²¡æœ‰æ•°æ®ï¼Œåˆ™åˆ°è¾¾ä¸€å®šçš„æ—¶é—´é™åˆ¶æ‰è¿”å›ã€‚å®¢æˆ·ç«¯ JavaScript å“åº”å¤„ç†å‡½æ•°ä¼šåœ¨å¤„ç†å®ŒæœåŠ¡å™¨è¿”å›çš„ä¿¡æ¯åï¼Œå†æ¬¡å‘å‡ºè¯·æ±‚ï¼Œé‡æ–°å»ºç«‹è¿æ¥ã€‚</li></ul> <p>ä¼˜ç¼ºç‚¹ğŸ‘‡</p> <ul><li>é•¿è½®è¯¢å’ŒçŸ­è½®è¯¢æ¯”èµ·æ¥ï¼Œå®ƒçš„ä¼˜ç‚¹æ˜¯<strong>æ˜æ˜¾å‡å°‘äº†å¾ˆå¤šä¸å¿…è¦çš„ http è¯·æ±‚æ¬¡æ•°</strong>ï¼Œç›¸æ¯”ä¹‹ä¸‹èŠ‚çº¦äº†èµ„æºã€‚</li> <li>é•¿è½®è¯¢çš„ç¼ºç‚¹åœ¨äºï¼Œè¿æ¥æŒ‚èµ·ä¹Ÿä¼šå¯¼è‡´èµ„æºçš„æµªè´¹</li></ul> <p><strong>3. WebSocket</strong></p> <ul><li>WebSocket æ˜¯ Html5 å®šä¹‰çš„ä¸€ä¸ªæ–°åè®®ï¼Œä¸ä¼ ç»Ÿçš„ http åè®®ä¸åŒï¼Œè¯¥åè®®å…è®¸ç”±æœåŠ¡å™¨ä¸»åŠ¨çš„å‘å®¢æˆ·ç«¯æ¨é€ä¿¡æ¯ã€‚</li> <li>ä½¿ç”¨ WebSocket åè®®çš„ç¼ºç‚¹æ˜¯åœ¨æœåŠ¡å™¨ç«¯çš„é…ç½®æ¯”è¾ƒå¤æ‚ã€‚WebSocket æ˜¯ä¸€ä¸ªå…¨åŒå·¥çš„åè®®ï¼Œä¹Ÿå°±æ˜¯é€šä¿¡åŒæ–¹æ˜¯å¹³ç­‰çš„ï¼Œå¯ä»¥ç›¸äº’å‘é€æ¶ˆæ¯ã€‚</li></ul> <h3 id="_15-è¯´ä¸€è¯´æ­£å‘ä»£ç†å’Œåå‘ä»£ç†"><a href="http://interview.poetries.top/docs/simply.html#_15-%E8%AF%B4%E4%B8%80%E8%AF%B4%E6%AD%A3%E5%90%91%E4%BB%A3%E7%90%86%E5%92%8C%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86" class="header-anchor">#</a> 15 è¯´ä¸€è¯´æ­£å‘ä»£ç†å’Œåå‘ä»£ç†</h3> <p><strong>æ­£å‘ä»£ç†</strong></p> <p>æˆ‘ä»¬å¸¸è¯´çš„ä»£ç†ä¹Ÿå°±æ˜¯æŒ‡æ­£å‘ä»£ç†ï¼Œæ­£å‘ä»£ç†çš„è¿‡ç¨‹ï¼Œå®ƒéšè—äº†çœŸå®çš„è¯·æ±‚å®¢æˆ·ç«¯ï¼ŒæœåŠ¡ç«¯ä¸çŸ¥é“çœŸå®çš„å®¢æˆ·ç«¯æ˜¯è°ï¼Œå®¢æˆ·ç«¯è¯·æ±‚çš„æœåŠ¡éƒ½è¢«ä»£ç†æœåŠ¡å™¨ä»£æ›¿æ¥è¯·æ±‚ã€‚</p> <p><strong>åå‘ä»£ç†</strong></p> <p>è¿™ç§ä»£ç†æ¨¡å¼ä¸‹ï¼Œå®ƒéšè—äº†çœŸå®çš„æœåŠ¡ç«¯ï¼Œå½“æˆ‘ä»¬å‘ä¸€ä¸ªç½‘ç«™å‘èµ·è¯·æ±‚çš„æ—¶å€™ï¼ŒèƒŒåå¯èƒ½æœ‰æˆåƒä¸Šä¸‡å°æœåŠ¡å™¨ä¸ºæˆ‘ä»¬æœåŠ¡ï¼Œå…·ä½“æ˜¯å“ªä¸€å°ï¼Œæˆ‘ä»¬ä¸æ¸…æ¥šï¼Œæˆ‘ä»¬åªéœ€è¦çŸ¥é“åå‘ä»£ç†æœåŠ¡å™¨æ˜¯è°å°±è¡Œï¼Œè€Œä¸”åå‘ä»£ç†æœåŠ¡å™¨ä¼šå¸®æˆ‘ä»¬æŠŠè¯·æ±‚è½¬å‘åˆ°çœŸå®çš„æœåŠ¡å™¨é‚£é‡Œå»ï¼Œä¸€èˆ¬è€Œè¨€åå‘ä»£ç†æœåŠ¡å™¨ä¸€èˆ¬ç”¨æ¥å®ç°è´Ÿè½½å¹³è¡¡ã€‚</p> <p><strong>è´Ÿè½½å¹³è¡¡çš„ä¸¤ç§å®ç°æ–¹å¼ï¼Ÿ</strong></p> <ul><li>ä¸€ç§æ˜¯ä½¿ç”¨åå‘ä»£ç†çš„æ–¹å¼ï¼Œç”¨æˆ·çš„è¯·æ±‚éƒ½å‘é€åˆ°åå‘ä»£ç†æœåŠ¡ä¸Šï¼Œç„¶åç”±åå‘ä»£ç†æœåŠ¡å™¨æ¥è½¬å‘è¯·æ±‚åˆ°çœŸå®çš„æœåŠ¡å™¨ä¸Šï¼Œä»¥æ­¤æ¥å®ç°é›†ç¾¤çš„è´Ÿè½½å¹³è¡¡ã€‚</li> <li>å¦ä¸€ç§æ˜¯ DNS çš„æ–¹å¼ï¼ŒDNS å¯ä»¥ç”¨äºåœ¨å†—ä½™çš„æœåŠ¡å™¨ä¸Šå®ç°è´Ÿè½½å¹³è¡¡ã€‚å› ä¸ºç°åœ¨ä¸€èˆ¬çš„å¤§å‹ç½‘ç«™ä½¿ç”¨å¤šå°æœåŠ¡å™¨æä¾›æœåŠ¡ï¼Œå› æ­¤ä¸€ä¸ªåŸŸåå¯èƒ½ä¼šå¯¹åº”å¤šä¸ªæœåŠ¡å™¨åœ°å€ã€‚å½“ç”¨æˆ·å‘ç½‘ç«™åŸŸåè¯·æ±‚çš„æ—¶å€™ï¼ŒDNS æœåŠ¡å™¨è¿”å›è¿™ä¸ªåŸŸåæ‰€å¯¹åº”çš„æœåŠ¡å™¨ IP åœ°å€çš„é›†åˆï¼Œä½†åœ¨æ¯ä¸ªå›ç­”ä¸­ï¼Œä¼šå¾ªç¯è¿™äº› IP åœ°å€çš„é¡ºåºï¼Œç”¨æˆ·ä¸€èˆ¬ä¼šé€‰æ‹©æ’åœ¨å‰é¢çš„åœ°å€å‘é€è¯·æ±‚ã€‚ä»¥æ­¤å°†ç”¨æˆ·çš„è¯·æ±‚å‡è¡¡çš„åˆ†é…åˆ°å„ä¸ªä¸åŒçš„æœåŠ¡å™¨ä¸Šï¼Œè¿™æ ·æ¥å®ç°è´Ÿè½½å‡è¡¡ã€‚è¿™ç§æ–¹å¼æœ‰ä¸€ä¸ªç¼ºç‚¹å°±æ˜¯ï¼Œç”±äº DNS æœåŠ¡å™¨ä¸­å­˜åœ¨ç¼“å­˜ï¼Œæ‰€ä»¥æœ‰å¯èƒ½ä¸€ä¸ªæœåŠ¡å™¨å‡ºç°æ•…éšœåï¼ŒåŸŸåè§£æä»ç„¶è¿”å›çš„æ˜¯é‚£ä¸ª IP åœ°å€ï¼Œå°±ä¼šé€ æˆè®¿é—®çš„é—®é¢˜ã€‚</li></ul> <h3 id="_16-ä»‹ç»ä¸€ä¸‹connection-keep-alive"><a href="http://interview.poetries.top/docs/simply.html#_16-%E4%BB%8B%E7%BB%8D%E4%B8%80%E4%B8%8Bconnection-keep-alive" class="header-anchor">#</a> 16 ä»‹ç»ä¸€ä¸‹Connection:keep-alive</h3> <p><strong>ä»€ä¹ˆæ˜¯keep-alive</strong></p> <p>æˆ‘ä»¬çŸ¥é“HTTPåè®®é‡‡ç”¨â€œè¯·æ±‚-åº”ç­”â€æ¨¡å¼ï¼Œå½“ä½¿ç”¨æ™®é€šæ¨¡å¼ï¼Œå³éKeepAliveæ¨¡å¼æ—¶ï¼Œæ¯ä¸ªè¯·æ±‚/åº”ç­”å®¢æˆ·å’ŒæœåŠ¡å™¨éƒ½è¦æ–°å»ºä¸€ä¸ªè¿æ¥ï¼Œå®Œæˆ ä¹‹åç«‹å³æ–­å¼€è¿æ¥ï¼ˆHTTPåè®®ä¸ºæ— è¿æ¥çš„åè®®ï¼‰ï¼›</p> <p>å½“ä½¿ç”¨Keep-Aliveæ¨¡å¼ï¼ˆåˆç§°æŒä¹…è¿æ¥ã€è¿æ¥é‡ç”¨ï¼‰æ—¶ï¼ŒKeep-AliveåŠŸèƒ½ä½¿å®¢æˆ·ç«¯åˆ°æœ åŠ¡å™¨ç«¯çš„è¿æ¥æŒç»­æœ‰æ•ˆï¼Œå½“å‡ºç°å¯¹æœåŠ¡å™¨çš„åç»§è¯·æ±‚æ—¶ï¼ŒKeep-AliveåŠŸèƒ½é¿å…äº†å»ºç«‹æˆ–è€…é‡æ–°å»ºç«‹è¿æ¥ã€‚</p> <p><strong>ä¸ºä»€ä¹ˆè¦ä½¿ç”¨keep-alive</strong></p> <p>keep-aliveæŠ€æœ¯çš„åˆ›å»ºç›®çš„ï¼Œèƒ½åœ¨å¤šæ¬¡HTTPä¹‹å‰é‡ç”¨åŒä¸€ä¸ªTCPè¿æ¥ï¼Œä»è€Œå‡å°‘åˆ›å»º/å…³é—­å¤šä¸ª TCP è¿æ¥çš„å¼€é”€ï¼ˆåŒ…æ‹¬å“åº”æ—¶é—´ã€CPU èµ„æºã€å‡å°‘æ‹¥å µç­‰ï¼‰ï¼Œå‚è€ƒå¦‚ä¸‹ç¤ºæ„å›¾</p> <p><img src="./è¿›é˜¶_files/20210409103238.png" alt="" class="medium-zoom-image"></p> <p><strong>å®¢æˆ·ç«¯å¦‚ä½•å¼€å¯</strong></p> <blockquote><p>åœ¨HTTP/1.0åè®®ä¸­ï¼Œé»˜è®¤æ˜¯å…³é—­çš„ï¼Œéœ€è¦åœ¨httpå¤´åŠ å…¥"Connection: Keep-Aliveâ€ï¼Œæ‰èƒ½å¯ç”¨Keep-Aliveï¼›</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>Connection: keep-alive
</code></pre></div><blockquote><p>http 1.1ä¸­é»˜è®¤å¯ç”¨Keep-Aliveï¼Œå¦‚æœåŠ å…¥"Connection: close â€œï¼Œæ‰å…³é—­ã€‚</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>Connection: close
</code></pre></div><p>ç›®å‰å¤§éƒ¨åˆ†æµè§ˆå™¨éƒ½æ˜¯ç”¨http1.1åè®®ï¼Œä¹Ÿå°±æ˜¯è¯´é»˜è®¤éƒ½ä¼šå‘èµ·Keep-Aliveçš„è¿æ¥è¯·æ±‚äº†ï¼Œæ‰€ä»¥æ˜¯å¦èƒ½å®Œæˆä¸€ä¸ªå®Œæ•´çš„Keep- Aliveè¿æ¥å°±çœ‹æœåŠ¡å™¨è®¾ç½®æƒ…å†µã€‚</p> <h3 id="_17-http-https-åè®®æ€»ç»“"><a href="http://interview.poetries.top/docs/simply.html#_17-http-https-%E5%8D%8F%E8%AE%AE%E6%80%BB%E7%BB%93" class="header-anchor">#</a> 17 http/https åè®®æ€»ç»“</h3> <p><strong>1.0 åè®®ç¼ºé™·:</strong></p> <ul><li>æ— æ³•å¤ç”¨é“¾æ¥ï¼Œå®Œæˆå³æ–­å¼€ï¼Œé‡æ–°æ…¢å¯åŠ¨å’Œ <code>TCP 3</code>æ¬¡æ¡æ‰‹</li> <li><code>head of line blocking</code>: çº¿å¤´é˜»å¡ï¼Œå¯¼è‡´è¯·æ±‚ä¹‹é—´äº’ç›¸å½±å“</li></ul> <p><strong>1.1 æ”¹è¿›:</strong></p> <ul><li>é•¿è¿æ¥(é»˜è®¤ <code>keep-alive</code>)ï¼Œå¤ç”¨</li> <li><code>host</code> å­—æ®µæŒ‡å®šå¯¹åº”çš„è™šæ‹Ÿç«™ç‚¹</li> <li><strong>æ–°å¢åŠŸèƒ½:</strong> <ul><li>æ–­ç‚¹ç»­ä¼ </li> <li>èº«ä»½è®¤è¯</li> <li>çŠ¶æ€ç®¡ç†</li> <li><code>cache</code> ç¼“å­˜
<ul><li><code>Cache-Control</code></li> <li><code>Expires</code></li> <li><code>Last-Modified</code></li> <li><code>Etag</code></li></ul></li></ul></li></ul> <p><strong>2.0:</strong></p> <ul><li>å¤šè·¯å¤ç”¨</li> <li>äºŒè¿›åˆ¶åˆ†å¸§å±‚: åº”ç”¨å±‚å’Œä¼ è¾“å±‚ä¹‹é—´</li> <li>é¦–éƒ¨å‹ç¼©</li> <li>æœåŠ¡ç«¯æ¨é€</li></ul> <p><strong>https: è¾ƒä¸ºå®‰å…¨çš„ç½‘ç»œä¼ è¾“åè®®</strong></p> <ul><li>è¯ä¹¦(å…¬é’¥)</li> <li><code>SSL</code> åŠ å¯†</li> <li>ç«¯å£ <code>443</code></li></ul> <p><strong>TCP:</strong></p> <ul><li>ä¸‰æ¬¡æ¡æ‰‹</li> <li>å››æ¬¡æŒ¥æ‰‹</li> <li>æ»‘åŠ¨çª—å£: æµé‡æ§åˆ¶</li> <li>æ‹¥å¡å¤„ç†
<ul><li>æ…¢å¼€å§‹</li> <li>æ‹¥å¡é¿å…</li> <li>å¿«é€Ÿé‡ä¼ </li> <li>å¿«é€Ÿæ¢å¤</li></ul></li></ul> <p><strong>ç¼“å­˜ç­–ç•¥: å¯åˆ†ä¸º å¼ºç¼“å­˜ å’Œ åå•†ç¼“å­˜</strong></p> <ul><li><code>Cache-Control/Expires</code>: æµè§ˆå™¨åˆ¤æ–­ç¼“å­˜æ˜¯å¦è¿‡æœŸï¼Œæœªè¿‡æœŸæ—¶ï¼Œç›´æ¥ä½¿ç”¨å¼ºç¼“å­˜ï¼Œ<code>Cache-Control</code>çš„ <code>max-age</code> ä¼˜å…ˆçº§é«˜äº <code>Expires</code></li> <li>å½“ç¼“å­˜å·²ç»è¿‡æœŸæ—¶ï¼Œä½¿ç”¨åå•†ç¼“å­˜
<ul><li>å”¯ä¸€æ ‡è¯†æ–¹æ¡ˆ: <code>Etag</code>(<code>response</code> æºå¸¦) &amp; <code>If-None-Match</code>(<code>request</code>æºå¸¦ï¼Œä¸Šä¸€æ¬¡è¿”å›çš„ <code>Etag</code>): æœåŠ¡å™¨åˆ¤æ–­èµ„æºæ˜¯å¦è¢«ä¿®æ”¹</li> <li>æœ€åä¸€æ¬¡ä¿®æ”¹æ—¶é—´: <code>Last-Modified(response) &amp; If-Modified-Since</code>(<code>request</code>ï¼Œä¸Šä¸€æ¬¡è¿”å›çš„<code>Last-Modified</code>)
<ul><li>å¦‚æœä¸€è‡´ï¼Œåˆ™ç›´æ¥è¿”å› 304 é€šçŸ¥æµè§ˆå™¨ä½¿ç”¨ç¼“å­˜</li> <li>å¦‚ä¸ä¸€è‡´ï¼Œåˆ™æœåŠ¡ç«¯è¿”å›æ–°çš„èµ„æº</li></ul></li></ul></li> <li><code>Last-Modified</code> ç¼ºç‚¹ï¼š
<ul><li>å‘¨æœŸæ€§ä¿®æ”¹ï¼Œä½†å†…å®¹æœªå˜æ—¶ï¼Œä¼šå¯¼è‡´ç¼“å­˜å¤±æ•ˆ</li> <li>æœ€å°ç²’åº¦åªåˆ° <code>s</code>ï¼Œ <code>s</code> ä»¥å†…çš„æ”¹åŠ¨æ— æ³•æ£€æµ‹åˆ°</li></ul></li> <li><code>Etag</code> çš„ä¼˜å…ˆçº§é«˜äº<code>Last-Modified</code></li></ul> <h3 id="_18-tcpä¸ºä»€ä¹ˆè¦ä¸‰æ¬¡æ¡æ‰‹"><a href="http://interview.poetries.top/docs/simply.html#_18-tcp%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B" class="header-anchor">#</a> 18 TCPä¸ºä»€ä¹ˆè¦ä¸‰æ¬¡æ¡æ‰‹</h3> <blockquote><p>å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯éƒ½éœ€è¦ç›´åˆ°å„è‡ªå¯æ”¶å‘ï¼Œå› æ­¤éœ€è¦ä¸‰æ¬¡æ¡æ‰‹</p></blockquote> <p><img src="./è¿›é˜¶_files/53062591-3d846300-34fc-11e9-8d0f-4063d9ff3398.png" alt="" class="medium-zoom-image"></p> <blockquote><p>TCPæœ‰6ç§æ ‡ç¤º:SYN(å»ºç«‹è”æœº) ACK(ç¡®è®¤) PSH(ä¼ é€) FIN(ç»“æŸ) RST(é‡ç½®) URG(ç´§æ€¥)</p></blockquote> <p><strong>ä¸¾ä¾‹ï¼šå·²å¤±æ•ˆçš„è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µ</strong></p> <ul><li><code>client</code>å‘é€äº†ç¬¬ä¸€ä¸ªè¿æ¥çš„è¯·æ±‚æŠ¥æ–‡ï¼Œä½†æ˜¯ç”±äºç½‘ç»œä¸å¥½ï¼Œè¿™ä¸ªè¯·æ±‚æ²¡æœ‰ç«‹å³åˆ°è¾¾æœåŠ¡ç«¯ï¼Œè€Œæ˜¯åœ¨æŸä¸ªç½‘ç»œèŠ‚ç‚¹ä¸­æ»ç•™äº†ï¼Œç›´åˆ°æŸä¸ªæ—¶é—´æ‰åˆ°è¾¾<code>server</code></li> <li>æœ¬æ¥è¿™å·²ç»æ˜¯ä¸€ä¸ªå¤±æ•ˆçš„æŠ¥æ–‡ï¼Œä½†æ˜¯<code>server</code>ç«¯æ¥æ”¶åˆ°è¿™ä¸ªè¯·æ±‚æŠ¥æ–‡åï¼Œè¿˜æ˜¯ä¼šæƒ³<code>client</code>å‘å‡ºç¡®è®¤çš„æŠ¥æ–‡ï¼Œè¡¨ç¤ºåŒæ„è¿æ¥ã€‚</li> <li>å‡å¦‚ä¸é‡‡ç”¨ä¸‰æ¬¡æ¡æ‰‹ï¼Œé‚£ä¹ˆåªè¦<code>server</code>å‘å‡ºç¡®è®¤ï¼Œæ–°çš„å»ºç«‹å°±è¿æ¥äº†ï¼Œä½†å…¶å®è¿™ä¸ªè¯·æ±‚æ˜¯å¤±æ•ˆçš„è¯·æ±‚ï¼Œ<code>client</code>æ˜¯ä¸ä¼šç†ç¬<code>server</code>çš„ç¡®è®¤ä¿¡æ¯ï¼Œä¹Ÿä¸ä¼šå‘æœåŠ¡ç«¯å‘é€ç¡®è®¤çš„è¯·æ±‚</li> <li>ä½†æ˜¯<code>server</code>è®¤ä¸ºæ–°çš„è¿æ¥å·²ç»å»ºç«‹èµ·æ¥äº†ï¼Œå¹¶ä¸€ç›´ç­‰å¾…<code>client</code>å‘æ¥æ•°æ®ï¼Œè¿™æ ·ï¼Œserverçš„å¾ˆå¤šèµ„æºå°±æ²¡ç™½ç™½æµªè´¹æ‰äº†</li> <li>é‡‡ç”¨ä¸‰æ¬¡æ¡æ‰‹å°±æ˜¯ä¸ºäº†é˜²æ­¢è¿™ç§æƒ…å†µçš„å‘ç”Ÿï¼Œserverä¼šå› ä¸ºæ”¶ä¸åˆ°ç¡®è®¤çš„æŠ¥æ–‡ï¼Œå°±çŸ¥é“<code>client</code>å¹¶æ²¡æœ‰å»ºç«‹è¿æ¥ã€‚è¿™å°±æ˜¯ä¸‰æ¬¡æ¡æ‰‹çš„ä½œç”¨</li></ul> <p><strong>ä¸‰æ¬¡æ¡æ‰‹è¿‡ç¨‹ä¸­å¯ä»¥æºå¸¦æ•°æ®å—</strong></p> <ul><li>ç¬¬ä¸€æ¬¡ã€ç¬¬äºŒæ¬¡æ¡æ‰‹ä¸å¯ä»¥æºå¸¦æ•°æ®ï¼Œå› ä¸ºä¸€æ¡äºŒæ¡æ—¶è¿˜æ²¡æœ‰å»ºç«‹è¿æ¥ï¼Œä¼šè®©æœåŠ¡å™¨å®¹æ˜“å—åˆ°æ”»å‡»</li> <li>è€Œç¬¬ä¸‰æ¬¡æ¡æ‰‹ï¼Œæ­¤æ—¶å®¢æˆ·ç«¯å·²ç»å¤„äº <code>ESTABLISHED (å·²å»ºç«‹è¿æ¥çŠ¶æ€)</code> ï¼Œå¯¹äºå®¢æˆ·ç«¯æ¥è¯´ï¼Œå·²ç»å»ºç«‹èµ·è¿æ¥äº†ï¼Œå¹¶ä¸”ä¹Ÿå·²ç»çŸ¥é“æœåŠ¡å™¨çš„æ¥æ”¶ã€å‘é€èƒ½åŠ›æ˜¯æ­£å¸¸çš„äº†ï¼Œæ‰€ä»¥èƒ½æºå¸¦æ•°æ®ä¹Ÿæ˜¯æ²¡é—®é¢˜çš„ã€‚</li></ul> <p><strong>TCPçš„å››æ¬¡æŒ¥æ‰‹</strong></p> <blockquote><p>ä¸ºäº†ç¡®ä¿æ•°æ®èƒ½å¤Ÿå®Œæˆä¼ è¾“</p></blockquote> <ul><li>å…³é—­è¿æ¥æ—¶ï¼Œå½“æ”¶åˆ°å¯¹æ–¹çš„FINæŠ¥æ–‡é€šçŸ¥æ—¶ï¼Œå®ƒä»…ä»…è¡¨ç¤ºå¯¹æ–¹æ²¡æœ‰æ•°æ®å‘é€ç»™ä½ äº†ï¼›ä½†æœªå¿…ä½ æ‰€æœ‰çš„æ•°æ®éƒ½å…¨éƒ¨å‘é€ç»™å¯¹æ–¹äº†</li> <li>æ‰€ä»¥ä½ æœªå¿…ä¼šé©¬ä¸Šå…³é—­<code>SOCKET</code>,ä¹Ÿå³ä½ å¯èƒ½è¿˜éœ€è¦å‘é€ä¸€äº›æ•°æ®ç»™å¯¹æ–¹ä¹‹åï¼Œå†å‘é€FINæŠ¥æ–‡ç»™å¯¹æ–¹æ¥è¡¨ç¤ºä½ åŒæ„ç°åœ¨å¯ä»¥å…³é—­è¿æ¥äº†ï¼Œæ‰€ä»¥å®ƒè¿™é‡Œçš„<code>ACK</code>æŠ¥æ–‡å’ŒFINæŠ¥æ–‡å¤šæ•°æƒ…å†µä¸‹éƒ½æ˜¯åˆ†å¼€å‘é€çš„ã€‚</li></ul> <h2 id="ä¹ã€9ç§å‰ç«¯å¸¸è§çš„è®¾è®¡æ¨¡å¼"><a href="http://interview.poetries.top/docs/simply.html#%E4%B9%9D%E3%80%819%E7%A7%8D%E5%89%8D%E7%AB%AF%E5%B8%B8%E8%A7%81%E7%9A%84%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F" class="header-anchor">#</a> ä¹ã€9ç§å‰ç«¯å¸¸è§çš„è®¾è®¡æ¨¡å¼</h2> <h3 id="_1-å¤–è§‚æ¨¡å¼"><a href="http://interview.poetries.top/docs/simply.html#_1-%E5%A4%96%E8%A7%82%E6%A8%A1%E5%BC%8F" class="header-anchor">#</a> 1. å¤–è§‚æ¨¡å¼</h3> <blockquote><p>å¤–è§‚æ¨¡å¼æ˜¯æœ€å¸¸è§çš„è®¾è®¡æ¨¡å¼ä¹‹ä¸€ï¼Œå®ƒä¸ºå­ç³»ç»Ÿä¸­çš„ä¸€ç»„æ¥å£æä¾›ä¸€ä¸ªç»Ÿä¸€çš„é«˜å±‚æ¥å£ï¼Œä½¿å­ç³»ç»Ÿæ›´å®¹æ˜“ä½¿ç”¨ã€‚ç®€è€Œè¨€ä¹‹å¤–è§‚è®¾è®¡æ¨¡å¼å°±æ˜¯æŠŠå¤šä¸ªå­ç³»ç»Ÿä¸­å¤æ‚é€»è¾‘è¿›è¡ŒæŠ½è±¡ï¼Œä»è€Œæä¾›ä¸€ä¸ªæ›´ç»Ÿä¸€ã€æ›´ç®€æ´ã€æ›´æ˜“ç”¨çš„APIã€‚å¾ˆå¤šæˆ‘ä»¬å¸¸ç”¨çš„æ¡†æ¶å’Œåº“åŸºæœ¬éƒ½éµå¾ªäº†å¤–è§‚è®¾è®¡æ¨¡å¼ï¼Œæ¯”å¦‚JQueryå°±æŠŠå¤æ‚çš„åŸç”ŸDOMæ“ä½œè¿›è¡Œäº†æŠ½è±¡å’Œå°è£…ï¼Œå¹¶æ¶ˆé™¤äº†æµè§ˆå™¨ä¹‹é—´çš„å…¼å®¹é—®é¢˜ï¼Œä»è€Œæä¾›äº†ä¸€ä¸ªæ›´é«˜çº§æ›´æ˜“ç”¨çš„ç‰ˆæœ¬ã€‚å…¶å®åœ¨å¹³æ—¶å·¥ä½œä¸­æˆ‘ä»¬ä¹Ÿä¼šç»å¸¸ç”¨åˆ°å¤–è§‚æ¨¡å¼è¿›è¡Œå¼€å‘ï¼Œåªæ˜¯æˆ‘ä»¬ä¸è‡ªçŸ¥è€Œå·²</p></blockquote> <p><strong>å…¼å®¹æµè§ˆå™¨äº‹ä»¶ç»‘å®š</strong></p> <div class="language- extra-class"><pre class="language-text"><code>let addMyEvent = function (el, ev, fn) {
    if (el.addEventListener) {
        el.addEventListener(ev, fn, false)
    } else if (el.attachEvent) {
        el.attachEvent('on' + ev, fn)
    } else {
        el['on' + ev] = fn
    }
};
</code></pre></div><p><strong>å°è£…æ¥å£</strong></p> <div class="language- extra-class"><pre class="language-text"><code>let myEvent = {
    // ...
    stop: e =&gt; {
        e.stopPropagation();
        e.preventDefault();
    }
};
</code></pre></div><p><strong>åœºæ™¯</strong></p> <ul><li>è®¾è®¡åˆæœŸï¼Œåº”è¯¥è¦æœ‰æ„è¯†åœ°å°†ä¸åŒçš„ä¸¤ä¸ªå±‚åˆ†ç¦»ï¼Œæ¯”å¦‚ç»å…¸çš„ä¸‰å±‚ç»“æ„ï¼Œåœ¨æ•°æ®è®¿é—®å±‚å’Œä¸šåŠ¡é€»è¾‘å±‚ã€ä¸šåŠ¡é€»è¾‘å±‚å’Œè¡¨ç¤ºå±‚ä¹‹é—´å»ºç«‹å¤–è§‚Facade</li> <li>åœ¨å¼€å‘é˜¶æ®µï¼Œå­ç³»ç»Ÿå¾€å¾€å› ä¸ºä¸æ–­çš„é‡æ„æ¼”åŒ–è€Œå˜å¾—è¶Šæ¥è¶Šå¤æ‚ï¼Œå¢åŠ å¤–è§‚Facadeå¯ä»¥æä¾›ä¸€ä¸ªç®€å•çš„æ¥å£ï¼Œå‡å°‘ä»–ä»¬ä¹‹é—´çš„ä¾èµ–ã€‚</li> <li>åœ¨ç»´æŠ¤ä¸€ä¸ªé—ç•™çš„å¤§å‹ç³»ç»Ÿæ—¶ï¼Œå¯èƒ½è¿™ä¸ªç³»ç»Ÿå·²ç»å¾ˆéš¾ç»´æŠ¤äº†ï¼Œè¿™æ—¶å€™ä½¿ç”¨å¤–è§‚Facadeä¹Ÿæ˜¯éå¸¸åˆé€‚çš„ï¼Œä¸ºç³»ç³»ç»Ÿå¼€å‘ä¸€ä¸ªå¤–è§‚Facadeç±»ï¼Œä¸ºè®¾è®¡ç²—ç³™å’Œé«˜åº¦å¤æ‚çš„é—ç•™ä»£ç æä¾›æ¯”è¾ƒæ¸…æ™°çš„æ¥å£ï¼Œè®©æ–°ç³»ç»Ÿå’ŒFacadeå¯¹è±¡äº¤äº’ï¼ŒFacadeä¸é—ç•™ä»£ç äº¤äº’æ‰€æœ‰çš„å¤æ‚å·¥ä½œã€‚</li></ul> <p><strong>ä¼˜ç‚¹</strong></p> <ul><li>å‡å°‘ç³»ç»Ÿç›¸äº’ä¾èµ–ã€‚</li> <li>æé«˜çµæ´»æ€§ã€‚</li> <li>æé«˜äº†å®‰å…¨æ€§</li></ul> <p><strong>ç¼ºç‚¹</strong></p> <blockquote><p>ä¸ç¬¦åˆå¼€é—­åŸåˆ™ï¼Œå¦‚æœè¦æ”¹ä¸œè¥¿å¾ˆéº»çƒ¦ï¼Œç»§æ‰¿é‡å†™éƒ½ä¸åˆé€‚ã€‚</p></blockquote> <h3 id="_2-ä»£ç†æ¨¡å¼"><a href="http://interview.poetries.top/docs/simply.html#_2-%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F" class="header-anchor">#</a> 2. ä»£ç†æ¨¡å¼</h3> <blockquote><p>æ˜¯ä¸ºä¸€ä¸ªå¯¹è±¡æä¾›ä¸€ä¸ªä»£ç”¨å“æˆ–å ä½ç¬¦ï¼Œä»¥ä¾¿æ§åˆ¶å¯¹å®ƒçš„è®¿é—®</p></blockquote> <p>å‡è®¾å½“A åœ¨å¿ƒæƒ…å¥½çš„æ—¶å€™æ”¶åˆ°èŠ±ï¼Œå°æ˜è¡¨ç™½æˆåŠŸçš„å‡ ç‡æœ‰60%ï¼Œè€Œå½“A åœ¨å¿ƒæƒ…å·®çš„æ—¶å€™æ”¶åˆ°èŠ±ï¼Œå°æ˜è¡¨ç™½çš„æˆåŠŸç‡æ— é™è¶‹è¿‘äº0ã€‚å°æ˜è·ŸA åˆšåˆšè®¤è¯†ä¸¤å¤©ï¼Œè¿˜æ— æ³•è¾¨åˆ«A ä»€ä¹ˆæ—¶å€™å¿ƒæƒ…å¥½ã€‚å¦‚æœä¸åˆæ—¶å®œåœ°æŠŠèŠ±é€ç»™Aï¼ŒèŠ±è¢«ç›´æ¥æ‰”æ‰çš„å¯èƒ½æ€§å¾ˆå¤§ï¼Œè¿™æŸèŠ±å¯æ˜¯å°æ˜åƒäº†7 å¤©æ³¡é¢æ¢æ¥çš„ã€‚ä½†æ˜¯A çš„æœ‹å‹B å´å¾ˆäº†è§£Aï¼Œæ‰€ä»¥å°æ˜åªç®¡æŠŠèŠ±äº¤ç»™Bï¼ŒB ä¼šç›‘å¬A çš„å¿ƒæƒ…å˜åŒ–ï¼Œç„¶åé€‰æ‹©A å¿ƒæƒ…å¥½çš„æ—¶å€™æŠŠèŠ±è½¬äº¤ç»™Aï¼Œä»£ç å¦‚ä¸‹ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>let Flower = function() {}
let xiaoming = {
  sendFlower: function(target) {
    let flower = new Flower()
    target.receiveFlower(flower)
  }
}
let B = {
  receiveFlower: function(flower) {
    A.listenGoodMood(function() {
      A.receiveFlower(flower)
    })
  }
}
let A = {
  receiveFlower: function(flower) {
    console.log('æ”¶åˆ°èŠ±'+ flower)
  },
  listenGoodMood: function(fn) {
    setTimeout(function() {
      fn()
    }, 1000)
  }
}
xiaoming.sendFlower(B)
</code></pre></div><p><strong>åœºæ™¯</strong></p> <p>HTMLå…ƒ ç´ äº‹ä»¶ä»£ç†</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;ul id="ul"&gt;
  &lt;li&gt;1&lt;/li&gt;
  &lt;li&gt;2&lt;/li&gt;
  &lt;li&gt;3&lt;/li&gt;
&lt;/ul&gt;
&lt;script&gt;
  let ul = document.querySelector('#ul');
  ul.addEventListener('click', event =&gt; {
    console.log(event.target);
  });
&lt;/script&gt;
</code></pre></div><p><strong>ä¼˜ç‚¹</strong></p> <ul><li>ä»£ç†æ¨¡å¼èƒ½å°†ä»£ç†å¯¹è±¡ä¸è¢«è°ƒç”¨å¯¹è±¡åˆ†ç¦»ï¼Œé™ä½äº†ç³»ç»Ÿçš„è€¦åˆåº¦ã€‚ä»£ç†æ¨¡å¼åœ¨å®¢æˆ·ç«¯å’Œç›®æ ‡å¯¹è±¡ä¹‹é—´èµ·åˆ°ä¸€ä¸ªä¸­ä»‹ä½œç”¨ï¼Œè¿™æ ·å¯ä»¥èµ·åˆ°ä¿æŠ¤ç›®æ ‡å¯¹è±¡çš„ä½œç”¨</li> <li>ä»£ç†å¯¹è±¡å¯ä»¥æ‰©å±•ç›®æ ‡å¯¹è±¡çš„åŠŸèƒ½ï¼›é€šè¿‡ä¿®æ”¹ä»£ç†å¯¹è±¡å°±å¯ä»¥äº†ï¼Œç¬¦åˆå¼€é—­åŸåˆ™ï¼›</li></ul> <p><strong>ç¼ºç‚¹</strong></p> <p>å¤„ç†è¯·æ±‚é€Ÿåº¦å¯èƒ½æœ‰å·®åˆ«ï¼Œéç›´æ¥è®¿é—®å­˜åœ¨å¼€é”€</p> <h3 id="_3-å·¥å‚æ¨¡å¼"><a href="http://interview.poetries.top/docs/simply.html#_3-%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F" class="header-anchor">#</a> 3. å·¥å‚æ¨¡å¼</h3> <blockquote><p>å·¥å‚æ¨¡å¼å®šä¹‰ä¸€ä¸ªç”¨äºåˆ›å»ºå¯¹è±¡çš„æ¥å£ï¼Œè¿™ä¸ªæ¥å£ç”±å­ç±»å†³å®šå®ä¾‹åŒ–å“ªä¸€ä¸ªç±»ã€‚è¯¥æ¨¡å¼ä½¿ä¸€ä¸ªç±»çš„å®ä¾‹åŒ–å»¶è¿Ÿåˆ°äº†å­ç±»ã€‚è€Œå­ç±»å¯ä»¥é‡å†™æ¥å£æ–¹æ³•ä»¥ä¾¿åˆ›å»ºçš„æ—¶å€™æŒ‡å®šè‡ªå·±çš„å¯¹è±¡ç±»å‹ã€‚</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>class Product {
    constructor(name) {
        this.name = name
    }
    init() {
        console.log('init')
    }
    fun() {
        console.log('fun')
    }
}

class Factory {
    create(name) {
        return new Product(name)
    }
}

// use
let factory = new Factory()
let p = factory.create('p1')
p.init()
p.fun()
</code></pre></div><p><strong>åœºæ™¯</strong></p> <ul><li>å¦‚æœä½ ä¸æƒ³è®©æŸä¸ªå­ç³»ç»Ÿä¸è¾ƒå¤§çš„é‚£ä¸ªå¯¹è±¡ä¹‹é—´å½¢æˆå¼ºè€¦åˆï¼Œè€Œæ˜¯æƒ³è¿è¡Œæ—¶ä»è®¸å¤šå­ç³»ç»Ÿä¸­è¿›è¡ŒæŒ‘é€‰çš„è¯ï¼Œé‚£ä¹ˆå·¥å‚æ¨¡å¼æ˜¯ä¸€ä¸ªç†æƒ³çš„é€‰æ‹©</li> <li>å°†newæ“ä½œç®€å•å°è£…ï¼Œé‡åˆ°newçš„æ—¶å€™å°±åº”è¯¥è€ƒè™‘æ˜¯å¦ç”¨å·¥å‚æ¨¡å¼ï¼›</li> <li>éœ€è¦ä¾èµ–å…·ä½“ç¯å¢ƒåˆ›å»ºä¸åŒå®ä¾‹ï¼Œè¿™äº›å®ä¾‹éƒ½æœ‰ç›¸åŒçš„è¡Œä¸º,è¿™æ—¶å€™æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å·¥å‚æ¨¡å¼ï¼Œç®€åŒ–å®ç°çš„è¿‡ç¨‹ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥å‡å°‘æ¯ç§å¯¹è±¡æ‰€éœ€çš„ä»£ç é‡ï¼Œæœ‰åˆ©äºæ¶ˆé™¤å¯¹è±¡é—´çš„è€¦åˆï¼Œæä¾›æ›´å¤§çš„çµæ´»æ€§</li></ul> <p><strong>ä¼˜ç‚¹</strong></p> <ul><li>åˆ›å»ºå¯¹è±¡çš„è¿‡ç¨‹å¯èƒ½å¾ˆå¤æ‚ï¼Œä½†æˆ‘ä»¬åªéœ€è¦å…³å¿ƒåˆ›å»ºç»“æœã€‚</li> <li>æ„é€ å‡½æ•°å’Œåˆ›å»ºè€…åˆ†ç¦», ç¬¦åˆâ€œå¼€é—­åŸåˆ™â€</li> <li>ä¸€ä¸ªè°ƒç”¨è€…æƒ³åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œåªè¦çŸ¥é“å…¶åç§°å°±å¯ä»¥äº†ã€‚</li> <li>æ‰©å±•æ€§é«˜ï¼Œå¦‚æœæƒ³å¢åŠ ä¸€ä¸ªäº§å“ï¼Œåªè¦æ‰©å±•ä¸€ä¸ªå·¥å‚ç±»å°±å¯ä»¥ã€‚</li></ul> <p><strong>ç¼ºç‚¹</strong></p> <ul><li>æ·»åŠ æ–°äº§å“æ—¶ï¼Œéœ€è¦ç¼–å†™æ–°çš„å…·ä½“äº§å“ç±»,ä¸€å®šç¨‹åº¦ä¸Šå¢åŠ äº†ç³»ç»Ÿçš„å¤æ‚åº¦</li> <li>è€ƒè™‘åˆ°ç³»ç»Ÿçš„å¯æ‰©å±•æ€§ï¼Œéœ€è¦å¼•å…¥æŠ½è±¡å±‚ï¼Œåœ¨å®¢æˆ·ç«¯ä»£ç ä¸­å‡ä½¿ç”¨æŠ½è±¡å±‚è¿›è¡Œå®šä¹‰ï¼Œå¢åŠ äº†ç³»ç»Ÿçš„æŠ½è±¡æ€§å’Œç†è§£éš¾åº¦</li></ul> <p><strong>ä»€ä¹ˆæ—¶å€™ä¸ç”¨</strong></p> <blockquote><p>å½“è¢«åº”ç”¨åˆ°é”™è¯¯çš„é—®é¢˜ç±»å‹ä¸Šæ—¶,è¿™ä¸€æ¨¡å¼ä¼šç»™åº”ç”¨ç¨‹åºå¼•å…¥å¤§é‡ä¸å¿…è¦çš„å¤æ‚æ€§.é™¤éä¸ºåˆ›å»ºå¯¹è±¡æä¾›ä¸€ä¸ªæ¥å£æ˜¯æˆ‘ä»¬ç¼–å†™çš„åº“æˆ–è€…æ¡†æ¶çš„ä¸€ä¸ªè®¾è®¡ä¸Šç›®æ ‡,å¦åˆ™æˆ‘ä¼šå»ºè®®ä½¿ç”¨æ˜ç¡®çš„æ„é€ å™¨,ä»¥é¿å…ä¸å¿…è¦çš„å¼€é”€ã€‚</p></blockquote> <p>ç”±äºå¯¹è±¡çš„åˆ›å»ºè¿‡ç¨‹è¢«é«˜æ•ˆçš„æŠ½è±¡åœ¨ä¸€ä¸ªæ¥å£åé¢çš„äº‹å®,è¿™ä¹Ÿä¼šç»™ä¾èµ–äºè¿™ä¸ªè¿‡ç¨‹å¯èƒ½ä¼šæœ‰å¤šå¤æ‚çš„å•å…ƒæµ‹è¯•å¸¦æ¥é—®é¢˜ã€‚</p> <h3 id="_4-å•ä¾‹æ¨¡å¼"><a href="http://interview.poetries.top/docs/simply.html#_4-%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F" class="header-anchor">#</a> 4. å•ä¾‹æ¨¡å¼</h3> <blockquote><p>é¡¾åæ€ä¹‰ï¼Œå•ä¾‹æ¨¡å¼ä¸­Classçš„å®ä¾‹ä¸ªæ•°æœ€å¤šä¸º1ã€‚å½“éœ€è¦ä¸€ä¸ªå¯¹è±¡å»è´¯ç©¿æ•´ä¸ªç³»ç»Ÿæ‰§è¡ŒæŸäº›ä»»åŠ¡æ—¶ï¼Œå•ä¾‹æ¨¡å¼å°±æ´¾ä¸Šäº†ç”¨åœºã€‚è€Œé™¤æ­¤ä¹‹å¤–çš„åœºæ™¯å°½é‡é¿å…å•ä¾‹æ¨¡å¼çš„ä½¿ç”¨ï¼Œå› ä¸ºå•ä¾‹æ¨¡å¼ä¼šå¼•å…¥å…¨å±€çŠ¶æ€ï¼Œè€Œä¸€ä¸ªå¥åº·çš„ç³»ç»Ÿåº”è¯¥é¿å…å¼•å…¥è¿‡å¤šçš„å…¨å±€çŠ¶æ€ã€‚</p></blockquote> <p><strong>å®ç°å•ä¾‹æ¨¡å¼éœ€è¦è§£å†³ä»¥ä¸‹å‡ ä¸ªé—®é¢˜ï¼š</strong></p> <ul><li>å¦‚ä½•ç¡®å®šClassåªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Ÿ</li> <li>å¦‚ä½•ç®€ä¾¿çš„è®¿é—®Classçš„å”¯ä¸€å®ä¾‹ï¼Ÿ</li> <li>Classå¦‚ä½•æ§åˆ¶å®ä¾‹åŒ–çš„è¿‡ç¨‹ï¼Ÿ</li> <li>å¦‚ä½•å°†Classçš„å®ä¾‹ä¸ªæ•°é™åˆ¶ä¸º1ï¼Ÿ</li></ul> <blockquote><p>æˆ‘ä»¬ä¸€èˆ¬é€šè¿‡å®ç°ä»¥ä¸‹ä¸¤ç‚¹æ¥è§£å†³ä¸Šè¿°é—®é¢˜ï¼š</p></blockquote> <ul><li>éšè—Classçš„æ„é€ å‡½æ•°ï¼Œé¿å…å¤šæ¬¡å®ä¾‹åŒ–</li> <li>é€šè¿‡æš´éœ²ä¸€ä¸ª <code>getInstance()</code> æ–¹æ³•æ¥åˆ›å»º/è·å–å”¯ä¸€å®ä¾‹</li></ul> <p>Javascriptä¸­å•ä¾‹æ¨¡å¼å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼å®ç°ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>// å•ä¾‹æ„é€ å™¨
const FooServiceSingleton = (function () {
  // éšè—çš„Classçš„æ„é€ å‡½æ•°
  function FooService() {}

  // æœªåˆå§‹åŒ–çš„å•ä¾‹å¯¹è±¡
  let fooService;

  return {
    // åˆ›å»º/è·å–å•ä¾‹å¯¹è±¡çš„å‡½æ•°
    getInstance: function () {
      if (!fooService) {
        fooService = new FooService();
      }
      return fooService;
    }
  }
})();
</code></pre></div><p><strong>å®ç°çš„å…³é”®ç‚¹æœ‰ï¼š</strong></p> <ul><li>ä½¿ç”¨ IIFEåˆ›å»ºå±€éƒ¨ä½œç”¨åŸŸå¹¶å³æ—¶æ‰§è¡Œï¼›</li> <li>getInstance() ä¸ºä¸€ä¸ª é—­åŒ… ï¼Œä½¿ç”¨é—­åŒ…ä¿å­˜å±€éƒ¨ä½œç”¨åŸŸä¸­çš„å•ä¾‹å¯¹è±¡å¹¶è¿”å›ã€‚</li></ul> <p>æˆ‘ä»¬å¯ä»¥éªŒè¯ä¸‹å•ä¾‹å¯¹è±¡æ˜¯å¦åˆ›å»ºæˆåŠŸï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>const fooService1 = FooServiceSingleton.getInstance();
const fooService2 = FooServiceSingleton.getInstance();

console.log(fooService1 === fooService2); // true
</code></pre></div><p><strong>åœºæ™¯ä¾‹å­</strong></p> <ul><li>å®šä¹‰å‘½åç©ºé—´å’Œå®ç°åˆ†æ”¯å‹æ–¹æ³•</li> <li>ç™»å½•æ¡†</li> <li>vuex å’Œ reduxä¸­çš„store</li></ul> <p><strong>ä¼˜ç‚¹</strong></p> <ul><li>åˆ’åˆ†å‘½åç©ºé—´ï¼Œå‡å°‘å…¨å±€å˜é‡</li> <li>å¢å¼ºæ¨¡å—æ€§ï¼ŒæŠŠè‡ªå·±çš„ä»£ç ç»„ç»‡åœ¨ä¸€ä¸ªå…¨å±€å˜é‡åä¸‹ï¼Œæ”¾åœ¨å•ä¸€ä½ç½®ï¼Œä¾¿äºç»´æŠ¤</li> <li>ä¸”åªä¼šå®ä¾‹åŒ–ä¸€æ¬¡ã€‚ç®€åŒ–äº†ä»£ç çš„è°ƒè¯•å’Œç»´æŠ¤</li></ul> <p><strong>ç¼ºç‚¹</strong></p> <ul><li>ç”±äºå•ä¾‹æ¨¡å¼æä¾›çš„æ˜¯ä¸€ç§å•ç‚¹è®¿é—®ï¼Œæ‰€ä»¥å®ƒæœ‰å¯èƒ½å¯¼è‡´æ¨¡å—é—´çš„å¼ºè€¦åˆ</li> <li>ä»è€Œä¸åˆ©äºå•å…ƒæµ‹è¯•ã€‚æ— æ³•å•ç‹¬æµ‹è¯•ä¸€ä¸ªè°ƒç”¨äº†æ¥è‡ªå•ä¾‹çš„æ–¹æ³•çš„ç±»ï¼Œè€Œåªèƒ½æŠŠå®ƒä¸é‚£ä¸ªå•ä¾‹ä½œä¸ºä¸€
ä¸ªå•å…ƒä¸€èµ·æµ‹è¯•ã€‚</li></ul> <h3 id="_5-ç­–ç•¥æ¨¡å¼"><a href="http://interview.poetries.top/docs/simply.html#_5-%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F" class="header-anchor">#</a> 5. ç­–ç•¥æ¨¡å¼</h3> <blockquote><p>ç­–ç•¥æ¨¡å¼ç®€å•æè¿°å°±æ˜¯ï¼šå¯¹è±¡æœ‰æŸä¸ªè¡Œä¸ºï¼Œä½†æ˜¯åœ¨ä¸åŒçš„åœºæ™¯ä¸­ï¼Œè¯¥è¡Œä¸ºæœ‰ä¸åŒçš„å®ç°ç®—æ³•ã€‚æŠŠå®ƒä»¬ä¸€ä¸ªä¸ªå°è£…èµ·æ¥ï¼Œå¹¶ä¸”ä½¿å®ƒä»¬å¯ä»¥äº’ç›¸æ›¿æ¢</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;ç­–ç•¥æ¨¡å¼-æ ¡éªŒè¡¨å•&lt;/title&gt;
    &lt;meta content="text/html; charset=utf-8" http-equiv="Content-Type"&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;form id = "registerForm" method="post" action="http://xxxx.com/api/register"&gt;
        ç”¨æˆ·åï¼š&lt;input type="text" name="userName"&gt;
        å¯†ç ï¼š&lt;input type="text" name="password"&gt;
        æ‰‹æœºå·ç ï¼š&lt;input type="text" name="phoneNumber"&gt;
        &lt;button type="submit"&gt;æäº¤&lt;/button&gt;
    &lt;/form&gt;
    &lt;script type="text/javascript"&gt;
        // ç­–ç•¥å¯¹è±¡
        const strategies = {
          isNoEmpty: function (value, errorMsg) {
            if (value === '') {
              return errorMsg;
            }
          },
          isNoSpace: function (value, errorMsg) {
            if (value.trim() === '') {
              return errorMsg;
            }
          },
          minLength: function (value, length, errorMsg) {
            if (value.trim().length &lt; length) {
              return errorMsg;
            }
          },
          maxLength: function (value, length, errorMsg) {
            if (value.length &gt; length) {
              return errorMsg;
            }
          },
          isMobile: function (value, errorMsg) {
            if (!/^(13[0-9]|14[5|7]|15[0|1|2|3|5|6|7|8|9]|17[7]|18[0|1|2|3|5|6|7|8|9])\d{8}$/.test(value)) {
              return errorMsg;
            }                
          }
        }
        
        // éªŒè¯ç±»
        class Validator {
          constructor() {
            this.cache = []
          }
          add(dom, rules) {
            for(let i = 0, rule; rule = rules[i++];) {
              let strategyAry = rule.strategy.split(':')
              let errorMsg = rule.errorMsg
              this.cache.push(() =&gt; {
                let strategy = strategyAry.shift()
                strategyAry.unshift(dom.value)
                strategyAry.push(errorMsg)
                return strategies[strategy].apply(dom, strategyAry)
              })
            }
          }
          start() {
            for(let i = 0, validatorFunc; validatorFunc = this.cache[i++];) {
              let errorMsg = validatorFunc()
              if (errorMsg) {
                return errorMsg
              }
            }
          }
        }

        // è°ƒç”¨ä»£ç 
        let registerForm = document.getElementById('registerForm')

        let validataFunc = function() {
          let validator = new Validator()
          validator.add(registerForm.userName, [{
            strategy: 'isNoEmpty',
            errorMsg: 'ç”¨æˆ·åä¸å¯ä¸ºç©º'
          }, {
            strategy: 'isNoSpace',
            errorMsg: 'ä¸å…è®¸ä»¥ç©ºç™½å­—ç¬¦å‘½å'
          }, {
            strategy: 'minLength:2',
            errorMsg: 'ç”¨æˆ·åé•¿åº¦ä¸èƒ½å°äº2ä½'
          }])
          validator.add(registerForm.password, [ {
            strategy: 'minLength:6',
            errorMsg: 'å¯†ç é•¿åº¦ä¸èƒ½å°äº6ä½'
          }])
          validator.add(registerForm.phoneNumber, [{
            strategy: 'isMobile',
            errorMsg: 'è¯·è¾“å…¥æ­£ç¡®çš„æ‰‹æœºå·ç æ ¼å¼'
          }])
          return validator.start()
        }

        registerForm.onsubmit = function() {
          let errorMsg = validataFunc()
          if (errorMsg) {
            alert(errorMsg)
            return false
          }
        }
    &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre></div><p><strong>åœºæ™¯ä¾‹å­</strong></p> <ul><li>å¦‚æœåœ¨ä¸€ä¸ªç³»ç»Ÿé‡Œé¢æœ‰è®¸å¤šç±»ï¼Œå®ƒä»¬ä¹‹é—´çš„åŒºåˆ«ä»…åœ¨äºå®ƒä»¬çš„'è¡Œä¸º'ï¼Œé‚£ä¹ˆä½¿ç”¨ç­–ç•¥æ¨¡å¼å¯ä»¥åŠ¨æ€åœ°è®©ä¸€ä¸ªå¯¹è±¡åœ¨è®¸å¤šè¡Œä¸ºä¸­é€‰æ‹©ä¸€ç§è¡Œä¸ºã€‚</li> <li>ä¸€ä¸ªç³»ç»Ÿéœ€è¦åŠ¨æ€åœ°åœ¨å‡ ç§ç®—æ³•ä¸­é€‰æ‹©ä¸€ç§ã€‚</li> <li>è¡¨å•éªŒè¯</li></ul> <p><strong>ä¼˜ç‚¹</strong></p> <ul><li>åˆ©ç”¨ç»„åˆã€å§”æ‰˜ã€å¤šæ€ç­‰æŠ€æœ¯å’Œæ€æƒ³ï¼Œå¯ä»¥æœ‰æ•ˆçš„é¿å…å¤šé‡æ¡ä»¶é€‰æ‹©è¯­å¥</li> <li>æä¾›äº†å¯¹å¼€æ”¾-å°é—­åŸåˆ™çš„å®Œç¾æ”¯æŒï¼Œå°†ç®—æ³•å°è£…åœ¨ç‹¬ç«‹çš„strategyä¸­ï¼Œä½¿å¾—å®ƒä»¬æ˜“äºåˆ‡æ¢ï¼Œç†è§£ï¼Œæ˜“äºæ‰©å±•</li> <li>åˆ©ç”¨ç»„åˆå’Œå§”æ‰˜æ¥è®©Contextæ‹¥æœ‰æ‰§è¡Œç®—æ³•çš„èƒ½åŠ›ï¼Œè¿™ä¹Ÿæ˜¯ç»§æ‰¿çš„ä¸€ç§æ›´è½»ä¾¿çš„ä»£æ›¿æ–¹æ¡ˆ</li></ul> <p><strong>ç¼ºç‚¹</strong></p> <ul><li>ä¼šåœ¨ç¨‹åºä¸­å¢åŠ è®¸å¤šç­–ç•¥ç±»æˆ–è€…ç­–ç•¥å¯¹è±¡</li> <li>è¦ä½¿ç”¨ç­–ç•¥æ¨¡å¼ï¼Œå¿…é¡»äº†è§£æ‰€æœ‰çš„strategyï¼Œå¿…é¡»äº†è§£å„ä¸ªstrategyä¹‹é—´çš„ä¸åŒç‚¹ï¼Œè¿™æ ·æ‰èƒ½é€‰æ‹©ä¸€ä¸ªåˆé€‚çš„strategy</li></ul> <h3 id="_6-è¿­ä»£å™¨æ¨¡å¼"><a href="http://interview.poetries.top/docs/simply.html#_6-%E8%BF%AD%E4%BB%A3%E5%99%A8%E6%A8%A1%E5%BC%8F" class="header-anchor">#</a> 6. è¿­ä»£å™¨æ¨¡å¼</h3> <blockquote><p>å¦‚æœä½ çœ‹åˆ°è¿™ï¼ŒES6ä¸­çš„è¿­ä»£å™¨ Iterator ç›¸ä¿¡ä½ è¿˜æ˜¯æœ‰ç‚¹å°è±¡çš„ï¼Œä¸Šé¢ç¬¬60æ¡å·²ç»åšè¿‡ç®€å•çš„ä»‹ç»ã€‚è¿­ä»£å™¨æ¨¡å¼ç®€å•çš„è¯´å°±æ˜¯æä¾›ä¸€ç§æ–¹æ³•é¡ºåºä¸€ä¸ªèšåˆå¯¹è±¡ä¸­å„ä¸ªå…ƒç´ ï¼Œè€Œåˆä¸æš´éœ²è¯¥å¯¹è±¡çš„å†…éƒ¨è¡¨ç¤ºã€‚</p></blockquote> <p><strong>è¿­ä»£å™¨æ¨¡å¼è§£å†³äº†ä»¥ä¸‹é—®é¢˜ï¼š</strong></p> <ul><li>æä¾›ä¸€è‡´çš„éå†å„ç§æ•°æ®ç»“æ„çš„æ–¹å¼ï¼Œè€Œä¸ç”¨äº†è§£æ•°æ®çš„å†…éƒ¨ç»“æ„</li> <li>æä¾›éå†å®¹å™¨ï¼ˆé›†åˆï¼‰çš„èƒ½åŠ›è€Œæ— éœ€æ”¹å˜å®¹å™¨çš„æ¥å£</li></ul> <p><strong>ä¸€ä¸ªè¿­ä»£å™¨é€šå¸¸éœ€è¦å®ç°ä»¥ä¸‹æ¥å£ï¼š</strong></p> <ul><li>hasNext()ï¼šåˆ¤æ–­è¿­ä»£æ˜¯å¦ç»“æŸï¼Œè¿”å›Boolean</li> <li>next()ï¼šæŸ¥æ‰¾å¹¶è¿”å›ä¸‹ä¸€ä¸ªå…ƒç´ </li></ul> <p>ä¸ºJavascriptçš„æ•°ç»„å®ç°ä¸€ä¸ªè¿­ä»£å™¨å¯ä»¥è¿™ä¹ˆå†™ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> item <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'red'</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token number">3.14</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">Iterator</span><span class="token punctuation">(</span><span class="token parameter">items</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>items <span class="token operator">=</span> items<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token class-name">Iterator</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">hasNext</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>index <span class="token operator">&lt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>items<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">next</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>items<span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>index<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>éªŒè¯ä¸€ä¸‹è¿­ä»£å™¨æ˜¯å¦å·¥ä½œï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>const iterator = new Iterator(item);

while(iterator.hasNext()){
  console.log(iterator.next());
}
//è¾“å‡ºï¼š1, red, false, 3.14
</code></pre></div><blockquote><p>ES6æä¾›äº†æ›´ç®€å•çš„è¿­ä»£å¾ªç¯è¯­æ³• for...ofï¼Œä½¿ç”¨è¯¥è¯­æ³•çš„å‰ææ˜¯æ“ä½œå¯¹è±¡éœ€è¦å®ç° å¯è¿­ä»£åè®®ï¼ˆThe iterable protocolï¼‰ï¼Œç®€å•è¯´å°±æ˜¯è¯¥å¯¹è±¡æœ‰ä¸ªKeyä¸º Symbol.iterator çš„æ–¹æ³•ï¼Œè¯¥æ–¹æ³•è¿”å›ä¸€ä¸ªiteratorå¯¹è±¡ã€‚</p></blockquote> <p>æ¯”å¦‚æˆ‘ä»¬å®ç°ä¸€ä¸ª Range ç±»ç”¨äºåœ¨æŸä¸ªæ•°å­—åŒºé—´è¿›è¡Œè¿­ä»£ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>function Range(start, end) {
  return {
    [Symbol.iterator]: function () {
      return {
        next() {
          if (start &lt; end) {
            return { value: start++, done: false };
          }
          return { done: true, value: end };
        }
      }
    }
  }
}
</code></pre></div><p>éªŒè¯ä¸€ä¸‹ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>for (num of Range(1, 5)) {
  console.log(num);
}
// è¾“å‡ºï¼š1, 2, 3, 4
</code></pre></div><h3 id="_7-è§‚å¯Ÿè€…æ¨¡å¼"><a href="http://interview.poetries.top/docs/simply.html#_7-%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F" class="header-anchor">#</a> 7. è§‚å¯Ÿè€…æ¨¡å¼</h3> <blockquote><p>è§‚å¯Ÿè€…æ¨¡å¼åˆç§°å‘å¸ƒ-è®¢é˜…æ¨¡å¼ï¼ˆPublish/Subscribe Patternï¼‰ï¼Œæ˜¯æˆ‘ä»¬ç»å¸¸æ¥è§¦åˆ°çš„è®¾è®¡æ¨¡å¼ï¼Œæ—¥å¸¸ç”Ÿæ´»ä¸­çš„åº”ç”¨ä¹Ÿæ¯”æ¯”çš†æ˜¯ï¼Œæ¯”å¦‚ä½ è®¢é˜…äº†æŸä¸ªåšä¸»çš„é¢‘é“ï¼Œå½“æœ‰å†…å®¹æ›´æ–°æ—¶ä¼šæ”¶åˆ°æ¨é€ï¼›åˆæ¯”å¦‚JavaScriptä¸­çš„äº‹ä»¶è®¢é˜…å“åº”æœºåˆ¶ã€‚è§‚å¯Ÿè€…æ¨¡å¼çš„æ€æƒ³ç”¨ä¸€å¥è¯æè¿°å°±æ˜¯ï¼šè¢«è§‚å¯Ÿå¯¹è±¡ï¼ˆsubjectï¼‰ç»´æŠ¤ä¸€ç»„è§‚å¯Ÿè€…ï¼ˆobserverï¼‰ï¼Œå½“è¢«è§‚å¯Ÿå¯¹è±¡çŠ¶æ€æ”¹å˜æ—¶ï¼Œé€šè¿‡è°ƒç”¨è§‚å¯Ÿè€…çš„æŸä¸ªæ–¹æ³•å°†è¿™äº›å˜åŒ–é€šçŸ¥åˆ°è§‚å¯Ÿè€…ã€‚</p></blockquote> <p><strong>è§‚å¯Ÿè€…æ¨¡å¼ä¸­Subjectå¯¹è±¡ä¸€èˆ¬éœ€è¦å®ç°ä»¥ä¸‹APIï¼š</strong></p> <ul><li>subscribe(): æ¥æ”¶ä¸€ä¸ªè§‚å¯Ÿè€…observerå¯¹è±¡ï¼Œä½¿å…¶è®¢é˜…è‡ªå·±</li> <li>unsubscribe(): æ¥æ”¶ä¸€ä¸ªè§‚å¯Ÿè€…observerå¯¹è±¡ï¼Œä½¿å…¶å–æ¶ˆè®¢é˜…è‡ªå·±</li> <li>fire(): è§¦å‘äº‹ä»¶ï¼Œé€šçŸ¥åˆ°æ‰€æœ‰è§‚å¯Ÿè€…</li></ul> <p><strong>ç”¨JavaScriptæ‰‹åŠ¨å®ç°è§‚å¯Ÿè€…æ¨¡å¼ï¼š</strong></p> <div class="language- extra-class"><pre class="language-text"><code>// è¢«è§‚å¯Ÿè€…
function Subject() {
  this.observers = [];
}

Subject.prototype = {
  // è®¢é˜…
  subscribe: function (observer) {
    this.observers.push(observer);
  },
  // å–æ¶ˆè®¢é˜…
  unsubscribe: function (observerToRemove) {
    this.observers = this.observers.filter(observer =&gt; {
      return observer !== observerToRemove;
    })
  },
  // äº‹ä»¶è§¦å‘
  fire: function () {
    this.observers.forEach(observer =&gt; {
      observer.call();
    });
  }
}
</code></pre></div><p>éªŒè¯ä¸€ä¸‹è®¢é˜…æ˜¯å¦æˆåŠŸï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>const subject = new Subject();

function observer1() {
  console.log('Observer 1 Firing!');
}


function observer2() {
  console.log('Observer 2 Firing!');
}

subject.subscribe(observer1);
subject.subscribe(observer2);
subject.fire();

//è¾“å‡ºï¼š
Observer 1 Firing! 
Observer 2 Firing!
</code></pre></div><p>éªŒè¯ä¸€ä¸‹å–æ¶ˆè®¢é˜…æ˜¯å¦æˆåŠŸï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>subject.unsubscribe(observer2);
subject.fire();

//è¾“å‡ºï¼š
Observer 1 Firing!
</code></pre></div><p><strong>åœºæ™¯</strong></p> <ul><li>DOMäº‹ä»¶</li></ul> <div class="language- extra-class"><pre class="language-text"><code>document.body.addEventListener('click', function() {
    console.log('hello world!');
});
document.body.click()
</code></pre></div><ul><li>vue å“åº”å¼</li></ul> <p><strong>ä¼˜ç‚¹</strong></p> <ul><li>æ”¯æŒç®€å•çš„å¹¿æ’­é€šä¿¡ï¼Œè‡ªåŠ¨é€šçŸ¥æ‰€æœ‰å·²ç»è®¢é˜…è¿‡çš„å¯¹è±¡</li> <li>ç›®æ ‡å¯¹è±¡ä¸è§‚å¯Ÿè€…ä¹‹é—´çš„æŠ½è±¡è€¦åˆå…³ç³»èƒ½å•ç‹¬æ‰©å±•ä»¥åŠé‡ç”¨</li> <li>å¢åŠ äº†çµæ´»æ€§</li> <li>è§‚å¯Ÿè€…æ¨¡å¼æ‰€åšçš„å·¥ä½œå°±æ˜¯åœ¨è§£è€¦ï¼Œè®©è€¦åˆçš„åŒæ–¹éƒ½ä¾èµ–äºæŠ½è±¡ï¼Œè€Œä¸æ˜¯ä¾èµ–äºå…·ä½“ã€‚ä»è€Œä½¿å¾—å„è‡ªçš„å˜åŒ–éƒ½ä¸ä¼šå½±å“åˆ°å¦ä¸€è¾¹çš„å˜åŒ–ã€‚</li></ul> <p><strong>ç¼ºç‚¹</strong></p> <blockquote><p>è¿‡åº¦ä½¿ç”¨ä¼šå¯¼è‡´å¯¹è±¡ä¸å¯¹è±¡ä¹‹é—´çš„è”ç³»å¼±åŒ–ï¼Œä¼šå¯¼è‡´ç¨‹åºéš¾ä»¥è·Ÿè¸ªç»´æŠ¤å’Œç†è§£</p></blockquote> <h3 id="_8-ä¸­ä»‹è€…æ¨¡å¼"><a href="http://interview.poetries.top/docs/simply.html#_8-%E4%B8%AD%E4%BB%8B%E8%80%85%E6%A8%A1%E5%BC%8F" class="header-anchor">#</a> 8. ä¸­ä»‹è€…æ¨¡å¼</h3> <ul><li>åœ¨ä¸­ä»‹è€…æ¨¡å¼ä¸­ï¼Œä¸­ä»‹è€…ï¼ˆMediatorï¼‰åŒ…è£…äº†ä¸€ç³»åˆ—å¯¹è±¡ç›¸äº’ä½œç”¨çš„æ–¹å¼ï¼Œä½¿å¾—è¿™äº›å¯¹è±¡ä¸å¿…ç›´æ¥ç›¸äº’ä½œç”¨ï¼Œè€Œæ˜¯ç”±ä¸­ä»‹è€…åè°ƒå®ƒä»¬ä¹‹é—´çš„äº¤äº’ï¼Œä»è€Œä½¿å®ƒä»¬å¯ä»¥æ¾æ•£å¶åˆã€‚å½“æŸäº›å¯¹è±¡ä¹‹é—´çš„ä½œç”¨å‘ç”Ÿæ”¹å˜æ—¶ï¼Œä¸ä¼šç«‹å³å½±å“å…¶ä»–çš„ä¸€äº›å¯¹è±¡ä¹‹é—´çš„ä½œç”¨ï¼Œä¿è¯è¿™äº›ä½œç”¨å¯ä»¥å½¼æ­¤ç‹¬ç«‹çš„å˜åŒ–ã€‚</li> <li>ä¸­ä»‹è€…æ¨¡å¼å’Œè§‚å¯Ÿè€…æ¨¡å¼æœ‰ä¸€å®šçš„ç›¸ä¼¼æ€§ï¼Œéƒ½æ˜¯ä¸€å¯¹å¤šçš„å…³ç³»ï¼Œä¹Ÿéƒ½æ˜¯é›†ä¸­å¼é€šä¿¡ï¼Œä¸åŒçš„æ˜¯ä¸­ä»‹è€…æ¨¡å¼æ˜¯å¤„ç†åŒçº§å¯¹è±¡ä¹‹é—´çš„äº¤äº’ï¼Œè€Œè§‚å¯Ÿè€…æ¨¡å¼æ˜¯å¤„ç†Observerå’ŒSubjectä¹‹é—´çš„äº¤äº’ã€‚ä¸­ä»‹è€…æ¨¡å¼æœ‰äº›åƒå©šæ‹ä¸­ä»‹ï¼Œç›¸äº²å¯¹è±¡åˆšå¼€å§‹å¹¶ä¸èƒ½ç›´æ¥äº¤æµï¼Œè€Œæ˜¯è¦é€šè¿‡ä¸­ä»‹å»ç­›é€‰åŒ¹é…å†å†³å®šè°å’Œè°è§é¢ã€‚</li></ul> <p><strong>åœºæ™¯</strong></p> <blockquote><p>ä¾‹å¦‚è´­ç‰©è½¦éœ€æ±‚ï¼Œå­˜åœ¨å•†å“é€‰æ‹©è¡¨å•ã€é¢œè‰²é€‰æ‹©è¡¨å•ã€è´­ä¹°æ•°é‡è¡¨å•ç­‰ç­‰ï¼Œéƒ½ä¼šè§¦å‘changeäº‹ä»¶ï¼Œé‚£ä¹ˆå¯ä»¥é€šè¿‡ä¸­ä»‹è€…æ¥è½¬å‘å¤„ç†è¿™äº›äº‹ä»¶ï¼Œå®ç°å„ä¸ªäº‹ä»¶é—´çš„è§£è€¦ï¼Œä»…ä»…ç»´æŠ¤ä¸­ä»‹è€…å¯¹è±¡å³å¯ã€‚</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> goods <span class="token operator">=</span> <span class="token punctuation">{</span>   <span class="token comment">//æ‰‹æœºåº“å­˜</span>
    <span class="token string">'red|32G'</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
    <span class="token string">'red|64G'</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token string">'blue|32G'</span><span class="token operator">:</span> <span class="token number">7</span><span class="token punctuation">,</span>
    <span class="token string">'blue|32G'</span><span class="token operator">:</span> <span class="token number">6</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">//ä¸­ä»‹è€…</span>
<span class="token keyword">var</span> mediator <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> colorSelect <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'colorSelect'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> memorySelect <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'memorySelect'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> numSelect <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'numSelect'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
        <span class="token function-variable function">changed</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">switch</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token keyword">case</span> colorSelect<span class="token operator">:</span>
                    <span class="token comment">//TODO</span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token keyword">case</span> memorySelect<span class="token operator">:</span>
                    <span class="token comment">//TODO</span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token keyword">case</span> numSelect<span class="token operator">:</span>
                    <span class="token comment">//TODO</span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
colorSelect<span class="token punctuation">.</span><span class="token function-variable function">onchange</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    mediator<span class="token punctuation">.</span><span class="token function">changed</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
memorySelect<span class="token punctuation">.</span><span class="token function-variable function">onchange</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    mediator<span class="token punctuation">.</span><span class="token function">changed</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
numSelect<span class="token punctuation">.</span><span class="token function-variable function">onchange</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    mediator<span class="token punctuation">.</span><span class="token function">changed</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>èŠå¤©å®¤é‡Œ</li></ul> <p>èŠå¤©å®¤æˆå‘˜ç±»ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>function Member(name) {
  this.name = name;
  this.chatroom = null;
}

Member.prototype = {
  // å‘é€æ¶ˆæ¯
  send: function (message, toMember) {
    this.chatroom.send(message, this, toMember);
  },
  // æ¥æ”¶æ¶ˆæ¯
  receive: function (message, fromMember) {
    console.log(`${fromMember.name} to ${this.name}: ${message}`);
  }
}
</code></pre></div><p><strong>èŠå¤©å®¤ç±»ï¼š</strong></p> <div class="language- extra-class"><pre class="language-text"><code>function Chatroom() {
  this.members = {};
}

Chatroom.prototype = {
  // å¢åŠ æˆå‘˜
  addMember: function (member) {
    this.members[member.name] = member;
    member.chatroom = this;
  },
  // å‘é€æ¶ˆæ¯
  send: function (message, fromMember, toMember) {
    toMember.receive(message, fromMember);
  }
}
</code></pre></div><p><strong>æµ‹è¯•ä¸€ä¸‹ï¼š</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> chatroom <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Chatroom</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> bruce <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Member</span><span class="token punctuation">(</span><span class="token string">'bruce'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> frank <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Member</span><span class="token punctuation">(</span><span class="token string">'frank'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

chatroom<span class="token punctuation">.</span><span class="token function">addMember</span><span class="token punctuation">(</span>bruce<span class="token punctuation">)</span><span class="token punctuation">;</span>
chatroom<span class="token punctuation">.</span><span class="token function">addMember</span><span class="token punctuation">(</span>frank<span class="token punctuation">)</span><span class="token punctuation">;</span>

bruce<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'Hey frank'</span><span class="token punctuation">,</span> frank<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//è¾“å‡ºï¼šbruce to frank: hello frank</span>
</code></pre></div><p><strong>ä¼˜ç‚¹</strong></p> <ul><li>ä½¿å„å¯¹è±¡ä¹‹é—´è€¦åˆæ¾æ•£ï¼Œè€Œä¸”å¯ä»¥ç‹¬ç«‹åœ°æ”¹å˜å®ƒä»¬ä¹‹é—´çš„äº¤äº’</li> <li>ä¸­ä»‹è€…å’Œå¯¹è±¡ä¸€å¯¹å¤šçš„å…³ç³»å–ä»£äº†å¯¹è±¡ä¹‹é—´çš„ç½‘çŠ¶å¤šå¯¹å¤šçš„å…³ç³»</li> <li>å¦‚æœå¯¹è±¡ä¹‹é—´çš„å¤æ‚è€¦åˆåº¦å¯¼è‡´ç»´æŠ¤å¾ˆå›°éš¾ï¼Œè€Œä¸”è€¦åˆåº¦éšé¡¹ç›®å˜åŒ–å¢é€Ÿå¾ˆå¿«ï¼Œå°±éœ€è¦ä¸­ä»‹è€…é‡æ„ä»£ç </li></ul> <p><strong>ç¼ºç‚¹</strong></p> <blockquote><p>ç³»ç»Ÿä¸­ä¼šæ–°å¢ä¸€ä¸ªä¸­ä»‹è€…å¯¹è±¡ï¼Œå› ä¸ºå¯¹è±¡ä¹‹é—´äº¤äº’çš„å¤æ‚æ€§ï¼Œè½¬ç§»æˆäº†ä¸­ä»‹è€…å¯¹è±¡çš„å¤æ‚æ€§ï¼Œä½¿å¾—ä¸­ä»‹è€…å¯¹è±¡ç»å¸¸æ˜¯å·¨å¤§çš„ã€‚ä¸­ä»‹ è€…å¯¹è±¡è‡ªèº«å¾€å¾€å°±æ˜¯ä¸€ä¸ªéš¾ä»¥ç»´æŠ¤çš„å¯¹è±¡ã€‚</p></blockquote> <h3 id="_9-è®¿é—®è€…æ¨¡å¼"><a href="http://interview.poetries.top/docs/simply.html#_9-%E8%AE%BF%E9%97%AE%E8%80%85%E6%A8%A1%E5%BC%8F" class="header-anchor">#</a> 9. è®¿é—®è€…æ¨¡å¼</h3> <blockquote><p>è®¿é—®è€…æ¨¡å¼ æ˜¯ä¸€ç§å°†ç®—æ³•ä¸å¯¹è±¡ç»“æ„åˆ†ç¦»çš„è®¾è®¡æ¨¡å¼ï¼Œé€šä¿—ç‚¹è®²å°±æ˜¯ï¼šè®¿é—®è€…æ¨¡å¼è®©æˆ‘ä»¬èƒ½å¤Ÿåœ¨ä¸æ”¹å˜ä¸€ä¸ªå¯¹è±¡ç»“æ„çš„å‰æä¸‹èƒ½å¤Ÿç»™è¯¥å¯¹è±¡å¢åŠ æ–°çš„é€»è¾‘ï¼Œæ–°å¢çš„é€»è¾‘ä¿å­˜åœ¨ä¸€ä¸ªç‹¬ç«‹çš„è®¿é—®è€…å¯¹è±¡ä¸­ã€‚è®¿é—®è€…æ¨¡å¼å¸¸ç”¨äºæ‹“å±•ä¸€äº›ç¬¬ä¸‰æ–¹çš„åº“å’Œå·¥å…·ã€‚</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// è®¿é—®è€…  </span>
<span class="token keyword">class</span> <span class="token class-name">Visitor</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token function">visitConcreteElement</span><span class="token punctuation">(</span><span class="token parameter">ConcreteElement</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        ConcreteElement<span class="token punctuation">.</span><span class="token function">operation</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// å…ƒç´ ç±»  </span>
<span class="token keyword">class</span> <span class="token class-name">ConcreteElement</span><span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
    <span class="token function">operation</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
       console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"ConcreteElement.operation invoked"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>
    <span class="token function">accept</span><span class="token punctuation">(</span><span class="token parameter">visitor</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        visitor<span class="token punctuation">.</span><span class="token function">visitConcreteElement</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// client</span>
<span class="token keyword">let</span> visitor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Visitor</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> element <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ConcreteElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
elementA<span class="token punctuation">.</span><span class="token function">accept</span><span class="token punctuation">(</span>visitor<span class="token punctuation">)</span>
</code></pre></div><p><strong>è®¿é—®è€…æ¨¡å¼çš„å®ç°æœ‰ä»¥ä¸‹å‡ ä¸ªè¦ç´ ï¼š</strong></p> <ul><li>Visitor Objectï¼šè®¿é—®è€…å¯¹è±¡ï¼Œæ‹¥æœ‰ä¸€ä¸ªvisit()æ–¹æ³•</li> <li>Receiving Objectï¼šæ¥æ”¶å¯¹è±¡ï¼Œæ‹¥æœ‰ä¸€ä¸ª accept() æ–¹æ³•</li> <li>visit(receivingObj)ï¼šç”¨äºVisitoræ¥æ”¶ä¸€ä¸ªReceiving Object</li> <li>accept(visitor)ï¼šç”¨äºReceving Objectæ¥æ”¶ä¸€ä¸ªVisitorï¼Œå¹¶é€šè¿‡è°ƒç”¨Visitorçš„ visit() ä¸ºå…¶æä¾›è·å–Receiving Objectæ•°æ®çš„èƒ½åŠ›</li></ul> <p>ç®€å•çš„ä»£ç å®ç°å¦‚ä¸‹ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>Receiving Objectï¼š

function Employee(name, salary) {
  this.name = name;
  this.salary = salary;
}

Employee.prototype = {
  getSalary: function () {
    return this.salary;
  },
  setSalary: function (salary) {
    this.salary = salary;
  },
  accept: function (visitor) {
    visitor.visit(this);
  }
}
Visitor Objectï¼š

function Visitor() { }

Visitor.prototype = {
  visit: function (employee) {
    employee.setSalary(employee.getSalary() * 2);
  }
}
</code></pre></div><p>éªŒè¯ä¸€ä¸‹ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>const employee = new Employee('bruce', 1000);
const visitor = new Visitor();
employee.accept(visitor);

console.log(employee.getSalary());//è¾“å‡ºï¼š2000
</code></pre></div><p>åœºæ™¯</p> <p>å¯¹è±¡ç»“æ„ä¸­å¯¹è±¡å¯¹åº”çš„ç±»å¾ˆå°‘æ”¹å˜ï¼Œä½†ç»å¸¸éœ€è¦åœ¨æ­¤å¯¹è±¡ç»“æ„ä¸Šå®šä¹‰æ–°çš„æ“ä½œ</p> <p>éœ€è¦å¯¹ä¸€ä¸ªå¯¹è±¡ç»“æ„ä¸­çš„å¯¹è±¡è¿›è¡Œå¾ˆå¤šä¸åŒçš„å¹¶ä¸”ä¸ç›¸å…³çš„æ“ä½œï¼Œè€Œéœ€è¦é¿å…è®©è¿™äº›æ“ä½œ"æ±¡æŸ“"è¿™äº›å¯¹è±¡çš„ç±»ï¼Œä¹Ÿä¸å¸Œæœ›åœ¨å¢åŠ æ–°æ“ä½œæ—¶ä¿®æ”¹è¿™äº›ç±»ã€‚</p> <p><strong>ä¼˜ç‚¹</strong></p> <ul><li>ç¬¦åˆå•ä¸€èŒè´£åŸåˆ™</li> <li>ä¼˜ç§€çš„æ‰©å±•æ€§</li> <li>çµæ´»æ€§</li></ul> <p><strong>ç¼ºç‚¹</strong></p> <ul><li>å…·ä½“å…ƒç´ å¯¹è®¿é—®è€…å…¬å¸ƒç»†èŠ‚ï¼Œè¿åäº†è¿ªç±³ç‰¹åŸåˆ™</li> <li>è¿åäº†ä¾èµ–å€’ç½®åŸåˆ™ï¼Œä¾èµ–äº†å…·ä½“ç±»ï¼Œæ²¡æœ‰ä¾èµ–æŠ½è±¡ã€‚</li> <li>å…·ä½“å…ƒç´ å˜æ›´æ¯”è¾ƒå›°éš¾</li></ul> <h2 id="åã€ç»¼åˆé—®é¢˜"><a href="http://interview.poetries.top/docs/simply.html#%E5%8D%81%E3%80%81%E7%BB%BC%E5%90%88%E9%97%AE%E9%A2%98" class="header-anchor">#</a> åã€ç»¼åˆé—®é¢˜</h2> <p><strong>ç»å†</strong></p> <ul><li>æ•´ä¸ªç»å†è‡ªæˆ‘ä»‹ç»ï¼Œè¶Šè¯¦ç»†è¶Šå¥½ï¼Œä»€ä¹ˆæ—¶å€™æ¥è§¦è®¡ç®—æœºï¼Œä»€ä¹ˆæ—¶å€™æ¥è§¦å‰ç«¯ã€‚</li> <li>æ•´ä¸ªç»å†ä¸­ï¼Œä½ è®¤ä¸ºæœ€å€¼å¾—éª„å‚²çš„äº‹æƒ…ï¼Œæœ€éš¾çš„äº‹æƒ…æ˜¯ä»€ä¹ˆã€‚</li> <li>ä»€ä¹ˆäº‹æƒ…è®©ä½ è‡ªè±ªï¼Œä»€ä¹ˆäº‹æƒ…è®©ä½ æœ‰æŒ«è´¥æ„Ÿã€‚</li> <li>æœªæ¥çš„å‘å±•ï¼Œè‡ªå·±çš„è§„åˆ’ã€‚</li></ul> <p><strong>é¡¹ç›®ç›¸å…³</strong></p> <ul><li>é¡¹ç›®éš¾ç‚¹ã€‚ï¼ˆå¦‚ä½•å‘ç°é—®é¢˜ï¼Œè§£å†³æ€è·¯ï¼Œæœ€åç»“æœï¼‰</li> <li>é¡¹ç›®è€ƒè™‘è¿‡ä¼˜åŒ–å—ï¼Œä½ æ˜¯å¦‚ä½•ä¼˜åŒ–çš„ï¼Œæ€è·¯æ˜¯ä»€ä¹ˆã€‚</li> <li>é¡¹ç›®çš„ç»„ç»‡æ¶æ„ï¼Œä½ å¯¹å®ƒçš„ç°æœ‰æ¶æ„çš„ç†è§£ï¼Œå“ªäº›ä¼˜ç‚¹å€¼å¾—å€Ÿé‰´ï¼Œå“ªäº›ç¼ºç‚¹éœ€è¦æ”¹è¿›ã€‚</li> <li>å¦‚æœè®©ä½ ä»0åˆ°1å»ºä¸€ä¸ªé¡¹ç›®ï¼Œä½ è€ƒè™‘çš„ç‚¹æ˜¯ä»€ä¹ˆï¼Œæœ‰å“ªäº›æµç¨‹éœ€è¦æ³¨æ„çš„ã€‚</li> <li>é¡¹ç›®ä¸­ä»£ç è§„èŒƒï¼Œä½ ä»¬é¡¹ç›®æœ‰æ–¹æ¡ˆå—ï¼Œä½ äº†è§£çš„ä»£ç è§„èŒƒæœ‰å“ªäº›æ–¹æ¡ˆã€‚</li> <li>è¯´ä¸€è¯´é¡¹ç›®ä¸­ä½ ä»¬æ˜¯å¦‚ä½•æµ‹è¯•çš„ï¼Œæœ‰å“ªäº›å•å…ƒæµ‹è¯•æ–¹æ¡ˆï¼Œèƒ½ä¸èƒ½è¯´ä¸€è¯´ã€‚</li> <li>é¡¹ç›®ä¸­å¼•å…¥TSçš„åŸå› ï¼Œä¸ºä»€ä¹ˆè¿™ä¹ˆåšã€‚</li></ul></div> <!----> </body></html>